dhtmlx=function(B){for(var A in B)dhtmlx[A]=B[A];return dhtmlx};dhtmlx.extend_api=function(B,C,D){var A=window[B];if(!A)return;window[B]=function(E){if(E&&typeof E=="object"&&!E.tagName){var B=A.apply(this,(C._init?C._init(E):arguments));for(var D in dhtmlx)if(C[D])this[C[D]](dhtmlx[D]);for(D in E)if(C[D])this[C[D]](E[D]);else if(D.indexOf("on")==0)this.attachEvent(D,E[D])}else B=A.apply(this,arguments);if(C._patch)C._patch(this);return B||this};window[B].prototype=A.prototype;if(D)dhtmlXHeir(window[B].prototype,D)};dhtmlxAjax={get:function(C,B){var A=new dtmlXMLLoaderObject(true);A.async=(arguments.length<3);A.waitCall=B;A.loadXML(C);return A},post:function(D,B,C){var A=new dtmlXMLLoaderObject(true);A.async=(arguments.length<4);A.waitCall=C;A.loadXML(D,true,B);return A},getSync:function(A){return this.get(A,null,true)},postSync:function(B,A){return this.post(B,A,null,true)}};function dtmlXMLLoaderObject(A,D,C,B){this.xmlDoc="";if(typeof(C)!="undefined")this.async=C;else this.async=true;this.onloadAction=A||null;this.mainObject=D||null;this.waitCall=null;this.rSeed=B||false;return this}dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(B){var A=true;this.check=function(){if((B)&&(B.onloadAction!=null))if((!B.xmlDoc.readyState)||(B.xmlDoc.readyState==4)){if(!A)return;A=false;dtmlXMLLoaderObject.count++;if(typeof B.onloadAction=="function")B.onloadAction(B.mainObject,null,null,null,B);if(B.waitCall){B.waitCall.call(this,B);B.waitCall=null}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(B,A){if(this.xmlDoc.responseXML){var C=this.xmlDoc.responseXML.getElementsByTagName(B);if(C.length==0&&B.indexOf(":")!=-1)C=this.xmlDoc.responseXML.getElementsByTagName((B.split(":"))[1]);var D=C[0]}else D=this.xmlDoc.documentElement;if(D){this._retry=false;return D}if(!this._retry){this._retry=true;var A=this.xmlDoc;this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),true);return this.getXMLTopNode(B,A)}dhtmlxError.throwError("LoadXML","Incorrect XML",[(A||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(B,A){if(!_isIE){var C=new DOMParser();this.xmlDoc=C.parseFromString(B,"text/xml")}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.onreadystatechange=function(){};this.xmlDoc["loadXM"+"L"](B)}if(A)return;if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(B,C,D,A){if(this.rSeed)B+=((B.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf();this.filePath=B;if((!_isIE)&&(window.XMLHttpRequest))this.xmlDoc=new XMLHttpRequest();else this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP");if(this.async)this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);this.xmlDoc.open(C?"POST":"GET",B,this.async);if(A){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else if(C)this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||D);if(!this.async)(new this.waitLoadFunction(this))()};dtmlXMLLoaderObject.prototype.destructor=function(){this._filterXPath=null;this._getAllNamedChilds=null;this._retry=null;this.async=null;this.rSeed=null;this.filePath=null;this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;this.doXPath=null;this.doXPathOpera=null;this.doXSLTransToObject=null;this.doXSLTransToString=null;this.loadXML=null;this.loadXMLString=null;this.doSerialization=null;this.xmlNodeToJSON=null;this.getXMLTopNode=null;this.setXSLParamValue=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(A){var B={};for(var D=0;D<A.attributes.length;D++)B[A.attributes[D].name]=A.attributes[D].value;B["_tagvalue"]=A.firstChild?A.firstChild.nodeValue:"";for(D=0;D<A.childNodes.length;D++){var C=A.childNodes[D].tagName;if(C){if(!B[C])B[C]=[];B[C].push(this.xmlNodeToJSON(A.childNodes[D]))}}return B};function callerFunction(A,B){this.handler=function(C){if(!C)C=window.event;A(C,B);return true};return this.handler}function getAbsoluteLeft(A){return getOffset(A).left}function getAbsoluteTop(A){return getOffset(A).top}function getOffsetSum(A){var C=0,B=0;while(A){C=C+parseInt(A.offsetTop);B=B+parseInt(A.offsetLeft);A=A.offsetParent}return{top:C,left:B}}function getOffsetRect(A){var I=A.getBoundingClientRect(),B=document.body,E=document.documentElement,G=window.pageYOffset||E.scrollTop||B.scrollTop,F=window.pageXOffset||E.scrollLeft||B.scrollLeft,C=E.clientTop||B.clientTop||0,D=E.clientLeft||B.clientLeft||0,J=I.top+G-C,H=I.left+F-D;return{top:Math.round(J),left:Math.round(H)}}function getOffset(A){if(A.getBoundingClientRect)return getOffsetRect(A);else return getOffsetSum(A)}function convertStringToBoolean(A){if(typeof(A)=="string")A=A.toLowerCase();switch(A){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(A){if(A.indexOf("?")!=-1)return"&";else return"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop)return window.dhtmlDragAndDrop;this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(A){A.onmousedown=null;A.dragStarter=null;A.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(A,B){A.onmousedown=this.preCreateDragCopy;A.dragStarter=B;this.addDragLanding(A,B)};dhtmlDragAndDropObject.prototype.addDragLanding=function(A,B){A.dragLanding=B};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(A){if((A||window.event)&&(A||event).button==2)return;if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode)window.dhtmlDragAndDrop.stopDrag(A);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((A)&&(A.preventDefault)){A.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(A){if(!A)A=window.event;dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100)return;if(!dragger.dragNode)if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,A);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else return dragger.stopDrag(A,true);if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var E=dragger.gldragNode;if(dragger.gldragNode.old)E=dragger.gldragNode.old;E.parentNode.removeChild(E);var C=dragger.dragNode.pWindow;if(E.pWindow&&E.pWindow.dhtmlDragAndDrop.lastLanding)E.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(E.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var B=document.createElement("Div");B.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=B.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(true);dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);C.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=A.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=A.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!A.srcElement)var D=A.target;else D=A.srcElement;dragger.checkLanding(D,A)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(E){if(window.name){var B=parent.frames[window.name].frameElement.offsetParent,C=0,D=0;while(B){C+=B.offsetLeft;D+=B.offsetTop;B=B.offsetParent}if((parent.dhtmlDragAndDrop)){var A=parent.dhtmlDragAndDrop.calculateFramePosition(1);C+=A.split("_")[0]*1;D+=A.split("_")[1]*1}if(E)return C+"_"+D;else this.fx=C;this.fy=D}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(A,B){if((A)&&(A.dragLanding)){if(this.lastLanding)this.lastLanding.dragLanding._dragOut(this.lastLanding);this.lastLanding=A;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,B.clientX,B.clientY,B);this.lastLanding_scr=(_isIE?B.srcElement:B.target)}else if((A)&&(A.tagName!="BODY"))this.checkLanding(A.parentNode,B);else{if(this.lastLanding)this.lastLanding.dragLanding._dragOut(this.lastLanding,B.clientX,B.clientY,B);this.lastLanding=0;if(this._onNotFound)this._onNotFound()}};dhtmlDragAndDropObject.prototype.stopDrag=function(A,C){dragger=window.dhtmlDragAndDrop;if(!C){dragger.stopFrameRoute();var B=dragger.lastLanding;dragger.lastLanding=null;if(B)B.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,B,(_isIE?event.srcElement:A.target))}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body))dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(B){if(B)window.dhtmlDragAndDrop.stopDrag(1,1);for(var C=0;C<window.frames.length;C++){try{if((window.frames[C]!=B)&&(window.frames[C].dhtmlDragAndDrop))window.frames[C].dhtmlDragAndDrop.stopFrameRoute(window)}catch(A){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=B))parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(A){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(B,D){if(B){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=B.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=B.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=B.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=B.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(D))&&((!_isFF)||(_FFrv<1.8)))window.dhtmlDragAndDrop.calculateFramePosition()}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=B))parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(A){}for(var C=0;C<window.frames.length;C++){try{if((window.frames[C]!=B)&&(window.frames[C].dhtmlDragAndDrop))window.frames[C].dhtmlDragAndDrop.initFrameRoute(window,((!B||D)?1:0))}catch(A){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1)_isMacOS=true;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1)_isChrome=true;if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else _isKHTML=true}else if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat")_isIE=8}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}dtmlXMLLoaderObject.prototype.doXPath=function(F,D,I,A){if(_isKHTML||(!_isIE&&!window.XPathResult))return this.doXPathOpera(F,D);if(_isIE){if(!D)if(!this.xmlDoc.nodeName)D=this.xmlDoc.responseXML;else D=this.xmlDoc;if(!D)dhtmlxError.throwError("LoadXML","Incorrect XML",[(D||this.xmlDoc),this.mainObject]);if(I!=null)D.setProperty("SelectionNamespaces","xmlns:xsl='"+I+"'");if(A=="single")return D.selectSingleNode(F);else return D.selectNodes(F)||new Array(0)}else{var H=D;if(!D)if(!this.xmlDoc.nodeName)D=this.xmlDoc.responseXML;else D=this.xmlDoc;if(!D)dhtmlxError.throwError("LoadXML","Incorrect XML",[(D||this.xmlDoc),this.mainObject]);if(D.nodeName.indexOf("document")!=-1)H=D;else{H=D;D=D.ownerDocument}var E=XPathResult.ANY_TYPE;if(A=="single")E=XPathResult.FIRST_ORDERED_NODE_TYPE;var G=new Array(),B=D.evaluate(F,H,function(A){return I},E,null);if(E==XPathResult.FIRST_ORDERED_NODE_TYPE)return B.singleNodeValue;var C=B.iterateNext();while(C){G[G.length]=C;C=B.iterateNext()}return G}};function _dhtmlxError(C,A,B){if(!this.catches)this.catches=new Array();return this}_dhtmlxError.prototype.catchError=function(B,A){this.catches[B]=A};_dhtmlxError.prototype.throwError=function(C,A,B){if(this.catches[C])return this.catches[C](C,A,B);if(this.catches["ALL"])return this.catches["ALL"](C,A,B);alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(C,A){var D=C.replace(/[\/]+/gi,"/").split("/"),B=null,E=1;if(!D.length)return[];if(D[0]==".")B=[A];else if(D[0]==""){B=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(D[E].replace(/\[[^\]]*\]/g,""));E++}else return[];for(E;E<D.length;E++)B=this._getAllNamedChilds(B,D[E]);if(D[E-1].indexOf("[")!=-1)B=this._filterXPath(B,D[E-1]);return B};dtmlXMLLoaderObject.prototype._filterXPath=function(C,A){var B=new Array(),A=A.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var D=0;D<C.length;D++)if(C[D].getAttribute(A))B[B.length]=C[D];return B};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(C,A){var B=new Array();if(_isKHTML)A=A.toUpperCase();for(var E=0;E<C.length;E++)for(var D=0;D<C[E].childNodes.length;D++)if(_isKHTML){if(C[E].childNodes[D].tagName&&C[E].childNodes[D].tagName.toUpperCase()==A)B[B.length]=C[E].childNodes[D]}else if(C[E].childNodes[D].tagName==A)B[B.length]=C[E].childNodes[D];return B};function dhtmlXHeir(C,A){for(var B in A)if(typeof(A[B])=="function")C[B]=A[B];return C}function dhtmlxEvent(A,B,C){if(A.addEventListener)A.addEventListener(B,C,false);else if(A.attachEvent)A.attachEvent("on"+B,C)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(D,C,B){if(!B)B=this.xslDoc;if(B.responseXML)B=B.responseXML;var A=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+D+"']",B,"http://www.w3.org/1999/XSL/Transform","single");if(A!=null)A.firstChild.nodeValue=C};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(C,D){if(!C)C=this.xslDoc;if(C.responseXML)C=C.responseXML;if(!D)D=this.xmlDoc;if(D.responseXML)D=D.responseXML;if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(C)}var A=this.XSLProcessor.transformToDocument(D)}else{A=new ActiveXObject("Msxml2.DOMDocument.3.0");try{D.transformNodeToObject(C,A)}catch(B){A=D.transformNode(C)}}return A};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(B,C){var A=this.doXSLTransToObject(B,C);if(typeof(A)=="string")return A;return this.doSerialization(A)};dtmlXMLLoaderObject.prototype.doSerialization=function(B){if(!B)B=this.xmlDoc;if(B.responseXML)B=B.responseXML;if(!_isIE){var A=new XMLSerializer();return A.serializeToString(B)}else return B.xml};dhtmlxEventable=function(obj){obj.attachEvent=function(C,B,A){C="ev_"+C.toLowerCase();if(!this[C])this[C]=new this.eventCatcher(A||this);return(C+":"+this[C].addEvent(B))};obj.callEvent=function(B,A){B="ev_"+B.toLowerCase();if(this[B])return this[B].apply(this,A);return true};obj.checkEvent=function(A){return(!!this["ev_"+A.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){var A=true;for(var C=0;C<dhx_catch.length;C++)if(dhx_catch[C]!=null){var B=dhx_catch[C].apply(obj,arguments);A=A&&B}return A};z.addEvent=function(ev){if(typeof(ev)!="function")ev=eval(ev);if(ev)return dhx_catch.push(ev)-1;return false};z.removeEvent=function(A){dhx_catch[A]=null};return z};obj.detachEvent=function(A){if(A!=false){var B=A.split(":");this[B[0]].removeEvent(B[1])}};obj.detachAllEvents=function(){for(var A in this)if(A.indexOf("ev_")==0)delete this[A]};obj=null};if(!window.dhtmlx)window.dhtmlx={};(function(){var M=null;function K(C,A){var B=C.callback;L(false);C.box.parentNode.removeChild(C.box);M=C.box=null;if(B)B(A)}function F(A){if(M){A=A||event;var B=A.which||event.keyCode;if(dhtmlx.message.keyboard){if(B==13||B==32)K(M,true);if(B==27)K(M,false)}if(A.preventDefault)A.preventDefault();return!(A.cancelBubble=true)}}if(document.attachEvent)document.attachEvent("onkeydown",F);else document.addEventListener("keydown",F,true);function L(B){if(!L.cover){L.cover=document.createElement("DIV");L.cover.onkeydown=F;L.cover.className="dhx_modal_cover";document.body.appendChild(L.cover)}var A=document.body.scrollHeight;L.cover.style.display=B?"inline-block":"none"}function J(B,A){return"<div class='dhtmlx_popup_button' result='"+A+"' ><div>"+B+"</div></div>"}function G(B){if(!H.area){H.area=document.createElement("DIV");H.area.className="dhtmlx_message_area";H.area.style[H.position]="5px";document.body.appendChild(H.area)}H.hide(B.id);var A=document.createElement("DIV");A.innerHTML="<div>"+B.text+"</div>";A.className="dhtmlx-info dhtmlx-"+B.type;A.onclick=function(){H.hide(B.id);B=null};if(H.position=="bottom"&&H.area.firstChild)H.area.insertBefore(A,H.area.firstChild);else H.area.appendChild(A);if(B.expire>0)H.timers[B.id]=window.setTimeout(function(){H.hide(B.id)},B.expire);H.pull[B.id]=A;A=null;return B.id}function A(C,F,E){var D=document.createElement("DIV");D.className=" dhtmlx_modal_box dhtmlx-"+C.type;D.setAttribute("dhxbox",1);var B="";if(C.width)D.style.width=C.width;if(C.height)D.style.height=C.height;if(C.title)B+="<div class=\"dhtmlx_popup_title\">"+C.title+"</div>";B+="<div class=\"dhtmlx_popup_text\"><span>"+(C.content?"":C.text)+"</span></div><div class=\"dhtmlx_popup_controls\">";if(F)B+=J(C.ok||"OK",true);if(E)B+=J(C.cancel||"Cancel",false);if(C.buttons)for(var G=0;G<C.buttons.length;G++)B+=J(C.buttons[G],G);B+="</div>";D.innerHTML=B;if(C.content){var A=C.content;if(typeof A=="string")A=document.getElementById(A);if(A.style.display=="none")A.style.display="";D.childNodes[C.title?1:0].appendChild(A)}D.onclick=function(A){A=A||event;var B=A.target||A.srcElement;if(!B.className)B=B.parentNode;if(B.className=="dhtmlx_popup_button"){result=B.getAttribute("result");result=(result=="true")||(result=="false"?false:result);K(C,result)}};C.box=D;if(F||E)M=C;return D}function I(B,E,D){var C=B.tagName?B:A(B,E,D);if(!B.hidden)L(true);document.body.appendChild(C);var H=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-C.offsetWidth)/2)),G=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-C.offsetHeight)/2));if(B.position=="top")C.style.top="-3px";else C.style.top=G+"px";C.style.left=H+"px";C.onkeydown=F;C.focus();if(B.hidden)dhtmlx.modalbox.hide(C);return C}function B(A){return I(A,true,false)}function D(A){return I(A,true,true)}function N(A){return I(A)}function C(A,C,B){if(typeof A!="object"){if(typeof C=="function"){B=C;C=""}A={text:A,type:C,callback:B}}return A}function E(C,D,B,A){if(typeof C!="object")C={text:C,type:D,expire:B,id:A};C.id=C.id||H.uid();C.expire=C.expire||H.expire;return C}dhtmlx.alert=function(){text=C.apply(this,arguments);text.type=text.type||"confirm";return B(text)};dhtmlx.confirm=function(){text=C.apply(this,arguments);text.type=text.type||"alert";return D(text)};dhtmlx.modalbox=function(){text=C.apply(this,arguments);text.type=text.type||"alert";return N(text)};dhtmlx.modalbox.hide=function(A){while(A&&A.getAttribute&&!A.getAttribute("dhxbox"))A=A.parentNode;if(A){A.parentNode.removeChild(A);L(false)}};var H=dhtmlx.message=function(F,I,C,A){F=E.apply(this,arguments);F.type=F.type||"info";var H=F.type.split("-")[0];switch(H){case"alert":return B(F);case"confirm":return D(F);case"modalbox":return N(F);default:return G(F);break}};H.seed=(new Date()).valueOf();H.uid=function(){return H.seed++};H.expire=4000;H.keyboard=true;H.position="top";H.pull={};H.timers={};H.hideAll=function(){for(var A in H.pull)H.hide(A)};H.hide=function(A){var B=H.pull[A];if(B&&B.parentNode){window.setTimeout(function(){B.parentNode.removeChild(B);B=null},2000);B.className+=" hidden";if(H.timers[A])window.clearTimeout(H.timers[A]);delete H.pull[A]}}})();var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(A){return dhtmlXHeir((A||new Array()),dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(A){for(var B=0;B<this.length;B++)if(A==this[B])return B;return-1},_dhx_insertAt:function(A,B){this[this.length]=null;for(var C=this.length-1;C>=A;C--)this[C]=this[C-1];this[A]=B},_dhx_removeAt:function(A){this.splice(A,1)},_dhx_swapItems:function(C,B){var A=this[C];this[C]=this[B];this[B]=A}};function dhtmlXGridObject(id){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(id){if(typeof(id)=="object"){this.entBox=id;if(!this.entBox.id)this.entBox.id="cgrid2_"+this.uid()}else this.entBox=document.getElementById(id)}else{this.entBox=document.createElement("DIV");this.entBox.id="cgrid2_"+this.uid()}this.entBox.innerHTML="";dhtmlxEventable(this);var self=this;this._wcorr=0;this.fontWidth=7;this.cell=null;this.row=null;this.iconURL="";this.editor=null;this._f2kE=true;this._dclE=true;this.combos=new Array(0);this.defVal=new Array(0);this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=true;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,true,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?(this.entBox.style.width||window.getComputedStyle(this.entBox,null)["width"]):(this.entBox.currentStyle?this.entBox.currentStyle["width"]:this.entBox.style.width||0))||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?(this.entBox.style.height||window.getComputedStyle(this.entBox,null)["height"]):(this.entBox.currentStyle?this.entBox.currentStyle["height"]:this.entBox.style.height||0))||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return false};var t_creator=function(B){var A=document.createElement("TABLE");A.cellSpacing=A.cellPadding=0;A.style.cssText="width:100%;table-layout:fixed;";A.className=B.substr(2);return A};this.obj=t_creator("c_obj");this.hdr=t_creator("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=new Array(0);this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=(_isIE&&(document.compatMode!="BackCompat")?22:20);this.imgURL=window.dhx_globalImgPath||"";this.isActive=false;this.isEditable=true;this.useImagesInHeader=false;this.pagingOn=false;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{if(self.destructor)self.destructor()}catch(A){}});this.setSkin=function(C){this.skin_name=C;var B=this.entBox.className.split(" gridbox")[0];this.entBox.className=B+" gridbox gridbox_"+C;this.skin_h_correction=0;this.enableAlterCss("ev_"+C,"odd_"+C,this.isTreeGrid());this._fixAlterCss();switch(C){case"clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px' src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px' src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";this.skin_h_correction=20;break;case"white":this._srdh=40;this.forceDivInHeader=true;break;case"dhx_skyblue":case"dhx_web":case"glassy_blue":case"dhx_black":case"dhx_blue":case"modern":case"light":this._srdh=20;this.forceDivInHeader=true;break;case"xp":this.forceDivInHeader=true;if((_isIE)&&(document.compatMode!="BackCompat"))this._srdh=26;else this._srdh=22;break;case"mt":if((_isIE)&&(document.compatMode!="BackCompat"))this._srdh=26;else this._srdh=22;break;case"gray":if((_isIE)&&(document.compatMode!="BackCompat"))this._srdh=22;break;case"sbdark":break}if(_isIE&&this.hdr){var A=this.hdr.parentNode;A.removeChild(this.hdr);A.appendChild(this.hdr)}this.setSizes()};if(_isIE)this.preventIECaching(true);if(window.dhtmlDragAndDropObject)this.dragger=new dhtmlDragAndDropObject();this._doOnScroll=function(A,B){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(A,B)};this.doOnScroll=function(A,B){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr)this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft;if(B)return;if(this._srnd){if(this._dLoadTimer)window.clearTimeout(this._dLoadTimer);this._dLoadTimer=window.setTimeout(function(){if(self._update_srnd_view)self._update_srnd_view()},100)}};this.attachToObject=function(A){A.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(A){if((this.isTreeGrid())&&(!this._h2)){this._h2=new dhtmlxHierarchy();if((this._fake)&&(!this._realfake))this._fake._h2=this._h2;this._tgc={imgURL:null}}if(!this._hstyles)return;this.editStop();this.lastClicked=null;this.resized=null;this.fldSorted=this.r_fldSorted=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0)this.clearAll(true);var D=this.hdr.insertRow(0);for(var E=0;E<this.hdrLabels.length;E++){D.appendChild(document.createElement("TH"));D.childNodes[E]._cellIndex=E;D.childNodes[E].style.height="0px"}if(_isIE&&_isIE<8)D.style.position="absolute";else D.style.height="auto";D=this.hdr.insertRow(_isKHTML?2:1);D._childIndexes=new Array();var B=0;for(E=0;E<this.hdrLabels.length;E++){D._childIndexes[E]=E-B;if((this.hdrLabels[E]==this.splitSign)&&(E!=0)){if(_isKHTML)D.insertCell(E-B);D.cells[E-B-1].colSpan=(D.cells[E-B-1].colSpan||1)+1;D.childNodes[E-B-1]._cellIndex++;B++;D._childIndexes[E]=E-B;continue}D.insertCell(E-B);D.childNodes[E-B]._cellIndex=E;D.childNodes[E-B]._cellIndexS=E;this.setColumnLabel(E,this.hdrLabels[E])}if(B==0)D._childIndexes=null;this._cCount=this.hdrLabels.length;if(_isIE)window.setTimeout(function(){if(self.setSizes)self.setSizes()},1);if(!this.obj.firstChild)this.obj.appendChild(document.createElement("TBODY"));var C=this.obj.firstChild;if(!C.firstChild){C.appendChild(document.createElement("TR"));C=C.firstChild;if(_isIE&&_isIE<8)C.style.position="absolute";else C.style.height="auto";for(E=0;E<this.hdrLabels.length;E++){C.appendChild(document.createElement("TH"));C.childNodes[E].style.height="0px"}}this._c_order=null;if(this.multiLine!=true)this.obj.className+=" row20px";this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;if(this.noHeader)this.hdrBox.style.display="none";else this.noHeader=false;if(this._ivizcol)this.setColHidden();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(A)this.parseXML();this.obj.scrollTop=0;if(this.dragAndDropOff)this.dragger.addDragLanding(this.entBox,this);if(this._initDrF)this._initD();if(this._init_point)this._init_point()};this.setColumnSizes=function(H){var I=0,G=[],C=0;for(var J=0;J<this._cCount;J++){if((this.initCellWidth[J]=="*")&&!this._hrrar[J]){this._awdth=false;G.push(J);continue}if(this.cellWidthType=="%"){if(typeof this.cellWidthPC[J]=="undefined")this.cellWidthPC[J]=this.initCellWidth[J];var D=(H*this.cellWidthPC[J]/100)||0;if(C>0.5){D++;C--}var B=this.cellWidthPX[J]=Math.floor(D),C=C+D-B}else if(typeof this.cellWidthPX[J]=="undefined")this.cellWidthPX[J]=this.initCellWidth[J];if(!this._hrrar[J])I+=this.cellWidthPX[J]*1}if(G.length){var F=Math.floor((H-I)/G.length);if(F<0)F=1;for(J=0;J<G.length;J++){var E=Math.max((this._drsclmW?(this._drsclmW[G[J]]||0):0),F);this.cellWidthPX[G[J]]=E;I+=E}if(H>I){var A=G[G.length-1];this.cellWidthPX[A]=this.cellWidthPX[A]+(H-I);I=H}this._setAutoResize()}this.obj.style.width=I+"px";this.hdr.style.width=I+"px";if(this.ftr)this.ftr.style.width=I+"px";this.chngCellWidth();return I};this.setSizes=function(){if((!this.hdr.rows[0]))return;var P=this.quirks=(_isIE&&document.compatMode=="BackCompat"),C=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){var Q=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var I=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,(this.globalBox.clientWidth+(P?Q*2:0))-this._fake.entBox.clientWidth)+"px";if(I!=this.globalBox.clientWidth)this._fake._correctSplit(this._fake.entBox.clientWidth)}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y;this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden";this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(P?Q*2:0)+"px"}}else{if(this._delta_x)if(this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"){this.entBox.style.width="1px";this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-C*2+"px"}else this.entBox.style.width=this._delta_x;if(this._delta_y)this.entBox.style.height=this._delta_y}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){if(self.setSizes)self.setSizes()},250);return}var B=((!this._wthB)&&((this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!P)?2:0),D=((!this._wthB)&&((this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!P)?2:0),O=this.parentGrid?false:(this.objBox.scrollHeight>this.objBox.offsetHeight),N=_isFF?18:18,H=this.entBox.clientWidth-(this.skin_h_correction||0)*(P?0:1)-B,L=this.entBox.clientWidth-(this.skin_h_correction||0)-B,K=this.entBox.clientHeight-D,R=this.setColumnSizes(L-(O?N:0)-(this._correction_x||0)),E=this.parentGrid?false:((this.objBox.scrollWidth>this.objBox.offsetWidth)||(this.objBox.style.overflowX=="scroll")),G=this.hdr.clientHeight,M=this.ftr?this.ftr.clientHeight:0,F=H,A=K-G-M;if(this._awdth&&this._awdth[0]&&this._awdth[1]==99999)E=0;if(this._ahgr){if(this._ahgrMA)A=this.entBox.parentNode.clientHeight-G-M;else A=this.obj.offsetHeight+(E?N:0)+(this._correction_y||0);if(this._ahgrM)if(this._ahgrF)A=Math.min(this._ahgrM,A+G+M)-G-M;else A=Math.min(this._ahgrM,A);if(O&&A>=this.obj.scrollHeight+(E?N:0)){O=false;this.setColumnSizes(L-(this._correction_x||0))}}if((this._awdth)&&(this._awdth[0])){if(this.cellWidthType=="%")this.cellWidthType="px";if(this._fake)R+=this._fake.entBox.clientWidth;F=Math.min(Math.max(R+(O?N:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);if(this._fake)F-=this._fake.entBox.clientWidth}A=Math.max(0,A);this._ff_size_delta=(this._ff_size_delta==0.1)?0.2:0.1;if(!_isFF)this._ff_size_delta=0;if(!this.dontSetSizes){this.entBox.style.width=Math.max(0,F+(P?2:0)*C+this._ff_size_delta)+"px";this.entBox.style.height=A+(P?2:0)*C+G+M+"px"}this.objBox.style.height=A+((P&&!O)?2:0)*C+"px";this.hdrBox.style.height=G+"px";if(A!=K)this.doOnScroll(0,!this._srnd);var J=this["setSizes_"+this.skin_name];if(J)J.call(this);this.setSortImgPos();if(G!=this.hdr.clientHeight&&this._ahgr)this.setSizes();this.callEvent("onSetSizes",[])};this.setSizes_clear=function(){var B=this.hdr.offsetHeight,C=this.entBox.offsetWidth,A=B+this.objBox.offsetHeight;this._topMb.style.top=(B||0)+"px";this._topMb.style.width=(C+20)+"px";this._botMb.style.top=(A-3)+"px";this._botMb.style.width=(C+20)+"px"};this.chngCellWidth=function(){if((_isOpera)&&(this.ftr))this.ftr.width=this.objBox.scrollWidth+"px";var A=this._cCount;for(var B=0;B<A;B++){this.hdr.rows[0].cells[B].style.width=this.cellWidthPX[B]+"px";this.obj.rows[0].childNodes[B].style.width=this.cellWidthPX[B]+"px";if(this.ftr)this.ftr.rows[0].cells[B].style.width=this.cellWidthPX[B]+"px"}};this.setDelimiter=function(A){this.delim=A};this.setInitWidthsP=function(A){this.cellWidthType="%";this.initCellWidth=A.split(this.delim.replace(/px/gi,""));if(!arguments[1])this._setAutoResize()};this._setAutoResize=function(){if(this._realfake)return;var A=window,B=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(B._resize_timer);if(B._setAutoResize)B._resize_timer=window.setTimeout(function(){if(B.setSizes)B.setSizes();if(B._fake)B._fake._correctSplit()},100)})};this.setInitWidths=function(A){this.cellWidthType="px";this.initCellWidth=A.split(this.delim);if(_isFF)for(var B=0;B<this.initCellWidth.length;B++)if(this.initCellWidth[B]!="*")this.initCellWidth[B]=parseInt(this.initCellWidth[B])};this.enableMultiline=function(A){this.multiLine=convertStringToBoolean(A)};this.enableMultiselect=function(A){this.selMultiRows=convertStringToBoolean(A)};this.setImagePath=function(A){this.imgURL=A};this.setImagesPath=this.setImagePath;this.setIconPath=function(A){this.iconURL=A};this.setIconsPath=this.setIconPath;this.changeCursorState=function(A){var C=A.target||A.srcElement;if(C.tagName!="TD")C=this.getFirstParentOfType(C,"TD");if(!C)return;if((C.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[C._cellIndex]))return C.style.cursor="default";var B=(A.layerX||0)+(((!_isIE)&&(A.target.tagName=="DIV"))?C.offsetLeft:0);if((C.offsetWidth-(A.offsetX||(parseInt(this.getPosition(C,this.hdrBox))-B)*-1))<(_isOpera?20:10))C.style.cursor="E-resize";else C.style.cursor="default";if(_isOpera)this.hdrBox.scrollLeft=this.objBox.scrollLeft};this.startColResize=function(C){if(this.resized)this.stopColResize();this.resized=null;var D=C.target||C.srcElement;if(D.tagName!="TD")D=this.getFirstParentOfType(D,"TD");var E=C.clientX,B=this.hdr.offsetWidth,A=parseInt(D.offsetWidth);if(D.tagName=="TD"&&D.style.cursor!="default"){if((this._drsclmn)&&(!this._drsclmn[D._cellIndex]))return;self._old_d_mm=document.body.onmousemove;self._old_d_mu=document.body.onmouseup;document.body.onmousemove=function(C){if(self)self.doColResize(C||window.event,D,A,E,B)};document.body.onmouseup=function(){if(self)self.stopColResize()}}};this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"";document.body.onmouseup=self._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(C,D,A,I,B){D.style.cursor="E-resize";this.resized=D;var E=A+(C.clientX-I),H=B+(C.clientX-I);if(!(this.callEvent("onResize",[D._cellIndex,E,this])))return;if(_isIE)this.objBox.scrollLeft=this.hdrBox.scrollLeft;if(D.colSpan>1){var F=new Array();for(var G=0;G<D.colSpan;G++)F[G]=Math.round(E*this.hdr.rows[0].childNodes[D._cellIndexS+G].offsetWidth/D.offsetWidth);for(G=0;G<D.colSpan;G++)this._setColumnSizeR(D._cellIndexS+G*1,F[G])}else this._setColumnSizeR(D._cellIndex,E);this.doOnScroll(0,1);this.setSizes();if(this._fake&&this._awdth)this._fake._correctSplit()};this._setColumnSizeR=function(A,D){if(D>((this._drsclmW&&!this._notresize)?(this._drsclmW[A]||10):10)){this.obj.rows[0].childNodes[A].style.width=D+"px";this.hdr.rows[0].childNodes[A].style.width=D+"px";if(this.ftr)this.ftr.rows[0].childNodes[A].style.width=D+"px";if(this.cellWidthType=="px")this.cellWidthPX[A]=D;else{var C=parseInt(this.entBox.offsetWidth);if(this.objBox.scrollHeight>this.objBox.offsetHeight)C-=17;var B=Math.round(D/C*100);this.cellWidthPC[A]=B}if(this.sortImg.style.display!="none")this.setSortImgPos()}};this.setSortImgState=function(D,C,A,E){A=(A||"asc").toLowerCase();if(!convertStringToBoolean(D)){this.sortImg.style.display="none";this.fldSorted=this.r_fldSorted=null;return}if(A=="asc")this.sortImg.src=this.imgURL+"sort_asc.gif";else this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[C];var B=this.hdr.rows[E||1];if(!B)return;for(var F=0;F<B.childNodes.length;F++)if(B.childNodes[F]._cellIndexS==C){this.r_fldSorted=B.childNodes[F];return this.setSortImgPos()}return this.setSortImgState(D,C,A,(E||1)+1)};this.setSortImgPos=function(B,F,D,A){if(this._hrrar&&this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:B])return;if(!A)if(!B)var A=this.r_fldSorted;else A=this.hdr.rows[D||0].cells[B];if(A!=null){var E=this.getPosition(A,this.hdrBox),C=A.offsetWidth;this.sortImg.style.left=Number(E[0]+C-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(E[1]+5)+"px";if((!this.useImagesInHeader)&&(!F))this.sortImg.style.display="inline";this.sortImg.style.left=this.sortImg.defLeft+"px"}};this.setActive=function(A){if(arguments.length==0)var A=true;if(A==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this)){globalActiveDHTMLGridObject.editStop();globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])}globalActiveDHTMLGridObject=this;this.isActive=true}else{this.isActive=false;this.callEvent("onBlur",[this])}};this._doClick=function(B){var D=0,C=this.getFirstParentOfType(_isIE?B.srcElement:B.target,"TD");if(!C)return;var A=true;if(this.markedCells){var E=0;if(B.shiftKey||B.metaKey)E=1;if(B.ctrlKey)E=2;this.doMark(C,E);return true}if(this.selMultiRows!=false){if(B.shiftKey&&this.row!=null&&this.selectedRows.length)D=1;if(B.ctrlKey||B.metaKey)D=2}this.doClick(C,A,D)};this._doContClick=function(A){var B=this.getFirstParentOfType(_isIE?A.srcElement:A.target,"TD");if((!B)||(typeof(B.parentNode.idd)=="undefined")){this.callEvent("onEmptyClick",[A]);return true}if(A.button==2||(_isMacOS&&A.ctrlKey)){if(!this.callEvent("onRightClick",[B.parentNode.idd,B._cellIndex,A])){var F=function(A){(A||event).cancelBubble=true;return false};(A.srcElement||A.target).oncontextmenu=F;return F(A)}if(this._ctmndx){if(!(this.callEvent("onBeforeContextMenu",[B.parentNode.idd,B._cellIndex,this])))return true;if(_isIE)A.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false};if(this._ctmndx.showContextMenu){var D=window.document.documentElement,E=window.document.body,C=new Array((D.scrollLeft||E.scrollLeft),(D.scrollTop||E.scrollTop));if(_isIE)var H=A.clientX+C[0],G=A.clientY+C[1];else H=A.pageX,G=A.pageY;this._ctmndx.showContextMenu(H-1,G-1);this.contextID=this._ctmndx.contextMenuZoneId=B.parentNode.idd+"_"+B._cellIndex;this._ctmndx._skip_hide=true}else{B.contextMenuId=B.parentNode.idd+"_"+B._cellIndex;B.contextMenu=this._ctmndx;B.a=this._ctmndx._contextStart;B.a(B,A);B.a=null}A.cancelBubble=true;return false}}else if(this._ctmndx)if(this._ctmndx.hideContextMenu)this._ctmndx.hideContextMenu();else this._ctmndx._contextEnd();return true};this.doClick=function(L,K,N,E){if(!this.selMultiRows)N=0;var F=this.row?this.row.idd:0;this.setActive(true);if(!N)N=0;if(this.cell!=null)this.cell.className=this.cell.className.replace(/cellselected/g,"");if(L.tagName=="TD"){if(this.checkEvent("onSelectStateChanged"))var O=this.getSelectedId();var A=this.row;if(N==1){var H=this.rowsCol._dhx_find(L.parentNode),P=this.rowsCol._dhx_find(this.lastClicked);if(H>P)var B=P,R=H;else B=H,R=P;for(var I=0;I<this.rowsCol.length;I++)if((I>=B&&I<=R))if(this.rowsCol[I]&&(!this.rowsCol[I]._sRow)){if(this.rowsCol[I].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[I].idd,F])){this.rowsCol[I].className+=" rowselected";this.selectedRows[this.selectedRows.length]=this.rowsCol[I]}}else{this.clearSelection();return this.doClick(L,K,0,E)}}else if(N==2)if(L.parentNode.className.indexOf("rowselected")!=-1){L.parentNode.className=L.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(L.parentNode));var J=true;E=false}this.editStop();if(typeof(L.parentNode.idd)=="undefined")return true;if((!J)&&(!L.parentNode._sRow))if(this.callEvent("onBeforeSelect",[L.parentNode.idd,F])){if(this.getSelectedRowId()!=L.parentNode.idd){if(N==0)this.clearSelection();this.cell=L;if((A==L.parentNode)&&(this._chRRS))K=false;this.row=L.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var C=this.cell.nextSibling,D=this.cell.parentNode;D.removeChild(this.cell);D.insertBefore(this.cell,C)}if(this.selectedRows._dhx_find(this.row)==-1)this.selectedRows[this.selectedRows.length]=this.row}else{this.cell=L;this.row=L.parentNode}}else K=false;if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1)this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected";if(N!=1)if(!this.row)return;this.lastClicked=L.parentNode;var M=this.row.idd,G=this.cell;if(K&&typeof(M)!="undefined"&&G&&!J)self.onRowSelectTime=setTimeout(function(){if(self.callEvent)self.callEvent("onRowSelect",[M,G._cellIndex])},100);else this.callEvent("onRowSelectRSOnly",[M]);if(this.checkEvent("onSelectStateChanged")){var Q=this.getSelectedId();if(O!=Q)this.callEvent("onSelectStateChanged",[Q,O])}}this.isActive=true;if(E!==false&&this.cell&&this.cell.parentNode.idd)this.moveToVisible(this.cell)};this.selectAll=function(){this.clearSelection();var A=this.rowsBuffer;if(this.pagingOn)A=this.rowsCol;for(var B=0;B<A.length;B++)this.render_row(B).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(A));if(this.selectedRows.length){this.row=this.selectedRows[0];this.cell=this.row.cells[0]}if((this._fake)&&(!this._realfake))this._fake.selectAll()};this.selectCell=function(D,A,B,G,E,F){if(!B)B=false;if(typeof(D)!="object")D=this.render_row(D);if(!D||D==-1)return null;if(D._childIndexes)var C=D.childNodes[D._childIndexes[A]];else C=D.childNodes[A];if(!C)C=D.childNodes[0];if(!this.markedCells){if(G)this.doClick(C,B,3,F);else this.doClick(C,B,0,F)}else this.doMark(C,G?2:0);if(E)this.editCell()};this.moveToVisible=function(E,I){if(this.pagingOn){var G=Math.floor(this.getRowIndex(E.parentNode.idd)/this.rowsBufferOutSize)+1;if(G!=this.currentPage)this.changePage(G)}try{if(E.offsetHeight){var A=E.offsetLeft+E.offsetWidth+20,D=0;if(A>(this.objBox.offsetWidth+this.objBox.scrollLeft)){if(E.offsetLeft>this.objBox.scrollLeft)D=E.offsetLeft-5}else if(E.offsetLeft<this.objBox.scrollLeft){A-=E.offsetWidth*2/3;if(A<this.objBox.scrollLeft)D=E.offsetLeft-5}if((D)&&(!I))this.objBox.scrollLeft=D}if(!E.offsetHeight){var F=this._realfake?this._fake.rowsAr[E.parentNode.idd]:E.parentNode;A=this.rowsBuffer._dhx_find(F)*this._srdh}else A=E.offsetTop;var B=A+E.offsetHeight+38;if(B>(this.objBox.offsetHeight+this.objBox.scrollTop))var C=B-this.objBox.offsetHeight;else if(A<this.objBox.scrollTop)C=A-5;if(C)this.objBox.scrollTop=C}catch(H){}};this.editCell=function(){if(this.editor&&this.cell==this.editor.cell)return;this.editStop();if((this.isEditable!=true)||(!this.cell))return false;var A=this.cell;if(A.parentNode._locked)return false;this.editor=this.cells4(A);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false}if(this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=false&&this.editor.edit){this._Opera_stop=(new Date).valueOf();A.className+=" editable";this.editor.edit();this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])}else this.editor=null}};this.editStop=function(D){if(_isOpera)if(this._Opera_stop){if((this._Opera_stop*1+50)>(new Date).valueOf())return;this._Opera_stop=null}if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(D){var B=this.editor.val;this.editor.detach();this.editor.setValue(B);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,B]);return}if(this.editor.detach())this.cell.wasChanged=true;var A=this.editor;this.editor=null;var C=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,A.getValue(),A.val]);if((typeof(C)=="string")||(typeof(C)=="number"))A[A.setImage?"setLabel":"setValue"](C);else if(!C)A[A.setImage?"setLabel":"setValue"](A.val);if(this._ahgr&&this.multiLine)this.setSizes()}};this._nextRowCell=function(B,A,C){B=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(B),A);if(!B)return null;return B.childNodes[B._childIndexes?B._childIndexes[C]:C]};this._getNextCell=function(C,B,D){C=C||this.cell;var A=C.parentNode;if(this._tabOrder){D=this._tabOrder[C._cellIndex];if(typeof D!="undefined")if(D<0)C=this._nextRowCell(A,B,Math.abs(D)-1);else C=A.childNodes[D]}else{var D=C._cellIndex+B;if(D>=0&&D<this._cCount){if(A._childIndexes)D=A._childIndexes[C._cellIndex]+B;C=A.childNodes[D]}else C=this._nextRowCell(A,B,(B==1?0:(this._cCount-1)))}if(!C){if((B==1)&&this.tabEnd){this.tabEnd.focus();this.tabEnd.focus();this.setActive(false)}if((B==-1)&&this.tabStart){this.tabStart.focus();this.tabStart.focus();this.setActive(false)}return null}if(C.style.display!="none"&&(!this.smartTabOrder||!this.cells(C.parentNode.idd,C._cellIndex).isDisabled()))return C;return this._getNextCell(C,B)};this._nextRow=function(C,B){var A=this.render_row(C+B);if(!A||A==-1)return null;if(A&&A.style.display=="none")return this._nextRow(C+B,B);return A};this.scrollPage=function(B){if(!this.rowsBuffer.length)return;var C=this._realfake?this._fake:this,A=Math.floor((C._r_select||this.getRowIndex(this.row.idd)||0)+(B)*this.objBox.offsetHeight/(this._srdh||20));if(A<0)A=0;if(A>=this.rowsBuffer.length)A=this.rowsBuffer.length-1;if(this._srnd&&!this.rowsBuffer[A]){this.objBox.scrollTop+=Math.floor((B)*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake)this._fake.objBox.scrollTop=this.objBox.scrollTop;C._r_select=A}else{this.selectCell(A,this.cell._cellIndex,true,false,false,(this.multiLine||this._srnd));if(!this.multiLine&&!this._srnd&&!this._realfake){this.objBox.scrollTop=this.getRowById(this.getRowId(A)).offsetTop;if(this._fake)this._fake.objBox.scrollTop=this.objBox.scrollTop}C._r_select=null}};this.doKey=function(B){if(!B)return true;if((B.target||B.srcElement).value!==window.undefined){var A=(B.target||B.srcElement);if((!A.parentNode)||(A.parentNode.className.indexOf("editable")==-1))return true}if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject))return globalActiveDHTMLGridObject.doKey(B);if(this.isActive==false)return true;if(this._htkebl)return true;if(!this.callEvent("onKeyPress",[B.keyCode,B.ctrlKey,B.shiftKey,B]))return false;var C="k"+B.keyCode+"_"+(B.ctrlKey?1:0)+"_"+(B.shiftKey?1:0);if(this.cell){if(this._key_events[C]){if(false===this._key_events[C].call(this))return true;if(B.preventDefault)B.preventDefault();B.cancelBubble=true;return false}if(this._key_events["k_other"])this._key_events.k_other.call(this,B)}return true};this.selectRow=function(B,A,D,C){if(typeof(B)!="object")B=this.render_row(B);this.selectCell(B,0,A,D,false,C)};this.wasDblClicked=function(A){var B=this.getFirstParentOfType(_isIE?A.srcElement:A.target,"TD");if(B){var C=B.parentNode.idd;return this.callEvent("onRowDblClicked",[C,B._cellIndex])}};this._onHeaderClick=function(B,C){var A=this.grid;C=C||A.getFirstParentOfType(_isIE?event.srcElement:B.target,"TD");if(this.grid.resized==null){if(!(this.grid.callEvent("onHeaderClick",[C._cellIndexS,(B||window.event)])))return false;A.sortField(C._cellIndexS,false,C)}this.grid.resized=null};this.deleteSelectedRows=function(){var B=this.selectedRows.length;if(B==0)return;var D=this.selectedRows;this.selectedRows=dhtmlxArray();for(var F=B-1;F>=0;F--){var A=D[F];if(!this.deleteRow(A.idd,A))this.selectedRows[this.selectedRows.length]=A;else if(A==this.row)var C=F}if(C){try{if(C+1>this.rowsCol.length)C--;this.selectCell(C,0,true)}catch(E){this.row=null;this.cell=null}}};this.getSelectedRowId=function(){var C=new Array(0),B={};for(var D=0;D<this.selectedRows.length;D++){var A=this.selectedRows[D].idd;if(B[A])continue;C[C.length]=A;B[A]=true}if(C.length==0)return null;else return C.join(this.delim)};this.getSelectedCellIndex=function(){if(this.cell!=null)return this.cell._cellIndex;else return-1};this.getColWidth=function(A){return parseInt(this.cellWidthPX[A])};this.setColWidth=function(A,B){if(B=="*")this.initCellWidth[A]="*";else{if(this._hrrar[A])return;if(this.cellWidthType=="px")this.cellWidthPX[A]=parseInt(B);else this.cellWidthPC[A]=parseInt(B)}this.setSizes()};this.getRowIndex=function(A){for(var B=0;B<this.rowsBuffer.length;B++)if(this.rowsBuffer[B]&&this.rowsBuffer[B].idd==A)return B;return-1};this.getRowId=function(A){return this.rowsBuffer[A]?this.rowsBuffer[A].idd:this.undefined};this.setRowId=function(B,A){this.changeRowId(this.getRowId(B),A)};this.changeRowId=function(A,E){if(A==E)return;var D=this.rowsAr[A];D.idd=E;if(this.UserData[A]){this.UserData[E]=this.UserData[A];this.UserData[A]=null}if(this._h2&&this._h2.get[A]){this._h2.get[E]=this._h2.get[A];this._h2.get[E].id=E;delete this._h2.get[A]}this.rowsAr[A]=null;this.rowsAr[E]=D;for(var F=0;F<D.childNodes.length;F++)if(D.childNodes[F]._code)D.childNodes[F]._code=this._compileSCL(D.childNodes[F]._val,D.childNodes[F]);if(this._mat_links&&this._mat_links[A]){var C=this._mat_links[A];delete this._mat_links[A];for(var B in C)for(F=0;F<C[B].length;F++)this._compileSCL(C[B][F].original,C[B][F])}this.callEvent("onRowIdChange",[A,E])};this.setColumnIds=function(A){this.columnIds=A.split(this.delim)};this.setColumnId=function(B,A){this.columnIds[B]=A};this.getColIndexById=function(A){for(var B=0;B<this.columnIds.length;B++)if(this.columnIds[B]==A)return B};this.getColumnId=function(A){return this.columnIds[A]};this.getColumnLabel=function(C,B,A){var D=(A||this.hdr).rows[(B||0)+1];for(var E=0;E<D.cells.length;E++)if(D.cells[E]._cellIndexS==C)return(_isIE?D.cells[E].innerText:D.cells[E].textContent);return""};this.getColLabel=this.getColumnLabel;this.getFooterLabel=function(B,A){return this.getColumnLabel(B,A,this.ftr)};this.setRowTextBold=function(A){var B=this.getRowById(A);if(B)B.style.fontWeight="bold"};this.setRowTextStyle=function(A,D){var C=this.getRowById(A);if(!C)return;for(var E=0;E<C.childNodes.length;E++){var B=C.childNodes[E]._attrs["style"]||"";if((this._hrrar)&&(this._hrrar[E]))B="display:none;";if(_isIE)C.childNodes[E].style.cssText=B+"width:"+C.childNodes[E].style.width+";"+D;else C.childNodes[E].style.cssText=B+"width:"+C.childNodes[E].style.width+";"+D}};this.setRowColor=function(A,C){var B=this.getRowById(A);for(var D=0;D<B.childNodes.length;D++)B.childNodes[D].bgColor=C};this.setCellTextStyle=function(A,D,F){var C=this.getRowById(A);if(!C)return;var E=C.childNodes[C._childIndexes?C._childIndexes[D]:D];if(!E)return;var B="";if((this._hrrar)&&(this._hrrar[D]))B="display:none;";if(_isIE)E.style.cssText=B+"width:"+E.style.width+";"+F;else E.style.cssText=B+"width:"+E.style.width+";"+F};this.setRowTextNormal=function(A){var B=this.getRowById(A);if(B)B.style.fontWeight="normal"};this.doesRowExist=function(A){if(this.getRowById(A)!=null)return true;else return false};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(A){var C=this.getRowById(A);if(this.isTreeGrid())return this.moveRowUDTG(A,-1);var D=this.rowsCol._dhx_find(C);if((C.previousSibling)&&(D!=0)){C.parentNode.insertBefore(C,C.previousSibling);this.rowsCol._dhx_swapItems(D,D-1);this.setSizes();var B=this.rowsBuffer._dhx_find(C);this.rowsBuffer._dhx_swapItems(B,B-1);if(this._cssEven)this._fixAlterCss(D-1)}};this.moveRowDown=function(A){var C=this.getRowById(A);if(this.isTreeGrid())return this.moveRowUDTG(A,1);var D=this.rowsCol._dhx_find(C);if(C.nextSibling){this.rowsCol._dhx_swapItems(D,D+1);if(C.nextSibling.nextSibling)C.parentNode.insertBefore(C,C.nextSibling.nextSibling);else C.parentNode.appendChild(C);this.setSizes();var B=this.rowsBuffer._dhx_find(C);this.rowsBuffer._dhx_swapItems(B,B+1);if(this._cssEven)this._fixAlterCss(D)}};this.getCombo=function(A){if(!this.combos[A])this.combos[A]=new dhtmlXGridComboObject();return this.combos[A]};this.setUserData=function(A,B,C){if(!A)A="gridglobaluserdata";if(!this.UserData[A])this.UserData[A]=new Hashtable();this.UserData[A].put(B,C)};this.getUserData=function(A,B){if(!A)A="gridglobaluserdata";this.getRowById(A);var C=this.UserData[A];return(C?C.get(B):"")};this.setEditable=function(A){this.isEditable=convertStringToBoolean(A)};this.selectRowById=function(B,D,C,A){if(!A)A=false;this.selectCell(this.getRowById(B),0,A,D,false,C)};this.clearSelection=function(){this.editStop();for(var B=0;B<this.selectedRows.length;B++){var A=this.rowsAr[this.selectedRows[B].idd];if(A)A.className=A.className.replace(/rowselected/g,"")}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"");this.cell=null}this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(A,C){var B=this.getRowById(A);if(!this.isTreeGrid()){for(var D=0;D<B.cells.length;D++)this.cells(C,D).setValue(this.cells(A,D).getValue())}else this._copyTreeGridRowContent(B,A,C);if(!_isIE)this.getRowById(A).cells[0].height=B.cells[0].offsetHeight};this.setFooterLabel=function(B,C,A){return this.setColumnLabel(B,C,A,this.ftr)};this.setColumnLabel=function(F,H,K,D){var L=(D||this.hdr).rows[K||1],B=(L._childIndexes?L._childIndexes[F]:F);if(!L.cells[B])return;if(!this.useImagesInHeader){var C="<div class='hdrcell'>";if(H.indexOf("img:[")!=-1){var I=H.replace(/.*\[([^>]+)\].*/,"$1");H=H.substr(H.indexOf("]")+1,H.length);C+="<img width='16px' height='16px' align='absmiddle' src='"+I+"' hspace='2'>"}C+=H;C+="</div>";L.cells[B].innerHTML=C;if(this._hstyles[B])L.cells[B].style.cssText=this._hstyles[B]}else{L.cells[B].style.textAlign="left";L.cells[B].innerHTML="<img src='"+this.imgURL+""+H+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var G=new Image();G.src=this.imgURL+""+H.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=G;var E=new Image();E.src=this.imgURL+""+H.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=E}if((H||"").indexOf("#")!=-1){var J=H.match(/(^|{)#([^}]+)(}|$)/);if(J){var A="_in_header_"+J[2];if(this[A])this[A]((this.forceDivInHeader?L.cells[B].firstChild:L.cells[B]),B,H.split(J[0]))}}};this.setColLabel=function(D,A,C,B){return this.setColumnLabel(D,A,(C||0)+1,B)};this.clearAll=function(C){if(!this.obj.rows[0])return;if(this._h2){this._h2=new dhtmlxHierarchy();if(this._fake)if(this._realfake)this._h2=this._fake._h2;else this._fake._h2=this._h2}this.limit=this._limitC=0;this.editStop(true);if(this._dLoadTimer)window.clearTimeout(this._dLoadTimer);if(this._dload){this.objBox.scrollTop=0;this.limit=this._limitC||0;this._initDrF=true}var B=this.rowsCol.length;B=this.obj.rows.length;for(var D=B-1;D>0;D--){var A=this.obj.rows[D];A.parentNode.removeChild(A)}if(C){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(D=this.hdr.rows.length-1;D>=0;D--){A=this.hdr.rows[D];A.parentNode.removeChild(A)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._strangeParams=[];this.defVal=[];this._ivizcol=null}this.row=null;this.cell=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd)this.xmlFileUrl="";if(this.pagingOn)this.changePage(1);if(this._contextCallTimer)window.clearTimeout(this._contextCallTimer);if(this._sst)this.enableStableSorting(true);this._fillers=this.undefined;this.setSortImgState(false);this.setSizes();this.callEvent("onClearAll",[])};this.sortField=function(C,D,J){if(this.getRowsNum()==0)return false;var A=this.hdr.rows[0].cells[C];if(!A)return;if(A.tagName=="TH"&&(this.fldSort.length-1)>=A._cellIndex&&this.fldSort[A._cellIndex]!="na"){var G=this.getSortingState(),F=(G[0]==C&&G[1]=="asc")?"des":"asc";if(!this.callEvent("onBeforeSorting",[C,this.fldSort[C],F]))return;this.sortImg.src=this.imgURL+"sort_"+(F=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var E=this.hdr.rows[1].cells[A._cellIndex].firstChild;if(this.fldSorted!=null){var I=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;I.src=I.src.replace(/(\.asc\.)|(\.des\.)/,".")}E.src=E.src.replace(/(\.[a-z]+)$/,"."+F+"$1")}this.sortRows(A._cellIndex,this.fldSort[A._cellIndex],F);this.fldSorted=A;this.r_fldSorted=J;var B=this.hdr.rows[1],B=J.parentNode,H=B._childIndexes?B._childIndexes[A._cellIndex]:A._cellIndex;this.setSortImgPos(false,false,false,J)}};this.setCustomSorting=function(func,col){if(!this._customSorts)this._customSorts=new Array();this._customSorts[col]=(typeof(func)=="string")?eval(func):func;this.fldSort[col]="cus"};this.enableHeaderImages=function(A){this.useImagesInHeader=A};this.setHeader=function(H,A,D){if(typeof(H)!="object")var G=this._eSplit(H);else G=[].concat(H);var C=new Array(0),F=new dhtmlxArray(0),E=new Array(0),I=new Array(0),B=new Array(0);for(var J=0;J<G.length;J++){C[C.length]=Math.round(100/G.length);F[F.length]="ed";E[E.length]="left";I[I.length]="middle";B[B.length]="na"}this.splitSign=A||"#cspan";this.hdrLabels=G;this.cellWidth=C;if(!this.initCellWidth.length)this.setInitWidthsP(C.join(this.delim),true);this.cellType=F;this.cellAlign=E;this.cellVAlign=I;this.fldSort=B;this._hstyles=D||[]};this._eSplit=function(A){if(![].push)return A.split(this.delim);var B="r"+(new Date()).valueOf(),C=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(A||"").replace(RegExp(C,"g"),B).replace(RegExp("\\\\"+B,"g"),this.delim).split(B)};this.getColType=function(A){return this.cellType[A]};this.getColTypeById=function(A){return this.cellType[this.getColIndexById(A)]};this.setColTypes=function(A){this.cellType=dhtmlxArray(A.split(this.delim));this._strangeParams=new Array();for(var C=0;C<this.cellType.length;C++){if((this.cellType[C].indexOf("[")!=-1)){var B=this.cellType[C].split(/[\[\]]+/g);this.cellType[C]=B[0];this.defVal[C]=B[1];if(B[1].indexOf("=")==0){this.cellType[C]="math";this._strangeParams[C]=B[0]}}if(!window["eXcell_"+this.cellType[C]])dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[C],[this,this.cellType[C]])}};this.setColSorting=function(A){this.fldSort=A.split(this.delim);for(var B=0;B<this.fldSort.length;B++)if(((this.fldSort[B]).length>4)&&(typeof(window[this.fldSort[B]])=="function")){if(!this._customSorts)this._customSorts=new Array();this._customSorts[B]=window[this.fldSort[B]];this.fldSort[B]="cus"}};this.setColAlign=function(A){this.cellAlign=A.split(this.delim);for(var B=0;B<this.cellAlign.length;B++)this.cellAlign[B]=this.cellAlign[B]._dhx_trim()};this.setColVAlign=function(A){this.cellVAlign=A.split(this.delim)};this.setNoHeader=function(A){this.noHeader=convertStringToBoolean(A)};this.showRow=function(B){this.getRowById(B);if(this._h2)this.openItem(this._h2.get[B].parent.id);var A=this.getRowById(B).childNodes[0];while(A&&A.style.display=="none")A=A.nextSibling;if(A)this.moveToVisible(A,true)};this.setStyle=function(C,F,A,G){this.ssModifier=[C,F,A,A,G];var E=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],B=0;while(!_isIE){try{var H=document.styleSheets[B].cssRules.length}catch(D){B++;continue}break}for(var I=0;I<E.length;I++)if(this.ssModifier[I])if(_isIE)document.styleSheets[0].addRule(E[I],this.ssModifier[I]);else document.styleSheets[B].insertRule(E[I]+(" {"+this.ssModifier[I]+" }"),document.styleSheets[B].cssRules.length)};this.setColumnColor=function(A){this.columnColor=A.split(this.delim)};this.enableAlterCss=function(B,A,D,C){if(B||A)this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();if(this._fake)this._fake._fixAlterCss()});this._cssSP=D;this._cssSU=C;this._cssEven=B;this._cssUnEven=A};this._fixAlterCss=function(A){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(A);if(!this._cssEven&&!this._cssUnEven)return;A=A||0;var B=A;for(var C=A;C<this.rowsCol.length;C++){if(!this.rowsCol[C])continue;if(this.rowsCol[C].style.display!="none"){if(this.rowsCol[C]._cntr){B=1;continue}if(this.rowsCol[C].className.indexOf("rowselected")!=-1){if(B%2==1)this.rowsCol[C].className=this._cssUnEven+" rowselected "+(this.rowsCol[C]._css||"");else this.rowsCol[C].className=this._cssEven+" rowselected "+(this.rowsCol[C]._css||"")}else if(B%2==1)this.rowsCol[C].className=this._cssUnEven+" "+(this.rowsCol[C]._css||"");else this.rowsCol[C].className=this._cssEven+" "+(this.rowsCol[C]._css||"");B++}}};this.clearChangedState=function(){for(var D=0;D<this.rowsCol.length;D++){var C=this.rowsCol[D];if(C&&C.childNodes){var A=C.childNodes.length;for(var B=0;B<A;B++)C.childNodes[B].wasChanged=false}}};this.getChangedRows=function(B){var A=new Array();this.forEachRow(function(C){var F=this.rowsAr[C];if(F.tagName!="TR")return;var D=F.childNodes.length;if(B&&F._added)A[A.length]=F.idd;else for(var E=0;E<D;E++)if(F.childNodes[E].wasChanged){A[A.length]=F.idd;break}});return A.join(this.delim)};this._sUDa=false;this._sAll=false;this.setSerializationLevel=function(E,C,D,A,B,F){this._sUDa=E;this._sAll=C;this._sConfig=D;this._chAttr=A;this._onlChAttr=B;this._asCDATA=F};this.setSerializableColumns=function(A){if(!A){this._srClmn=null;return}this._srClmn=(A||"").split(",");for(var B=0;B<this._srClmn.length;B++)this._srClmn[B]=convertStringToBoolean(this._srClmn[B])};this._serialise=function(G,A,C){this.editStop();var F=[],E="</"+this.xml.s_row+">";if(this.isTreeGrid())this._h2.forEachChildF(0,function(A){var B=this._serializeRow(this.render_row_tree(-1,A.id));F.push(B);if(B)return true;else return false},this,function(){F.push(E)});else for(var D=0;D<this.rowsBuffer.length;D++)if(this.rowsBuffer[D]){if(this._chAttr&&this.rowsBuffer[D]._locator)continue;var B=this._serializeRow(this.render_row(D));F.push(B);if(B)F.push(E)}return[F.join("")]};this._serializeRow=function(F,J){var I=[],A=this.xml.row_attrs,D=this.xml.cell_attrs;I.push("<"+this.xml.s_row);I.push(" id='"+F.idd+"'");if((this._sAll)&&this.selectedRows._dhx_find(F)!=-1)I.push(" selected='1'");if(this._h2&&this._h2.get[F.idd].state=="minus")I.push(" open='1'");if(A.length)for(var J=0;J<A.length;J++)I.push(" "+A[J]+"='"+F._attrs[A[J]]+"'");I.push(">");if(this._sUDa&&this.UserData[F.idd]){keysAr=this.UserData[F.idd].getKeys();for(var G=0;G<keysAr.length;G++)I.push("<userdata name='"+keysAr[G]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[F.idd].get(keysAr[G])+(this._asCDATA?"]]>":"")+"</userdata>")}var E=false;for(var H=0;H<this._cCount;H++)if((!this._srClmn)||(this._srClmn[H])){var C=this.cells3(F,H);I.push("<cell");if(D.length)for(J=0;J<D.length;J++)I.push(" "+D[J]+"='"+C.cell._attrs[D[J]]+"'");zxVal=C[this._agetm]();if(this._asCDATA)zxVal="<![CDATA["+zxVal+"]]>";if((this._ecspn)&&(C.cell.colSpan)&&C.cell.colSpan>1)I.push(" colspan=\""+C.cell.colSpan+"\" ");if(this._chAttr){if(C.wasChanged()){I.push(" changed=\"1\"");E=true}}else if((this._onlChAttr)&&(C.wasChanged()))E=true;if(this._sAll&&this.cellType[H]=="tree")I.push((this._h2?(" image='"+this._h2.get[F.idd].image+"'"):"")+">"+zxVal+"</cell>");else I.push(">"+zxVal+"</cell>");if((this._ecspn)&&(C.cell.colSpan))for(var B=0;B<C.cell.colSpan-1;B++){I.push("<cell/>");H++}}if((this._onlChAttr)&&(!E)&&(!F._added))return"";return I.join("")};this._serialiseConfig=function(){var E="<head>";for(var D=0;D<this.hdr.rows[0].cells.length;D++){if(this._srClmn&&!this._srClmn[D])continue;var A=this.fldSort[D];if(A=="cus"){A=this._customSorts[D].toString();A=A.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}E+="<column width='"+this.getColWidth(D)+"' align='"+this.cellAlign[D]+"' type='"+this.cellType[D]+"' sort='"+(A||"na")+"' color='"+this.columnColor[D]+"'"+(this.columnIds[D]?(" id='"+this.columnIds[D]+"'"):"")+">";if(this._asCDATA)E+="<![CDATA["+this.getHeaderCol(D)+"]]>";else E+=this.getHeaderCol(D);var C=this.getCombo(D);if(C)for(var B=0;B<C.keys.length;B++)E+="<option value='"+C.keys[B]+"'>"+C.values[B]+"</option>";E+="</column>"}return E+="</head>"};this.serialize=function(){var C="<?xml version=\"1.0\"?><rows>";if(this._mathSerialization)this._agetm="getMathValue";else this._agetm="getValue";if(this._sUDa&&this.UserData["gridglobaluserdata"]){var A=this.UserData["gridglobaluserdata"].getKeys();for(var B=0;B<A.length;B++)C+="<userdata name='"+A[B]+"'>"+this.UserData["gridglobaluserdata"].get(A[B])+"</userdata>"}if(this._sConfig)C+=this._serialiseConfig();C+=this._serialise();C+="</rows>";return C};this.getPosition=function(D,E){if(!E&&!_isChrome){var F=getOffset(D);return[F.left,F.top]}E=E||document.body;var B=D,C=0,A=0;while((B)&&(B!=E)){C+=B.offsetLeft-B.scrollLeft;A+=B.offsetTop-B.scrollTop;B=B.offsetParent}if(E==document.body)if(_isIE){A+=document.body.offsetTop||document.documentElement.offsetTop;C+=document.body.offsetLeft||document.documentElement.offsetLeft}else if(!_isFF){C+=document.body.offsetLeft;A+=document.body.offsetTop}return[C,A]};this.getFirstParentOfType=function(B,A){while(B&&B.tagName!=A&&B.tagName!="BODY")B=B.parentNode;return B};this.objBox.onscroll=function(){this.grid._doOnScroll()};this.hdrBox.onscroll=function(){if(this._try_header_sync)return;this._try_header_sync=true;if(this.grid.objBox.scrollLeft!=this.scrollLeft)this.grid.objBox.scrollLeft=this.scrollLeft;this._try_header_sync=false};if((!_isOpera)||(_OperaRv>8.5)){this.hdr.onmousemove=function(A){this.grid.changeCursorState(A||window.event)};this.hdr.onmousedown=function(A){return this.grid.startColResize(A||window.event)}}this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(A){(A||event).cancelBubble=true};this.obj.onclick=function(A){this.grid._doClick(A||window.event);if(this.grid._sclE)this.grid.editCell(A||window.event);else this.grid.editStop();(A||event).cancelBubble=true};if(_isMacOS)this.entBox.oncontextmenu=function(A){A.cancelBubble=true;A.returnValue=false;return this.grid._doContClick(A||window.event)};else{this.entBox.onmousedown=function(A){return this.grid._doContClick(A||window.event)};this.entBox.oncontextmenu=function(A){if(this.grid._ctmndx)(A||event).cancelBubble=true;return!this.grid._ctmndx}}this.obj.ondblclick=function(A){if(!this.grid.wasDblClicked(A||window.event))return false;if(this.grid._dclE){var B=this.grid.getFirstParentOfType((_isIE?event.srcElement:A.target),"TR");if(B==this.grid.row)this.grid.editCell(A||window.event)}(A||event).cancelBubble=true;if(_isOpera)return false};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,"keydown",function(A){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(A||window.event)});document.body._dhtmlxgrid_onkeydown=true}dhtmlxEvent(document.body,"click",function(){if(self.editStop)self.editStop();if(self.isActive)self.setActive(false)});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=true};this.entBox.onbeforedeactivate=function(){if(this.grid._still_active)this.grid._still_active=null;else this.grid.isActive=false;event.cancelBubble=true};if(this.entBox.style.height.toString().indexOf("%")!=-1)this._delta_y=this.entBox.style.height;if(this.entBox.style.width.toString().indexOf("%")!=-1)this._delta_x=this.entBox.style.width;if(this._delta_x||this._delta_y)this._setAutoResize();this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;if(dhtmlx.image_path)this.setImagePath(dhtmlx.image_path);if(dhtmlx.skin)this.setSkin(dhtmlx.skin);return this}dhtmlXGridObject.prototype={getRowAttribute:function(A,B){return this.getRowById(A)._attrs[B]},setRowAttribute:function(A,B,C){this.getRowById(A)._attrs[B]=C},isTreeGrid:function(){return(this.cellType._dhx_find("tree")!=-1)},setRowHidden:function(B,C){var A=convertStringToBoolean(C),E=this.getRowById(B);if(!E)return;if(E.expand==="")this.collapseKids(E);if((C)&&(E.style.display!="none")){E.style.display="none";var D=this.selectedRows._dhx_find(E);if(D!=-1){E.className=E.className.replace("rowselected","");for(var F=0;F<E.childNodes.length;F++)E.childNodes[F].className=E.childNodes[F].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(D)}this.callEvent("onGridReconstructed",[])}if((!C)&&(E.style.display=="none")){E.style.display="";this.callEvent("onGridReconstructed",[])}this.callEvent("onRowHide",[B,C]);this.setSizes()},setColumnHidden:function(B,C){if(!this.hdr.rows.length){if(!this._ivizcol)this._ivizcol=[];return this._ivizcol[B]=C}if((this.fldSorted)&&(this.fldSorted.cellIndex==B)&&(C))this.sortImg.style.display="none";var A=convertStringToBoolean(C);if(A){if(!this._hrrar)this._hrrar=new Array();else if(this._hrrar[B])return;this._hrrar[B]="display:none;";this._hideShowColumn(B,"none")}else{if((!this._hrrar)||(!this._hrrar[B]))return;this._hrrar[B]="";this._hideShowColumn(B,"")}if((this.fldSorted)&&(this.fldSorted.cellIndex==B)&&(!C))this.sortImg.style.display="inline";this.setSortImgPos();this.callEvent("onColumnHidden",[B,C])},isColumnHidden:function(A){if((this._hrrar)&&(this._hrrar[A]))return true;return false},setColumnsVisibility:function(A){if(A)this._ivizcol=A.split(this.delim);if(this.hdr.rows.length&&this._ivizcol)for(var B=0;B<this._ivizcol.length;B++)this.setColumnHidden(B,this._ivizcol[B])},_fixHiddenRowsAll:function(C,B,E,D,A){A=A||"_cellIndex";var G=C.rows.length;for(var I=0;I<G;I++){var H=C.rows[I].childNodes;if(H.length!=this._cCount){for(var F=0;F<H.length;F++)if(H[F][A]==B){H[F].style[E]=D;break}}else H[B].style[E]=D}},_hideShowColumn:function(D,E){var C=D;if(this.hdr.rows[1]&&(this.hdr.rows[1]._childIndexes)&&(this.hdr.rows[1]._childIndexes[D]!=D))C=this.hdr.rows[1]._childIndexes[D];if(E=="none"){this.hdr.rows[0].cells[D]._oldWidth=this.hdr.rows[0].cells[D].style.width||(this.initCellWidth[D]+"px");this.hdr.rows[0].cells[D]._oldWidthP=this.cellWidthPC[D];this.obj.rows[0].cells[D].style.width="0px";var B={rows:[this.obj.rows[0]]};this.forEachRow(function(A){if(this.rowsAr[A].tagName=="TR")B.rows.push(this.rowsAr[A])});this._fixHiddenRowsAll(B,D,"display","none");if(this.isTreeGrid())this._fixHiddenRowsAllTG(D,"none");if((_isOpera&&_OperaRv<9)||_isKHTML||(_isFF))this._fixHiddenRowsAll(this.hdr,D,"display","none","_cellIndexS");if(this.ftr)this._fixHiddenRowsAll(this.ftr.childNodes[0],D,"display","none");this._fixHiddenRowsAll(this.hdr,D,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length)this.cellWidthPX=[].concat(this.initCellWidth);if(this.cellWidthPX[D])this.cellWidthPX[D]=0;if(this.cellWidthPC[D])this.cellWidthPC[D]=0}else if(this.hdr.rows[0].cells[D]._oldWidth){var A=this.hdr.rows[0].cells[D];if(_isOpera||_isKHTML||(_isFF))this._fixHiddenRowsAll(this.hdr,D,"display","","_cellIndexS");if(this.ftr)this._fixHiddenRowsAll(this.ftr.childNodes[0],D,"display","");B={rows:[this.obj.rows[0]]};this.forEachRow(function(A){if(this.rowsAr[A].tagName=="TR")B.rows.push(this.rowsAr[A])});this._fixHiddenRowsAll(B,D,"display","");if(this.isTreeGrid())this._fixHiddenRowsAllTG(D,"");this._fixHiddenRowsAll(this.hdr,D,"whiteSpace","normal","_cellIndexS");if(A._oldWidthP)this.cellWidthPC[D]=A._oldWidthP;if(A._oldWidth)this.cellWidthPX[D]=parseInt(A._oldWidth)}this.setSizes();if((!_isIE)&&(!_isFF)){this.obj.border=1;this.obj.border=0}},enableColSpan:function(A){this._ecspn=convertStringToBoolean(A)},enableRowsHover:function(B,A){this._unsetRowHover(false,true);this._hvrCss=A;if(convertStringToBoolean(B)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove;this.obj.onmousemove=this._setRowHover;if(_isIE)this.obj.onmouseleave=this._unsetRowHover;else this.obj.onmouseout=this._unsetRowHover;this._elmnh=true}}else if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove;if(_isIE)this.obj.onmouseleave=null;else this.obj.onmouseout=null;this._elmnh=false}},enableEditEvents:function(C,B,A){this._sclE=convertStringToBoolean(C);this._dclE=convertStringToBoolean(B);this._f2kE=convertStringToBoolean(A)},enableLightMouseNavigation:function(A){if(convertStringToBoolean(A)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick;this.entBox.onclick=function(){return true};this.obj._onclick=this.obj.onclick;this.obj.onclick=function(A){var B=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");if(!B)return;this.grid.editStop();this.grid.doClick(B);this.grid.editCell();(A||event).cancelBubble=true};this.obj._onmousemove=this.obj.onmousemove;this.obj.onmousemove=this._autoMoveSelect;this._elmn=true}}else if(this._elmn){this.entBox.onclick=this.entBox._onclick;this.obj.onclick=this.obj._onclick;this.obj.onmousemove=this.obj._onmousemove;this._elmn=false}},_unsetRowHover:function(A,B){if(B)that=this;else that=this.grid;if((that._lahRw)&&(that._lahRw!=B)){for(var C=0;C<that._lahRw.childNodes.length;C++)that._lahRw.childNodes[C].className=that._lahRw.childNodes[C].className.replace(that._hvrCss,"");that._lahRw=null}},_setRowHover:function(A){var B=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");if(B&&B.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,B);B=B.parentNode;if(!B.idd||B.idd=="__filler__")return;for(var C=0;C<B.childNodes.length;C++)B.childNodes[C].className+=" "+this.grid._hvrCss;this.grid._lahRw=B}this._honmousemove(A)},_autoMoveSelect:function(A){if(!this.grid.editor){var B=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");if(B.parentNode.idd)this.grid.doClick(B,true,0)}this._onmousemove(A)},enableDistributedParsing:function(C,B,A){if(convertStringToBoolean(C)){this._ads_count=B||10;this._ads_time=A||250}else this._ads_count=0},destructor:function(){this.editStop(true);if(this._sizeTime)this._sizeTime=window.clearTimeout(this._sizeTime);this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs)for(var C=0;C<this.formInputs.length;C++)this.parentForm.removeChild(this.formInputs[C]);var A;this.xmlLoader=this.xmlLoader.destructor();for(C=0;C<this.rowsCol.length;C++)if(this.rowsCol[C])this.rowsCol[C].grid=null;for(C in this.rowsAr)if(this.rowsAr[C])this.rowsAr[C]=null;this.rowsCol=new dhtmlxArray();this.rowsAr={};this.entBox.innerHTML="";var B=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=B;this.setSizes=this._update_srnd_view=this.callEvent=B;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake){this.globalBox.innerHTML="";this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=B;this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=B}for(A in this){if((this[A])&&(this[A].m_obj))this[A].m_obj=null;this[A]=null}if(this==globalActiveDHTMLGridObject)globalActiveDHTMLGridObject=null;return null},getSortingState:function(){var A=new Array();if(this.fldSorted){A[0]=this.fldSorted._cellIndex;A[1]=(this.sortImg.src.indexOf("sort_desc.gif")!=-1)?"des":"asc"}return A},enableAutoHeight:function(C,A,B){this._ahgr=convertStringToBoolean(C);this._ahgrF=convertStringToBoolean(B);this._ahgrM=A||null;if(arguments.length==1)this.objBox.style.overflowY=C?"hidden":"auto";if(A=="auto"){this._ahgrM=null;this._ahgrMA=true;this._setAutoResize()}},enableStableSorting:function(A){this._sst=convertStringToBoolean(A);this.rowsCol.stablesort=function(B){var E=this.length-1;for(var D=0;D<this.length-1;D++){for(var C=0;C<E;C++)if(B(this[C],this[C+1])>0){var A=this[C];this[C]=this[C+1];this[C+1]=A}E--}}},enableKeyboardSupport:function(A){this._htkebl=!convertStringToBoolean(A)},enableContextMenu:function(A){this._ctmndx=A},setScrollbarWidthCorrection:function(A){},enableTooltips:function(A){this._enbTts=A.split(",");for(var B=0;B<this._enbTts.length;B++)this._enbTts[B]=convertStringToBoolean(this._enbTts[B])},enableResizing:function(A){this._drsclmn=A.split(",");for(var B=0;B<this._drsclmn.length;B++)this._drsclmn[B]=convertStringToBoolean(this._drsclmn[B])},setColumnMinWidth:function(B,A){if(arguments.length==2){if(!this._drsclmW)this._drsclmW=new Array();this._drsclmW[A]=B}else this._drsclmW=B.split(",")},enableCellIds:function(A){this._enbCid=convertStringToBoolean(A)},lockRow:function(A,C){var B=this.getRowById(A);if(B){B._locked=convertStringToBoolean(C);if((this.cell)&&(this.cell.parentNode.idd==A))this.editStop()}},_getRowArray:function(D){var A=new Array();for(var C=0;C<D.childNodes.length;C++){var B=this.cells3(D,C);A[C]=B.getValue()}return A},setDateFormat:function(B,A){this._dtmask=B;this._dtmask_inc=A},setNumberFormat:function(F,A,G,C){var D=F.replace(/[^0\,\.]*/g,""),B=D.indexOf(".");if(B>-1)B=D.length-B-1;var E=D.indexOf(",");if(E>-1)E=D.length-B-2-E;if(typeof G!="string")G=this.i18n.decimal_separator;if(typeof C!="string")C=this.i18n.group_separator;var I=F.split(D)[0],H=F.split(D)[1];this._maskArr[A]=[B,E,I,H,G,C]},_aplNFb:function(D,B){var C=this._maskArr[B];if(!C)return D;var A=parseFloat(D.toString().replace(/[^0-9]*/g,""));if(D.toString().substr(0,1)=="-")A=A*-1;if(C[0]>0)A=A/Math.pow(10,C[0]);return A},_aplNF:function(D,B){var C=this._maskArr[B];if(!C)return D;var A=(parseFloat(D)<0?"-":"")+C[2];D=Math.abs(Math.round(parseFloat(D)*Math.pow(10,C[0]>0?C[0]:0))).toString();D=(D.length<C[0]?Math.pow(10,C[0]+1-D.length).toString().substr(1,C[0]+1)+D.toString():D).split("").reverse();D[C[0]]=(D[C[0]]||"0")+C[4];if(C[1]>0)for(var E=(C[0]>0?0:1)+C[0]+C[1];E<D.length;E+=C[1])D[E]+=C[5];return A+D.reverse().join("")+C[3]},_launchCommands:function(A){for(var D=0;D<A.length;D++){var B=new Array();for(var C=0;C<A[D].childNodes.length;C++)if(A[D].childNodes[C].nodeType==1)B[B.length]=A[D].childNodes[C].firstChild.data;this[A[D].getAttribute("command")].apply(this,B)}},_parseHead:function(J){var B=this.xmlLoader.doXPath("./head",J);if(B.length){var S=this.xmlLoader.doXPath("./column",B[0]),R=this.xmlLoader.doXPath("./settings",B[0]),D="setInitWidths",Q=false;if(R[0])for(var M=0;M<R[0].childNodes.length;M++)switch(R[0].childNodes[M].tagName){case"colwidth":if(R[0].childNodes[M].firstChild&&R[0].childNodes[M].firstChild.data=="%")D="setInitWidthsP";break;case"splitat":Q=(R[0].childNodes[M].firstChild?R[0].childNodes[M].firstChild.data:false);break}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",B[0]));if(S.length>0){if(this.hdr.rows.length>0)this.clearAll(true);var P=[[],[],[],[],[],[],[],[],[]],N=["","width","type","align","sort","color","format","hidden","id"],K=["",D,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"];for(var L=0;L<S.length;L++){for(var I=1;I<N.length;I++)P[I].push(S[L].getAttribute(N[I]));P[0].push((S[L].firstChild?S[L].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(P[0]);for(L=0;L<K.length;L++)if(K[L])this[K[L]](P[L].join(this.delim));for(L=0;L<S.length;L++)if((this.cellType[L].indexOf("co")==0)||(this.cellType[L]=="clist")){var G=this.xmlLoader.doXPath("./option",S[L]);if(G.length){var O=new Array();if(this.cellType[L]=="clist"){for(I=0;I<G.length;I++)O[O.length]=G[I].firstChild?G[I].firstChild.data:"";this.registerCList(L,O)}else{var F=this.getCombo(L);for(I=0;I<G.length;I++)F.put(G[I].getAttribute("value"),G[I].firstChild?G[I].firstChild.data:"")}}}else if(P[6][L])if((this.cellType[L].toLowerCase().indexOf("calendar")!=-1)||(this.fldSort[L]=="date"))this.setDateFormat(P[6][L]);else this.setNumberFormat(P[6][L],L);this.init();var C=P[7].join(this.delim);if(this.setColHidden&&C.replace(/,/g,"")!="")this.setColHidden(C);if((Q)&&(this.splitAt))this.splitAt(Q)}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",B[0]))}var E=this.xmlLoader.doXPath("//rows/userdata",J);if(E.length>0){if(!this.UserData["gridglobaluserdata"])this.UserData["gridglobaluserdata"]=new Hashtable();for(I=0;I<E.length;I++){var H="";for(var A=0;A<E[I].childNodes.length;A++)H+=E[I].childNodes[A].nodeValue;this.UserData["gridglobaluserdata"].put(E[I].getAttribute("name"),H)}}},getCheckedRows:function(B){var A=new Array();this.forEachRowA(function(C){if(this.cells(C,B).getValue()!=0)A.push(C)},true);return A.join(",")},checkAll:function(){var B=arguments.length?arguments[0]:1;for(var A=0;A<this.getColumnsNum();A++)if(this.getColType(A)=="ch")this.setCheckedRows(A,B)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(A,B){this.forEachRowA(function(C){if(this.cells(C,A).isCheckbox())this.cells(C,A).setValue(B)})},_drawTooltip:function(A){var D=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");if(!D||((this.grid.editor)&&(this.grid.editor.cell==D)))return true;var C=D.parentNode;if(!C.idd||C.idd=="__filler__")return;var B=(A?A.target:event.srcElement);if(C.idd==window.unknown)return true;if(!this.grid.callEvent("onMouseOver",[C.idd,D._cellIndex,(A||window.event)]))return true;if((this.grid._enbTts)&&(!this.grid._enbTts[D._cellIndex])){if(B.title)B.title="";return true}if(D._cellIndex>=this.grid._cCount)return;var E=this.grid.cells3(C,D._cellIndex);if(!E||!E.cell||!E.cell._attrs)return;if(B._title)E.cell.title="";if(!E.cell._attrs["title"])B._title=true;if(E)B.title=E.cell._attrs["title"]||(E.getTitle?E.getTitle():(E.getValue()||"").toString().replace(/<[^>]*>/gi,""));return true},enableCellWidthCorrection:function(A){if(_isFF)this._wcorr=parseInt(A)},getAllRowIds:function(B){var A=[];for(var C=0;C<this.rowsBuffer.length;C++)if(this.rowsBuffer[C])A.push(this.rowsBuffer[C].idd);return A.join(B||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(A,F,B){if(!this._ecspn)return;var E=this.getRowById(A);if((E._childIndexes)&&(E.childNodes[E._childIndexes[F]])){var I=E._childIndexes[F],G=E.childNodes[I],H=G.colSpan;G.colSpan=1;if((H)&&(H!=1))for(var K=1;K<H;K++){var D=document.createElement("TD");if(G.nextSibling)E.insertBefore(D,G.nextSibling);else E.appendChild(D);E._childIndexes[F+K]=I+K;D._cellIndex=F+K;D.style.textAlign=this.cellAlign[K];D.style.verticalAlign=this.cellVAlign[K];G=D;this.cells3(E,F+K).setValue("")}for(var J=F*1+1*H;J<E._childIndexes.length;J++)E._childIndexes[J]+=(H-1)*1}if((B)&&(B>1)){if(E._childIndexes)I=E._childIndexes[F];else{I=F;E._childIndexes=new Array();for(J=0;J<E.childNodes.length;J++)E._childIndexes[J]=J}E.childNodes[I].colSpan=B;for(J=1;J<B;J++){E._childIndexes[E.childNodes[I+1]._cellIndex]=I;E.removeChild(E.childNodes[I+1])}var C=E.childNodes[E._childIndexes[F]]._cellIndex;for(J=C*1+1*B;J<E._childIndexes.length;J++)E._childIndexes[J]-=(B-1)}},preventIECaching:function(A){this.no_cashe=convertStringToBoolean(A);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(A){this._eCAS=convertStringToBoolean(A)},_onHeaderDblClick:function(B){var A=this.grid,C=A.getFirstParentOfType(_isIE?event.srcElement:B.target,"TD");if(!A._eCAS)return false;A.adjustColumnSize(C._cellIndexS)},adjustColumnSize:function(A,B){if(this._hrrar&&this._hrrar[A])return;this._notresize=true;var E=0;this._setColumnSizeR(A,20);for(var F=1;F<this.hdr.rows.length;F++){var C=this.hdr.rows[F];C=C.childNodes[(C._childIndexes)?C._childIndexes[A]:A];if((C)&&((!C.colSpan)||(C.colSpan<2))&&C._cellIndex==A){if((C.childNodes[0])&&(C.childNodes[0].className=="hdrcell"))C=C.childNodes[0];E=Math.max(E,((_isFF||_isOpera)?(C.textContent.length*this.fontWidth):C.scrollWidth))}}var D=this.obj.rows.length;for(var H=1;H<D;H++){var G=this.obj.rows[H];if(!this.rowsAr[G.idd])continue;if(G._childIndexes&&G._childIndexes[A]!=A||!G.childNodes[A])continue;if(_isFF||_isOpera||B)G=G.childNodes[A].textContent.length*this.fontWidth;else G=G.childNodes[A].scrollWidth;if(G>E)E=G}E+=20+(B||0);this._setColumnSizeR(A,E);this._notresize=false;this.setSizes()},detachHeader:function(A,B){B=B||this.hdr;var C=B.rows[A+1];if(C)C.parentNode.removeChild(C);this.setSizes()},detachFooter:function(A){this.detachHeader(A,this.ftr)},attachHeader:function(B,C,A){if(typeof(B)=="string")B=this._eSplit(B);if(typeof(C)=="string")C=C.split(this.delim);A=A||"_aHead";if(this.hdr.rows.length){if(B)this._createHRow([B,C],this[(A=="_aHead")?"hdr":"ftr"]);else if(this[A])for(var D=0;D<this[A].length;D++)this.attachHeader.apply(this,this[A][D])}else{if(!this[A])this[A]=new Array();this[A][this[A].length]=[B,C,A]}},_createHRow:function(D,E){if(!E){if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";var N=document.createElement("DIV");N.className="c_ftr".substr(2);this.entBox.appendChild(N);var L=document.createElement("TABLE");L.cellPadding=L.cellSpacing=0;if(!_isIE||_isIE==8){L.width="100%";L.style.paddingRight="20px"}L.style.marginRight="20px";L.style.tableLayout="fixed";N.appendChild(L);L.appendChild(document.createElement("TBODY"));this.ftr=E=L;var H=L.insertRow(0),B=((this.hdrLabels.length<=1)?D[0].length:this.hdrLabels.length);for(var J=0;J<B;J++){H.appendChild(document.createElement("TH"));H.childNodes[J]._cellIndex=J}if(_isIE&&_isIE<8)H.style.position="absolute";else H.style.height="auto"}var I=D[1],N=document.createElement("TR");E.rows[0].parentNode.appendChild(N);for(J=0;J<D[0].length;J++){if(D[0][J]=="#cspan"){var M=N.cells[N.cells.length-1];M.colSpan=(M.colSpan||1)+1;continue}if((D[0][J]=="#rspan")&&(E.rows.length>1)){var C=E.rows.length-2,O=false,M=null;while(!O){M=E.rows[C];for(var G=0;G<M.cells.length;G++)if(M.cells[G]._cellIndex==J){O=G+1;break}C--}M=M.cells[O-1];M.rowSpan=(M.rowSpan||1)+1;continue}var K=document.createElement("TD");K._cellIndex=K._cellIndexS=J;if(this._hrrar&&this._hrrar[J]&&!_isIE)K.style.display="none";if(typeof D[0][J]=="object")K.appendChild(D[0][J]);else{if(this.forceDivInHeader)K.innerHTML="<div class='hdrcell'>"+(D[0][J]||"&nbsp;")+"</div>";else K.innerHTML=(D[0][J]||"&nbsp;");if((D[0][J]||"").indexOf("#")!=-1){L=D[0][J].match(/(^|{)#([^}]+)(}|$)/);if(L){var A="_in_header_"+L[2];if(this[A])this[A]((this.forceDivInHeader?K.firstChild:K),J,D[0][J].split(L[0]))}}}if(I)K.style.cssText=I[J];N.appendChild(K)}var F=E;if(_isKHTML){if(E._kTimer)window.clearTimeout(E._kTimer);E._kTimer=window.setTimeout(function(){E.rows[1].style.display="none";window.setTimeout(function(){E.rows[1].style.display=""},1)},500)}},attachFooter:function(A,B){this.attachHeader(A,B,"_aFoot")},setCellExcellType:function(B,A,C){this.changeCellType(this.getRowById(B),A,C)},changeCellType:function(C,B,D){D=D||this.cellType[B];var E=this.cells3(C,B),A=E.getValue();E.cell._cellType=D;E=this.cells3(C,B);E.setValue(A)},setRowExcellType:function(A,B){var C=this.rowsAr[A];for(var D=0;D<C.childNodes.length;D++)this.changeCellType(C,D,B)},setColumnExcellType:function(A,B){for(var C=0;C<this.rowsBuffer.length;C++)if(this.rowsBuffer[C]&&this.rowsBuffer[C].tagName=="TR")this.changeCellType(this.rowsBuffer[C],A,B);if(this.cellType[A]=="math")this._strangeParams[C]=B;else this.cellType[A]=B},forEachRow:function(A){for(var B in this.rowsAr)if(this.rowsAr[B]&&this.rowsAr[B].idd)A.apply(this,[this.rowsAr[B].idd])},forEachRowA:function(A){for(var B=0;B<this.rowsBuffer.length;B++)if(this.rowsBuffer[B])A.call(this,this.render_row(B).idd)},forEachCell:function(B,A){var C=this.getRowById(B);if(!C)return;for(var D=0;D<this._cCount;D++)A(this.cells3(C,D),D)},enableAutoWidth:function(C,A,B){this._awdth=[convertStringToBoolean(C),parseInt(A||99999),parseInt(B||0)];if(arguments.length==1)this.objBox.style.overflowX=C?"hidden":"auto"},updateFromXML:function(C,A,D,B){if(typeof A=="undefined")A=true;this._refresh_mode=[true,A,D];this.load(C,B)},_refreshFromXML:function(F){if(this._f_rowsBuffer)this.filterBy(0,"");reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(A){var B=this.grid._h2.get[this.cell.parentNode.idd];if(B&&this.cell.parentNode.valTag)this.setLabel(A);else this.setValueX(A)}}var B=this.cellType._dhx_find("tree");F.getXMLTopNode("rows");var E=F.doXPath("//rows")[0].getAttribute("parent")||0,D={};if(this._refresh_mode[2])if(B!=-1)this._h2.forEachChild(E,function(A){D[A.id]=true},this);else this.forEachRow(function(A){D[A]=true});var J=F.doXPath("//row");for(var I=0;I<J.length;I++){var H=J[I],A=H.getAttribute("id");D[A]=false;E=H.parentNode.getAttribute("id")||E;if(this.rowsAr[A]&&this.rowsAr[A].tagName!="TR"){if(this._h2)this._h2.get[A].buff.data=H;else this.rowsBuffer[this.getRowIndex(A)].data=H;this.rowsAr[A]=H}else if(this.rowsAr[A]){this._process_xml_row(this.rowsAr[A],H,-1);this._postRowProcessing(this.rowsAr[A],true)}else if(this._refresh_mode[1]){var C={idd:A,data:H,_parser:this._process_xml_row,_locator:this._get_xml_data},G=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(C);G=0}else this.rowsBuffer.push(C);if(this._h2){reset=true;(this._h2.add(A,(H.parentNode.getAttribute("id")||H.parentNode.getAttribute("parent")))).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[A]=H;H=this.render_row(G);this._insertRowAt(H,G?-1:0)}}if(this._refresh_mode[2])for(A in D)if(D[A]&&this.rowsAr[A])this.deleteRow(A);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;if(reset)this._renderSort();if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},getCustomCombo:function(A,B){var C=this.cells(A,B).cell;if(!C._combo)C._combo=new dhtmlXGridComboObject();return C._combo},setTabOrder:function(C){var B=C.split(this.delim);this._tabOrder=[];var A=this._cCount||C.length;for(var D=0;D<A;D++)B[D]={c:parseInt(B[D]),ind:D};B.sort(function(B,A){return(B.c>A.c?1:-1)});for(D=0;D<A;D++)if(!B[D+1]||(typeof B[D].c=="undefined"))this._tabOrder[B[D].ind]=(B[0].ind+1)*-1;else this._tabOrder[B[D].ind]=B[D+1].ind},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A+1],this.cell._cellIndex,true)},k13_0_1:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A-1],this.cell._cellIndex,true)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true]))return true;var A=this._getNextCell(null,1);if(A){this.selectCell(A.parentNode,A._cellIndex,(this.row!=A.parentNode),false,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false]))return false;var A=this._getNextCell(null,-1);if(A){this.selectCell(A.parentNode,A._cellIndex,(this.row!=A.parentNode),false,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE)this.editCell()},k32_0_0:function(){var A=this.cells4(this.cell);if(!A.changeState||(A.changeState()===false))return false},k27_0_0:function(){this.editStop(true)},k33_0_0:function(){if(this.pagingOn)this.changePage(this.currentPage-1);else this.scrollPage(-1)},k34_0_0:function(){if(this.pagingOn)this.changePage(this.currentPage+1);else this.scrollPage(1)},k37_0_0:function(){if(!this.editor&&this.isTreeGrid())this.collapseKids(this.row);else return false},k39_0_0:function(){if(!this.editor&&this.isTreeGrid())this.expandKids(this.row);else return false},k40_0_0:function(){var B=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var A=Math.max((B._r_select||0),this.getRowIndex(this.row.idd))+1;if(this.rowsBuffer[A]){B._r_select=null;this.selectCell(A,this.cell._cellIndex,true);if(B.pagingOn)B.showRow(B.getRowId(A))}else{if(!this.callEvent("onLastRow",[]))return false;this._key_events.k34_0_0.apply(this,[]);if(this.pagingOn&&this.rowsCol[A])this.selectCell(A,0,true)}}this._still_active=true},k38_0_0:function(){var C=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var A=this.getRowIndex(this.row.idd)+1;if(A!=-1&&(!this.pagingOn||(A!=1))){var B=this._nextRow(A-1,-1);this.selectCell(B,this.cell._cellIndex,true);if(C.pagingOn&&B)C.showRow(B.idd)}else this._key_events.k33_0_0.apply(this,[])}this._still_active=true}},_build_master_row:function(){var A=document.createElement("DIV"),B=["<table><tr>"];for(var C=0;C<this._cCount;C++)B.push("<td></td>");B.push("</tr></table>");A.innerHTML=B.join("");this._master_row=A.firstChild.rows[0]},_prepareRow:function(B){if(!this._master_row)this._build_master_row();var A=this._master_row.cloneNode(true);for(var C=0;C<A.childNodes.length;C++){A.childNodes[C]._cellIndex=C;if(this._enbCid)A.childNodes[C].id="c_"+B+"_"+C;if(this.dragAndDropOff)this.dragger.addDraggableItem(A.childNodes[C],this)}A.idd=B;A.grid=this;return A},_process_jsarray_row:function(A,B){A._attrs={};for(var C=0;C<A.childNodes.length;C++)A.childNodes[C]._attrs={};this._fillRow(A,(this._c_order?this._swapColumns(B):B));return A},_get_jsarray_data:function(B,A){return B[A]},_process_json_row:function(A,B){B=this._c_order?this._swapColumns(B.data):B.data;return this._process_some_row(A,B)},_process_some_row:function(A,B){A._attrs={};for(var C=0;C<A.childNodes.length;C++)A.childNodes[C]._attrs={};this._fillRow(A,B);return A},_get_json_data:function(B,A){return B.data[A]},_process_js_row:function(B,C){var A=[];for(var D=0;D<this.columnIds.length;D++){A[D]=C[this.columnIds[D]];if(!A[D]&&A[D]!==0)A[D]=""}this._process_some_row(B,A);B._attrs=C;return B},_get_js_data:function(B,A){return B[this.columnIds[A]]},_process_csv_row:function(A,B){A._attrs={};for(var C=0;C<A.childNodes.length;C++)A.childNodes[C]._attrs={};this._fillRow(A,(this._c_order?this._swapColumns(B.split(this.csv.cell)):B.split(this.csv.cell)));return A},_get_csv_data:function(B,A){return B.split(this.csv.cell)[A]},_process_store_row:function(D,B){var A=[];for(var E=0;E<this.columnIds.length;E++)A[E]=B[this.columnIds[E]];for(var C=0;C<D.childNodes.length;C++)D.childNodes[C]._attrs={};D._attrs=B;this._fillRow(D,A)},_process_xml_row:function(C,E){var J=this.xmlLoader.doXPath(this.xml.cell,E),A=[];C._attrs=this._xml_attrs(E);if(this._ud_enabled){var I=this.xmlLoader.doXPath("./userdata",E);for(var K=I.length-1;K>=0;K--){var H="";for(var G=0;G<I[K].childNodes.length;G++)H+=I[K].childNodes[G].nodeValue;this.setUserData(C.idd,I[K].getAttribute("name"),H)}}for(G=0;G<J.length;G++){var D=J[this._c_order?this._c_order[G]:G];if(!D)continue;var B=C._childIndexes?C._childIndexes[G]:G,F=D.getAttribute("type");if(C.childNodes[B]){if(F)C.childNodes[B]._cellType=F;C.childNodes[B]._attrs=this._xml_attrs(D)}if(!D.getAttribute("xmlcontent"))if(D.firstChild)D=D.firstChild.data;else D="";A.push(D)}for(G<J.length;G<C.childNodes.length;G++)C.childNodes[G]._attrs={};if(C.parentNode&&C.parentNode.tagName=="row")C._attrs["parent"]=C.parentNode.getAttribute("idd");this._fillRow(C,A);return C},_get_xml_data:function(B,A){B=B.firstChild;while(true){if(!B)return"";if(B.tagName=="cell")A--;if(A<0)break;B=B.nextSibling}return(B.firstChild?B.firstChild.data:"")},_fillRow:function(D,C){if(this.editor)this.editStop();for(var F=0;F<D.childNodes.length;F++)if((F<C.length)||(this.defVal[F])){var E=D.childNodes[F]._cellIndex,A=C[E],B=this.cells4(D.childNodes[F]);if((this.defVal[E])&&((A=="")||(typeof(A)=="undefined")))A=this.defVal[E];if(B)B.setValue(A)}else{D.childNodes[F].innerHTML="&nbsp;";D.childNodes[F]._clearCell=true}return D},_postRowProcessing:function(F,C){if(F._attrs["class"])F._css=F.className=F._attrs["class"];if(F._attrs.locked)F._locked=true;if(F._attrs.bgColor)F.bgColor=F._attrs.bgColor;var B=0;for(var H=0;H<F.childNodes.length;H++){var E=F.childNodes[H],G=E._cellIndex,A=E._attrs.style||F._attrs.style;if(A)E.style.cssText+=";"+A;if(E._attrs["class"])E.className=E._attrs["class"];A=E._attrs.align||this.cellAlign[G];if(A)E.align=A;E.vAlign=E._attrs.valign||this.cellVAlign[G];var D=E._attrs.bgColor||this.columnColor[G];if(D)E.bgColor=D;if(E._attrs["colspan"]&&!C){this.setColspan(F.idd,H+B,E._attrs["colspan"]);B+=(E._attrs["colspan"]-1)}if(this._hrrar&&this._hrrar[G]&&!C)E.style.display="none"}this.callEvent("onRowCreated",[F.idd,F,null])},load:function(C,A,B){this.callEvent("onXLS",[this]);if(arguments.length==2&&typeof A!="function"){B=A;A=null}B=B||"xml";if(!this.xmlFileUrl)this.xmlFileUrl=C;this._data_type=B;this.xmlLoader.onloadAction=function(C,E,F,D,G){if(!C.callEvent)return;G=C["_process_"+B](G);if(!C._contextCallTimer)C.callEvent("onXLE",[C,0,0,G]);if(A){A();A=null}};this.xmlLoader.loadXML(C)},loadXMLString:function(B,C){var A=new dtmlXMLLoaderObject(function(){});A.loadXMLString(B);this.parse(A,C,"xml")},loadXML:function(B,A){this.load(B,A,"xml")},parse:function(B,A,C){if(arguments.length==2&&typeof A!="function"){C=A;A=null}C=C||"xml";this._data_type=C;B=this["_process_"+C](B);if(!this._contextCallTimer)this.callEvent("onXLE",[this,0,0,B]);if(A)A()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(A){var B={};if(A.attributes.length)for(var C=0;C<A.attributes.length;C++)B[A.attributes[C].name]=A.attributes[C].value;return B},_process_xml:function(G){if(!G.doXPath){var D=new dtmlXMLLoaderObject(function(){});if(typeof G=="string")D.loadXMLString(G);else{if(G.responseXML)D.xmlDoc=G;else D.xmlDoc={};D.xmlDoc.responseXML=G}G=D}if(this._refresh_mode)return this._refreshFromXML(G);this._parsing=true;var K=G.getXMLTopNode(this.xml.top);if(K.tagName!=this.xml.top)return;var E=K.getAttribute("dhx_security");if(E)dhtmlx.security_key=E;this._parseHead(K);var J=G.doXPath(this.xml.row,K),C=parseInt(G.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),B=parseInt(G.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0),F=false;if(B&&B!=this.rowsBuffer.length){if(!this.rowsBuffer[B-1]){if(this.rowsBuffer.length)F=true;this.rowsBuffer[B-1]=null}if(B<this.rowsBuffer.length){this.rowsBuffer.splice(B,this.rowsBuffer.length-B);F=true}}if(this.isTreeGrid())return this._process_tree_xml(G);for(var I=0;I<J.length;I++){if(this.rowsBuffer[I+C])continue;var A=J[I].getAttribute("id")||(I+C+1);this.rowsBuffer[I+C]={idd:A,data:J[I],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[A]=J[I]}if(F&&this._srnd){var H=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=H}else this.render_dataset();this._parsing=false;return G.xmlDoc.responseXML?G.xmlDoc.responseXML:G.xmlDoc},_process_jsarray:function(data){this._parsing=true;if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[id]=data[i]}this.render_dataset();this._parsing=false},_process_csv:function(C){this._parsing=true;if(C.xmlDoc)C=C.xmlDoc.responseText;C=C.replace(/\r/g,"");C=C.split(this.csv.row);if(this._csvHdr){this.clearAll();var B=C.splice(0,1)[0].split(this.csv.cell);if(!this._csvAID)B.splice(0,1);this.setHeader(B.join(this.delim));this.init()}for(var E=0;E<C.length;E++){if(!C[E]&&E==C.length-1)continue;if(this._csvAID){var A=E+1;this.rowsBuffer.push({idd:A,data:C[E],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var D=C[E].split(this.csv.cell),A=D.splice(0,1)[0];this.rowsBuffer.push({idd:A,data:D,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[A]=C[E]}this.render_dataset();this._parsing=false},_process_js:function(A){return this._process_json(A,"js")},_process_json:function(data,mode){this._parsing=true;if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}if(mode=="js"){if(data.data)data=data.data;for(var i=0;i<data.length;i++){var row=data[i],id=row.id||(i+1);this.rowsBuffer.push({idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data});this.rowsAr[id]=data[i]}}else for(i=0;i<data.rows.length;i++){id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[id]=data[i]}if(data.dhx_security)dhtmlx.security_key=data.dhx_security;this.render_dataset();this._parsing=false},render_dataset:function(A,C){if(this._srnd){if(this._fillers)return this._update_srnd_view();C=Math.min((this._get_view_size()+(this._srnd_pr||0)),this.rowsBuffer.length)}if(this.pagingOn){A=Math.max((A||0),(this.currentPage-1)*this.rowsBufferOutSize);C=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)}else{A=A||0;C=C||this.rowsBuffer.length}for(var H=A;H<C;H++){var D=this.render_row(H);if(D==-1){if(this.xmlFileUrl)if(this.callEvent("onDynXLS",[H,(this._dpref?this._dpref:(C-H))]))this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+H+"&count="+(this._dpref?this._dpref:(C-H)),this._data_type);C=H;break}if(!D.parentNode||!D.parentNode.tagName){this._insertRowAt(D,H);if(D._attrs["selected"]||D._attrs["select"]){this.selectRow(D,D._attrs["call"]?true:false,true);D._attrs["selected"]=D._attrs["select"]=null}}if(this._ads_count&&H-A==this._ads_count){var B=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){B._contextCallTimer=null;B.render_dataset(H,C);if(!B._contextCallTimer){if(B._context_parsing)B.callEvent("onXLE",[]);else B._fixAlterCss();B.callEvent("onDistributedEnd",[]);B._context_parsing=false}},this._ads_time)}}if(this._srnd&&!this._fillers){var F=this.rowsBuffer.length-C;this._fillers=[];while(F>0){var E=_isIE?Math.min(F,50000):F,G=this._add_filler(C,E);if(G)this._fillers.push(G);F-=E;C+=E}}this.setSizes()},render_row:function(B){if(!this.rowsBuffer[B])return-1;if(this.rowsBuffer[B]._parser){var A=this.rowsBuffer[B];if(this.rowsAr[A.idd]&&this.rowsAr[A.idd].tagName=="TR")return this.rowsBuffer[B]=this.rowsAr[A.idd];var C=this._prepareRow(A.idd);this.rowsBuffer[B]=C;this.rowsAr[A.idd]=C;A._parser.call(this,C,A.data);this._postRowProcessing(C);return C}return this.rowsBuffer[B]},_get_cell_value:function(C,A,B){if(C._locator){if(this._c_order)A=this._c_order[A];return C._locator.call(this,C.data,A)}return this.cells3(C,A)[B?B:"getValue"]()},sortRows:function(B,F,C){C=(C||"asc").toLowerCase();F=(F||this.fldSort[B]);B=B||0;if(this.isTreeGrid())this.sortTreeRows(B,F,C);else{var E={},A=this.cellType[B],D="getValue";if(A=="link")D="getContent";if(A=="dhxCalendar"||A=="dhxCalendarA")D="getDate";for(var G=0;G<this.rowsBuffer.length;G++)E[this.rowsBuffer[G].idd]=this._get_cell_value(this.rowsBuffer[G],B,D);this._sortRows(B,F,C,E)}this.callEvent("onAfterSorting",[B,F,C])},_sortCore:function(A,F,D,E,C){var B="sort";if(this._sst){C["stablesort"]=this.rowsCol.stablesort;B="stablesort"}if(F.length>4)F=window[F];if(F=="cus"){var G=this._customSorts[A];C[B](function(B,A){return G(E[B.idd],E[A.idd],D,B.idd,A.idd)})}else if(typeof(F)=="function")C[B](function(B,A){return F(E[B.idd],E[A.idd],D,B.idd,A.idd)});else if(F=="str")C[B](function(B,A){if(D=="asc")return E[B.idd]>E[A.idd]?1:-1;else return E[B.idd]<E[A.idd]?1:-1});else if(F=="int")C[B](function(C,B){var A=parseFloat(E[C.idd]);A=isNaN(A)?-99999999999999:A;var F=parseFloat(E[B.idd]);F=isNaN(F)?-99999999999999:F;if(D=="asc")return A-F;else return F-A});else if(F=="date")C[B](function(C,B){var A=Date.parse(E[C.idd])||(Date.parse("01/01/1900")),F=Date.parse(E[B.idd])||(Date.parse("01/01/1900"));if(D=="asc")return A-F;else return F-A})},_sortRows:function(A,D,B,C){this._sortCore(A,D,B,C,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(C){if(!this.obj.rows[0])return;this.callEvent("onResetView",[]);var A=this.obj.rows[0].parentNode,B=A.removeChild(A.childNodes[0],true);if(_isKHTML){for(var D=A.parentNode.childNodes.length-1;D>=0;D--)if(A.parentNode.childNodes[D].tagName=="TR")A.parentNode.removeChild(A.parentNode.childNodes[D],true)}else if(_isIE){for(D=A.childNodes.length-1;D>=0;D--)A.childNodes[D].removeNode(true)}else A.innerHTML="";A.appendChild(B);this.rowsCol=dhtmlxArray();if(this._sst)this.enableStableSorting(true);this._fillers=this.undefined;if(!C)if(_isIE&&this._srnd)this.render_dataset();else this.render_dataset()},deleteRow:function(B,C){if(!C)C=this.getRowById(B);if(!C)return;this.editStop();if(!this._realfake)if(this.callEvent("onBeforeRowDeleted",[B])==false)return false;var E=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){E=this._h2.get[B].parent.id;this._removeTrGrRow(C)}else{if(C.parentNode)C.parentNode.removeChild(C);var D=this.rowsCol._dhx_find(C);if(D!=-1)this.rowsCol._dhx_removeAt(D);for(var F=0;F<this.rowsBuffer.length;F++)if(this.rowsBuffer[F]&&this.rowsBuffer[F].idd==B){this.rowsBuffer._dhx_removeAt(F);D=F;break}}this.rowsAr[B]=null;for(F=0;F<this.selectedRows.length;F++)if(this.selectedRows[F].idd==B)this.selectedRows._dhx_removeAt(F);if(this._srnd){for(F=0;F<this._fillers.length;F++){var A=this._fillers[F];if(!A)continue;if(A[0]>=D)A[0]=A[0]-1;else if(A[1]>=D)A[1]=A[1]-1}this._update_srnd_view()}if(this.pagingOn)this.changePage();if(!this._realfake)this.callEvent("onAfterRowDeleted",[B,E]);this.callEvent("onGridReconstructed",[]);if(this._ahgr)this.setSizes();return true},_addRow:function(D,B,C){if(C==-1||typeof C=="undefined")C=this.rowsBuffer.length;if(typeof B=="string")B=B.split(this.delim);var F=this._prepareRow(D);F._attrs={};for(var E=0;E<F.childNodes.length;E++)F.childNodes[E]._attrs={};this.rowsAr[F.idd]=F;if(this._h2)this._h2.get[F.idd].buff=F;this._fillRow(F,B);this._postRowProcessing(F);if(this._skipInsert){this._skipInsert=false;return this.rowsAr[F.idd]=F}if(this.pagingOn){this.rowsBuffer._dhx_insertAt(C,F);this.rowsAr[F.idd]=F;return F}if(this._fillers){this.rowsCol._dhx_insertAt(C,null);this.rowsBuffer._dhx_insertAt(C,F);if(this._fake)this._fake.rowsCol._dhx_insertAt(C,null);this.rowsAr[F.idd]=F;var H=false;for(var G=0;G<this._fillers.length;G++){var A=this._fillers[G];if(A&&A[0]<=C&&(A[0]+A[1])>=C){A[1]=A[1]+1;A[2].firstChild.style.height=parseInt(A[2].firstChild.style.height)+this._srdh+"px";H=true;if(this._fake)this._fake._fillers[G][1]++}if(A&&A[0]>C){A[0]=A[0]+1;if(this._fake)this._fake._fillers[G][0]++}}if(!H)this._fillers.push(this._add_filler(C,1,(C==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:(this.rowsCol[1])}:this.rowsCol[C-1])));return F}this.rowsBuffer._dhx_insertAt(C,F);return this._insertRowAt(F,C)},addRow:function(D,A,C){var B=this._addRow(D,A,C);if(!this.dragContext)this.callEvent("onRowAdded",[D]);if(this.pagingOn)this.changePage(this.currentPage);if(this._srnd)this._update_srnd_view();B._added=true;if(this._ahgr)this.setSizes();this.callEvent("onGridReconstructed",[]);return B},_insertRowAt:function(B,A,C){this.rowsAr[B.idd]=B;if(this._skipInsert){this._skipInsert=false;return B}if((A<0)||((!A)&&(parseInt(A)!==0)))A=this.rowsCol.length;else if(A>this.rowsCol.length)A=this.rowsCol.length;if(this._cssEven)if((this._cssSP?this.getLevel(B.idd):A)%2==1)B.className+=" "+this._cssUnEven+(this._cssSU?(" "+this._cssUnEven+"_"+this.getLevel(B.idd)):"");else B.className+=" "+this._cssEven+(this._cssSU?(" "+this._cssEven+"_"+this.getLevel(B.idd)):"");if(!C)if((A==(this.obj.rows.length-1))||(!this.rowsCol[A])){if(_isKHTML)this.obj.appendChild(B);else this.obj.firstChild.appendChild(B)}else this.rowsCol[A].parentNode.insertBefore(B,this.rowsCol[A]);this.rowsCol._dhx_insertAt(A,B);this.callEvent("onRowInserted",[B,A]);return B},getRowById:function(A){var B=this.rowsAr[A];if(B){if(B.tagName!="TR"){for(var C=0;C<this.rowsBuffer.length;C++)if(this.rowsBuffer[C]&&this.rowsBuffer[C].idd==A)return this.render_row(C);if(this._h2)return this.render_row(null,B.idd)}return B}return null},cellById:function(A,B){return this.cells(A,B)},cells:function(A,B){if(arguments.length==0)return this.cells4(this.cell);else var C=this.getRowById(A);var D=(C._childIndexes?C.childNodes[C._childIndexes[B]]:C.childNodes[B]);return this.cells4(D)},cellByIndex:function(B,A){return this.cells2(B,A)},cells2:function(B,A){var C=this.render_row(B),D=(C._childIndexes?C.childNodes[C._childIndexes[A]]:C.childNodes[A]);return this.cells4(D)},cells3:function(C,A){var B=(C._childIndexes?C.childNodes[C._childIndexes[A]]:C.childNodes[A]);return this.cells4(B)},cells4:function(A){var B=window["eXcell_"+(A._cellType||this.cellType[A._cellIndex])];if(B)return new B(A)},cells5:function(A,C){var C=C||(A._cellType||this.cellType[A._cellIndex]);if(!this._ecache[C]){if(!window["eXcell_"+C])var B=eXcell_ro;else B=window["eXcell_"+C];this._ecache[C]=new B(A)}this._ecache[C].cell=A;return this._ecache[C]},dma:function(A){if(!this._ecache)this._ecache={};if(A&&!this._dma){this._dma=this.cells4;this.cells4=this.cells5}else if(!A&&this._dma){this.cells4=this._dma;this._dma=null}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(A){if(arguments.length>0)this.smartTabOrder=convertStringToBoolean(A);else this.smartTabOrder=true},setExternalTabOrder:function(A,C){var B=this;this.tabStart=(typeof(A)=="object")?A:document.getElementById(A);this.tabStart.onkeydown=function(C){var A=(C||window.event);if(A.keyCode==9&&!A.shiftKey){A.cancelBubble=true;B.selectCell(0,0,0,0,1);if(B.smartTabOrder&&B.cells2(0,0).isDisabled())B._key_events["k9_0_0"].call(B);this.blur();return false}};if(_isOpera)this.tabStart.onkeypress=this.tabStart.onkeydown;this.tabEnd=(typeof(C)=="object")?C:document.getElementById(C);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(C){var A=(C||window.event);if(A.keyCode==9&&A.shiftKey){A.cancelBubble=true;B.selectCell((B.getRowsNum()-1),(B.getColumnCount()-1),0,0,1);if(B.smartTabOrder&&B.cells2((B.getRowsNum()-1),(B.getColumnCount()-1)).isDisabled())B._key_events["k9_0_1"].call(B);this.blur();return false}};if(_isOpera)this.tabEnd.onkeypress=this.tabEnd.onkeydown},uid:function(){if(!this._ui_seed)this._ui_seed=(new Date()).valueOf();return this._ui_seed++},clearAndLoad:function(){var A=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=A;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var A=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,A,Math.min(A+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};(function(){function A(A,B){this[A]=B}function B(A,B){this[A].call(this,B)}function D(A,B){this[A].call(this,B.join(this.delim))}function F(A,B){for(var E=0;E<B.length;E++)if(typeof B[E]=="object"){var C=this.getCombo(E);for(var D in B[E])C.put(D,B[E][D])}}function C(A,B,C){var J=1,H=[];function D(C,B,A){if(!H[B])H[B]=[];if(typeof A=="object")A.toString=function(){return this.text};H[B][C]=A}for(var I=0;I<B.length;I++)if(typeof(B[I])=="object"&&B[I].length){for(var E=0;E<B[I].length;E++)D(I,E,B[I][E])}else D(I,0,B[I]);for(I=0;I<H.length;I++)for(E=0;E<H[0].length;E++){var G=H[I][E];H[I][E]=(G||"").toString()||"&nbsp;";if(G&&G.colspan)for(var F=1;F<G.colspan;F++)D(E+F,I,"#cspan");if(G&&G.rowspan)for(F=1;F<G.rowspan;F++)D(E,I+F,"#rspan")}this.setHeader(H[0]);for(I=1;I<H.length;I++)this.attachHeader(H[I])}var E=[{name:"label",def:"&nbsp;",operation:"setHeader",type:C},{name:"id",def:"",operation:"columnIds",type:A},{name:"width",def:"*",operation:"setInitWidths",type:D},{name:"align",def:"left",operation:"cellAlign",type:A},{name:"valign",def:"middle",operation:"cellVAlign",type:A},{name:"sort",def:"na",operation:"fldSort",type:A},{name:"type",def:"ro",operation:"setColTypes",type:D},{name:"options",def:"",operation:"",type:F}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(A){return[A.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(C){for(var F=0;F<E.length;F++){var A=[];for(var G=0;G<C.length;G++)A[G]=C[G][E[F].name]||E[F].def;var D=E[F].type||B;D.call(this,E[F].operation,A,C)}this.init()},rows:function(A){},headers:function(A){for(var B=0;B<A.length;B++)this.attachHeader(A[B])}})})();dhtmlXGridObject.prototype._dp_init=function(A){A.attachEvent("insertCallback",function(B,A){if(this.obj._h2)this.obj.addRow(A,C,null,parent);else this.obj.addRow(A,[],0);var C=this.obj.getRowById(A);if(C){this.obj._process_xml_row(C,B.firstChild);this.obj._postRowProcessing(C)}});A.attachEvent("updateCallback",function(B,A){var C=this.obj.getRowById(A);if(C){this.obj._process_xml_row(C,B.firstChild);this.obj._postRowProcessing(C)}});A.attachEvent("deleteCallback",function(B,A){this.obj.setUserData(A,this.action_param,"true_deleted");this.obj.deleteRow(A)});A._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(E,B,C){if(A._columns&&!A._columns[C])return true;var D=this.cells(B,C);if(E==1){if(D.isCheckbox())A.setUpdated(B,true)}else if(E==2)if(D.wasChanged())A.setUpdated(B,true);return true});this.attachEvent("onRowPaste",function(B){A.setUpdated(B,true)});this.attachEvent("onRowIdChange",function(B,D){var C=A.findRow(B);if(C<A.updatedRows.length)A.updatedRows[C]=D});this.attachEvent("onSelectStateChanged",function(B){if(A.updateMode=="row")A.sendData();return true});this.attachEvent("onEnter",function(C,B){if(A.updateMode=="row")A.sendData();return true});this.attachEvent("onBeforeRowDeleted",function(B){if(!this.rowsAr[B])return true;if(this.dragContext&&A.dnd){window.setTimeout(function(){A.setUpdated(B,true)},1);return true}var C=A.getState(B);if(this._h2)this._h2.forEachChild(B,function(B){A.setUpdated(B.id,false);A.markRow(B.id,true,"deleted")},this);if(C=="inserted"){A.set_invalid(B,false);A.setUpdated(B,false);return true}if(C=="deleted")return false;if(C=="true_deleted"){A.setUpdated(B,false);return true}A.setUpdated(B,true,"deleted");return false});this.attachEvent("onBindUpdate",function(B){A.setUpdated(B,true)});this.attachEvent("onRowAdded",function(B){if(this.dragContext&&A.dnd)return true;A.setUpdated(B,true,"inserted");return true});A._getRowData=function(F,H){var D=[];D["gr_id"]=F;if(this.obj.isTreeGrid())D["gr_pid"]=this.obj.getParentId(F);var C=this.obj.getRowById(F);for(var I=0;I<this.obj._cCount;I++){if(this.obj._c_order)var E=this.obj._c_order[I];else E=I;var B=this.obj.cells(C.idd,I);if(this._changed&&!B.wasChanged())continue;if(this._endnm)D[this.obj.getColumnId(I)]=B.getValue();else D["c"+E]=B.getValue()}var A=this.obj.UserData[F];if(A)for(var G=0;G<A.keys.length;G++)if(A.keys[G]&&A.keys[G].indexOf("__")!=0)D[A.keys[G]]=A.values[G];A=this.obj.UserData["gridglobaluserdata"];if(A)for(G=0;G<A.keys.length;G++)D[A.keys[G]]=A.values[G];return D};A._clearUpdateFlag=function(A){var C=this.obj.getRowById(A);if(C)for(var B=0;B<this.obj._cCount;B++)this.obj.cells(A,B).cell.wasChanged=false};A.checkBeforeUpdate=function(D){var B=true,C=[];for(var E=0;E<this.obj._cCount;E++)if(this.mandatoryFields[E]){var A=this.mandatoryFields[E].call(this.obj,this.obj.cells(D,E).getValue(),D,E);if(typeof A=="string"){this.messages.push(A);B=false}else{B&=A;C[E]=!A}}if(!B){this.set_invalid(D,"invalid",C);this.setUpdated(D,false)}return B}};function dhtmlXGridCellObject(A){this.destructor=function(){this.cell.obj=null;this.cell=null;this.grid=null;this.base=null;return null};this.cell=A;this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA"))return this.cell.firstChild.value;else return this.cell.innerHTML._dhx_trim()};this.getMathValue=function(){if(this.cell.original)return this.cell.original;else return this.getValue()};this.getFont=function(){arOut=new Array(3);if(this.cell.style.fontFamily)arOut[0]=this.cell.style.fontFamily;if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold")arOut[1]="bold";if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic")arOut[1]+="italic";if(this.cell.style.fontSize)arOut[2]=this.cell.style.fontSize;else arOut[2]="";return arOut.join("-")};this.getTextColor=function(){if(this.cell.style.color)return this.cell.style.color;else return"#000000"};this.getBgColor=function(){if(this.cell.bgColor)return this.cell.bgColor;else return"#FFFFFF"};this.getHorAlign=function(){if(this.cell.style.textAlign)return this.cell.style.textAlign;else if(this.cell.style.textAlign)return this.cell.style.textAlign;else return"left"};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(A){fntAr=A.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1]))this.cell.style.fontWeight="bold";if(/italic/.test(fntAr[1]))this.cell.style.fontStyle="italic";if(/underline/.test(fntAr[1]))this.cell.style.textDecoration="underline"}};this.setTextColor=function(A){this.cell.style.color=A};this.setBgColor=function(A){if(A=="")A=null;this.cell.bgColor=A};this.setHorAlign=function(A){if(A.length==1){if(A=="c")this.cell.style.textAlign="center";else if(A=="l")this.cell.style.textAlign="left";else this.cell.style.textAlign="right"}else this.cell.style.textAlign=A};this.wasChanged=function(){if(this.cell.wasChanged)return true;else return false};this.isCheckbox=function(){var A=this.cell.firstChild;if(A&&A.tagName=="INPUT"){type=A.type;if(type=="radio"||type=="checkbox")return true;else return false}else return false};this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(A){if(this.isCheckbox()){if(A!="true"&&A!=1)A=false;this.cell.firstChild.checked=A}};this.setDisabled=function(A){if(A!="true"&&A!=1)A=false;if(this.isCheckbox()){this.cell.firstChild.disabled=A;if(this.disabledF)this.disabledF(A)}this.cell._disabled=A}}dhtmlXGridCellObject.prototype={getAttribute:function(A){return this.cell._attrs[A]},setAttribute:function(A,B){this.cell._attrs[A]=B},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA"))return this.obj;var A=(this.obj||this.cell).getElementsByTagName("TEXTAREA");if(!A.length)A=(this.obj||this.cell).getElementsByTagName("INPUT");return A[0]}};dhtmlXGridCellObject.prototype.setValue=function(A){if((typeof(A)!="number")&&(!A||A.toString()._dhx_trim()=="")){A="&nbsp;";this.cell._clearCell=true}else this.cell._clearCell=false;this.setCValue(A)};dhtmlXGridCellObject.prototype.getTitle=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};dhtmlXGridCellObject.prototype.setCValue=function(A,B){this.cell.innerHTML=A;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,(arguments.length>1?B:A)])};dhtmlXGridCellObject.prototype.setCTxtValue=function(A){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(A));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,A])};dhtmlXGridCellObject.prototype.setLabel=function(A){this.cell.innerHTML=A};dhtmlXGridCellObject.prototype.getMath=function(){if(this._val)return this.val;else return this.getValue()};function eXcell(){this.obj=null;this.val=null;this.changeState=function(){return false};this.edit=function(){this.val=this.getValue()};this.detach=function(){return false};this.getPosition=function(D){var B=D,C=0,A=0;while(B.tagName!="BODY"){C+=B.offsetLeft;A+=B.offsetTop;B=B.offsetParent}return new Array(C,A)}}eXcell.prototype=new dhtmlXGridCellObject;function eXcell_ed(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=(this.cell.offsetHeight-(_isIE?4:4))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(A){(A||event).cancelBubble=true};this.obj.onmousedown=function(A){(A||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(A){if(!A)A=event;A.cancelBubble=true;return true};if(_isIE)this.obj.focus();this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag)))return this.cell.firstChild.value;if(this.cell._clearCell)return"";return this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag)))return this.cell.firstChild.value;if(this.cell._clearCell)return"";return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){A=" ";this.cell._clearCell=true}else this.cell._clearCell=false;this.setCTxtValue(A)}}eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA"))return this.cell.firstChild.value;if(this.cell._clearCell)return"";return this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var A=this.obj.value;this.setValue(A);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;eXcell_edn.prototype.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){this.cell._clearCell=true;return this.setCValue("&nbsp;",0)}else{this.cell._clearCell=false;this.cell._orig_value=A}this.setCValue(this.grid._aplNF(A,this.cell._cellIndex),A)};function eXcell_ch(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.disabledF=function(A){if((A==true)||(A==1))this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis.");else this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")};this.changeState=function(A){if(A===true&&!this.grid.isActive){if(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive)window.globalActiveDHTMLGridObject.setActive(false);this.grid.setActive(true)}if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled()))return;if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])){this.val=this.getValue();if(this.val=="1")this.setValue("0");else this.setValue("1");this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else this.editor=null};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1")return true;else return false};this.setChecked=function(A){this.setValue(A.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;eXcell_ch.prototype.setValue=function(A){this.cell.style.verticalAlign="middle";if(A){A=A.toString()._dhx_trim();if((A=="false")||(A=="0"))A=""}if(A){A="1";this.cell.chstate="1"}else{A="0";this.cell.chstate="0"}var B=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+A+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true);(arguments[0]||event).cancelBubble=true;'>",this.cell.chstate)};function eXcell_ra(A){this.base=eXcell_ch;this.base(A);this.grid=A.parentNode.grid;this.disabledF=function(A){if((A==true)||(A==1))this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis.");else this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")};this.changeState=function(A){if(A===false&&this.getValue()==1)return;if((!this.grid.isEditable)||(this.cell.parentNode._locked))return;if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1")this.setValue("0");else this.setValue("1");this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else this.editor=null};this.edit=null}eXcell_ra.prototype=new eXcell_ch;eXcell_ra.prototype.setValue=function(A){this.cell.style.verticalAlign="middle";if(A){A=A.toString()._dhx_trim();if((A=="false")||(A=="0"))A=""}if(A){if(!this.grid._RaSeCol)this.grid._RaSeCol=[];if(this.grid._RaSeCol[this.cell._cellIndex]){var B=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);B.setValue("0");if(this.grid.rowsAr[B.cell.parentNode.idd])this.grid.callEvent("onEditCell",[1,B.cell.parentNode.idd,B.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;A="1";this.cell.chstate="1"}else{A="0";this.cell.chstate="0"}this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+A+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};function eXcell_txt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(A){(A||event).cancelBubble=true};var B=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var A=document.createElement("DIV");A.appendChild(this.obj);A.style.overflow="auto";A.className="dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=A}document.body.appendChild(this.obj);if(_isOpera)this.obj.onkeypress=function(A){if(A.keyCode==9)return false};this.obj.onkeydown=function(B){var A=(B||event);if(A.keyCode==9){globalActiveDHTMLGridObject.entBox.focus();globalActiveDHTMLGridObject.doKey({keyCode:A.keyCode,shiftKey:A.shiftKey,srcElement:"0"});return false}};this.obj.style.left=B[0]+"px";this.obj.style.top=B[1]+this.cell.offsetHeight+"px";if(this.cell.offsetWidth<200)var C=200;else C=this.cell.offsetWidth;this.obj.style.width=C+(_isFF?18:16)+"px";if(_isFF){this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px";this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px"}if(_isIE){this.obj.select();this.obj.value=this.obj.value}if(_isFF)this.obj.firstChild.focus();else this.obj.focus()};this.detach=function(){var A="";if(_isFF)A=this.obj.firstChild.value;else A=this.obj.value;if(A=="")this.cell._clearCell=true;else this.cell._clearCell=false;this.setValue(A);document.body.removeChild(this.obj);this.obj=null;return this.val!=this.getValue()};this.getValue=function(){if(this.obj)if(_isFF)return this.obj.firstChild.value;else return this.obj.value;if(this.cell._clearCell)return"";if((!this.grid.multiLine))return this.cell._brval||this.cell.innerHTML;else return this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim()}}eXcell_txt.prototype=new eXcell;function eXcell_txttxt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA"))return this.cell.firstChild.value;if(this.cell._clearCell)return"";if((!this.grid.multiLine)&&this.cell._brval)return this.cell._brval;return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(A){this.cell._brval=A;if(!A||A.toString()._dhx_trim()==""){A=" ";this.cell._clearCell=true}else this.cell._clearCell=false;this.setCTxtValue(A)}}eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){A="&nbsp;";this.cell._clearCell=true}else this.cell._clearCell=false;this.cell._brval=A;if((!this.grid.multiLine))this.setCValue(A,A);else this.setCValue(A.replace(/\n/g,"<br/>"),A)};function eXcell_co(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.combo=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));this.editable=true}this.shiftNext=function(){var A=this.list.options[this.list.selectedIndex+1];if(A)A.selected=true;this.obj.value=this.list.options[this.list.selectedIndex].text;return true};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var A=this.list.options[this.list.selectedIndex-1];if(A)A.selected=true;this.obj.value=this.list.options[this.list.selectedIndex].text}return true};this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var E=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(A){(A||event).cancelBubble=true};this.obj.onmousedown=function(A){(A||event).cancelBubble=true};this.obj.value=this.text;this.obj.onselectstart=function(A){if(!A)A=event;A.cancelBubble=true;return true};var D=this;this.obj.onkeyup=function(B){var E=(B||event).keyCode;if(E==38||E==40||E==9)return;var A=this.readonly?String.fromCharCode(E):this.value,C=D.list.options;for(var F=0;F<C.length;F++)if(C[F].text.indexOf(A)==0)return C[F].selected=true};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=E[0]+"px";this.list.style.top=E[1]+this.cell.offsetHeight+"px";this.list.onclick=function(B){var A=B||window.event,C=A.target||A.srcElement;if(C.tagName=="OPTION")C=C.parentNode;D.editable=false;D.grid.editStop();A.cancelBubble=true};var C=this.combo.getKeys(),B=false,F=0;for(var G=0;G<C.length;G++){var A=this.combo.get(C[G]);this.list.options[this.list.options.length]=new Option(A,C[G]);if(C[G]==this.val){F=this.list.options.length-1;B=true}}if(B==false){this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val);F=this.list.options.length-1}document.body.appendChild(this.list);this.list.size="6";this.cstate=1;if(this.editable)this.cell.innerHTML="";else{this.obj.style.width="1px";this.obj.style.height="1px"}this.cell.appendChild(this.obj);this.list.options[F].selected=true;if((!_isFF)||(this.editable)){this.obj.focus();this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden";this.list.focus();this.list.onkeydown=function(A){A=A||window.event;D.grid.setActive(true);if(A.keyCode<30)return D.grid.doKey({target:D.cell,keyCode:A.keyCode,shiftKey:A.shiftKey,ctrlKey:A.ctrlKey})}}};this.getValue=function(){return((this.cell.combo_value==window.undefined)?"":this.cell.combo_value)};this.detach=function(){if(this.val!=this.getValue())this.cell.wasChanged=true;if(this.list.parentNode!=null)if(this.editable){var B=this.list.options[this.list.selectedIndex];if(B&&B.text==this.obj.value)this.setValue(this.list.value);else{var C=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)),A=C.values._dhx_find(this.obj.value);if(A!=-1)this.setValue(C.keys[A]);else this.setCValue(this.cell.combo_value=this.obj.value)}}else this.setValue(this.list.value);if(this.list.parentNode)this.list.parentNode.removeChild(this.list);if(this.obj.parentNode)this.obj.parentNode.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};eXcell_co.prototype.setValue=function(A){if(typeof(A)=="object"){var C=this.grid.xmlLoader.doXPath("./option",A);if(C.length)this.cell._combo=new dhtmlXGridComboObject();for(var D=0;D<C.length;D++)this.cell._combo.put(C[D].getAttribute("value"),C[D].firstChild?C[D].firstChild.data:"");A=A.firstChild.data}if((A||"").toString()._dhx_trim()=="")A=null;this.cell.combo_value=A;if(A!==null){var B=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(A);this.setCValue(B===null?A:B,A)}else this.setCValue("&nbsp;",A)};function eXcell_coro(A){this.base=eXcell_co;this.base(A);this.editable=false}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(A){this.base=eXcell_co;this.base(A)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};eXcell_cotxt.prototype.setValue=function(A){if(typeof(A)=="object"){var B=this.grid.xmlLoader.doXPath("./option",A);if(B.length)this.cell._combo=new dhtmlXGridComboObject();for(var C=0;C<B.length;C++)this.cell._combo.put(B[C].getAttribute("value"),B[C].firstChild?B[C].firstChild.data:"");A=A.firstChild.data}if((A||"").toString()._dhx_trim()=="")A=null;if(A!==null)this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(A)||A,A);else this.setCTxtValue(" ",A);this.cell.combo_value=A};function eXcell_corotxt(A){this.base=eXcell_co;this.base(A);this.editable=false}eXcell_corotxt.prototype=new eXcell_cotxt;function eXcell_cp(A){try{this.cell=A;this.grid=this.cell.parentNode.grid}catch(C){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var A=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=A[0]+"px";this.obj.style.zIndex=1000;this.obj.style.top=A[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(A){if(A.length==1)A="0"+A;return A};this.colorPanel=function(C,I){var A=document.createElement("TABLE");I.appendChild(A);A.cellSpacing=0;A.editor_obj=this;A.style.cursor="default";A.onclick=function(B){var A=B||window.event,C=A.target||A.srcElement,D=C.parentNode.parentNode.parentNode.editor_obj;D.setValue(C._bg);D.grid.editStop()};var D=256/C;for(var K=0;K<=(256/D);K++){var F=A.insertRow(K);for(var L=0;L<=(256/D);L++)for(var H=0;H<=(256/D);H++){R=new Number(D*K)-(K==0?0:1);G=new Number(D*L)-(L==0?0:1);B=new Number(D*H)-(H==0?0:1);var J=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16)),E=F.insertCell(L);E.width="10px";E.innerHTML="&nbsp;";E.title=J.toUpperCase();E.style.backgroundColor="#"+J;E._bg="#"+J;if(this.val!=null&&"#"+J.toUpperCase()==this.val.toUpperCase())E.style.border="2px solid white"}}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){if(this.obj.offsetParent!=null)document.body.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(A){this.setCValue("<div style='width:100%;height:"+((this.grid.multiLine?this.cell.offsetHeight-2:16))+";background-color:"+(A||"")+";border:0px;'>&nbsp;</div>",A);this.cell.firstChild._bg=A};function eXcell_img(A){try{this.cell=A;this.grid=this.cell.parentNode.grid}catch(B){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG")return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");else if(this.cell.firstChild.tagName=="A"){var A=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");A+="^"+this.cell.lnk;if(this.cell.trg)A+="^"+this.cell.trg;return A}};this.isDisabled=function(){return true}}eXcell_img.prototype=new eXcell;eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(A){var B=A;if(A.indexOf("^")!=-1){var C=A.split("^");A=C[0];B=this.cell._attrs.title||C[1];if(C.length>2){this.cell.lnk=C[2];if(C[3])this.cell.trg=C[3]}this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(A||"")._dhx_trim()+"' border='0'>",A);if(this.cell.lnk)this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>";this.cell._brval=B};function eXcell_price(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){if(this.cell.childNodes.length>1)return this.cell.childNodes[1].innerHTML.toString()._dhx_trim();else return"0"}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(A){if(isNaN(parseFloat(A)))A=this.val||0;var B="green";if(A<0)B="red";this.setCValue("<span>$</span><span style='padding-right:2px;color:"+B+";'>"+A+"</span>",A)};function eXcell_dyn(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;eXcell_dyn.prototype.setValue=function(A){if(!A||isNaN(Number(A)))if(A!=="")A=0;if(A>0)var B="green",C="dyn_up.gif";else if(A==0)B="black",C="dyn_.gif";else B="red",C="dyn_down.gif";this.setCValue("<div style='position:relative;padding-right:2px;width:100%;overflow:hidden;white-space:nowrap;'><img src='"+this.grid.imgURL+""+C+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px;width:100%;color:"+B+";'>"+A+"</span></div>",A)};function eXcell_ro(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;function eXcell_ron(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}}eXcell_ron.prototype=new eXcell;eXcell_ron.prototype.setValue=function(A){if(A===0);else if(!A||A.toString()._dhx_trim()==""){this.setCValue("&nbsp;");return this.cell._clearCell=true}this.cell._clearCell=false;this.setCValue(A?this.grid._aplNF(A,this.cell._cellIndex):"0")};function eXcell_rotxt(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.setValue=function(A){if(!A){A=" ";this.cell._clearCell=true}else this.cell._clearCell=false;this.setCTxtValue(A)};this.getValue=function(){if(this.cell._clearCell)return"";return(_isIE?this.cell.innerText:this.cell.textContent)}}eXcell_rotxt.prototype=new eXcell;function dhtmlXGridComboObject(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();this.put=function(B,A){for(var C=0;C<this.keys.length;C++)if(this.keys[C]==B){this.values[C]=A;return true}this.values[this.values.length]=A;this.keys[this.keys.length]=B};this.get=function(A){for(var B=0;B<this.keys.length;B++)if(this.keys[B]==A)return this.values[B];return null};this.clear=function(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray()};this.remove=function(A){for(var B=0;B<this.keys.length;B++)if(this.keys[B]==A){this.keys._dhx_removeAt(B);this.values._dhx_removeAt(B);return true}};this.size=function(){var A=0;for(var B=0;B<this.keys.length;B++)if(this.keys[B]!=null)A++;return A};this.getKeys=function(){var A=new Array(0);for(var B=0;B<this.keys.length;B++)if(this.keys[B]!=null)A[A.length]=this.keys[B];return A};this.save=function(){this._save=new Array();for(var A=0;A<this.keys.length;A++)this._save[A]=[this.keys[A],this.values[A]]};this.restore=function(){if(this._save){this.keys[A]=new Array();this.values[A]=new Array();for(var A=0;A<this._save.length;A++){this.keys[A]=this._save[A][0];this.values[A]=this._save[A][1]}}};return this}function Hashtable(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();return this}Hashtable.prototype=new dhtmlXGridComboObject;dhtmlXGridObject.prototype._process_json_row=function(A,C){A._attrs=C;for(var D=0;D<A.childNodes.length;D++)A.childNodes[D]._attrs={};if(C.userdata)for(var B in C.userdata)this.setUserData(A.idd,B,C.userdata[B]);C=this._c_order?this._swapColumns(C.data):C.data;for(var E=0;E<C.length;E++)if(typeof C[E]=="object"&&C[E]!=null){A.childNodes[E]._attrs=C[E];if(C[E].type)A.childNodes[E]._cellType=C[E].type;C[E]=C[E].value}this._fillRow(A,C);return A};dhtmlXGridObject.prototype._process_js_row=function(B,D){B._attrs=D;for(var E=0;E<B.childNodes.length;E++)B.childNodes[E]._attrs={};if(D.userdata)for(var C in D.userdata)this.setUserData(B.idd,C,D.userdata[C]);var A=[];for(var F=0;F<this.columnIds.length;F++){A[F]=D[this.columnIds[F]];if(typeof A[F]=="object"&&A[F]!=null){B.childNodes[F]._attrs=A[F];if(A[F].type)B.childNodes[F]._cellType=A[F].type;A[F]=A[F].value}if(!A[F]&&A[F]!==0)A[F]=""}this._fillRow(B,A);return B};dhtmlXGridObject.prototype.updateFromJSON=function(C,A,D,B){if(typeof A=="undefined")A=true;this._refresh_mode=[true,A,D];this.load(C,B,"json")},dhtmlXGridObject.prototype._refreshFromJSON=function(C){if(this._f_rowsBuffer)this.filterBy(0,"");reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(A){var B=this.grid._h2.get[this.cell.parentNode.idd];if(B&&this.cell.parentNode.valTag)this.setLabel(A);else this.setValueX(A)}}var B=this.cellType._dhx_find("tree"),F=C.parent||0,E={};if(this._refresh_mode[2])if(B!=-1)this._h2.forEachChild(F,function(A){E[A.id]=true},this);else this.forEachRow(function(A){E[A]=true});var J=C.rows;for(var I=0;I<J.length;I++){var H=J[I],A=H.id;E[A]=false;if(this.rowsAr[A]&&this.rowsAr[A].tagName!="TR"){if(this._h2)this._h2.get[A].buff.data=H;else this.rowsBuffer[this.getRowIndex(A)].data=H;this.rowsAr[A]=H}else if(this.rowsAr[A]){this._process_json_row(this.rowsAr[A],H,-1);this._postRowProcessing(this.rowsAr[A],true)}else if(this._refresh_mode[1]){var D={idd:A,data:H,_parser:this._process_json_row,_locator:this._get_json_data},G=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(D);G=0}else this.rowsBuffer.push(D);if(this._h2){reset=true;(this._h2.add(A,F)).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[A]=H;H=this.render_row(G);this._insertRowAt(H,G?-1:0)}}if(this._refresh_mode[2])for(A in E)if(E[A]&&this.rowsAr[A])this.deleteRow(A);this._refresh_mode=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX;if(reset)this._renderSort();if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},dhtmlXGridObject.prototype._process_js=function(A){return this._process_json(A,"js")},dhtmlXGridObject.prototype._process_json=function(data,mode){this._parsing=true;try{if(data&&data.xmlDoc){eval("dhtmlx.temp="+data.xmlDoc.responseText+";");data=dhtmlx.temp}else if(typeof data=="string"){eval("dhtmlx.temp="+data+";");data=dhtmlx.temp}}catch(e){dhtmlxError.throwError("LoadXML","Incorrect JSON",[(data.xmlDoc||data),this]);data={rows:[]}}if(this._refresh_mode)return this._refreshFromJSON(data);var cr=parseInt(data.pos||0),total=parseInt(data.total_count||0),reset=false;if(total){if(!this.rowsBuffer[total-1]){if(this.rowsBuffer.length)reset=true;this.rowsBuffer[total-1]=null}if(total<this.rowsBuffer.length){this.rowsBuffer.splice(total,this.rowsBuffer.length-total);reset=true}}for(var key in data)if(key!="rows")this.setUserData("",key,data[key]);if(mode=="js"&&data.collections)for(var colkey in data.collections){var index=this.getColIndexById(colkey),colrecs=data.collections[colkey];if(index!==window.undefined)if(this.cellType[index]=="clist"){colplaindata=[];for(var j=0;j<colrecs.length;j++)colplaindata.push(colrecs[j].label);this.registerCList(index,colplaindata)}else{var combo=this.getCombo(index);for(j=0;j<colrecs.length;j++)combo.put(colrecs[j].value,colrecs[j].label)}}if(this.isTreeGrid())return this._process_tree_json(data,null,null,mode);if(mode=="js"){if(data.data)data=data.data;for(var i=0;i<data.length;i++){if(this.rowsBuffer[i+cr])continue;var row=data[i],id=row.id||(i+1);this.rowsBuffer[i+cr]={idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data};this.rowsAr[id]=data[i]}}else for(i=0;i<data.rows.length;i++){if(this.rowsBuffer[i+cr])continue;id=data.rows[i].id;this.rowsBuffer[i+cr]={idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data};this.rowsAr[id]=data.rows[i]}if(reset&&this._srnd){var h=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=h}else this.render_dataset();this._parsing=false};dhtmlXGridObject.prototype._get_json_data=function(B,A){if(typeof B.data[A]=="object")return B.data[A].value;else return B.data[A]};dhtmlXGridObject.prototype._process_tree_json=function(B,H,C,G){this._parsing=true;var F=false;if(!H){this.render_row=this.render_row_tree;F=true;H=B;C=H.parent||0;if(C=="0")C=0;if(!this._h2)this._h2=new dhtmlxHierarchy();if(this._fake)this._fake._h2=this._h2}if(G=="js"){if(H.data&&!C)B=H.data;if(H.rows)H=H.rows;for(var E=0;E<H.length;E++){var A=H[E].id,D=this._h2.add(A,C);D.buff={idd:A,data:H[E],_parser:this._process_js_row,_locator:this._get_js_data};if(H[E].open)D.state="minus";this.rowsAr[A]=D.buff;this._process_tree_json(H[E],H[E],A,G)}}else if(H.rows)for(E=0;E<H.rows.length;E++){A=H.rows[E].id,D=this._h2.add(A,C);D.buff={idd:A,data:H.rows[E],_parser:this._process_json_row,_locator:this._get_json_data};if(H.rows[E].open)D.state="minus";this.rowsAr[A]=D.buff;this._process_tree_json(H.rows[E],H.rows[E],A,G)}if(F){if(C!=0)this._h2.change(C,"state","minus");this._updateTGRState(this._h2.get[C]);this._h2_to_buff();if(C!=0&&(this._srnd||this.pagingOn))this._renderSort();else this.render_dataset();if(this._slowParse===false)this.forEachRow(function(A){this.render_row_tree(0,A)});this._parsing=false}};dhtmlXGridObject.prototype.filterBy=function(C,B,E){if(this.isTreeGrid())return this.filterTreeBy(C,B,E);if(this._f_rowsBuffer){if(!E){this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer));if(this._fake)this._fake.rowsBuffer=this.rowsBuffer}}else this._f_rowsBuffer=[].concat(this.rowsBuffer);if(!this.rowsBuffer.length)return;var A=true;this.dma(true);if(typeof(C)=="object"){for(var D=0;D<B.length;D++)this._filterA(C[D],B[D])}else this._filterA(C,B);this.dma(false);if(this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<(this.currentPage-1))this.changePage(0);this._reset_view();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._filterA=function(C,B){if(B=="")return;var A=true;if(typeof(B)=="function")A=false;else B=(B||"").toString().toLowerCase();if(!this.rowsBuffer.length)return;for(var D=this.rowsBuffer.length-1;D>=0;D--)if(A?(this._get_cell_value(this.rowsBuffer[D],C).toString().toLowerCase().indexOf(B)==-1):(!B.call(this,this._get_cell_value(this.rowsBuffer[D],C),this.rowsBuffer[D].idd)))this.rowsBuffer.splice(D,1)};dhtmlXGridObject.prototype.getFilterElement=function(A){if(!this.filters)return;for(var B=0;B<this.filters.length;B++)if(this.filters[B][1]==A)return(this.filters[B][0].combo||this.filters[B][0]);return null};dhtmlXGridObject.prototype.collectValues=function(G){var F=this.callEvent("onCollectValues",[G]);if(F!==true)return F;if(this.isTreeGrid())return this.collectTreeValues(G);this.dma(true);this._build_m_order();G=this._m_order?this._m_order[G]:G;var E={},B=[],D=this._f_rowsBuffer||this.rowsBuffer;for(var I=0;I<D.length;I++){var A=this._get_cell_value(D[I],G);if(A&&(!D[I]._childIndexes||D[I]._childIndexes[G]!=D[I]._childIndexes[G-1]))E[A]=true}this.dma(false);var H=(this.combos[G]||(this._col_combos?this._col_combos[G]:false));for(var C in E)if(E[C]===true){if(H)if(H.get&&H.get(C))C=H.get(C);else if(H.getOption&&H.getOption(C))C=H.getOption(C).text;B.push(C)}return B.sort()};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var A=0;A<this._c_order.length;A++)this._m_order[this._c_order[A]]=A}};dhtmlXGridObject.prototype.filterByAll=function(){var D=[],B=[];this._build_m_order();for(var F=0;F<this.filters.length;F++){if(C>=this._cCount)continue;var C=this._m_order?this._m_order[this.filters[F][1]]:this.filters[F][1];B.push(C);var A=this.filters[F][0]._filter?this.filters[F][0]._filter():this.filters[F][0].value,E;if(typeof A!="function"&&(E=(this.combos[C]||(this._col_combos?this._col_combos[C]:false))))if(E.values){C=E.values._dhx_find(A);A=(C==-1)?A:E.keys[C]}else if(E.getOptionByLabel)A=(E.getOptionByLabel(A)?E.getOptionByLabel(A).value:A);D.push(A)}if(!this.callEvent("onFilterStart",[B,D]))return;this.filterBy(B,D);if(this._cssEven)this._fixAlterCss();this.callEvent("onFilterEnd",[this.filters]);if(this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length)this._f_rowsBuffer=null};dhtmlXGridObject.prototype.makeFilter=function(A,B,E){if(!this.filters)this.filters=[];if(typeof(A)!="object")A=document.getElementById(A);if(!A)return;var C=this;if(!A.style.width)A.style.width="90%";if(A.tagName=="SELECT"){this.filters.push([A,B]);this._loadSelectOptins(A,B);A.onchange=function(){C.filterByAll()};if(_isIE)A.style.marginTop="1px";this.attachEvent("onEditCell",function(E,D,C){this._build_m_order();if(E==2&&this.filters&&(this._m_order?(C==this._m_order[B]):(C==B)))this._loadSelectOptins(A,B);return true})}else if(A.tagName=="INPUT"){this.filters.push([A,B]);A.old_value=A.value="";A.onkeydown=function(){if(this._timer)window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(A.value!=A.old_value){C.filterByAll();A.old_value=A.value}},500)}}else if(A.tagName=="DIV"&&A.className=="combo"){this.filters.push([A,B]);A.style.padding="0px";A.style.margin="0px";if(!window.dhx_globalImgPath)window.dhx_globalImgPath=this.imgURL;var D=new dhtmlXCombo(A,"_filter","90%");D.filterSelfA=D.filterSelf;D.filterSelf=function(){if(this.getSelectedIndex()==0)this.setComboText("");this.filterSelfA.apply(this,arguments);this.optionsArr[0].hide(false)};D.enableFilteringMode(true);A.combo=D;A.value="";this._loadComboOptins(A,B);D.attachEvent("onChange",function(){A.value=D.getSelectedValue();if(A.value===null)A.value="";C.filterByAll()})}if(A.parentNode)A.parentNode.className+=" filter";this._filters_ready()};dhtmlXGridObject.prototype.findCell=function(E,B,C,D){var D=D||(function(B,A){return A.toString().toLowerCase().indexOf(B)!=-1});if(D===true)D=function(B,A){return A.toString().toLowerCase()==B};var A=new Array();E=E.toString().toLowerCase();if(typeof C!="number")C=C?1:0;if(!this.rowsBuffer.length)return A;for(var G=(B||0);G<this._cCount;G++){if(this._h2)this._h2.forEachChild(0,function(B){if(C&&A.length==C)return A;if(D(E,this._get_cell_value(B.buff,G)))A.push([B.id,G])},this);else for(var F=0;F<this.rowsBuffer.length;F++)if(D(E,this._get_cell_value(this.rowsBuffer[F],G))){A.push([this.rowsBuffer[F].idd,G]);if(C&&A.length==C)return A}if(typeof(B)!="undefined")return A}return A};dhtmlXGridObject.prototype.makeSearch=function(A,B,D){if(typeof(A)!="object")A=document.getElementById(A);if(!A)return;var C=this;if(A.tagName=="INPUT")A.onkeypress=function(){if(this._timer)window.clearTimeout(this._timer);this._timer=window.setTimeout(function(){if(A.value=="")return;var E=C.findCell(A.value,B,true,D);if(E.length){if(C._h2)C.openItem(E[0][0]);C.selectCell(C.getRowIndex(E[0][0]),(B||0))}},500)};if(A.parentNode)A.parentNode.className+=" filter"};dhtmlXGridObject.prototype._loadSelectOptins=function(C,D){var E=this.collectValues(D),B=C.value;C.innerHTML="";C.options[0]=new Option("","");var A=this._filter_tr?this._filter_tr[D]:null;for(var F=0;F<E.length;F++)C.options[C.options.length]=new Option(A?A(E[F]):E[F],E[F]);C.value=B};dhtmlXGridObject.prototype.setSelectFilterLabel=function(A,B){if(!this._filter_tr)this._filter_tr=[];this._filter_tr[A]=B};dhtmlXGridObject.prototype._loadComboOptins=function(B,C){if(!B.combo)return;var D=this.collectValues(C);B.combo.clearAll();B.combo.render(false);var A=[["","&nbsp;"]];for(var E=0;E<D.length;E++)A.push([D[E],D[E]]);B.combo.addOption(A);B.combo.render(true)};dhtmlXGridObject.prototype.refreshFilters=function(){if(!this.filters)return;for(var A=0;A<this.filters.length;A++)switch(this.filters[A][0].tagName.toLowerCase()){case"input":break;case"select":this._loadSelectOptins.apply(this,this.filters[A]);break;case"div":this._loadComboOptins.apply(this,this.filters[A]);break}};dhtmlXGridObject.prototype._filters_ready=function(A,B){this.attachEvent("onXLE",this.refreshFilters);this.attachEvent("onRowCreated",function(A,B){if(this._f_rowsBuffer)for(var C=0;C<this._f_rowsBuffer.length;C++)if(this._f_rowsBuffer[C].idd==A)return this._f_rowsBuffer[C]=B});this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null;if(!this.hdr.rows.length)this.filters=[]});if(window.dhtmlXCombo)this.attachEvent("onScroll",dhtmlXCombo.prototype.closeAll);this._filters_ready=function(){}};dhtmlXGridObject.prototype._in_header_text_filter=function(A,B){A.innerHTML="<input type='text'>";A.onclick=A.onmousedown=function(A){(A||event).cancelBubble=true;return true};A.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(A.firstChild,B)};dhtmlXGridObject.prototype._in_header_text_filter_inc=function(A,B){A.innerHTML="<input type='text'>";A.onclick=A.onmousedown=function(A){(A||event).cancelBubble=true;return true};A.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(A.firstChild,B);A.firstChild._filter=function(){if(A.firstChild.value=="")return"";return function(B){return(B.toString().toLowerCase().indexOf(A.firstChild.value.toLowerCase())==0)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_select_filter=function(A,B){A.innerHTML="<select></select>";A.onclick=function(A){(A||event).cancelBubble=true;return false};this.makeFilter(A.firstChild,B)};dhtmlXGridObject.prototype._in_header_select_filter_strict=function(A,C){A.innerHTML="<select style='width:90%;font-size:8pt;font-family:Tahoma;'></select>";A.onclick=function(A){(A||event).cancelBubble=true;return false};this.makeFilter(A.firstChild,C);var B=this.combos;A.firstChild._filter=function(){var D=A.firstChild.value;if(!D)return"";if(B[C])D=B[C].keys[B[C].values._dhx_find(D)];D=D.toLowerCase();return function(A){return(A.toString().toLowerCase()==D)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_combo_filter=function(A,B){A.innerHTML="<div style='width:100%;padding-left:2px;overflow:hidden;' class='combo'></div>";A.onselectstart=function(){return(event.cancelBubble=true)};A.onclick=A.onmousedown=function(A){(A||event).cancelBubble=true;return true};this.makeFilter(A.firstChild,B)};dhtmlXGridObject.prototype._search_common=function(A,B){A.innerHTML="<input type='text' style='width:90%;'>";A.onclick=A.onmousedown=function(A){(A||event).cancelBubble=true;return true};A.onselectstart=function(){return(event.cancelBubble=true)}};dhtmlXGridObject.prototype._in_header_text_search=function(A,C,B){this._search_common(A,C);this.makeSearch(A.firstChild,C)};dhtmlXGridObject.prototype._in_header_text_search_strict=function(A,B){this._search_common(A,B);this.makeSearch(A.firstChild,B,true)};dhtmlXGridObject.prototype._in_header_numeric_filter=function(A,B){this._in_header_text_filter.call(this,A,B);A.firstChild._filter=function(){var A=this.value,D,C="==",B=parseFloat(A.replace("=","")),E=null;if(A){if(A.indexOf("..")!=-1){A=A.split("..");B=parseFloat(A[0]);E=parseFloat(A[1]);return function(A){if(A>=B&&A<=E)return true;return false}}D=A.match(/>=|<=|>|</);if(D){C=D[0];B=parseFloat(A.replace(C,""))}return Function("v"," if (v "+C+" "+B+" )return true;return false;")}return""}};dhtmlXGridObject.prototype._in_header_master_checkbox=function(A,D,B){A.innerHTML=B[0]+"<input type='checkbox' />"+B[1];var C=this;A.getElementsByTagName("input")[0].onclick=function(B){C._build_m_order();var E=C._m_order?C._m_order[D]:D,A=this.checked?1:0;C.forEachRowA(function(B){var C=this.cells(B,E);if(C.isCheckbox()){C.setValue(A);C.cell.wasChanged=true}this.callEvent("onEditCell",[1,B,E,A]);this.callEvent("onCheckbox",[B,E,A])});(B||event).cancelBubble=true}};dhtmlXGridObject.prototype._in_header_stat_total=function(A,D,B){var C=function(){var E=0;this._build_m_order();var B=this._m_order?this._m_order[D]:D;for(var C=0;C<this.rowsBuffer.length;C++){var A=parseFloat(this._get_cell_value(this.rowsBuffer[C],B));E+=isNaN(A)?0:A}return this._maskArr[B]?this._aplNF(E,B):(Math.round(E*100)/100)};this._stat_in_header(A,C,D,B,B)};dhtmlXGridObject.prototype._in_header_stat_multi_total=function(B,G,C){var A=C[1].split(":");C[1]="";for(var F=0;F<A.length;F++)A[F]=parseInt(A[F]);var E=function(){var E=0;for(var C=0;C<this.rowsBuffer.length;C++){var B=1;for(var D=0;D<A.length;D++)B*=parseFloat(this._get_cell_value(this.rowsBuffer[C],A[D]));E+=isNaN(B)?0:B}return this._maskArr[G]?this._aplNF(E,G):(Math.round(E*100)/100)},D=[];for(var G=0;G<A.length;G++)D[A[G]]=true;this._stat_in_header(B,E,D,C,C)};dhtmlXGridObject.prototype._in_header_stat_max=function(A,D,B){var C=function(){var B=-999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var A=0;A<this.rowsBuffer.length;A++)B=Math.max(B,parseFloat(this._get_cell_value(this.rowsBuffer[A],D)));return this._maskArr[D]?this._aplNF(B,D):B};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_min=function(A,D,B){var C=function(){var B=999999999;if(this.getRowsNum()==0)return"&nbsp;";for(var A=0;A<this.rowsBuffer.length;A++)B=Math.min(B,parseFloat(this._get_cell_value(this.rowsBuffer[A],D)));return this._maskArr[D]?this._aplNF(B,D):B};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_average=function(A,D,B){var C=function(){var E=0,B=0;if(this.getRowsNum()==0)return"&nbsp;";for(var C=0;C<this.rowsBuffer.length;C++){var A=parseFloat(this._get_cell_value(this.rowsBuffer[C],D));E+=isNaN(A)?0:A;B++}return this._maskArr[D]?this._aplNF(E/B,D):(Math.round(E/B*100)/100)};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_count=function(A,D,B){var C=function(){return this.getRowsNum()};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._stat_in_header=function(C,E,F,D){var B=this,A=function(){this.dma(true);C.innerHTML=(D[0]?D[0]:"")+E.call(this)+(D[1]?D[1]:"");this.dma(false);this.callEvent("onStatReady",[])};if(!this._stat_events){this._stat_events=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var B=0;B<this._stat_events.length;B++)for(var A=0;A<4;A++)this.detachEvent(this._stat_events[B][A]);this._stat_events=[]}})}this._stat_events.push([this.attachEvent("onGridReconstructed",A),this.attachEvent("onXLE",A),this.attachEvent("onFilterEnd",A),this.attachEvent("onEditCell",function(D,B,C){if(D==2&&(C==F||(F&&F[C])))A.call(this);return true})]);C.innerHTML=""};dhtmlXGridObject.prototype.unGroup=function(){if(!this._groups)return;this._dndProblematic=false;delete this._groups;delete this._gIndex;if(this._fake)this._mirror_rowsCol();this.forEachRow(function(A){this.rowsAr[A].style.display=""});this._reset_view();this.callEvent("onGridReconstructed",[]);this.callEvent("onUnGroup",[])};dhtmlXGridObject.prototype._mirror_rowsCol=function(){this._fake._groups=this._groups;this._fake._gIndex=this._gIndex;this.rowsBuffer=dhtmlxArray();for(var A=0;A<this.rowsCol.length;A++)if(!this.rowsCol[A]._cntr)this.rowsBuffer.push(this.rowsCol[A]);this._fake.rowsBuffer=dhtmlxArray();for(A=0;A<this._fake.rowsCol.length;A++)if(!this._fake.rowsCol[A]._cntr)this._fake.rowsBuffer.push(this._fake.rowsCol[A])};dhtmlXGridObject.prototype.groupBy=function(A,D){if(this._groups)this.unGroup();this._dndProblematic=true;this._groups={};if(!D){D=["#title"];for(var F=1;F<this._cCount;F++)D.push("#cspan")}this._gmask=document.createElement("TR");this._gmask.origin=D;var E,B=0;for(F=0;F<D.length;F++)if(D[F]=="#cspan")E.colSpan=(parseInt(E.colSpan)||1)+1;else{E=document.createElement("TD");E._cellIndex=F;if(this._hrrar[F])E.style.display="none";E.className="group_row";E.innerHTML="&nbsp;";if(D[F]=="#title")this._gmask._title=B;else E.align=this.cellAlign[F]||"left";this._gmask.appendChild(E);if(D[F].indexOf("#stat")==0){this._gmask._math=true;E._counter=[this["_g_"+D[F].replace("#","")],F,B]}B++}for(var C in this._groups)this._groups[C]=this.undefined;this._gIndex=A;if(this._fake&&!this._realfake){this._fake._groups=[];this._fake._gIndex=this._gIndex}this._nextRow=function(C,B){var A=this.rowsCol[C+B];if(A&&(A.style.display=="none"||A._cntr))return this._nextRow(C+B,B);return A};if(!this.__sortRowsBG){this._key_events=dhtmlXHeir({},this._key_events);this._key_events.k38_0_0=function(){if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{var A=this.row.rowIndex;if(!A)return;var B=this._nextRow(A-1,-1);if(B)this.selectCell(B,this.cell._cellIndex,true)}};this._key_events.k13_1_0=this._key_events.k13_0_1=function(){};this._key_events.k40_0_0=function(){if(this.editor&&this.editor.combo)this.editor.shiftNext();else{var A=this.row.rowIndex;if(!A)return;var B=this._nextRow(A-1,1);if(B)this.selectCell(B,this.cell._cellIndex,true)}};this.attachEvent("onFilterStart",function(){if(this._groups)this._groups=this.undefined;return true});this.attachEvent("onFilterEnd",function(){if(typeof this._gIndex!="undefined")this.groupBy(this._gIndex,this._gmask.origin)});this.sortRows_bg=this.sortRows;this.sortRows=function(B,C,A){if(typeof(this._groups)=="undefined")return this.sortRows_bg.apply(this,arguments);this.callEvent("onBeforeSorting",[B,(C||"str"),(A||"asc")])};this.attachEvent("onBeforeSorting",function(B,C,A){if(typeof(this._groups)=="undefined")return true;if(B==this._gIndex)this._sortByGroup(B,C,A);else this._sortInGroup(B,C,A);this.setSortImgState(true,B,A);if(this._fake){this._mirror_rowsCol();this._fake._groups=[];this._fake._reset_view()}this.setSortImgState(true,B,A);this.callEvent("onAfterSorting",[B,C,A]);return false});this.attachEvent("onClearAll",function(){this.unGroup()});this.attachEvent("onBeforeRowDeleted",function(B){if(!this._groups)return true;if(!this.rowsAr[B])return true;var A=this.cells(B,this._gIndex).getValue();if(A==="")A=" ";var C=this._groups[A];this._dec_group(C);return true});this.attachEvent("onAfterRowDeleted",function(A){this.updateGroups()});this.attachEvent("onCheckbox",function(A,B,C){this.callEvent("onEditCell",[2,A,B,(C?1:0),(C?0:1)])});this.attachEvent("onXLE",this.updateGroups);this.attachEvent("onColumnHidden",this.hideGroupColumn);this.attachEvent("onEditCell",function(J,B,D,A,I){if(!this._groups)return true;if(J==2&&A!=I&&D==this._gIndex){if(I==="")I=" ";this._dec_group(this._groups[I]);var C=this.rowsAr[B],K=this.rowsCol._dhx_find(C),H=this._inc_group(A),F=this.rowsCol[H];if(C==F)F=F.nextSibling;var E=C.parentNode,G=C.rowIndex;E.removeChild(C);if(F)E.insertBefore(C,F);else E.appendChild(C);this.rowsCol._dhx_insertAt(H,C);if(H<K)K++;this.rowsCol._dhx_removeAt(K,C);this._fixAlterCss()}else if(J==2&&A!=I){this.updateGroups();this._updateGroupView(this._groups[this.cells(B,this._gIndex).getValue()||" "])}return true});this.__sortRowsBG=true}this._groupExisting();if(this._hrrar)for(F=0;F<this._hrrar.length;F++)if(this._hrrar[F])this.hideGroupColumn(F,true);this.callEvent("onGroup",[]);if(this._ahgr||this._awdth)this.setSizes()};dhtmlXGridObject.prototype._sortInGroup=function(A,H,C){var B=this._groups_get();B.reverse();for(var I=0;I<B.length;I++){var D=B[I]._cntr._childs,F={};for(var G=0;G<D.length;G++){var E=this.cells3(D[G],A);F[D[G].idd]=E.getDate?E.getDate():E.getValue()}this._sortCore(A,H,C,F,D)}this._groups_put(B);this.setSizes();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._sortByGroup=function(A,E,C){var B=this._groups_get(),D=[];for(var F=0;F<B.length;F++){B[F].idd="_sort_"+F;D["_sort_"+F]=B[F]._cntr.text}this._sortCore(A,E,C,D,B);this._groups_put(B);this.callEvent("onGridReconstructed",[]);this.setSizes()};dhtmlXGridObject.prototype._inc_group=function(A,C,D){if(A==="")A=" ";if(!this._groups[A])this._groups[A]={text:A,row:this._addPseudoRow(),count:0,state:C?"plus":"minus"};var E=this._groups[A];E.row._cntr=E;var B=this.rowsCol._dhx_find(E.row)+E.count+1;E.count++;if(!D){this._updateGroupView(E);this.updateGroups()}return B};dhtmlXGridObject.prototype._dec_group=function(A){if(!A)return;A.count--;if(A.count==0){A.row.parentNode.removeChild(A.row);this.rowsCol._dhx_removeAt(this.rowsCol._dhx_find(A.row));delete this._groups[A.text]}else this._updateGroupView(A);if(this._fake&&!this._realfake)this._fake._dec_group(this._fake._groups[A.text]);this.updateGroups();return true};dhtmlXGridObject.prototype._insertRowAt_gA=dhtmlXGridObject.prototype._insertRowAt;dhtmlXGridObject.prototype._insertRowAt=function(D,C,E){if(typeof(this._groups)!="undefined"){if(this._realfake)var A=this._fake._bfs_cells(D.idd,this._gIndex).getValue();else if(this._bfs_cells3)A=this._bfs_cells3(D,this._gIndex).getValue();else A=this.cells3(D,this._gIndex).getValue();if(!A)A=" ";C=this._inc_group(A,D.style.display=="none")}var B=this._insertRowAt_gA(D,C,E);if(typeof(this._groups)!="undefined"){this.expandGroup(A);this._updateGroupView(this._groups[A]);this.updateGroups()}return B};dhtmlXGridObject.prototype._updateGroupView=function(C){if(this._fake&&!this._realfake)return C.row.firstChild.innerHTML="&nbsp;";var A=this._gmask||this._fake._gmask,B="<img style='margin-bottom:-4px' src='"+this.imgURL+C.state+".gif'> ";if(this.customGroupFormat)B+=this.customGroupFormat(C.text,C.count);else B+=C.text+" ( "+C.count+" ) ";C.row.childNodes[A._title].innerHTML=B};dhtmlXGridObject.prototype._addPseudoRow=function(D){var C=this._gmask||this._fake._gmask,B=C.cloneNode(true);for(var E=0;E<B.childNodes.length;E++){B.childNodes[E]._cellIndex=C.childNodes[E]._cellIndex;if(this._realfake)B.childNodes[E].style.display=""}var A=this;B.onclick=function(B){if(!A.callEvent("onGroupClick",[this._cntr.text]))return;if(A._fake&&A._realfake)A._fake._switchGroupState(A._fake._groups[this._cntr.text].row);else A._switchGroupState(this);(B||event).cancelBubble="true"};B.ondblclick=function(A){(A||event).cancelBubble="true"};if(!D){if(_isKHTML)this.obj.appendChild(B);else this.obj.firstChild.appendChild(B);this.rowsCol.push(B)}return B};dhtmlXGridObject.prototype._groups_get=function(){var A=[];this._temp_par=this.obj.parentNode;this._temp_par.removeChild(this.obj);var B=[];for(var C=this.rowsCol.length-1;C>=0;C--){if(this.rowsCol[C]._cntr){this.rowsCol[C]._cntr._childs=B;B=[];A.push(this.rowsCol[C])}else B.push(this.rowsCol[C]);this.rowsCol[C].parentNode.removeChild(this.rowsCol[C])}return A};dhtmlXGridObject.prototype._groups_put=function(A){var B=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray(0);this.rowsCol.stablesort=B;for(var E=0;E<A.length;E++){var D=A[E]._cntr;this.obj.firstChild.appendChild(D.row);this.rowsCol.push(D.row);D.row.idd=null;for(var C=0;C<D._childs.length;C++){this.obj.firstChild.appendChild(D._childs[C]);this.rowsCol.push(D._childs[C])}delete D._childs}this._temp_par.appendChild(this.obj)};dhtmlXGridObject.prototype._groupExisting=function(B){if(!this.getRowsNum())return;var B=[];this._temp_par=this.obj.parentNode;this._temp_par.removeChild(this.obj);var C=[],D=this.rowsCol.length;for(var F=0;F<D;F++){var A=this.cells4(this.rowsCol[F].childNodes[this._gIndex]).getValue();this.rowsCol[F].style.display="";if(!A)A=" ";if(!this._groups[A]){this._groups[A]={text:A,row:this._addPseudoRow(true),count:0,state:"minus"};var E=this._groups[A];E.row._cntr=E;this._groups[A]._childs=[];B.push(E.row)}this._groups[A].count++;this._groups[A]._childs.push(this.rowsCol[F]);this.rowsCol[F].parentNode.removeChild(this.rowsCol[F])}for(F=0;F<B.length;F++)this._updateGroupView(B[F]._cntr);this._groups_put(B);if(this._fake&&!this._realfake){this._mirror_rowsCol();this._fake._groups=[];this._fake._reset_view()}this.callEvent("onGridReconstructed",[]);this.updateGroups()};dhtmlXGridObject.prototype._switchGroupState=function(D){var C=D._cntr;if(this._fake&&!this._realfake){C.state=this._fake._groups[D._cntr.text].row._cntr.state;this._fake._switchGroupState(this._fake._groups[D._cntr.text].row)}var A=this.rowsCol._dhx_find(C.row)+1;C.state=C.state=="minus"?"plus":"minus";var B=C.state=="plus"?"none":"";while(this.rowsCol[A]&&!this.rowsCol[A]._cntr){this.rowsCol[A].style.display=B;A++}this._updateGroupView(C);this.callEvent("onGroupStateChanged",[C.text,(C.state=="minus")]);this.setSizes()};dhtmlXGridObject.prototype.expandGroup=function(A){if(this._groups[A].state=="plus")this._switchGroupState(this._groups[A].row)};dhtmlXGridObject.prototype.collapseGroup=function(A){if(this._groups[A].state=="minus")this._switchGroupState(this._groups[A].row)};dhtmlXGridObject.prototype.expandAllGroups=function(){for(var A in this._groups)if(this._groups[A]&&this._groups[A].state=="plus")this._switchGroupState(this._groups[A].row)};dhtmlXGridObject.prototype.collapseAllGroups=function(){for(var A in this._groups)if(this._groups[A]&&this._groups[A].state=="minus")this._switchGroupState(this._groups[A].row)};dhtmlXGridObject.prototype.hideGroupColumn=function(A,C){if(this._fake)return;var D=-1,E=this._gmask.childNodes;for(var F=0;F<E.length;F++)if(E[F]._cellIndex==A){D=F;break}if(D==-1)return;for(var B in this._groups)this._groups[B].row.childNodes[D].style.display=C?"none":""};dhtmlXGridObject.prototype.groupStat=function(D,C,A){A=this["_g_"+(A||"stat_total")];var E=0,B=0;this.forEachRowInGroup(D,function(D){E=A(E,this.cells(D,C).getValue()*1,B);B++});return E};dhtmlXGridObject.prototype.forEachRowInGroup=function(A,B){var C=this._groups[A].row.nextSibling;if(C){while(C&&!C._cntr){B.call(this,C.idd);C=C.nextSibling}}else{var E=this._groups[A]._childs;if(E)for(var D=0;D<E.length;D++)B.call(this,E[D].idd)}};dhtmlXGridObject.prototype.updateGroups=function(){if(!this._gmask||!this._gmask._math||this._parsing)return;var A=this._gmask.childNodes;for(var B=0;B<A.length;B++)if(A[B]._counter)this._b_processing.apply(this,A[B]._counter)};dhtmlXGridObject.prototype._b_processing=function(C,B,E){var A=0,D=0;if(!this._ecache[this.cellType[B]])this.cells5({parentNode:{grid:this}},this.cellType[B]);for(var F=this.rowsCol.length-1;F>=0;F--)if(!this.rowsCol[F]._cntr){A=C(A,this.cells3(this.rowsCol[F],B).getValue()*1,D);D++}else{this.cells5(this.rowsCol[F].childNodes[E],this.cellType[B]).setValue(A);D=A=0}};dhtmlXGridObject.prototype._g_stat_total=function(A,B,C){return A+B};dhtmlXGridObject.prototype._g_stat_min=function(A,B,C){if(!C)A=Infinity;return Math.min(A,B)};dhtmlXGridObject.prototype._g_stat_max=function(A,B,C){if(!C)A=-Infinity;return Math.max(A,B)};dhtmlXGridObject.prototype._g_stat_average=function(A,B,C){return(A*C+B)/(C+1)};dhtmlXGridObject.prototype._g_stat_count=function(A,B,C){return A++};dhtmlXGridObject.prototype.enableDragAndDrop=function(A){if(A=="temporary_disabled"){this.dADTempOff=false;A=true}else this.dADTempOff=true;this.dragAndDropOff=convertStringToBoolean(A);this._drag_validate=true;if(A)this.objBox.ondragstart=function(A){(A||event).cancelBubble=true;return false}};dhtmlXGridObject.prototype.setDragBehavior=function(A){this.dadmodec=this.dadmodefix=0;switch(A){case"child":this.dadmode=0;this._sbmod=false;break;case"sibling":this.dadmode=1;this._sbmod=false;break;case"sibling-next":this.dadmode=1;this._sbmod=true;break;case"complex":this.dadmode=2;this._sbmod=false;break;case"complex-next":this.dadmode=2;this._sbmod=true;break}};dhtmlXGridObject.prototype.enableDragOrder=function(A){this._dndorder=convertStringToBoolean(A)};dhtmlXGridObject.prototype._checkParent=function(C,A){var B=this._h2.get[C.idd].parent;if(!B.parent)return;for(var D=0;D<A.length;D++)if(A[D]==B.id)return true;return this._checkParent(this.rowsAr[B.id],A)};dhtmlXGridObject.prototype._createDragNode=function(C,D){this.editStop();if(window.dhtmlDragAndDrop.dragNode)return null;if(!this.dADTempOff)return null;C.parentObject=new Object();C.parentObject.treeNod=this;var B=this.callEvent("onBeforeDrag",[C.parentNode.idd,C._cellIndex]);if(!B)return null;var H=new Array();H=this.getSelectedId();H=(((H)&&(H!=""))?H.split(this.delim):[]);var F=false;for(var I=0;I<H.length;I++)if(H[I]==C.parentNode.idd)F=true;if(!F){this.selectRow(this.rowsAr[C.parentNode.idd],false,D.ctrlKey,false);if(!D.ctrlKey)H=[];H[this.selMultiRows?H.length:0]=C.parentNode.idd}if(this.isTreeGrid())for(I=H.length-1;I>=0;I--)if(this._checkParent(this.rowsAr[H[I]],H))H.splice(I,1);var G=this;if(H.length&&this._dndorder)H.sort(function(B,A){return(G.rowsAr[B].rowIndex>G.rowsAr[A].rowIndex?1:-1)});var E=this.getFirstParentOfType(_isIE?D.srcElement:D.target,"TD");if(E)this._dndExtra=E._cellIndex;this._dragged=new Array();for(I=0;I<H.length;I++)if(this.rowsAr[H[I]]){this._dragged[this._dragged.length]=this.rowsAr[H[I]];this.rowsAr[H[I]].treeNod=this}C.parentObject.parentNode=C.parentNode;var A=document.createElement("div");A.innerHTML=(B!==true?B:this.rowToDragElement(C.parentNode.idd));A.style.position="absolute";A.className="dragSpanDiv";return A};dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV");this._sdrgc.innerHTML="&nbsp;";this._sdrgc.className="gridDragLine";this.objBox.appendChild(this._sdrgc)};function dragContext(F,D,E,B,C,A,H,J,I,G){this.source=F||"grid";this.target=D||"grid";this.mode=E||"move";this.dropmode=B||"child";this.sid=C||0;this.tid=A;this.sobj=H||null;this.tobj=J||null;this.sExtra=I||null;this.tExtra=G||null;return this}dragContext.prototype.valid=function(){if(this.sobj!=this.tobj)return true;if(this.sid==this.tid)return false;if(this.target=="treeGrid"){var A=this.tid;while(A=this.tobj.getParentId(A))if(this.sid==A)return false}return true};dragContext.prototype.close=function(){this.sobj=null;this.tobj=null};dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)};dragContext.prototype.set=function(B,A){this[B]=A;return this};dragContext.prototype.uid=function(B,A){this.nid=this.sid;while(this.tobj.rowsAr[this.nid])this.nid=this.nid+((new Date()).valueOf());return this};dragContext.prototype.data=function(){if(this.sobj==this.tobj)return this.sobj._getRowArray(this.sobj.rowsAr[this.sid]);if(this.source=="tree")return this.tobj.treeToGridElement(this.sobj,this.sid,this.tid);else return this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)};dragContext.prototype.attrs=function(){if(this.source=="tree")return{};else return this.sobj.rowsAr[this.sid]._attrs};dragContext.prototype.childs=function(){if(this.source=="treeGrid")return this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null;return null};dragContext.prototype.pid=function(){if(!this.tid)return 0;if(!this.tobj._h2)return 0;if(this.target=="treeGrid")if(this.dropmode=="child")return this.tid;else{var B=this.tobj.rowsAr[this.tid],A=this.tobj._h2.get[B.idd].parent.id;if((this.alfa)&&(this.tobj._sbmod)&&(B.nextSibling)){var C=this.tobj._h2.get[B.nextSibling.idd].parent.id;if(C==this.tid)return this.tid;if(C!=A)return C}return A}};dragContext.prototype.ind=function(){if(this.tid==window.unknown)return this.tobj.rowsBuffer.length;if(this.target=="treeGrid")if(this.dropmode=="child")this.tobj.openItem(this.tid);else this.tobj.openItem(this.tobj.getParentId(this.tid));var A=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if((this.alfa)&&(this.tobj._sbmod)&&(this.dropmode=="sibling")){var B=this.tobj.rowsAr[this.tid];if((B.nextSibling)&&(this._h2.get[B.nextSibling.idd].parent.id==this.tid))return A+1}return(A+1+((this.target=="treeGrid"&&A>=0&&this.tobj._h2.get[this.tobj.rowsBuffer[A].idd].state=="minus")?this.tobj._getOpenLenght(this.tobj.rowsBuffer[A].idd,0):0))};dragContext.prototype.img=function(){if((this.target!="grid")&&(this.sobj._h2))return this.sobj.getItemImage(this.sid);else return null};dragContext.prototype.slist=function(){var A=new Array();for(var B=0;B<this.sid.length;B++)A[A.length]=this.sid[B][(this.source=="tree")?"id":"idd"];return A.join(",")};dhtmlXGridObject.prototype._drag=function(A,E,B,K){if(this._realfake)return this._fake._drag();var L=(this.lastLanding);if(this._autoOpenTimer)window.clearTimeout(this._autoOpenTimer);var I=B.parentNode,J=A.parentObject;if(!I.idd){I.grid=this;this.dadmodefix=0}var D=new dragContext(0,0,0,((I.grid.dadmode==1||I.grid.dadmodec)?"sibling":"child"));if(J&&J.childNodes)D.set("source","tree").set("sobj",J.treeNod).set("sid",D.sobj._dragged);else{if(!J)return true;if(J.treeNod.isTreeGrid&&J.treeNod.isTreeGrid())D.set("source","treeGrid");D.set("sobj",J.treeNod).set("sid",D.sobj._dragged)}if(I.grid.isTreeGrid())D.set("target","treeGrid");else D.set("dropmode","sibling");D.set("tobj",I.grid).set("tid",I.idd);if(((D.tobj.dadmode==2)&&(D.tobj.dadmodec==1))&&(D.tobj.dadmodefix<0))if(D.tobj.obj.rows[1].idd!=D.tid)D.tid=I.previousSibling.idd;else D.tid=0;var G=this.getFirstParentOfType(K,"TD");if(G)D.set("tExtra",G._cellIndex);if(G)D.set("sExtra",D.sobj._dndExtra);if(D.sobj.dpcpy)D.set("mode","copy");if(D.tobj._realfake)D.tobj=D.tobj._fake;if(D.sobj._realfake)D.sobj=D.sobj._fake;D.tobj._clearMove();if(J&&J.treeNod&&J.treeNod._nonTrivialRow)J.treeNod._nonTrivialRow(this,D.tid,D.dropmode,J);else{D.tobj.dragContext=D;if(!D.tobj.callEvent("onDrag",[D.slist(),D.tid,D.sobj,D.tobj,D.sExtra,D.tExtra]))return D.tobj.dragContext=null;var C=new Array();if(typeof(D.sid)=="object"){var H=D.copy();for(var F=0;F<D.sid.length;F++){if(!H.set("alfa",(!F)).set("sid",D.sid[F][(D.source=="tree"?"id":"idd")]).valid())continue;H.tobj._dragRoutine(H);if(H.target=="treeGrid"&&H.dropmode=="child")H.tobj.openItem(H.tid);C[C.length]=H.nid;H.set("dropmode","sibling").set("tid",H.nid)}H.close()}else D.tobj._dragRoutine(D);if(D.tobj.laterLink)D.tobj.laterLink();D.tobj.callEvent("onDrop",[D.slist(),D.tid,C.join(","),D.sobj,D.tobj,D.sExtra,D.tExtra])}D.tobj.dragContext=null;D.close()};dhtmlXGridObject.prototype._dragRoutine=function(D){if((D.sobj==D.tobj)&&(D.source=="grid")&&(D.mode=="move")&&!this._fake){if(D.sobj._dndProblematic)return;var E=D.sobj.rowsAr[D.sid],I=D.sobj.rowsCol._dhx_find(E);D.sobj.rowsCol._dhx_removeAt(D.sobj.rowsCol._dhx_find(E));D.sobj.rowsBuffer._dhx_removeAt(D.sobj.rowsBuffer._dhx_find(E));D.sobj.rowsBuffer._dhx_insertAt(D.ind(),E);if(D.tobj._fake){D.tobj._fake.rowsCol._dhx_removeAt(I);var C=D.tobj._fake.rowsAr[D.sid];C.parentNode.removeChild(C)}D.sobj._insertRowAt(E,D.ind());D.nid=D.sid;D.sobj.callEvent("onGridReconstructed",[]);return}var G;if(this._h2&&typeof D.tid!="undefined"&&D.dropmode=="sibling"&&(this._sbmod||D.tid)){if(D.alfa&&this._sbmod&&this._h2.get[D.tid].childs.length){this.openItem(D.tid);G=D.uid().tobj.addRowBefore(D.nid,D.data(),this._h2.get[D.tid].childs[0].id,D.img(),D.childs())}else G=D.uid().tobj.addRowAfter(D.nid,D.data(),D.tid,D.img(),D.childs())}else G=D.uid().tobj.addRow(D.nid,D.data(),D.ind(),D.pid(),D.img(),D.childs());G._attrs=D.attrs();if(D.source=="tree"){this.callEvent("onRowAdded",[D.nid]);var A=D.sobj._globalIdStorageFind(D.sid);if(A.childsCount){var B=D.copy().set("tid",D.nid).set("dropmode",D.target=="grid"?"sibling":"child");for(var H=0;H<A.childsCount;H++){D.tobj._dragRoutine(B.set("sid",A.childNodes[H].id));if(D.mode=="move")H--}B.close()}}else{D.tobj._copyUserData(D);this.callEvent("onRowAdded",[D.nid]);if((D.source=="treeGrid")){if(D.sobj==D.tobj)G._xml=D.sobj.rowsAr[D.sid]._xml;var J=D.sobj._h2.get[D.sid];if((J)&&(J.childs.length)){B=D.copy().set("tid",D.nid);if(D.target=="grid")B.set("dropmode","sibling");else{B.tobj.openItem(D.tid);B.set("dropmode","child")}var F=J.childs.length;for(H=0;H<F;H++){D.sobj.render_row_tree(null,J.childs[H].id);D.tobj._dragRoutine(B.set("sid",J.childs[H].id));if(F!=J.childs.length){H--;F=J.childs.length}}B.close()}}}if(D.mode=="move"){D.sobj[(D.source=="tree")?"deleteItem":"deleteRow"](D.sid);if((D.sobj==D.tobj)&&(!D.tobj.rowsAr[D.sid])){D.tobj.changeRowId(D.nid,D.sid);D.nid=D.sid}}};dhtmlXGridObject.prototype.gridToGrid=function(B,A,E){var C=new Array();for(var D=0;D<A.hdr.rows[0].cells.length;D++)C[D]=A.cells(B,D).getValue();return C};dhtmlXGridObject.prototype.checkParentLine=function(B,A){if((!this._h2)||(!A)||(!B))return false;if(B.id==A)return true;else return this.checkParentLine(B.parent,A)};dhtmlXGridObject.prototype._dragIn=function(A,C,F,E){if(!this.dADTempOff)return 0;var B=this.isTreeGrid(),D=C.parentNode.idd?C.parentNode:C.parentObject;if(this._drag_validate){if(A.parentNode==C.parentNode)return 0;if((B)&&(this==D.grid)&&((this.checkParentLine(this._h2.get[A.parentNode.idd],C.parentNode.idd))))return 0}if(!this.callEvent("onDragIn",[D.idd||D.id,A.parentNode.idd,D.grid||D.treeNod,(A.grid||A.parentNode.grid)]))return this._setMove(A,F,E,true);this._setMove(A,F,E);if((B)&&(A.parentNode.expand!="")){this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1000);this._autoOpenId=A.parentNode.idd}else if(this._autoOpenTimer)window.clearTimeout(this._autoOpenTimer);return A};dhtmlXGridObject.prototype._autoOpenItem=function(A,B){B.openItem(B._autoOpenId)};dhtmlXGridObject.prototype._dragOut=function(A){this._clearMove();var B=A.parentNode.parentObject?A.parentObject.id:A.parentNode.idd;this.callEvent("onDragOut",[B]);if(this._autoOpenTimer)window.clearTimeout(this._autoOpenTimer)};dhtmlXGridObject.prototype._setMove=function(A,H,F,D){if(!A.parentNode.idd)return;var B=getAbsoluteTop(A),C=getAbsoluteTop(this.objBox);if((B-C)>(parseInt(this.objBox.offsetHeight)-50))this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20;if((B-C+parseInt(this.objBox.scrollTop))<(parseInt(this.objBox.scrollTop)+30))this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20;if(D)return 0;if(this.dadmode==2){var E=F-B+(document.body.scrollTop||document.documentElement.scrollTop)-2-A.offsetHeight/2;if((Math.abs(E)-A.offsetHeight/6)>0){this.dadmodec=1;if(E<0)this.dadmodefix=-1;else this.dadmodefix=1}else this.dadmodec=0}else this.dadmodec=this.dadmode;if(this.dadmodec){if(!this._sdrgc)this._createSdrgc();this._sdrgc.style.display="block";this._sdrgc.style.top=B-C+parseInt(this.objBox.scrollTop)+((this.dadmodefix>=0)?A.offsetHeight:0)+"px"}else{this._llSelD=A;if(A.parentNode.tagName=="TR")for(var G=0;G<A.parentNode.childNodes.length;G++){E=A.parentNode.childNodes[G];E._bgCol=E.style.backgroundColor;E.style.backgroundColor="#FFCCCC"}}};dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc)this._sdrgc.style.display="none";if((this._llSelD)&&(this._llSelD.parentNode.tagName=="TR")){var A=this._llSelD.parentNode.childNodes;for(var B=0;B<A.length;B++)A[B].style.backgroundColor=A[B]._bgCol}this._llSelD=null};dhtmlXGridObject.prototype.rowToDragElement=function(A){var B=this.cells(A,0).getValue();return B};dhtmlXGridObject.prototype._copyUserData=function(B){if(!B.tobj.UserData[B.nid]||B.tobj!=B.sobj)B.tobj.UserData[B.nid]=new Hashtable();else return;var A=B.sobj.UserData[B.sid],C=B.tobj.UserData[B.nid];if(A){C.keys=C.keys.concat(A.keys);C.values=C.values.concat(A.values)}};dhtmlXGridObject.prototype.moveRow=function(C,D,B,A){switch(D){case"row_sibling":this.moveRowTo(C,B,"move","sibling",this,A);break;case"up":this.moveRowUp(C);break;case"down":this.moveRowDown(C);break}};dhtmlXGridObject.prototype._nonTrivialNode=function(C,A,D,K,G){if((C.callEvent)&&(!G))if(!C.callEvent("onDrag",[K.idd,A.id,(D?D.id:null),this,C]))return false;var H=K.idd,I=H;while(C._idpull[I])I+=(new Date()).getMilliseconds().toString();var E=(this.isTreeGrid()?this.getItemImage(H):"");if(D){for(J=0;J<A.childsCount;J++)if(A.childNodes[J]==D)break;if(J!=0)D=A.childNodes[J-1];else{st="TOP";D=""}}var B=C._attachChildNode(A,I,this.gridToTreeElement(C,I,H),"",E,E,E,"","",D);if(this._h2){var F=this._h2.get[H];if(F.childs.length)for(var J=0;J<F.childs.length;J++){this._nonTrivialNode(C,B,0,this.rowsAr[F.childs[J].id],1);if(!this.dpcpy)J--}}if(!this.dpcpy)this.deleteRow(H);if((C.callEvent)&&(!G))C.callEvent("onDrop",[I,A.id,(D?D.id:null),this,C])};dhtmlXGridObject.prototype.gridToTreeElement=function(A,C,B){return this.cells(B,0).getValue()};dhtmlXGridObject.prototype.treeToGridElement=function(B,E,C){var A=new Array(),D=this.cellType._dhx_find("tree");if(D==-1)D=0;for(var F=0;F<this.getColumnCount();F++)A[A.length]=(F!=D)?(B.getUserData(E,this.getColumnId(F))||""):B.getItemText(E);return A};dhtmlXGridObject.prototype.moveRowTo=function(F,E,G,B,D,A){var C=new dragContext((D||this).isTreeGrid()?"treeGrid":"grid",(A||this).isTreeGrid()?"treeGrid":"grid",G,B||"sibling",F,E,D||this,A||this);C.tobj._dragRoutine(C);C.close();return C.nid};dhtmlXGridObject.prototype.enableMercyDrag=function(A){this.dpcpy=convertStringToBoolean(A)};dhtmlXGridObject.prototype._process_xmlA=function(E){if(!E.doXPath){var D=new dtmlXMLLoaderObject(function(){});if(typeof E=="string")D.loadXMLString(E);else{if(E.responseXML)D.xmlDoc=E;else D.xmlDoc={};D.xmlDoc.responseXML=E}E=D}this._parsing=true;var H=E.getXMLTopNode(this.xml.top);this._parseHead(H);var G=E.doXPath(this.xml.row,H),C=parseInt(E.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),B=parseInt(E.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(B&&!this.rowsBuffer[B-1])this.rowsBuffer[B-1]=null;if(this.isTreeGrid()){this._get_xml_data=this._get_xml_dataA;this._process_xml_row=this._process_xml_rowA;return this._process_tree_xml(E)}for(var F=0;F<G.length;F++){if(this.rowsBuffer[F+C])continue;var A=G[F].getAttribute("id")||this.uid();this.rowsBuffer[F+C]={idd:A,data:G[F],_parser:this._process_xml_rowA,_locator:this._get_xml_dataA};this.rowsAr[A]=G[F]}this.render_dataset();this._parsing=false;return E.xmlDoc.responseXML?E.xmlDoc.responseXML:E.xmlDoc};dhtmlXGridObject.prototype._process_xmlB=function(E){if(!E.doXPath){var D=new dtmlXMLLoaderObject(function(){});if(typeof E=="string")D.loadXMLString(E);else{if(E.responseXML)D.xmlDoc=E;else D.xmlDoc={};D.xmlDoc.responseXML=E}E=D}this._parsing=true;var H=E.getXMLTopNode(this.xml.top);this._parseHead(H);var G=E.doXPath(this.xml.row,H),C=parseInt(E.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),B=parseInt(E.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(B&&!this.rowsBuffer[B-1])this.rowsBuffer[B-1]=null;if(this.isTreeGrid()){this._get_xml_data=this._get_xml_dataB;this._process_xml_row=this._process_xml_rowB;return this._process_tree_xml(E)}for(var F=0;F<G.length;F++){if(this.rowsBuffer[F+C])continue;var A=G[F].getAttribute("id")||this.uid();this.rowsBuffer[F+C]={idd:A,data:G[F],_parser:this._process_xml_rowB,_locator:this._get_xml_dataB};this.rowsAr[A]=G[F]}this.render_dataset();this._parsing=false;return E.xmlDoc.responseXML?E.xmlDoc.responseXML:E.xmlDoc};dhtmlXGridObject.prototype._process_xml_rowA=function(B,D){var A=[];B._attrs=this._xml_attrs(D);for(var E=0;E<this.columnIds.length;E++){var F=this.columnIds[E],C=B._attrs[F]||"";if(B.childNodes[E])B.childNodes[E]._attrs={};A.push(C)}this._fillRow(B,(this._c_order?this._swapColumns(A):A));return B};dhtmlXGridObject.prototype._get_xml_dataA=function(B,A){return B.getAttribute(this.getColumnId(A))};dhtmlXGridObject.prototype._process_xml_rowB=function(C,E){var B=[];C._attrs=this._xml_attrs(E);if(this._ud_enabled){var H=this.xmlLoader.doXPath("./userdata",E);for(var I=H.length-1;I>=0;I--)this.setUserData(H[I].getAttribute("name"),H[I].firstChild?H[I].firstChild.data:"")}for(var A=0;A<E.childNodes.length;A++){var D=E.childNodes[A];if(!D.tagName)continue;var G=this.getColIndexById(D.tagName);if(isNaN(G))continue;var F=D.getAttribute("type");if(F)C.childNodes[G]._cellType=F;C.childNodes[G]._attrs=this._xml_attrs(D);if(D.getAttribute("xmlcontent"));else if(D.firstChild)D=D.firstChild.data;else D="";B[G]=D}for(I=0;I<C.childNodes.length;I++)if(!C.childNodes[I]._attrs)C.childNodes[I]._attrs={};this._fillRow(C,(this._c_order?this._swapColumns(B):B));return C};dhtmlXGridObject.prototype._get_xml_dataB=function(C,B){var A=this.getColumnId(B);C=C.firstChild;while(true){if(!C)return"";if(C.tagName==A)return(C.firstChild?C.firstChild.data:"");C=C.nextSibling}return""};dhtmlXGridObject.prototype.attachHeaderA=dhtmlXGridObject.prototype.attachHeader;dhtmlXGridObject.prototype.attachHeader=function(){this.attachHeaderA.apply(this,arguments);if(this._realfake)return true;this.formAutoSubmit();if(typeof(this.FormSubmitOnlyChanged)=="undefined")this.submitOnlyChanged(true);if(typeof(this._submitAR)=="undefined")this.submitAddedRows(true);var A=this;this._added_rows=[];this._deleted_rows=[];this.attachEvent("onRowAdded",function(B){A._added_rows.push(B);A.forEachCell(B,function(A){A.cell.wasChanged=true});return true});this.attachEvent("onBeforeRowDeleted",function(B){A._deleted_rows.push(B);return true});this.attachHeader=this.attachHeaderA};dhtmlXGridObject.prototype.formAutoSubmit=function(){this.parentForm=this.detectParentFormPresent();if(this.parentForm===false)return false;if(this.formEventAttached)return;this.formInputs=new Array();var A=this;dhtmlxEvent(this.parentForm,"submit",function(){if(A.entBox)A.parentFormOnSubmit()});this.formEventAttached=true};dhtmlXGridObject.prototype.parentFormOnSubmit=function(){this.formCreateInputCollection();if(!this.callEvent("onBeforeFormSubmit",[]))return false};dhtmlXGridObject.prototype.submitOnlyChanged=function(A){this.FormSubmitOnlyChanged=convertStringToBoolean(A)};dhtmlXGridObject.prototype.submitColumns=function(A){if(typeof A=="string")A=A.split(this.delim);this._submit_cols=A};dhtmlXGridObject.prototype.setFieldName=function(A){A=A.replace(/\{GRID_ID\}/g,"'+a1+'");A=A.replace(/\{ROW_ID\}/g,"'+a2+'");A=A.replace(/\{ROW_INDEX\}/g,"'+this.getRowIndex(a2)+'");A=A.replace(/\{COLUMN_INDEX\}/g,"'+a3+'");A=A.replace(/\{COLUMN_ID\}/g,"'+this.getColumnId(a3)+'");this._input_mask=Function("a1","a2","a3","return '"+A+"';")};dhtmlXGridObject.prototype.submitSerialization=function(A){this.FormSubmitSerialization=convertStringToBoolean(A)};dhtmlXGridObject.prototype.submitAddedRows=function(A){this._submitAR=convertStringToBoolean(A)};dhtmlXGridObject.prototype.submitOnlySelected=function(A){this.FormSubmitOnlySelected=convertStringToBoolean(A)};dhtmlXGridObject.prototype.submitOnlyRowID=function(A){this.FormSubmitOnlyRowID=convertStringToBoolean(A)};dhtmlXGridObject.prototype.createFormInput=function(B,C){var A=document.createElement("input");A.type="hidden";if(this._input_mask&&(typeof B!="string"))A.name=this._input_mask.apply(this,B);else A.name=((this.globalBox||this.entBox).id||"dhtmlXGrid")+"_"+B;A.value=C;this.parentForm.appendChild(A);this.formInputs.push(A)};dhtmlXGridObject.prototype.createFormInputRow=function(C){var A=(this.globalBox||this.entBox).id;for(var D=0;D<this._cCount;D++){var B=this.cells3(C,D);if(((!this.FormSubmitOnlyChanged)||B.wasChanged())&&(!this._submit_cols||this._submit_cols[D]))this.createFormInput(this._input_mask?[A,C.idd,D]:(C.idd+"_"+D),B.getValue())}};dhtmlXGridObject.prototype.formCreateInputCollection=function(){if(this.parentForm==false)return false;for(var A=0;A<this.formInputs.length;A++)this.parentForm.removeChild(this.formInputs[A]);this.formInputs=new Array();if(this.FormSubmitSerialization)this.createFormInput("serialized",this.serialize());else if(this.FormSubmitOnlySelected){if(this.FormSubmitOnlyRowID)this.createFormInput("selected",this.getSelectedId());else for(A=0;A<this.selectedRows.length;A++)this.createFormInputRow(this.selectedRows[A])}else{if(this._submitAR){if(this._added_rows.length)this.createFormInput("rowsadded",this._added_rows.join(","));if(this._deleted_rows.length)this.createFormInput("rowsdeleted",this._deleted_rows.join(","))}this.forEachRow(function(A){this.getRowById(A);this.createFormInputRow(this.rowsAr[A])})}};dhtmlXGridObject.prototype.detectParentFormPresent=function(){var B=false,A=this.entBox;while(A&&A.tagName&&A!=document.body)if(A.tagName.toLowerCase()=="form"){B=A;break}else A=A.parentNode;return B};dhtmlXGridObject.prototype.enableHeaderMenu=function(B){if(typeof B=="string")B=B.split(",");this._hm_config=B;var A=this;this.attachEvent("onInit",function(){this.hdr.oncontextmenu=function(B){return A._doHContClick(B||window.event)};this.startColResizeA=this.startColResize;this.startColResize=function(A){if(A.button==2||(_isMacOS&&A.ctrlKey))return this._doHContClick(A);return this.startColResizeA(A)};this._chm_ooc=this.obj.onclick;this._chm_hoc=this.hdr.onclick;this.hdr.onclick=function(B){if(B&&(B.button==2||(_isMacOS&&B.ctrlKey)))return false;A._showHContext(false);return A._chm_hoc.apply(this,arguments)};this.obj.onclick=function(){A._showHContext(false);return A._chm_ooc.apply(this,arguments)}});dhtmlxEvent(document.body,"click",function(){if(A._hContext)A._showHContext(false)});if(this.hdr.rows.length)this.callEvent("onInit",[]);this.enableHeaderMenu=function(){}};dhtmlXGridObject.prototype._doHContClick=function(B){function C(B){if(B.pageX||B.pageY)return{x:B.pageX,y:B.pageY};var A=((_isIE)&&(document.compatMode!="BackCompat"))?document.documentElement:document.body;return{x:B.clientX+A.scrollLeft-A.clientLeft,y:B.clientY+A.scrollTop-A.clientTop}}this._createHContext();var A=C(B);this._showHContext(true,A.x,A.y);B[_isIE?"srcElement":"target"].oncontextmenu=function(A){(A||event).cancelBubble=true;return false};B.cancelBubble=true;if(B.preventDefault)B.preventDefault();return false};dhtmlXGridObject.prototype._createHContext=function(){if(this._hContext)return this._hContext;var D=document.createElement("DIV");D.oncontextmenu=function(A){(A||event).cancelBubble=true;return false};D.onclick=function(A){(A||event).cancelBubble=true;return true};D.className="dhx_header_cmenu";D.style.width=D.style.height="5px";D.style.display="none";var G=[],H=0;if(this._fake)H=this._fake._cCount;var E=H;for(H;H<this.hdr.rows[1].cells.length;H++){var F=this.hdr.rows[1].cells[H];if(!this._hm_config||(this._hm_config[H]&&this._hm_config[H]!="false")){if(F.firstChild&&F.firstChild.tagName=="DIV")var B=F.firstChild.innerHTML;else B=F.innerHTML;B=B.replace(/<[^>]*>/gi,"");G.push("<div class='dhx_header_cmenu_item'><input type='checkbox' column='"+E+"' len='"+(F.colSpan||1)+"' checked='true' />"+B+"</div>")}E+=(F.colSpan||1)}D.innerHTML=G.join("");var C=this,A=function(){var A=this.getAttribute("column");if(!this.checked&&!C._checkLast(A))return this.checked=true;if(C._realfake)C=C._fake;for(var B=0;B<this.getAttribute("len");B++)C.setColumnHidden((A*1+B*1),!this.checked);if(this.checked&&C.getColWidth(A)==0)C.adjustColumnSize(A)};for(H=0;H<D.childNodes.length;H++)D.childNodes[H].firstChild.onclick=A;document.body.insertBefore(D,document.body.firstChild);this._hContext=D;D.style.position="absolute";D.style.zIndex=999;D.style.width="auto";D.style.height="auto";D.style.display="block"};dhtmlXGridObject.prototype._checkLast=function(A){for(var B=0;B<this._cCount;B++)if((!this._hrrar||!this._hrrar[B])&&(B!=A))return true;return false};dhtmlXGridObject.prototype._updateHContext=function(){for(var C=0;C<this._hContext.childNodes.length;C++){var B=this._hContext.childNodes[C].firstChild,A=B.getAttribute("column");if(this.isColumnHidden(A)||(this.getColWidth(A)==0))B.checked=false}};dhtmlXGridObject.prototype._showHContext=function(C,B,A){if(C&&this.enableColumnMove){this._hContext.parentNode.removeChild(this._hContext);this._hContext=null}this._createHContext();this._hContext.style.display=(C?"block":"none");if(C){this._updateHContext(true);this._hContext.style.left=B+"px";this._hContext.style.top=A+"px"}};function eXcell_math(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){this.grid.editor=new eXcell_ed(this.cell);this.grid.editor.fix_self=true;this.grid.editor.getValue=this.cell.original?(function(){return this.cell.original}):this.getValue;this.grid.editor.setValue=this.setValue;this.grid.editor.edit()};this.isDisabled=function(){return!this.grid._mathEdit};this.setValue=function(A){A=this.grid._compileSCL(A,this.cell,this.fix_self);if(this.grid._strangeParams[this.cell._cellIndex])this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).setValue(A);else{this.setCValue(A);this.cell._clearCell=false}};this.getValue=function(){if(this.grid._strangeParams[this.cell._cellIndex])return this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).getValue();return this.cell.innerHTML}}eXcell_math.prototype=new eXcell;dhtmlXGridObject.prototype._init_point_bm=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._mat_links={};this._aggregators=[];this.attachEvent("onClearAll",function(){this._mat_links={};this._aggregators=[]});this.attachEvent("onCellChanged",function(A,B){if(this._mat_links[A]){var C=this._mat_links[A][B];if(C)for(var F=0;F<C.length;F++)if(C[F].parentNode)this.cells5(C[F]).setValue(this._calcSCL(C[F]))}if(!this._parsing&&this._aggregators[B]){var D=this._h2.get[A].parent.id;if(D!=0){var E=this.cells(D,B);E.setValue(this._calcSCL(E.cell))}}});this.attachEvent("onAfterRowDeleted",function(A,C){if(C!=0)if(!this._parsing&&this._aggregators.length)for(var B=0;B<this._aggregators.length;B++)if(this._aggregators[B]){var D=this.cells(C,B);D.setValue(this._calcSCL(D.cell))}return true});this.attachEvent("onXLE",function(){for(var A=0;A<this._aggregators.length;A++)if(this._aggregators[A])this._h2.forEachChild(0,function(B){if(B.childs.length!=0){var C=this.cells(B.id,A);C.setValue(this._calcSCL(C.cell))}},this)});this._init_point=this._init_point_bm;if(this._init_point)this._init_point()};dhtmlXGridObject.prototype.enableMathSerialization=function(A){this._mathSerialization=convertStringToBoolean(A)};dhtmlXGridObject.prototype.setMathRound=function(A){this._roundDl=A;this._roundD=Math.pow(10,A)};dhtmlXGridObject.prototype.enableMathEditing=function(A){this._mathEdit=convertStringToBoolean(A)};dhtmlXGridObject.prototype._calcSCL=function(cell){if(!cell._code)return this.cells5(cell).getValue();try{dhtmlx.agrid=this;var z=eval(cell._code)}catch(e){return("#SCL")}if(this._roundD){var pre=Math.abs(z)<1?"0":"";if(z<0)pre="-"+pre;z=Math.round(Math.abs(z)*this._roundD).toString();if(z==0)return 0;if(this._roundDl>0){var n=z.length-this._roundDl;if(n<0){z=("000000000"+z).substring(9+n);n=0}return(pre+z.substring(0,n)+"."+z.substring(n,z.length))}return pre+z}return z};dhtmlXGridObject.prototype._countTotal=function(D,B){var A=0,C=this._h2.get[D];for(var E=0;E<C.childs.length;E++){if(!C.childs[E].buff)return A;if(C.childs[E].buff._parser){this._h2.forEachChild(D,function(C){if(C.childs.length==0)A+=parseInt(this._get_cell_value(C.buff,B),10)},this);return A}A+=parseInt(this._get_cell_value(C.childs[E].buff,B),10)}return A};dhtmlXGridObject.prototype._compileSCL=function(E,D,C){if(E===null||E===window.undefined)return E;E=E.toString();if(E.indexOf("=")!=0){this._reLink([],D);if(C)D._code=D.original=null;return E}D.original=E;var F=null;E=E.replace("=","");if(E.indexOf("sum")!=-1){E=E.replace("sum","(dhtmlx.agrid._countTotal('"+D.parentNode.idd+"',"+D._cellIndex+"))");if(!this._aggregators)this._aggregators=[];this._aggregators[D._cellIndex]="sum";D._code=E;return this._parsing?"":this._calcSCL(D)}if(E.indexOf("[[")!=-1){var B=/(\[\[([^\,]*)\,([^\]]*)]\])/g;dhtmlx.agrid=this;F=F||(new Array());E=E.replace(B,function(B,A,E,C){if(E=="-")E=D.parentNode.idd;if(E.indexOf("#")==0)E=dhtmlx.agrid.getRowId(E.replace("#",""));F[F.length]=[E,C];return"(parseInt(dhtmlx.agrid.cells(\""+E+"\","+C+").getValue(),10))"})}if(E.indexOf(":")!=-1){B=/:(\w+)/g;dhtmlx.agrid=this;var A=D.parentNode.idd;F=F||(new Array());E=E.replace(B,function(C,B,E,D){F[F.length]=[A,dhtmlx.agrid.getColIndexById(B)];return"(parseInt(dhtmlx.agrid.cells(\""+A+"\",dhtmlx.agrid.getColIndexById(\""+B+"\")).getValue(),10))"})}else{B=/c([0-9]+)/g;dhtmlx.agrid=this;A=D.parentNode.idd;F=F||(new Array());E=E.replace(B,function(C,B,E,D){F[F.length]=[A,B];return"(parseInt(dhtmlx.agrid.cells(\""+A+"\","+B+").getValue(),10))"})}this._reLink(F,D);D._code=E;return this._calcSCL(D)};dhtmlXGridObject.prototype._reLink=function(C,B){if(!C.length)return;for(var D=0;D<C.length;D++){if(!this._mat_links[C[D][0]])this._mat_links[C[D][0]]={};var A=this._mat_links[C[D][0]];if(!A[C[D][1]])A[C[D][1]]=[];A[C[D][1]].push(B)}};if(_isKHTML)(function(){var A=String.prototype.replace;String.prototype.replace=function(G,C){if(typeof C!="function")return A.apply(this,arguments);var F=""+this,J=C;if(!(G instanceof RegExp)){var E=F.indexOf(G);return(E==-1?F:A.apply(F,[G,J(G,E,F)]))}var I=G,D=[],B=I.lastIndex,K;while((K=I.exec(F))!=null){var E=K.index,H=K.concat(E,F);D.push(F.slice(B,E),J.apply(null,H).toString());if(!I.global){B+=RegExp.lastMatch.length;break}else B=I.lastIndex}D.push(F.slice(B));return D.join("")}})();dhtmlXGridObject.prototype.insertColumn=function(K,H,F,C,B,D,M,G,I){K=parseInt(K);if(K>this._cCount)K=this._cCount;if(!this._cMod)this._cMod=this._cCount;this._processAllArrays(this._cCount,K-1,[(H||"&nbsp;"),(C||100),(F||"ed"),(D||"left"),(M||""),(B||"na"),(I||""),"",this._cMod,(C||100)]);this._processAllRows("_addColInRow",K);if(typeof(H)=="object"){for(var J=1;J<this.hdr.rows.length;J++)if(H[J-1]=="#rspan"){var A=J-1,N=false,L=null;while(!N){L=this.hdr.rows[A];for(var E=0;E<L.cells.length;E++)if(L.cells[E]._cellIndex==K){N=E;break}A--}this.hdr.rows[A+1].cells[E].rowSpan=(this.hdr.rows[A].cells[E].rowSpan||1)+1}else this.setHeaderCol(K,(H[J-1]||"&nbsp;"),J)}else this.setHeaderCol(K,(H||"&nbsp;"));this.hdr.rows[0].cells[K];this._cCount++;this._cMod++;this._master_row=null;this.setSizes()};dhtmlXGridObject.prototype.deleteColumn=function(A){A=parseInt(A);if(this._cCount==0)return;if(!this._cMod)this._cMod=this._cCount;if(A>=this._cCount)return;this._processAllArrays(A,this._cCount-1,[null,null,null,null,null,null,null,null,null,null,null]);this._processAllRows("_deleteColInRow",A);this._cCount--;this._master_row=null;this.setSizes()};dhtmlXGridObject.prototype._processAllRows=function(B,D,A){this[B](this.obj.rows[0],D,A,0);var C=this.hdr.rows.length;for(var E=0;E<C;E++)this[B](this.hdr.rows[E],D,A,E);if(this.ftr){C=this.ftr.firstChild.rows.length;for(E=0;E<C;E++)this[B](this.ftr.firstChild.rows[E],D,A,E)}this.forEachRow(function(C){if(this.rowsAr[C]&&this.rowsAr[C].tagName=="TR")this[B](this.rowsAr[C],D,A,-1)})};dhtmlXGridObject.prototype._processAllArrays=function(H,D,G){var C=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor","_hrrar","_c_order"];if(this.cellWidthPX.length)C.push("cellWidthPX");if(this.cellWidthPC.length)C.push("cellWidthPC");if(this._col_combos)C.push("_col_combos");if(this._mCols)C[C.length]="_mCols";if(this.columnIds)C[C.length]="columnIds";if(this._maskArr)C.push("_maskArr");if(this._drsclmW)C.push("_drsclmW");if(this._RaSeCol)C.push("_RaSeCol");if(this.clists)C.push("clists");if(this._validators&&this._validators.data)C.push(this._validators.data);C.push("combos");if(this._customSorts)C.push("_customSorts");if(this._aggregators)C.push("_aggregators");var J=(H<=D);if(!this._c_order){this._c_order=new Array();var E=this._cCount;for(var I=0;I<E;I++)this._c_order[I]=I}for(I=0;I<C.length;I++){var B=this[C[I]]||C[I];if(B){if(J){var A=B[H];for(var F=H;F<D;F++)B[F]=B[F+1];B[D]=A}else{A=B[H];for(F=H;F>(D+1);F--)B[F]=B[F-1];B[D+1]=A}if(G)B[D+(J?0:1)]=G[I]}}};dhtmlXGridObject.prototype.moveColumn=function(B,A){A--;B=parseInt(B);A=parseInt(A);if(A<B)var C=A+1;else C=A;if(!this.callEvent("onBeforeCMove",[B,C]))return false;if(B==C)return;this.editStop();this._processAllRows("_moveColInRow",B,A);this._processAllArrays(B,A);if(this.fldSorted)this.setSortImgPos(this.fldSorted._cellIndex);this.callEvent("onAfterCMove",[B,C])};dhtmlXGridObject.prototype._swapColumns=function(A){var C=new Array();for(var D=0;D<this._cCount;D++){var B=A[this._c_order[D]];if(typeof(B)=="undefined")B="";C[D]=B}return C};dhtmlXGridObject.prototype._moveColInRow=function(E,D,C){var A=E.childNodes[D],B=E.childNodes[C+1];if(!A)return;if(B)E.insertBefore(A,B);else E.appendChild(A);for(var F=0;F<E.childNodes.length;F++)E.childNodes[F]._cellIndex=E.childNodes[F]._cellIndexS=F};dhtmlXGridObject.prototype._addColInRow=function(G,D,A,E){var B=D;if(G._childIndexes){if(G._childIndexes[D-1]==G._childIndexes[D]||!G.childNodes[G._childIndexes[D-1]]){for(var H=G._childIndexes.length;H>=D;H--)G._childIndexes[H]=H?(G._childIndexes[H-1]+1):0;G._childIndexes[D]--}else for(H=G._childIndexes.length;H>=D;H--)G._childIndexes[H]=H?(G._childIndexes[H-1]+1):0;B=G._childIndexes[D]}var C=G.childNodes[B],F=document.createElement((E)?"TD":"TH");if(E)F._attrs={};else F.style.width=(parseInt(this.cellWidthPX[D])||"100")+"px";if(C)G.insertBefore(F,C);else G.appendChild(F);if(this.dragAndDropOff&&G.idd)this.dragger.addDraggableItem(G.childNodes[B],this);for(H=B+1;H<G.childNodes.length;H++)G.childNodes[H]._cellIndex=G.childNodes[H]._cellIndexS=G.childNodes[H]._cellIndex+1;if(G.childNodes[B])G.childNodes[B]._cellIndex=G.childNodes[B]._cellIndexS=D;if(G.idd||typeof(G.idd)!="undefined"){this.cells3(G,D).setValue("");F.align=this.cellAlign[D];F.style.verticalAlign=this.cellVAlign[D];F.bgColor=this.columnColor[D]}else if(F.tagName=="TD")if(!G.idd&&this.forceDivInHeader)F.innerHTML="<div class='hdrcell'>&nbsp;</div>";else F.innerHTML="&nbsp;"};dhtmlXGridObject.prototype._deleteColInRow=function(F,E){if(F._childIndexes)E=F._childIndexes[E];var D=F.childNodes[E];if(!D)return;if(D.colSpan&&D.colSpan>1&&D.parentNode.idd){var B=D.colSpan-1,A=this.cells4(D).getValue();this.setColspan(D.parentNode.idd,D._cellIndex,1);if(B>1){var C=D._cellIndex*1;this.setColspan(D.parentNode.idd,C+1,B);this.cells(D.parentNode.idd,D._cellIndex*1+1).setValue(A);F._childIndexes.splice(C,1);for(var G=C;G<F._childIndexes.length;G++)F._childIndexes[G]-=1}}else if(F._childIndexes){F._childIndexes.splice(E,1);for(G=E;G<F._childIndexes.length;G++)F._childIndexes[G]--}if(D)F.removeChild(D);for(G=E;G<F.childNodes.length;G++)F.childNodes[G]._cellIndex=F.childNodes[G]._cellIndexS=F.childNodes[G]._cellIndex-1};dhtmlXGridObject.prototype.enableColumnMove=function(B,A){this._mCol=convertStringToBoolean(B);if(typeof(A)!="undefined")this._mCols=A.split(",");if(!this._mmevTrue){dhtmlxEvent(this.hdr,"mousedown",this._startColumnMove);dhtmlxEvent(document.body,"mousemove",this._onColumnMove);dhtmlxEvent(document.body,"mouseup",this._stopColumnMove);this._mmevTrue=true}};dhtmlXGridObject.prototype._startColumnMove=function(A){A=A||event;var B=A.target||A.srcElement,D=B;while(D.tagName!="TABLE")D=D.parentNode;var C=D.grid;if(!C)return;C.setActive();if(!C._mCol||A.button==2)return;B=C.getFirstParentOfType(B,"TD");if(B.style.cursor!="default")return true;if((C)&&(!C._colInMove)){C.resized=null;if((!C._mCols)||(C._mCols[B._cellIndex]=="true"))C._colInMove=B._cellIndex+1}return true};dhtmlXGridObject.prototype._onColumnMove=function(A){A=A||event;var D=window.globalActiveDHTMLGridObject;if((D)&&(D._colInMove)){if(D._showHContext)D._showHContext(false);if(typeof(D._colInMove)!="object"){var F=document.createElement("DIV");F._aIndex=(D._colInMove-1);F._bIndex=null;F.innerHTML=D.getHeaderCol(F._aIndex);F.className="dhx_dragColDiv";F.style.position="absolute";document.body.appendChild(F);D._colInMove=F}var C=[];C[0]=(document.body.scrollLeft||document.documentElement.scrollLeft);C[1]=(document.body.scrollTop||document.documentElement.scrollTop);D._colInMove.style.left=A.clientX+C[0]+8+"px";D._colInMove.style.top=A.clientY+C[1]+8+"px";var B=A.target||A.srcElement;while((B)&&(typeof(B._cellIndexS)=="undefined"))B=B.parentNode;if(D._colInMove._oldHe){D._colInMove._oldHe.className=D._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,"");D._colInMove._oldHe=null;D._colInMove._bIndex=null}if(B){if(D.hdr.rows[1]._childIndexes)var E=D.hdr.rows[1].cells[D.hdr.rows[1]._childIndexes[B._cellIndexS]];else E=D.hdr.rows[1].cells[B._cellIndexS];F=A.clientX-(getAbsoluteLeft(E)-D.hdrBox.scrollLeft);if(F/E.offsetWidth>0.5){E.className+=" columnTargetR";D._colInMove._bIndex=B._cellIndexS}else{E.className+=" columnTargetL";D._colInMove._bIndex=B._cellIndexS-1}if(E.offsetLeft<(D.objBox.scrollLeft+20))D.objBox.scrollLeft=Math.max(0,E.offsetLeft-20);if((E.offsetLeft+E.offsetWidth-D.objBox.scrollLeft)>(D.objBox.offsetWidth-20))D.objBox.scrollLeft=Math.min(D.objBox.scrollLeft+E.offsetWidth+20,D.objBox.scrollWidth-D.objBox.offsetWidth);D._colInMove._oldHe=E}A.cancelBubble=true;return false}return true};dhtmlXGridObject.prototype._stopColumnMove=function(A){A=A||event;var B=window.globalActiveDHTMLGridObject;if((B)&&(B._colInMove)){if(typeof(B._colInMove)=="object"){B._colInMove.parentNode.removeChild(B._colInMove);if(B._colInMove._bIndex!=null)B.moveColumn(B._colInMove._aIndex,B._colInMove._bIndex+1);if(B._colInMove._oldHe)B._colInMove._oldHe.className=B._colInMove._oldHe.className.replace(/columnTarget(L|R)/g,"");B._colInMove._oldHe=null;B._colInMove.grid=null;B.resized=true}B._colInMove=0}return true};dhtmlXGridObject.prototype.loadCSVFile=function(B,A){this.load(B,A,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(A){this._csvAID=convertStringToBoolean(A)};dhtmlXGridObject.prototype.enableCSVHeader=function(A){this._csvHdr=convertStringToBoolean(A)};dhtmlXGridObject.prototype.setCSVDelimiter=function(A){this.csv.cell=A};dhtmlXGridObject.prototype._csvAID=true;dhtmlXGridObject.prototype.loadCSVString=function(A){this.parse(A,"csv")};dhtmlXGridObject.prototype.serializeToCSV=function(A){this.editStop();if(this._mathSerialization)this._agetm="getMathValue";else if(this._strictText||A)this._agetm="getTitle";else this._agetm="getValue";var G=[];if(this._csvHdr)for(var E=1;E<this.hdr.rows.length;E++){var C=[];for(var F=0;F<this._cCount;F++)if((!this._srClmn)||(this._srClmn[F]))C.push(this.getColumnLabel(F,E-1));G.push(this.csvParser.str(C,this.csv.cell,this.csv.row))}var F=0,B=this.rowsBuffer.length;for(F;F<B;F++){var D=this._serializeRowToCVS(null,F);if(D!="")G.push(D)}return this.csvParser.block(G,this.csv.row)};dhtmlXGridObject.prototype._serializeRowToCVS=function(G,C,H,J){var L=new Array();if(!G){G=this.render_row(C);if(this._fake&&!this._fake.rowsAr[G.idd])this._fake.render_row(C)}if(!this._csvAID)L[L.length]=G.idd;H=H||0;J=J||this._cCount;var F=false,I=H;while(G.childNodes[H]._cellIndex>I&&H)H--;for(var B=H;I<J;B++){if(!G.childNodes[B])break;var A=G.childNodes[B]._cellIndex;if((!this._srClmn)||(this._srClmn[A])){var K=G.childNodes[B],E=this.cells(G.idd,A);while(I!=A){I++;L.push("");if(I>=J)break}if(I>=J)break;I++;if(E.cell)zxVal=E[this._agetm]();else zxVal="";if((this._chAttr)&&(E.wasChanged()))F=true;L[L.length]=((zxVal===null)?"":zxVal);if(this._ecspn&&K.colSpan&&K.colSpan>1){K=K.colSpan-1;for(var D=0;D<K;D++){L[L.length]="";I++}}}else I++}if((this._onlChAttr)&&(!F))return"";return this.csvParser.str(L,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(A){if(window.clipboardData)window.clipboardData.setData("Text",A);else(new Clipboard()).copy(A)};dhtmlXGridObject.prototype.fromClipBoard=function(){if(window.clipboardData)return window.clipboardData.getData("Text");else return(new Clipboard()).paste()};dhtmlXGridObject.prototype.cellToClipboard=function(A,C){if((!A)||(!C)){if(!this.selectedRows[0])return;A=this.selectedRows[0].idd;C=this.cell._cellIndex}var B=this.cells(A,C);this.toClipBoard(((B.getLabel?B.getLabel():B.getValue())||"").toString())};dhtmlXGridObject.prototype.updateCellFromClipboard=function(A,C){if((!A)||(!C)){if(!this.selectedRows[0])return;A=this.selectedRows[0].idd;C=this.cell._cellIndex}var B=this.cells(A,C);B[B.setImage?"setLabel":"setValue"](this.fromClipBoard())};dhtmlXGridObject.prototype.rowToClipboard=function(B){var D="";if(this._mathSerialization)this._agetm="getMathValue";else if(this._strictText)this._agetm="getTitle";else this._agetm="getValue";if(B)D=this._serializeRowToCVS(this.getRowById(B));else{var A=[];for(var C=0;C<this.selectedRows.length;C++){A[A.length]=this._serializeRowToCVS(this.selectedRows[C]);D=this.csvParser.block(A,this.csv.row)}}this.toClipBoard(D)};dhtmlXGridObject.prototype.updateRowFromClipboard=function(B){var C=this.fromClipBoard();if(!C)return;if(B)var A=this.getRowById(B);else A=this.selectedRows[0];if(!A)return;var D=this.csvParser;C=D.unblock(C,this.csv.cell,this.csv.row)[0];if(!this._csvAID)C.splice(0,1);for(var F=0;F<C.length;F++){var E=this.cells3(A,F);E[E.setImage?"setLabel":"setValue"](C[F])}};dhtmlXGridObject.prototype.csvParser={block:function(A,B){return A.join(B)},unblock:function(B,C,E){var D=(B||"").split(E);for(var F=0;F<D.length;F++)D[F]=(D[F]||"").split(C);var A=D.length-1;if(D[A].length==1&&D[A][0]=="")D.splice(A,1);return D},str:function(B,A,C){return B.join(A)}};dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp("\"","g"),_quote_esc:RegExp("\\\\\"","g"),block:function(A,B){return A.join(B)},unblock:function(G,C,E){var M=[[]],H=0;if(!G)return M;var K=/^[ ]*"/,I=/"[ ]*$/,B=new RegExp(".*"+E+".*$"),D=G.split(C);for(var F=0;F<D.length;F++)if(D[F].match(K)){var L=D[F].replace(K,"");while(!D[F].match(I)){F++;L+=D[F]}M[H].push(L.replace(I,"").replace(this._quote_esc,"\""))}else if(D[F].match(B)){var J=D[F].indexOf(E);M[H].push(D[F].substr(0,J));H++;M[H]=[];D[F]=D[F].substr(J+1);F--}else if(D[F]||F!=D.length-1)M[H].push(D[F]);var A=M.length-1;if(A>0&&!M[A].length)M.splice(A,1);return M},str:function(B,A,C){for(var D=0;D<B.length;D++)B[D]="\""+B[D].replace(this._quote,"\\\"")+"\"";return B.join(A)}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var A=this.fromClipBoard();if(!A)return;var B=this.csvParser.unblock(A,this.csv.cell,this.csv.row);for(var C=0;C<B.length;C++)if(B[C]){A=B[C];if(!A.length)continue;if(this._csvAID)this.addRow(this.getRowsNum()+2,A);else{if(this.rowsAr[A[0]])A[0]=this.uid();this.addRow(A[0],A.slice(1))}}};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var A=this.fromClipBoard();if(!A)return;this.loadCSVString(A)};dhtmlXGridObject.prototype.getXLS=function(A){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(A||"")+"xls.php";this.xslform.method="post";this.xslform.target=(_isIE?"_blank":"");document.body.appendChild(this.xslform);var G=document.createElement("INPUT");G.type="hidden";G.name="csv";this.xslform.appendChild(G);var E=document.createElement("INPUT");E.type="hidden";E.name="csv_header";this.xslform.appendChild(E)}var C=this.serializeToCSV();this.xslform.childNodes[0].value=C;var D=[],B=this._cCount;for(var F=0;F<B;F++)D.push(this.getHeaderCol(F));D=D.join(",");this.xslform.childNodes[1].value=D;this.xslform.submit()};dhtmlXGridObject.prototype.printView=function(I,P){var T="<style>TD {font-family:Arial;text-align:center;padding-left:2px;padding-right:2px;}\n td.filter input, td.filter select {display:none;}\n </style>",U=null;if(this._fake){U=[].concat(this._hrrar);for(var O=0;O<this._fake._cCount;O++)this._hrrar[O]=null}T+="<base href='"+document.location.href+"'></base>";if(!this.parentGrid)T+=(I||"");T+="<table width=\"100%\" border=\"2px\" cellpadding=\"0\" cellspacing=\"0\">";var L=Math.max(this.rowsBuffer.length,this.rowsCol.length),D=this._cCount,K=this._printWidth();T+="<tr class=\"header_row_1\">";for(O=0;O<D;O++){if(this._hrrar&&this._hrrar[O])continue;var Q=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(O)]:O],G=(Q.colSpan||1),M=(Q.rowSpan||1);for(var N=1;N<G;N++)K[O]+=K[N];T+="<td rowspan=\""+M+"\" width=\""+K[O]+"%\" style=\"background-color:lightgrey;\" colspan=\""+G+"\">"+this.getHeaderCol(O)+"</td>";O+=G-1}T+="</tr>";for(O=2;O<this.hdr.rows.length;O++)if(_isIE){T+="<tr style='background-color:lightgrey' class='header_row_"+O+"'>";var C=this.hdr.rows[O].childNodes;for(N=0;N<C.length;N++)if(!this._hrrar||!this._hrrar[C[N]._cellIndex])T+=C[N].outerHTML;T+="</tr>"}else T+="<tr class='header_row_"+O+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[O].innerHTML:"")+this.hdr.rows[O].innerHTML+"</tr>";for(O=0;O<L;O++){T+="<tr>";if(this.rowsCol[O]&&this.rowsCol[O]._cntr){T+=this.rowsCol[O].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";continue}if(this.rowsCol[O]&&this.rowsCol[O].style.display=="none")continue;var B;if(this.rowsCol[O])B=this.rowsCol[O].idd;else if(this.rowsBuffer[O])B=this.rowsBuffer[O].idd;else continue;for(N=0;N<D;N++){if(this._hrrar&&this._hrrar[N])continue;if(this.rowsAr[B]&&this.rowsAr[B].tagName=="TR"){var H=this.cells(B,N);if(H._setState)var S="";else if(H.getContent)S=H.getContent();else if(H.getImage||H.combo)S=H.cell.innerHTML;else S=H.getValue()}else S=this._get_cell_value(this.rowsBuffer[O],N);var R=this.columnColor[N]?"background-color:"+this.columnColor[N]+";":"",J=this.cellAlign[N]?"text-align:"+this.cellAlign[N]+";":"",A=H.getAttribute("colspan");T+="<td style=\""+R+J+"\" "+(A?"colSpan=\""+A+"\"":"")+">"+(S===""?"&nbsp;":S)+"</td>";if(A)N+=A-1}T+="</tr>";if(this.rowsCol[O]&&this.rowsCol[O]._expanded){var F=this.cells4(this.rowsCol[O]._expanded.ctrl);if(F.getSubGrid)T+="<tr><td colspan=\""+D+"\">"+F.getSubGrid().printView()+"</td></tr>";else T+="<tr><td colspan=\""+D+"\">"+this.rowsCol[O]._expanded.innerHTML+"</td></tr>"}}if(this.ftr)for(O=1;O<this.ftr.childNodes[0].rows.length;O++)T+="<tr style='background-color:lightgrey'>"+((this._fake)?this._fake.ftr.childNodes[0].rows[O].innerHTML:"")+this.ftr.childNodes[0].rows[O].innerHTML+"</tr>";T+="</table>";if(this.parentGrid)return T;T+=(P||"");var E=window.open("","_blank");E.document.write(T);E.document.write("<script>window.onerror=function(){return true;}</script>");E.document.close();if(this._fake)this._hrrar=U};dhtmlXGridObject.prototype._printWidth=function(){var E=[],G=0;for(var F=0;F<this._cCount;F++){var A=this.getColWidth(F);E.push(A);G+=A}var C=[],B=0;for(F=0;F<E.length;F++){var D=Math.floor((E[F]/G)*100);B+=D;C.push(D)}C[C.length-1]+=100-B;return C};dhtmlXGridObject.prototype.loadObject=function(A){};dhtmlXGridObject.prototype.loadJSONFile=function(A){};dhtmlXGridObject.prototype.serializeToObject=function(){};dhtmlXGridObject.prototype.serializeToJSON=function(){};if(!window.clipboardData)window.clipboardData={_make:function(){var A=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!A)return null;var B=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!B)return null;B.addDataFlavor("text/unicode");var C=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[A,B,C];return true},setData:function(C,A){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(B){dhtmlxError.throwError("Clipboard","Access to clipboard denied",[C,A]);return""}if(!this._make())return false;this._p[2].data=A;this._p[1].setTransferData("text/unicode",this._p[2],A.length*2);var D=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,D.kGlobalClipboard)},getData:function(D){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(A){dhtmlxError.throwError("Clipboard","Access to clipboard denied",[D]);return""}if(!this._make())return false;this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var C=new Object(),B=new Object();try{this._p[1].getTransferData("text/unicode",B,C)}catch(A){return""}if(B)B=B.value.QueryInterface(Components.interfaces.nsISupportsString);if(B)return B.data.substring(0,C.value/2);return""}};dhtmlXGridObject.prototype.enableBlockSelection=function(B){if(typeof this._bs_mode=="undefined"){var A=this;this.obj.onmousedown=function(B){if(A._bs_mode)A._OnSelectionStart((B||event),this);return true};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){A._HideSelection();return true});this.attachEvent("onGridReconstructed",function(){A._HideSelection();return true});this.attachEvent("onFilterEnd",this._HideSelection)}if(B===false){this._bs_mode=false;return this._HideSelection()}else this._bs_mode=true};dhtmlXGridObject.prototype.forceLabelSelection=function(A){this._strictText=convertStringToBoolean(A)};dhtmlXGridObject.prototype.disableBlockSelection=function(){this.obj.onmousedown=null};dhtmlXGridObject.prototype._OnSelectionStart=function(A,C){var B=this;if(A.button==2)return;var D=A.srcElement||A.target;if(this.editor){if(D.tagName&&(D.tagName=="INPUT"||D.tagName=="TEXTAREA"))return;this.editStop()}if(!B.isActive)B.setActive(true);var G=this.getPosition(this.obj),F=A.clientX-G[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),E=A.clientY-G[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));this._CreateSelection(F-4,E-4);if(D==this._selectionObj){this._HideSelection();this._startSelectionCell=null}else{while(D.tagName.toLowerCase()!="td")D=D.parentNode;this._startSelectionCell=D}if(this._startSelectionCell)if(!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex]))return this._startSelectionCell=null;this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(A){if(B._blsTimer)window.clearTimeout(B._blsTimer)};this.obj.onmmold=this.obj.onmousemove;this._init_pos=[F,E];this._selectionObj.onmousemove=this.obj.onmousemove=function(C){C=C||A;C.returnValue=false;B._OnSelectionMove(C)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(C){C=C||A;B._OnSelectionStop(C,this);return true};this.callEvent("onBeforeBlockSelection",[]);document.body.onselectstart=function(){return false}};dhtmlXGridObject.prototype._getCellByPos=function(D,B){D=D;if(this._fake)D+=this._fake.entBox.offsetWidth;B=B;var A=0;for(var C=0;C<this.obj.rows.length;C++){B-=this.obj.rows[C].offsetHeight;if(B<=0){A=this.obj.rows[C];break}}if(!A||!A.idd)return null;for(C=0;C<this._cCount;C++){D-=this.getColWidth(C);if(D<=0)while(true)if(A._childIndexes&&A._childIndexes[C+1]==A._childIndexes[C])A=A.previousSibling;else return this.cells(A.idd,C).cell}return null};dhtmlXGridObject.prototype._OnSelectionMove=function(G){var C=this;this._ShowSelection();var D=this.getPosition(this.obj),K=G.clientX-D[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),J=G.clientY-D[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if((Math.abs(this._init_pos[0]-K)<5)&&(Math.abs(this._init_pos[1]-J)<5))return this._HideSelection();var H=this._endSelectionCell;if(this._startSelectionCell==null)this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(G.srcElement||G.target,"TD");else if(G.srcElement||G.target)if((G.srcElement||G.target).className=="dhtmlxGrid_selection")this._endSelectionCell=(this._getCellByPos(K,J)||this._endSelectionCell);else{var F=this.getFirstParentOfType(G.srcElement||G.target,"TD");if(F.parentNode.idd)this._endSelectionCell=F}if(this._endSelectionCell)if(!this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex]))this._endSelectionCell=H;var L=this.objBox.scrollLeft+this.objBox.clientWidth,E=this.objBox.scrollTop+this.objBox.clientHeight,M=this.objBox.scrollLeft,N=this.objBox.scrollTop,I=false;if(this._blsTimer)window.clearTimeout(this._blsTimer);if(K+20>=L){this.objBox.scrollLeft=this.objBox.scrollLeft+20;I=true}else if(K-20<M){this.objBox.scrollLeft=this.objBox.scrollLeft-20;I=true}if(J+20>=E&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop+20;I=true}else if(J-20<N&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop-20;I=true}this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);if(I){var B=G.clientX,A=G.clientY;this._blsTimer=window.setTimeout(function(){C._OnSelectionMove({clientX:B,clientY:A})},100)}};dhtmlXGridObject.prototype._OnSelectionStop=function(A){var B=this;if(this._blsTimer)window.clearTimeout(this._blsTimer);this.obj.onmousedown=function(C){if(B._bs_mode)B._OnSelectionStart((C||A),this);return true};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2)this._HideSelection();else{var C=this.getFirstParentOfType(A.srcElement||A.target,"TD");if((!C)||(!C.parentNode.idd))C=this._endSelectionCell;if(!C)return this._HideSelection();while(C.tagName.toLowerCase()!="td")C=C.parentNode;this._stopSelectionCell=C;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};dhtmlXGridObject.prototype._RedrawSelectionPos=function(L,C){var H={};H.LeftTopCol=L._cellIndex;H.LeftTopRow=this.getRowIndex(L.parentNode.idd);H.RightBottomCol=C._cellIndex;H.RightBottomRow=this.getRowIndex(C.parentNode.idd);var F=L.offsetWidth,J=L.offsetHeight;L=this.getPosition(L,this.obj);var N=C.offsetWidth,K=C.offsetHeight;C=this.getPosition(C,this.obj);if(L[0]<C[0])var G=L[0],A=C[0]+N;else{var E=H.RightBottomCol;H.RightBottomCol=H.LeftTopCol;H.LeftTopCol=E;G=C[0],A=L[0]+F}if(L[1]<C[1])var B=L[1],I=C[1]+K;else{E=H.RightBottomRow;H.RightBottomRow=H.LeftTopRow;H.LeftTopRow=E;B=C[1],I=L[1]+J}var M=A-G,D=I-B;this._selectionObj.style.left=G+"px";this._selectionObj.style.top=B+"px";this._selectionObj.style.width=M+"px";this._selectionObj.style.height=D+"px";return H};dhtmlXGridObject.prototype._CreateSelection=function(C,B){if(this._selectionObj==null){var A=document.createElement("div");A.style.position="absolute";A.style.display="none";A.className="dhtmlxGrid_selection";this._selectionObj=A;this._selectionObj.onmousedown=function(A){A=A||event;if(A.button==2||(_isMacOS&&A.ctrlKey))return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",A])};this._selectionObj.oncontextmenu=function(A){(A||event).cancelBubble=true;return false};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=C+"px";this._selectionObj.style.top=B+"px";this._selectionObj.startX=C;this._selectionObj.startY=B};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj)this._selectionObj.style.display=""};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj)this._selectionObj.style.display="none";this._selectionArea=null};dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._selectionArea!=null){var A=new Array();if(this._mathSerialization)this._agetm="getMathValue";else if(this._strictText)this._agetm="getTitle";else this._agetm="getValue";for(var C=this._selectionArea.LeftTopRow;C<=this._selectionArea.RightBottomRow;C++){var B=this._serializeRowToCVS(this.rowsBuffer[C],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);if(!this._csvAID)A[A.length]=B.substr(B.indexOf(this.csv.cell)+1);else A[A.length]=B}A=A.join(this._CSVRowDelimiter);this.toClipBoard(A)}};dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){var K=this.fromClipBoard();if(this._selectionArea!=null)var L=this._selectionArea.LeftTopRow,I=this._selectionArea.LeftTopCol;else if(this.cell!=null&&!this.editor)L=this.getRowIndex(this.cell.parentNode.idd),I=this.cell._cellIndex;else return false;K=this.csvParser.unblock(K,this.csv.cell,this.csv.row);var J=L+K.length,M=I+K[0].length;if(M>this._cCount)M=this._cCount;var E=0;for(var G=L;G<J;G++){var F=this.render_row(G);if(F==-1)continue;var C=0;for(var D=I;D<M;D++){var H=this.cells3(F,D);if(H.isDisabled()){C++;continue}if(this._onEditUndoRedo)this._onEditUndoRedo(2,F.idd,D,K[E][C],H.getValue());if(H.combo){var A=H.combo.values;for(var B=0;B<A.length;B++)if(K[E][C]==A[B]){H.setValue(H.combo.keys[B]);A=null;break}if(A!=null&&H.editable)H.setValue(K[E][C++]);else C++}else H[H.setImage?"setLabel":"setValue"](K[E][C++]);H.cell.wasChanged=true}this.callEvent("onRowPaste",[F.idd]);E++}};dhtmlXGridObject.prototype.getSelectedBlock=function(){if(this._selectionArea)return this._selectionArea;else if(this.getSelectedRowId()!==null)return{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()};else return null};dhtmlXGridObject.prototype.enablePaging=function(C,D,F,E,B,A){this._pgn_parentObj=typeof(E)=="string"?document.getElementById(E):E;this._pgn_recInfoParentObj=typeof(A)=="string"?document.getElementById(A):A;this.pagingOn=C;this.showRecInfo=B;this.rowsBufferOutSize=parseInt(D);this.currentPage=1;this.pagesInGroup=parseInt(F);this._init_pgn_events();this.setPagingSkin("default")};dhtmlXGridObject.prototype.setXMLAutoLoading=function(B,A){this.xmlFileUrl=B;this._dpref=A};dhtmlXGridObject.prototype.changePageRelative=function(A){this.changePage(this.currentPage+A)};dhtmlXGridObject.prototype.changePage=function(A){if(arguments.length==0)A=this.currentPage||0;A=parseInt(A);A=Math.max(1,Math.min(A,Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)));if(!this.callEvent("onBeforePageChanged",[this.currentPage,A]))return;this.currentPage=parseInt(A);this._reset_view();this._fixAlterCss();this.callEvent("onPageChanged",this.getStateOfView())};dhtmlXGridObject.prototype.setPagingSkin=function(A){this._pgn_skin=this["_pgn_"+A];if(A=="toolbar")this._pgn_skin_tlb=arguments[1]};dhtmlXGridObject.prototype.setPagingTemplates=function(B,A){this._pgn_templateA=this._pgn_template_compile(B);this._pgn_templateB=this._pgn_template_compile(A);this._page_skin_update()};dhtmlXGridObject.prototype._page_skin_update=function(A){if(!this.pagesInGroup)this.pagesInGroup=Math.ceil(Math.min(5,this.rowsBuffer.length/this.rowsBufferOutSize));var B=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(B&&B<this.currentPage)return this.changePage(B);if(this.pagingOn&&this._pgn_skin)this._pgn_skin.apply(this,this.getStateOfView())};dhtmlXGridObject.prototype._init_pgn_events=function(A){this.attachEvent("onXLE",this._page_skin_update);this.attachEvent("onClearAll",this._page_skin_update);this.attachEvent("onPageChanged",this._page_skin_update);this.attachEvent("onGridReconstructed",this._page_skin_update);this._init_pgn_events=function(){}};dhtmlXGridObject.prototype._pgn_default=function(C,B,D){if(!this.pagingBlock){this.pagingBlock=document.createElement("DIV");this.pagingBlock.className="pagingBlock";this.recordInfoBlock=document.createElement("SPAN");this.recordInfoBlock.className="recordsInfoBlock";if(!this._pgn_parentObj)return;this._pgn_parentObj.appendChild(this.pagingBlock);if(this._pgn_recInfoParentObj&&this.showRecInfo)this._pgn_recInfoParentObj.appendChild(this.recordInfoBlock);if(!this._pgn_templateA){this._pgn_templateA=this._pgn_template_compile("[prevpages:&lt;:&nbsp;] [currentpages:,&nbsp;] [nextpages:&gt;:&nbsp;]");this._pgn_templateB=this._pgn_template_compile("Results <b>[from]-[to]</b> of <b>[total]</b>")}}var A=this.getStateOfView();this.pagingBlock.innerHTML=this._pgn_templateA.apply(this,A);this.recordInfoBlock.innerHTML=this._pgn_templateB.apply(this,A);this._pgn_template_active(this.pagingBlock);this._pgn_template_active(this.recordInfoBlock);this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_block=function(D){var C=Math.floor((this.currentPage-1)/this.pagesInGroup)*this.pagesInGroup,A=Math.min(Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize),C+this.pagesInGroup),B=[];for(var E=C+1;E<=A;E++)if(E==this.currentPage)B.push("<a class='dhx_not_active'><b>"+E+"</b></a>");else B.push("<a onclick='this.grid.changePage("+E+");return false;'>"+E+"</a>");return B.join(D)};dhtmlXGridObject.prototype._pgn_link=function(D,A,B){if(D=="prevpages"||D=="prev"){if(this.currentPage==1)return B;return"<a onclick='this.grid.changePageRelative(-1*"+(D=="prev"?"1":"this.grid.pagesInGroup")+");return false;'>"+A+"</a>"}if(D=="nextpages"||D=="next"){if(this.rowsBuffer.length/this.rowsBufferOutSize<=this.currentPage)return B;if(this.rowsBuffer.length/(this.rowsBufferOutSize*(D=="next"?"1":this.pagesInGroup))<=1)return B;return"<a onclick='this.grid.changePageRelative("+(D=="next"?"1":"this.grid.pagesInGroup")+");return false;'>"+A+"</a>"}if(D=="current"){var C=this.currentPage+(A?parseInt(A):0);if(C<1||Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)<C)return B;return"<a "+(C==this.currentPage?"class='dhx_active_page_link' ":"")+"onclick='this.grid.changePage("+C+");return false;'>"+C+"</a>"}return A};dhtmlXGridObject.prototype._pgn_template_active=function(B){var A=B.getElementsByTagName("A");if(A)for(var C=0;C<A.length;C++)A[C].grid=this};dhtmlXGridObject.prototype._pgn_template_compile=function(A){A=A.replace(/\[([^\]]*)\]/g,function(B,A){A=A.split(":");switch(A[0]){case"from":return"\"+(arguments[1]*1+(arguments[2]*1?1:0))+\"";case"total":return"\"+arguments[3]+\"";case"to":return"\"+arguments[2]+\"";case"current":case"prev":case"next":case"prevpages":case"nextpages":return"\"+this._pgn_link('"+A[0]+"','"+A[1]+"','"+A[2]+"')+\"";case"currentpages":return"\"+this._pgn_block('"+A[1]+"')+\""}});return new Function("return \""+A+"\";")};dhtmlXGridObject.prototype.i18n.paging={results:"Results",records:"Records from ",to:" to ",page:"Page ",perpage:"rows per page",first:"To first Page",previous:"Previous Page",found:"Found records",next:"Next Page",last:"To last Page",of:" of ",notfound:"No Records Found"};dhtmlXGridObject.prototype.setPagingWTMode=function(C,A,B,D){this._WTDef=[C,A,B,D]};dhtmlXGridObject.prototype._pgn_bricks=function(H,I,L){var J=(this.skin_name||"").split("_")[1],E="";if(J=="light"||J=="modern"||J=="skyblue")E="_"+J;this.pagerElAr=new Array();this.pagerElAr["pagerCont"]=document.createElement("DIV");this.pagerElAr["pagerBord"]=document.createElement("DIV");this.pagerElAr["pagerLine"]=document.createElement("DIV");this.pagerElAr["pagerBox"]=document.createElement("DIV");this.pagerElAr["pagerInfo"]=document.createElement("DIV");this.pagerElAr["pagerInfoBox"]=document.createElement("DIV");var D=(this.globalBox||this.objBox);this.pagerElAr["pagerCont"].style.width=D.clientWidth+"px";this.pagerElAr["pagerCont"].style.overflow="hidden";this.pagerElAr["pagerCont"].style.clear="both";this.pagerElAr["pagerBord"].className="dhx_pbox"+E;this.pagerElAr["pagerLine"].className="dhx_pline"+E;this.pagerElAr["pagerBox"].style.clear="both";this.pagerElAr["pagerInfo"].className="dhx_pager_info"+E;this.pagerElAr["pagerCont"].appendChild(this.pagerElAr["pagerBord"]);this.pagerElAr["pagerCont"].appendChild(this.pagerElAr["pagerLine"]);this.pagerElAr["pagerCont"].appendChild(this.pagerElAr["pagerInfo"]);this.pagerElAr["pagerLine"].appendChild(this.pagerElAr["pagerBox"]);this.pagerElAr["pagerInfo"].appendChild(this.pagerElAr["pagerInfoBox"]);this._pgn_parentObj.innerHTML="";this._pgn_parentObj.appendChild(this.pagerElAr["pagerCont"]);if(this.rowsBuffer.length>0){var A=20,K=22;if(H>this.pagesInGroup){var G=document.createElement("DIV"),B=document.createElement("DIV");G.className="dhx_page"+E;B.innerHTML="&larr;";G.appendChild(B);this.pagerElAr["pagerBox"].appendChild(G);var C=this;G.pgnum=(Math.ceil(H/this.pagesInGroup)-1)*this.pagesInGroup;G.onclick=function(){C.changePage(this.pgnum)};A+=K}for(var F=1;F<=this.pagesInGroup;F++){G=document.createElement("DIV"),B=document.createElement("DIV");G.className="dhx_page"+E;pageNumber=((Math.ceil(H/this.pagesInGroup)-1)*this.pagesInGroup)+F;if(pageNumber>Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize))break;B.innerHTML=pageNumber;G.appendChild(B);if(H==pageNumber){G.className+=" dhx_page_active"+E;B.className="dhx_page_active"+E}else{C=this;G.pgnum=pageNumber;G.onclick=function(){C.changePage(this.pgnum)}}A+=(parseInt(K/3)*pageNumber.toString().length)+15;B.style.width=(parseInt(K/3)*pageNumber.toString().length)+8+"px";this.pagerElAr["pagerBox"].appendChild(G)}if(Math.ceil(H/this.pagesInGroup)*this.pagesInGroup<Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize)){G=document.createElement("DIV"),B=document.createElement("DIV");G.className="dhx_page"+E;B.innerHTML="&rarr;";G.appendChild(B);this.pagerElAr["pagerBox"].appendChild(G);C=this;G.pgnum=(Math.ceil(H/this.pagesInGroup)*this.pagesInGroup)+1;G.onclick=function(){C.changePage(this.pgnum)};A+=K}this.pagerElAr["pagerLine"].style.width=A+"px"}if(this.rowsBuffer.length>0&&this.showRecInfo)this.pagerElAr["pagerInfoBox"].innerHTML=this.i18n.paging.records+(I+1)+this.i18n.paging.to+L+this.i18n.paging.of+this.rowsBuffer.length;else if(this.rowsBuffer.length==0){this.pagerElAr["pagerLine"].parentNode.removeChild(this.pagerElAr["pagerLine"]);this.pagerElAr["pagerInfoBox"].innerHTML=this.i18n.paging.notfound}this.pagerElAr["pagerBox"].appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.pagerElAr["pagerBord"].appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.pagerElAr["pagerCont"].appendChild(document.createElement("SPAN")).innerHTML="&nbsp;";this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_toolbar=function(C,B,E){if(!this.aToolBar)this.aToolBar=this._pgn_createToolBar();var D=Math.ceil(this.rowsBuffer.length/this.rowsBufferOutSize);if(this._WTDef[0]){this.aToolBar.enableItem("right");this.aToolBar.enableItem("rightabs");this.aToolBar.enableItem("left");this.aToolBar.enableItem("leftabs");if(this.currentPage>=D){this.aToolBar.disableItem("right");this.aToolBar.disableItem("rightabs")}if(this.currentPage==1){this.aToolBar.disableItem("left");this.aToolBar.disableItem("leftabs")}}if(this._WTDef[2]){var A=this;this.aToolBar.forEachListOption("pages",function(B){A.aToolBar.removeListOption("pages",B)});for(var F=0;F<D;F++)this.aToolBar.addListOption("pages","pages_"+(F+1),NaN,"button",this.i18n.paging.page+(F+1));this.aToolBar.setItemText("pages","<div style='width:100%;text-align:right'>"+this.i18n.paging.page+C+"</div>")}if(this._WTDef[1])if(!this.getRowsNum())this.aToolBar.setItemText("results",this.i18n.paging.notfound);else this.aToolBar.setItemText("results","<div style='width:100%;text-align:center'>"+this.i18n.paging.records+(B+1)+this.i18n.paging.to+E+"</div>");if(this._WTDef[3])this.aToolBar.setItemText("perpagenum","<div style='width:100%;text-align:right'>"+this.rowsBufferOutSize.toString()+" "+this.i18n.paging.perpage+"</div>");this.callEvent("onPaging",[])};dhtmlXGridObject.prototype._pgn_createToolBar=function(){this.aToolBar=new dhtmlXToolbarObject(this._pgn_parentObj,(this._pgn_skin_tlb||"dhx_blue"));if(!this._WTDef)this.setPagingWTMode(true,true,true,true);var B=this;this.aToolBar.attachEvent("onClick",function(A){A=A.split("_");switch(A[0]){case"leftabs":B.changePage(1);break;case"left":B.changePage(B.currentPage-1);break;case"rightabs":B.changePage(99999);break;case"right":B.changePage(B.currentPage+1);break;case"perpagenum":if(A[1]===this.undefined)return;B.rowsBufferOutSize=parseInt(A[1]);B.changePage();B.aToolBar.setItemText("perpagenum","<div style='width:100%;text-align:right'>"+A[1]+" "+B.i18n.paging.perpage+"</div>");break;case"pages":if(A[1]===this.undefined)return;B.changePage(A[1]);B.aToolBar.setItemText("pages","<div style='width:100%;text-align:right'>"+B.i18n.paging.page+A[1]+"</div>");break}});if(this._WTDef[0]){this.aToolBar.addButton("leftabs",NaN,"",this.imgURL+"ar_left_abs.gif",this.imgURL+"ar_left_abs_dis.gif");this.aToolBar.setWidth("leftabs","20");this.aToolBar.addButton("left",NaN,"",this.imgURL+"ar_left.gif",this.imgURL+"ar_left_dis.gif");this.aToolBar.setWidth("left","20")}if(this._WTDef[1]){this.aToolBar.addText("results",NaN,this.i18n.paging.results);this.aToolBar.setWidth("results","150");this.aToolBar.disableItem("results")}if(this._WTDef[0]){this.aToolBar.addButton("right",NaN,"",this.imgURL+"ar_right.gif",this.imgURL+"ar_right_dis.gif");this.aToolBar.setWidth("right","20");this.aToolBar.addButton("rightabs",NaN,"",this.imgURL+"ar_right_abs.gif",this.imgURL+"ar_right_abs_dis.gif");this.aToolBar.setWidth("rightabs","20")}if(this._WTDef[2]){this.aToolBar.addButtonSelect("pages",NaN,"select page",[],null,null,true,true);this.aToolBar.setWidth("pages","75")}var A;if(A=this._WTDef[3]){this.aToolBar.addButtonSelect("perpagenum",NaN,"select size",[],null,null,true,true);if(typeof A!="object")A=[5,10,15,20,25,30];for(var C=0;C<A.length;C++)this.aToolBar.addListOption("perpagenum","perpagenum_"+A[C],NaN,"button",A[C]+" "+this.i18n.paging.perpage);this.aToolBar.setWidth("perpagenum","135")}return this.aToolBar};dhtmlXGridObject.prototype.hidePivot=function(B){if(this._pgridCont){if(this._pgrid)this._pgrid.destructor();var A=this._pgridCont.parentNode;A.innerHTML="";if(A.parentNode==this.entBox)this.entBox.removeChild(A);this._pgrid=this._pgridSelect=this._pUNI=this._pgridCont=null}};dhtmlXGridObject.prototype.makePivot=function(H,B){B=B||{};this.hidePivot();if(!H){var H=document.createElement("DIV");H.style.cssText="position:absolute;top:0px;left:0px;background-color:white;";H.style.height=this.entBox.offsetHeight+"px";H.style.width=this.entBox.offsetWidth+"px";if(this.entBox.style.position!="absolute")this.entBox.style.position="relative";this.entBox.appendChild(H)}if(typeof(H)!="object")H=document.getElementById(H);if(B.column_list)this._column_list=B.column_list;else{this._column_list=[];for(var I=0;I<this.hdr.rows[1].cells.length;I++)this._column_list.push(this.hdr.rows[1].cells[I][_isIE?"innerText":"textContent"])}var A=this;H.innerHTML="<table cellspacing='0' cellpadding='0'><tr><td style='width:160px' align='center'></td><td>&nbsp;&nbsp;&nbsp;</td><td></td></tr></table><div></div>";var C=this.makePivotSelect(this._column_list);C.style.width="80px";C.onchange=function(){if(this.value!=-1)A._pivotS.value=this.value;else A._pivotS.value="";A._reFillPivotLists();A._renderPivot2()};var E=this.makePivotSelect(this._column_list);E.onchange=function(){if(this.value!=-1)A._pivotS.x=this.value;else A._pivotS.x="";A._reFillPivotLists();A._renderPivot()};var F=this.makePivotSelect(this._column_list);F.onchange=function(){if(this.value!=-1)A._pivotS.y=this.value;else A._pivotS.y="";A._reFillPivotLists();A._renderPivot()};var D=this.makePivotSelect(["Sum","Min","Max","Average","Count"],-1);D.style.width="70px";D.onchange=function(){if(this.value!=-1)A._pivotS.action=this.value;else A._pivotS.action=null;A._renderPivot2()};if(B.readonly)C.disabled=E.disabled=F.disabled=D.disabled=true;H.firstChild.rows[0].cells[0].appendChild(D);H.firstChild.rows[0].cells[0].appendChild(C);H.firstChild.rows[0].cells[2].appendChild(E);var G=H.childNodes[1];G.style.width=H.offsetWidth+"px";G.style.height=H.offsetHeight-20+"px";G.style.overflow="hidden";this._pgridCont=G;this._pgridSelect=[C,E,F,D];this._pData=this._fetchPivotData();this._pUNI=[];this._pivotS={action:(B.action||"0"),value:(typeof B.value!="undefined"?(B.value||"0"):null),x:(typeof B.x!="undefined"?(B.x||"0"):null),y:(typeof B.y!="undefined"?(B.y||"0"):null)};C.value=this._pivotS.value;E.value=this._pivotS.x;F.value=this._pivotS.y;D.value=this._pivotS.action;A._reFillPivotLists();this._renderPivot()};dhtmlXGridObject.prototype._fetchPivotData=function(){var C=[];for(var D=0;D<this._cCount;D++){var A=[];for(var B=0;B<this.rowsCol.length;B++){if(this.rowsCol[B]._cntr)continue;A.push(this.cells2(B,D).getValue())}C.push(A)}return C};dhtmlXGridObject.prototype._renderPivot=function(){if(_isIE)this._pgridSelect[2].removeNode(true);if(this._pgrid)this._pgrid.destructor();this._pgrid=new dhtmlXGridObject(this._pgridCont);this._pgrid.setImagePath(this.imgURL);this._pgrid.attachEvent("onBeforeSelect",function(){return false});if(this._pivotS.x){var C=this._getUniList(this._pivotS.x),B=[160];for(var D=0;D<C.length;D++)B.push(100);C=[""].concat(C);this._pgrid.setHeader(C);this._pgrid.setInitWidths(B.join(","))}else{this._pgrid.setHeader("");this._pgrid.setInitWidths("160")}this._pgrid.init();this._pgrid.setEditable(false);this._pgrid.setSkin(this.entBox.className.replace("gridbox gridbox_",""));var A=this._pgrid.hdr.rows[1].cells[0];if(A.firstChild&&A.firstChild.tagName=="DIV")A=A.firstChild;A.appendChild(this._pgridSelect[2]);this._pgrid.setSizes();if(this._pivotS.y){C=this._getUniList(this._pivotS.y);for(D=0;D<C.length;D++)this._pgrid.addRow(this._pgrid.uid(),[C[D]],-1)}else this._pgrid.addRow(1,"not ready",1);this._renderPivot2()};dhtmlXGridObject.prototype._pivot_action_0=function(D,B,C,J,G,E){var A=0,F=E[D],H=E[B],I=E[C];for(var K=F.length-1;K>=0;K--)if(F[K]==J&&H[K]==G)A+=this.parseFloat(I[K]);return A};dhtmlXGridObject.prototype._pivot_action_1=function(C,A,B,I,F,D){ret=9999999999;var E=D[C],G=D[A],H=D[B];for(var J=E.length-1;J>=0;J--)if(E[J]==I&&G[J]==F)ret=Math.min(this.parseFloat(H[J]),ret);if(ret==9999999999)ret="";return ret};dhtmlXGridObject.prototype._pivot_action_2=function(C,A,B,I,F,D){ret=-9999999999;var E=D[C],G=D[A],H=D[B];for(var J=E.length-1;J>=0;J--)if(E[J]==I&&G[J]==F)ret=Math.max(this.parseFloat(H[J]),ret);if(ret==-9999999999)ret="";return ret};dhtmlXGridObject.prototype._pivot_action_3=function(E,B,D,K,G,F){var A=0,C=0,H=F[E],I=F[B],J=F[D];for(var L=H.length-1;L>=0;L--)if(H[L]==K&&I[L]==G){A+=this.parseFloat(J[L]);C++}return C?A/C:""};dhtmlXGridObject.prototype._pivot_action_4=function(E,B,D,K,G,F){var A=0,C=0,H=F[E],I=F[B],J=F[D];for(var L=H.length-1;L>=0;L--)if(H[L]==K&&I[L]==G)A++;return A};dhtmlXGridObject.prototype.parseFloat=function(A){A=parseFloat(A);if(isNaN(A))return 0;return A};dhtmlXGridObject.prototype._renderPivot2=function(){if(!(this._pivotS.x&&this._pivotS.y&&this._pivotS.value&&this._pivotS.action))return;var A=this["_pivot_action_"+this._pivotS.action],E=this._getUniList(this._pivotS.x),C=this._getUniList(this._pivotS.y);for(var D=0;D<E.length;D++)for(var B=0;B<C.length;B++)this._pgrid.cells2(B,D+1).setValue(Math.round(A(this._pivotS.x,this._pivotS.y,this._pivotS.value,E[D],C[B],this._pData)*100)/100)};dhtmlXGridObject.prototype._getUniList=function(A){if(!this._pUNI[A]){var B={},C=[];for(var E=this._pData[A].length-1;E>=0;E--)B[this._pData[A][E]]=true;for(var D in B)if(B[D]===true)C.push(D);this._pUNI[A]=C.sort()}return this._pUNI[A]};dhtmlXGridObject.prototype._fillPivotList=function(C,B,D,A){if(!D){D={};A=-1}C.innerHTML="";C.options[C.options.length]=new Option("-select-",-1);for(var E=0;E<B.length;E++){if(D[E]||B[E]===null)continue;C.options[C.options.length]=new Option(B[E],E)}C.value=parseInt(A)};dhtmlXGridObject.prototype._reFillPivotLists=function(){var C=[],A=[];for(var E=0;E<3;E++){C.push(this._pgridSelect[E]);A.push(C[E].value)}var B=this._reFfillPivotLists,D={};D[A[1]]=D[A[2]]=true;this._fillPivotList(C[0],this._column_list,D,A[0]);D={};D[A[0]]=D[A[2]]=true;this._fillPivotList(C[1],this._column_list,D,A[1]);D={};D[A[1]]=D[A[0]]=true;this._fillPivotList(C[2],this._column_list,D,A[2]);this._reFfillPivotLists=B};dhtmlXGridObject.prototype.makePivotSelect=function(A,C){var B=document.createElement("SELECT");this._fillPivotList(B,A,C);B.style.cssText="width:150px;height:20px;font-family:Tahoma;font-size:8pt;font-weight:normal;";return B};dhtmlXGridObject.prototype.setRowspan=function(E,A,F){var D=this[this._bfs_cells?"_bfs_cells":"cells"](E,A).cell,C=this.rowsAr[E];if(D.rowSpan&&D.rowSpan!=1){var G=C.nextSibling;for(var K=1;K<D.rowSpan;K++){var B=G.childNodes[G._childIndexes[D._cellIndex+1]],J=document.createElement("TD");J.innerHTML="&nbsp;";J._cellIndex=D._cellIndex;J._clearCell=true;if(B)B.parentNode.insertBefore(J,B);else G.parentNode.appendChild(J);this._shiftIndexes(G,D._cellIndex,-1);G=G.nextSibling}}D.rowSpan=F;if(!this._h2)C=C.nextSibling||this.rowsCol[this.rowsCol._dhx_find(C)+1];else C=this.rowsAr[this._h2.get[C.idd].parent.childs[this._h2.get[C.idd].index+1].id];var H=[];for(K=1;K<F;K++){var I=null;if(this._fake&&!this._realfake)I=this._bfs_cells3(C,A).cell;else I=this.cells3(C,A).cell;this._shiftIndexes(C,D._cellIndex,1);if(I)I.parentNode.removeChild(I);H.push(C);if(!this._h2)C=C.nextSibling||this.rowsCol[this.rowsCol._dhx_find(C)+1];else{C=this._h2.get[C.idd].parent.childs[this._h2.get[C.idd].index+1];if(C)C=this.rowsAr[C.id]}}this.rowsAr[E]._rowSpan=this.rowsAr[E]._rowSpan||{};this.rowsAr[E]._rowSpan[A]=H;if(this._fake&&!this._realfake&&A<this._fake._cCount)this._fake.setRowspan(E,A,F)};dhtmlXGridObject.prototype._shiftIndexes=function(B,D,A){if(!B._childIndexes){B._childIndexes=new Array();for(var C=0;C<B.childNodes.length;C++)B._childIndexes[C]=C}for(C=0;C<B._childIndexes.length;C++)if(C>D)B._childIndexes[C]=B._childIndexes[C]-A};dhtmlXGridObject.prototype.enableRowspan=function(){this._erspan=true;this.enableRowspan=function(){};this.attachEvent("onAfterSorting",function(){if(this._dload)return;for(var I=1;I<this.obj.rows.length;I++)if(this.obj.rows[I]._rowSpan){var H=this.obj.rows[I];for(var F in H._rowSpan){var G=H,D=G._rowSpan[F];for(var E=0;E<D.length;E++){if(G.nextSibling)G.parentNode.insertBefore(D[E],G.nextSibling);else G.parentNode.appendChild(D[E]);if(this._fake){var C=this._fake.rowsAr[G.idd],B=this._fake.rowsAr[D[E].idd];if(C.nextSibling)C.parentNode.insertBefore(B,C.nextSibling);else C.parentNode.appendChild(B);this._correctRowHeight(G.idd)}G=G.nextSibling}}}var A=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray();this.rowsCol.stablesort=A;for(I=1;I<this.obj.rows.length;I++)this.rowsCol.push(this.obj.rows[I])});this.attachEvent("onXLE",function(C,A,B,E){for(var H=0;H<this.rowsBuffer.length;H++){var G=this.render_row(H),D=G.childNodes;for(var F=0;F<D.length;F++)if(D[F]._attrs["rowspan"])this.setRowspan(G.idd,F,D[F]._attrs["rowspan"])}})};dhtmlXGridObject.prototype._init_point_bspl=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){if(this._split_later)this.splitAt(this._split_later);this._init_point=this._init_point_bspl;if(this._init_point)this._init_point()};dhtmlXGridObject.prototype.splitAt=function(M){if(!this.obj.rows[0])return this._split_later=M;M=parseInt(M);var A=document.createElement("DIV");this.entBox.appendChild(A);var F=document.createElement("DIV");this.entBox.appendChild(F);for(var J=this.entBox.childNodes.length-3;J>=0;J--)F.insertBefore(this.entBox.childNodes[J],F.firstChild);this.entBox.style.position="relative";this.globalBox=this.entBox;this.entBox=F;F.grid=this;A.style.cssText+="border:0px solid red !important;";F.style.cssText+="border:0px solid red !important;";F.style.top="0px";F.style.position="absolute";A.style.position="absolute";A.style.top="0px";A.style.left="0px";A.style.zIndex=11;F.style.height=A.style.height=this.globalBox.clientHeight;this._fake=new dhtmlXGridObject(A);this._fake.setSkin("not_existing_skin");this.globalBox=this._fake.globalBox=this.globalBox;this._fake._fake=this;this._fake._realfake=true;this._treeC=this.cellType._dhx_find("tree");this._fake.delim=this.delim;this._fake.customGroupFormat=this.customGroupFormat;this._fake.imgURL=this.imgURL;this._fake._customSorts=this._customSorts;this._fake.noHeader=this.noHeader;this._fake._enbTts=this._enbTts;this._fake._htkebl=this._htkebl;this._fake.clists=this.clists;this._fake.fldSort=new Array();this._fake.selMultiRows=this.selMultiRows;this._fake.multiLine=this.multiLine;if(this.multiLine||this._erspan){this.attachEvent("onCellChanged",this._correctRowHeight);this.attachEvent("onRowAdded",this._correctRowHeight);var N=function(){this.forEachRow(function(A){this._correctRowHeight(A)})};this.attachEvent("onPageChanged",N);this.attachEvent("onXLE",N);this.attachEvent("onResizeEnd",N);if(!this._ads_count)this.attachEvent("onAfterSorting",N);this.attachEvent("onDistributedEnd",N)}this.attachEvent("onGridReconstructed",function(){this._fake.objBox.scrollTop=this.objBox.scrollTop});this._fake.loadedKidsHash=this.loadedKidsHash;if(this._h2)this._fake._h2=this._h2;this._fake._dInc=this._dInc;var D=[[],[],[],[],[],[],[]],K=["hdrLabels","initCellWidth","cellType","cellAlign","cellVAlign","fldSort","columnColor"],O=["setHeader","setInitWidths","setColTypes","setColAlign","setColVAlign","setColSorting","setColumnColor"];this._fake.callEvent=function(){this._fake._split_event=true;if(arguments[0]=="onGridReconstructed")this._fake.callEvent.apply(this,arguments);return this._fake.callEvent.apply(this._fake,arguments);this._fake._split_event=false};if(this._elmn)this._fake.enableLightMouseNavigation(true);if(this.__cssEven||this._cssUnEven)this._fake.attachEvent("onGridReconstructed",function(){this._fixAlterCss()});this._fake._cssEven=this._cssEven;this._fake._cssUnEven=this._cssUnEven;this._fake._cssSP=this._cssSP;this._fake.isEditable=this.isEditable;this._fake._edtc=this._edtc;if(this._sst)this._fake.enableStableSorting(true);this._fake._sclE=this._sclE;this._fake._dclE=this._dclE;this._fake._f2kE=this._f2kE;this._fake._maskArr=this._maskArr;this._fake._dtmask=this._dtmask;this._fake.combos=this.combos;var E=0,C=this.globalBox.offsetWidth;for(J=0;J<M;J++){for(var H=0;H<K.length;H++){if(this[K[H]])D[H][J]=this[K[H]][J];if(typeof D[H][J]=="string")D[H][J]=D[H][J].replace(new RegExp("\\"+this.delim,"g"),"\\"+this.delim)}if(_isFF)D[1][J]=D[1][J]*1;if(this.cellWidthType=="%"){D[1][J]=Math.round(parseInt(this[K[1]][J])*C/100);E+=D[1][J]}else E+=parseInt(this[K[1]][J]);this.setColumnHidden(J,true)}for(H=0;H<K.length;H++){var L=D[H].join(this.delim);if(O[H]!="setHeader"){if(L!="")this._fake[O[H]](L)}else this._fake[O[H]](L,null,this._hstyles)}this._fake._strangeParams=this._strangeParams;this._fake._drsclmn=this._drsclmn;E=Math.min(this.globalBox.offsetWidth,E);F.style.left=E+"px";A.style.width=E+"px";F.style.width=Math.max(this.globalBox.offsetWidth-E,0);if(this._ecspn)this._fake._ecspn=true;this._fake.init();if(this.dragAndDropOff)this.dragger.addDragLanding(this._fake.entBox,this);this._fake.objBox.style.overflow="hidden";this._fake.objBox.style.overflowX="scroll";this._fake._srdh=this._srdh||20;this._fake._srnd=this._srnd;function I(D,B){B.style.whiteSpace="";var C=B.nextSibling,A=B.parentNode;D.parentNode.insertBefore(B,D);if(!C)A.appendChild(D);else A.insertBefore(D,C);var E=D.style.display;D.style.display=B.style.display;B.style.display=E}function B(K,L,N,O){var F=(new Array(M)).join(this.delim),C=[];if(K==2)for(var J=0;J<M;J++){var Q=L[K-1].cells[L[K-1]._childIndexes?L[K-1]._childIndexes[J]:J];if(Q.rowSpan&&Q.rowSpan>1){C[Q._cellIndex]=Q.rowSpan-1;O[K-1].cells[O[K-1]._childIndexes?O[K-1]._childIndexes[J]:J].rowSpan=Q.rowSpan;Q.rowSpan=1}}for(K;K<L.length;K++){this._fake.attachHeader(F,null,N);O=O||this._fake.ftr.childNodes[0].rows;var D=M,B=0;for(var H=0;H<D;H++){if(C[H]){C[H]=C[H]-1;if(_isIE||(_isFF&&_FFrv>=1.9)||_isOpera){var G=document.createElement("TD");if(_isFF)G.style.display="none";L[K].insertBefore(G,L[K].cells[0])}B++;continue}var E=O[K].cells[H-B],A=L[K].cells[H-(_isIE?0:B)],P=A.rowSpan;I(E,A);if(P>1){C[H]=P-1;A.rowSpan=P}if(O[K].cells[H].colSpan>1){L[K].cells[H].colSpan=O[K].cells[H].colSpan;D-=O[K].cells[H].colSpan-1;for(J=1;J<O[K].cells[H].colSpan;J++)O[K].removeChild(O[K].cells[H+1])}}}}if(this.hdr.rows.length>2)B.call(this,2,this.hdr.rows,"_aHead",this._fake.hdr.rows);if(this.ftr){B.call(this,1,this.ftr.childNodes[0].rows,"_aFoot");this._fake.ftr.parentNode.style.bottom=(_isFF?2:1)+"px"}if(this.saveSizeToCookie){this.saveSizeToCookie=function(B,A){if(this._realfake)return this._fake.saveSizeToCookie.apply(this._fake,arguments);if(!B)B=this.entBox.id;var D=new Array(),C="cellWidthPX";for(var E=0;E<this[C].length;E++)if(E<M)D[E]=this._fake[C][E];else D[E]=this[C][E];D=D.join(",");this.setCookie(B,A,0,D);D=(this.initCellWidth||(new Array)).join(",");this.setCookie(B,A,1,D);return true};this.loadSizeFromCookie=function(C){if(!C)C=this.entBox.id;var E=this._getCookie(C,1);if(!E)return;this.initCellWidth=E.split(",");var E=this._getCookie(C,0),D="cellWidthPX";this.cellWidthType="px";var A=0;if((E)&&(E.length)){E=E.split(",");for(var F=0;F<E.length;F++)if(F<M){this._fake[D][F]=E[F];A+=E[F]*1}else this[D][F]=E[F]}this._fake.entBox.style.width=A+"px";this._fake.objBox.style.width=A+"px";var B=this.globalBox.childNodes[1];B.style.left=A-(_isFF?0:0)+"px";if(this.ftr)this.ftr.style.left=A-(_isFF?0:0)+"px";B.style.width=this.globalBox.offsetWidth-A+"px";this.setSizes();return true};this._fake.onRSE=this.onRSE}this.setCellTextStyleA=this.setCellTextStyle;this.setCellTextStyle=function(A,C,B){if(C<M)this._fake.setCellTextStyle(A,C,B);this.setCellTextStyleA(A,C,B)};this.setRowTextBoldA=this.setRowTextBold;this.setRowTextBold=function(A){this.setRowTextBoldA(A);this._fake.setRowTextBold(A)};this.setRowColorA=this.setRowColor;this.setRowColor=function(A,B){this.setRowColorA(A,B);this._fake.setRowColor(A,B)};this.setRowHiddenA=this.setRowHidden;this.setRowHidden=function(A,B){this.setRowHiddenA(A,B);this._fake.setRowHidden(A,B)};this.setRowTextNormalA=this.setRowTextNormal;this.setRowTextNormal=function(A){this.setRowTextNormalA(A);this._fake.setRowTextNormal(A)};this.getChangedRows=function(C){var A=new Array();function B(C){for(var B=0;B<C.childNodes.length;B++)if(C.childNodes[B].wasChanged)return A[A.length]=C.idd}this.forEachRow(function(D){var F=this.rowsAr[D],E=this._fake.rowsAr[D];if(F.tagName!="TR"||E.tagName!="TR")return;if(C&&F._added)A[A.length]=F.idd;else if(!B(F))B(E)});return A.join(this.delim)};this.setRowTextStyleA=this.setRowTextStyle;this.setRowTextStyle=function(A,B){this.setRowTextStyleA(A,B);if(this._fake.rowsAr[A])this._fake.setRowTextStyle(A,B)};this.lockRowA=this.lockRow;this.lockRow=function(A,B){this.lockRowA(A,B);this._fake.lockRow(A,B)};this.getColWidth=function(A){if(A<M)return parseInt(this._fake.cellWidthPX[A]);else return parseInt(this.cellWidthPX[A])};this.getColumnLabel=function(A){return this._fake.getColumnLabel.apply(((A<M)?this._fake:this),arguments)};this.setColWidthA=this._fake.setColWidthA=this.setColWidth;this.setColWidth=function(B,A){B=B*1;if(B<M)this._fake.setColWidthA(B,A);else this.setColWidthA(B,A);if((B+1)<=M)this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth,this._fake.obj.offsetWidth))};this.adjustColumnSizeA=this.adjustColumnSize;this.setColumnLabelA=this.setColumnLabel;this.setColumnLabel=function(E,C,D,B){var A=this;if(E<M)A=this._fake;return this.setColumnLabelA.apply(A,[E,C,D,B])};this.adjustColumnSize=function(B,A){if(B<M){if(_isIE)this._fake.obj.style.tableLayout="";this._fake.adjustColumnSize(B,A);if(_isIE)this._fake.obj.style.tableLayout="fixed";this._fake._correctSplit()}else return this.adjustColumnSizeA(B,A)};var G="cells";this._bfs_cells=this[G];this[G]=function(){if(arguments[1]<M)return this._fake.cells.apply(this._fake,arguments);else return this._bfs_cells.apply(this,arguments)};this._bfs_isColumnHidden=this.isColumnHidden;this.isColumnHidden=function(){if(parseInt(arguments[0])<M)return this._fake.isColumnHidden.apply(this._fake,arguments);else return this._bfs_isColumnHidden.apply(this,arguments)};this._bfs_setColumnHidden=this.setColumnHidden;this.setColumnHidden=function(){if(parseInt(arguments[0])<M){this._fake.setColumnHidden.apply(this._fake,arguments);return this._fake._correctSplit()}else return this._bfs_setColumnHidden.apply(this,arguments)};G="cells2";this._bfs_cells2=this[G];this[G]=function(){if(arguments[1]<M)return this._fake.cells2.apply(this._fake,arguments);else return this._bfs_cells2.apply(this,arguments)};G="cells3";this._bfs_cells3=this[G];this[G]=function(B,A){if(arguments[1]<M&&this._fake.rowsAr[arguments[0].idd]){if(this._fake.rowsAr[B.idd]&&this._fake.rowsAr[B.idd].childNodes.length==0)return this._bfs_cells3.apply(this,arguments);arguments[0]=arguments[0].idd;return this._fake.cells.apply(this._fake,arguments)}else return this._bfs_cells3.apply(this,arguments)};G="changeRowId";this._bfs_changeRowId=this[G];this[G]=function(){this._bfs_changeRowId.apply(this,arguments);if(this._fake.rowsAr[arguments[0]])this._fake.changeRowId.apply(this._fake,arguments)};this._fake.getRowById=function(A){var B=this.rowsAr[A];if(!B&&this._fake.rowsAr[A])B=this._fake.getRowById(A);if(B){if(B.tagName!="TR"){for(var C=0;C<this.rowsBuffer.length;C++)if(this.rowsBuffer[C]&&this.rowsBuffer[C].idd==A)return this.render_row(C);if(this._h2)return this.render_row(null,B.idd)}return B}return null};if(this.collapseKids){this._fake["_bfs_collapseKids"]=this.collapseKids;this._fake["collapseKids"]=function(){return this._fake["collapseKids"].apply(this._fake,[this._fake.rowsAr[arguments[0].idd]])};this["_bfs_collapseKids"]=this.collapseKids;this["collapseKids"]=function(){var A=this["_bfs_collapseKids"].apply(this,arguments);this._fake._h2syncModel();if(!this._cssSP)this._fake._fixAlterCss()};this._fake["_bfs_expandKids"]=this.expandKids;this._fake["expandKids"]=function(){this._fake["expandKids"].apply(this._fake,[this._fake.rowsAr[arguments[0].idd]]);if(!this._cssSP)this._fake._fixAlterCss()};this["_bfs_expandAll"]=this.expandAll;this["expandAll"]=function(){this._bfs_expandAll();this._fake._h2syncModel();if(!this._cssSP)this._fake._fixAlterCss()};this["_bfs_collapseAll"]=this.collapseAll;this["collapseAll"]=function(){this._bfs_collapseAll();this._fake._h2syncModel();if(!this._cssSP)this._fake._fixAlterCss()};this["_bfs_expandKids"]=this.expandKids;this["expandKids"]=function(){var A=this["_bfs_expandKids"].apply(this,arguments);this._fake._h2syncModel();if(!this._cssSP)this._fake._fixAlterCss()};this._fake._h2syncModel=function(){if(this._fake.pagingOn)this._fake._renderSort();else this._renderSort()};this._updateTGRState=function(A){return this._fake._updateTGRState(A)}}if(this._elmnh){this._setRowHoverA=this._fake._setRowHoverA=this._setRowHover;this._unsetRowHoverA=this._fake._unsetRowHoverA=this._unsetRowHover;this._setRowHover=this._fake._setRowHover=function(){var A=this.grid;A._setRowHoverA.apply(this,arguments);var B=(_isIE?event.srcElement:arguments[0].target);B=A._fake.rowsAr[A.getFirstParentOfType(B,"TD").parentNode.idd];if(B)A._fake._setRowHoverA.apply(A._fake.obj,[{target:B.childNodes[0]},arguments[1]])};this._unsetRowHover=this._fake._unsetRowHover=function(){if(arguments[1])var A=this;else A=this.grid;A._unsetRowHoverA.apply(this,arguments);A._fake._unsetRowHoverA.apply(A._fake.obj,arguments)};this._fake.enableRowsHover(true,this._hvrCss);this.enableRowsHover(false);this.enableRowsHover(true,this._fake._hvrCss)}this._updateTGRState=function(A){if(!A.update||A.id==0)return;if(this.rowsAr[A.id].imgTag)this.rowsAr[A.id].imgTag.src=this.imgURL+A.state+".gif";if(this._fake.rowsAr[A.id]&&this._fake.rowsAr[A.id].imgTag)this._fake.rowsAr[A.id].imgTag.src=this.imgURL+A.state+".gif";A.update=false};this.copy_row=function(D){var F=D.cloneNode(true);F._skipInsert=D._skipInsert;var B=M;F._attrs={};F._css=D._css;if(this._ecspn){B=0;for(var E=0;(B<F.childNodes.length&&E<M);E+=(F.childNodes[B].colSpan||1))B++}while(F.childNodes.length>B)F.removeChild(F.childNodes[F.childNodes.length-1]);var C=B;for(E=0;E<C;E++){if(this.dragAndDropOff)this.dragger.addDraggableItem(F.childNodes[E],this);F.childNodes[E].style.display=(this._fake._hrrar?(this._fake._hrrar[E]?"none":""):"");F.childNodes[E]._cellIndex=E;F.childNodes[E].combo_value=arguments[0].childNodes[E].combo_value;F.childNodes[E]._clearCell=arguments[0].childNodes[E]._clearCell;F.childNodes[E]._cellType=arguments[0].childNodes[E]._cellType;F.childNodes[E]._brval=arguments[0].childNodes[E]._brval;F.childNodes[E]._attrs=arguments[0].childNodes[E]._attrs;F.childNodes[E].chstate=arguments[0].childNodes[E].chstate;if(D._attrs["style"])F.childNodes[E].style.cssText+=";"+D._attrs["style"];if(F.childNodes[E].colSpan>1)this._childIndexes=this._fake._childIndexes}if(this._h2&&this._treeC<M){var A=this._h2.get[arguments[0].idd];F.imgTag=F.childNodes[this._treeC].childNodes[0].childNodes[A.level];F.valTag=F.childNodes[this._treeC].childNodes[0].childNodes[A.level+2]}F.idd=D.idd;F.grid=this._fake;return F};G="_insertRowAt";this._bfs_insertRowAt=this[G];this[G]=function(){var A=this["_bfs_insertRowAt"].apply(this,arguments);arguments[0]=this.copy_row(arguments[0]);var B=this._fake["_insertRowAt"].apply(this._fake,arguments);if(A._fhd){B.parentNode.removeChild(B);this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(B));A._fhd=false}return A};this._bfs_setSizes=this.setSizes;this.setSizes=function(){if(this._notresize)return;this._bfs_setSizes(this,arguments);this.sync_headers();if(this.sync_scroll()&&this._ahgr)this.setSizes();this._fake.entBox.style.height=this.entBox.style.height;this._fake.objBox.style.height=this.objBox.style.height;this._fake.hdrBox.style.height=this.hdrBox.style.height;this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake.setColumnSizes(this._fake.entBox.clientWidth);this.globalBox.style.width=parseInt(this.entBox.style.width)+parseInt(this._fake.entBox.style.width);this.globalBox.style.height=this.entBox.style.height};this.sync_scroll=this._fake.sync_scroll=function(B){var A=this.objBox.style.overflowX;if(this.obj.offsetWidth<=this.objBox.offsetWidth){if(!B)return this._fake.sync_scroll(true);this.objBox.style.overflowX="hidden";this._fake.objBox.style.overflowX="hidden"}else{this.objBox.style.overflowX="scroll";this._fake.objBox.style.overflowX="scroll"}return A!=this.objBox.style.overflowX};this.sync_headers=this._fake.sync_headers=function(){if(this.noHeader||(this._fake.hdr.scrollHeight==this.hdr.offsetHeight))return;for(var C=1;C<this.hdr.rows.length;C++){var B=this.hdr.rows[C].scrollHeight,A=this._fake.hdr.rows[C].scrollHeight;if(B!=A)this._fake.hdr.rows[C].style.height=this.hdr.rows[C].style.height=Math.max(B,A)+"px";if(window._KHTMLrv)this._fake.hdr.rows[C].childNodes[0].style.height=this.hdr.rows[C].childNodes[M].style.height=Math.max(B,A)+"px"}this._fake.sync_headers};this._fake._bfs_setSizes=this._fake.setSizes;this._fake.setSizes=function(){if(this._fake._notresize)return;this._fake.setSizes()};G="_doOnScroll";this._bfs__doOnScroll=this[G];this[G]=function(){this._bfs__doOnScroll.apply(this,arguments);this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake["_doOnScroll"].apply(this._fake,arguments)};G="selectAll";this._bfs__selectAll=this[G];this[G]=function(){this._bfs__selectAll.apply(this,arguments);this._bfs__selectAll.apply(this._fake,arguments)};G="doClick";this._bfs_doClick=this[G];this[G]=function(){this["_bfs_doClick"].apply(this,arguments);if(arguments[0].tagName=="TD"){var A=(arguments[0]._cellIndex>=M);if(!arguments[0].parentNode.idd)return;if(!A)arguments[0].className=arguments[0].className.replace(/cellselected/g,"");if(!this._fake.rowsAr[arguments[0].parentNode.idd])this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd));arguments[0]=this._fake.cells(arguments[0].parentNode.idd,(A?0:arguments[0]._cellIndex)).cell;if(A)this._fake.cell=null;this._fake["_bfs_doClick"].apply(this._fake,arguments);if(A)this._fake.cell=this.cell;else this.cell=this._fake.cell;if(this._fake.onRowSelectTime)clearTimeout(this._fake.onRowSelectTime);if(A){arguments[0].className=arguments[0].className.replace(/cellselected/g,"");globalActiveDHTMLGridObject=this;this._fake.cell=this.cell}else this.objBox.scrollTop=this._fake.objBox.scrollTop}};this._fake._bfs_doClick=this._fake[G];this._fake[G]=function(){this["_bfs_doClick"].apply(this,arguments);if(arguments[0].tagName=="TD"){var A=(arguments[0]._cellIndex<M);if(!arguments[0].parentNode.idd)return;arguments[0]=this._fake._bfs_cells(arguments[0].parentNode.idd,(A?M:arguments[0]._cellIndex)).cell;this._fake.cell=null;this._fake["_bfs_doClick"].apply(this._fake,arguments);this._fake.cell=this.cell;if(this._fake.onRowSelectTime)clearTimeout(this._fake.onRowSelectTime);if(A){arguments[0].className=arguments[0].className.replace(/cellselected/g,"");globalActiveDHTMLGridObject=this;this._fake.cell=this.cell;this._fake.objBox.scrollTop=this.objBox.scrollTop}}};this.clearSelectionA=this.clearSelection;this.clearSelection=function(A){if(A)this._fake.clearSelection();this.clearSelectionA()};this.moveRowUpA=this.moveRowUp;this.moveRowUp=function(A){if(!this._h2)this._fake.moveRowUp(A);this.moveRowUpA(A);if(this._h2)this._fake._h2syncModel()};this.moveRowDownA=this.moveRowDown;this.moveRowDown=function(A){if(!this._h2)this._fake.moveRowDown(A);this.moveRowDownA(A);if(this._h2)this._fake._h2syncModel()};this._fake.getUserData=function(){return this._fake.getUserData.apply(this._fake,arguments)};this._fake.setUserData=function(){return this._fake.setUserData.apply(this._fake,arguments)};this.getSortingStateA=this.getSortingState;this.getSortingState=function(){var A=this.getSortingStateA();if(A.length!=0)return A;return this._fake.getSortingState()};this.setSortImgStateA=this._fake.setSortImgStateA=this.setSortImgState;this.setSortImgState=function(D,B,C,A){this.setSortImgStateA(D,B,C,A);if(B*1<M){this._fake.setSortImgStateA(D,B,C,A);this.setSortImgStateA(false)}else this._fake.setSortImgStateA(false)};this._fake.doColResizeA=this._fake.doColResize;this._fake.doColResize=function(C,D,A,G,B){var E=-1,F=0;if(arguments[1]._cellIndex==(M-1)){E=this._initalSplR+(C.clientX-G);if(!this._initalSplF)this._initalSplF=arguments[3]+this.objBox.scrollWidth-this.objBox.offsetWidth;if(this.objBox.scrollWidth==this.objBox.offsetWidth&&(this._fake.alter_split_resize||(C.clientX-G)>0)){arguments[3]=(this._initalSplF||arguments[3]);F=this.doColResizeA.apply(this,arguments)}else F=this.doColResizeA.apply(this,arguments)}else{if(this.obj.offsetWidth<this.entBox.offsetWidth)E=this.obj.offsetWidth;F=this.doColResizeA.apply(this,arguments)}this._correctSplit(E);this.resized=this._fake.resized=1;return F};this._fake.changeCursorState=function(A){var C=A.target||A.srcElement;if(C.tagName!="TD")C=this.getFirstParentOfType(C,"TD");if((C.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[C._cellIndex]))return;var B=(A.layerX||0)+(((!_isIE)&&(A.target.tagName=="DIV"))?C.offsetLeft:0),D=parseInt(this.getPosition(C,this.hdrBox));if(((C.offsetWidth-(A.offsetX||(D-B)*-1))<(_isOpera?20:10))||((this.entBox.offsetWidth-(A.offsetX?(A.offsetX+C.offsetLeft):B)+this.objBox.scrollLeft-0)<(_isOpera?20:10)))C.style.cursor="E-resize";else C.style.cursor="default";if(_isOpera)this.hdrBox.scrollLeft=this.objBox.scrollLeft};this._fake.startColResizeA=this._fake.startColResize;this._fake.startColResize=function(A){var C=this.startColResizeA(A);this._initalSplR=this.entBox.offsetWidth;this._initalSplF=null;if(this.entBox.onmousemove){var B=this.entBox.parentNode;if(B._aggrid)return C;B._aggrid=B.grid;B.grid=this;this.entBox.parentNode.onmousemove=this.entBox.onmousemove;this.entBox.onmousemove=null}return C};this._fake.stopColResizeA=this._fake.stopColResize;this._fake.stopColResize=function(A){if(this.entBox.parentNode.onmousemove){var B=this.entBox.parentNode;B.grid=B._aggrid;B._aggrid=null;this.entBox.onmousemove=this.entBox.parentNode.onmousemove;this.entBox.parentNode.onmousemove=null;if(this.obj.offsetWidth<this.entBox.offsetWidth)this._correctSplit(this.obj.offsetWidth)}return this.stopColResizeA(A)};this.doKeyA=this.doKey;this._fake.doKeyA=this._fake.doKey;this._fake.doKey=this.doKey=function(B){if(!B)return true;if(this._htkebl)return true;if((B.target||B.srcElement).value!==window.undefined){var A=(B.target||B.srcElement);if((!A.parentNode)||(A.parentNode.className.indexOf("editable")==-1))return true}switch(B.keyCode){case 9:if(!B.shiftKey){if(this._realfake){if((this.cell)&&(this.cell._cellIndex==(M-1))){if(B.preventDefault)B.preventDefault();var C=M;while(this._fake._hrrar&&this._fake._hrrar[C])C++;this._fake.selectCell(this._fake.getRowIndex(this.cell.parentNode.idd),C,false,false,true);return false}else var D=this.doKeyA(B);globalActiveDHTMLGridObject=this;return D}else{if(this.cell){C=this.cell._cellIndex+1;while(this.rowsCol[0].childNodes[C]&&this.rowsCol[0].childNodes[C].style.display=="none")C++;if(C==this.rowsCol[0].childNodes.length){if(B.preventDefault)B.preventDefault();D=this.rowsBuffer[this.getRowIndex(this.cell.parentNode.idd)+1];if(D){this.showRow(D.idd);this._fake.selectCell(this._fake.getRowIndex(D.idd),0,false,false,true);return false}}}return this.doKeyA(B)}}else if(this._realfake){if((this.cell)&&(this.cell._cellIndex==0)){if(B.preventDefault)B.preventDefault();D=this._fake.rowsBuffer[this._fake.getRowIndex(this.cell.parentNode.idd)-1];if(D){this._fake.showRow(D.idd);C=this._fake._cCount-1;while(D.childNodes[C].style.display=="none")C--;this._fake.selectCell(this._fake.getRowIndex(D.idd),C,false,false,true)}return false}else return this.doKeyA(B)}else if((this.cell)&&(this.cell._cellIndex==M)){if(B.preventDefault)B.preventDefault();this._fake.selectCell(this.getRowIndex(this.cell.parentNode.idd),M-1,false,false,true);return false}else return this.doKeyA(B);break}return this.doKeyA(B)};this.editCellA=this.editCell;this.editCell=function(){if(this.cell&&this.cell.parentNode.grid!=this)return this._fake.editCell();return this.editCellA()};this.deleteRowA=this.deleteRow;this.deleteRow=function(A,B){if(this.deleteRowA(A,B)===false)return false;if(this._fake.rowsAr[A])this._fake.deleteRow(A)};this.clearAllA=this.clearAll;this.clearAll=function(){this.clearAllA();this._fake.clearAll()};this.editStopA=this.editStop;this.editStop=function(){if(this._fake.editor)this._fake.editStop();else this.editStopA()};this.attachEvent("onAfterSorting",function(C,A,B){if(C>=M)this._fake.setSortImgState(false)});this._fake.sortField=function(C,A,B){this._fake.sortField.call(this._fake,C,A,this._fake.hdr.rows[0].cells[C]);if(this.fldSort[C]!="na"&&this._fake.fldSorted){var D=this._fake.getSortingState()[1];this._fake.setSortImgState(false);this.setSortImgState(true,arguments[0],D)}};this.sortTreeRowsA=this.sortTreeRows;this._fake.sortTreeRowsA=this._fake.sortTreeRows;this.sortTreeRows=this._fake.sortTreeRows=function(A,D,B,C){if(this._realfake)return this._fake.sortTreeRows(A,D,B,C);this.sortTreeRowsA(A,D,B,C);this._fake._h2syncModel();this._fake.setSortImgStateA(false);this._fake.fldSorted=null};this._fake._fillers=[];this._fake.rowsBuffer=this.rowsBuffer;this.attachEvent("onClearAll",function(){this._fake.rowsBuffer=this.rowsBuffer});this._add_filler_s=this._add_filler;this._add_filler=function(E,C,D,B){if(!this._fake._fillers)this._fake._fillers=[];if(this._realfake||!B){var A;if(D||!this._fake._fillers.length){if(D&&D.idd)A=this._fake.rowsAr[D.idd];else if(D&&D.nextSibling){A={};A.nextSibling=this._fake.rowsAr[D.nextSibling.idd];A.parentNode=A.nextSibling.parentNode}this._fake._fillers.push(this._fake._add_filler(E,C,A))}}return this._add_filler_s.apply(this,arguments)};this._add_from_buffer_s=this._add_from_buffer;this._add_from_buffer=function(){var A=this._add_from_buffer_s.apply(this,arguments);if(A!=-1){this._fake._add_from_buffer.apply(this._fake,arguments);if(this.multiLine)this._correctRowHeight(this.rowsBuffer[arguments[0]].idd)}return A};this._fake.render_row=function(A){var B=this._fake.render_row(A);if(B==-1)return-1;if(B)return this.rowsAr[B.idd]=this.rowsAr[B.idd]||this._fake.copy_row(B);return null};this._reset_view_s=this._reset_view;this._reset_view=function(){this._fake._reset_view(true);this._fake._fillers=[];this._reset_view_s()};this.moveColumn_s=this.moveColumn;this.moveColumn=function(B,A){if(A>=M)return this.moveColumn_s(B,A)};this.attachEvent("onCellChanged",function(B,E,A){if(this._split_event&&E<M&&this.rowsAr[B]){var C=this._fake.rowsAr[B];if(!C)return;if(C._childIndexes)C=C.childNodes[C._childIndexes[E]];else C=C.childNodes[E];var D=this.rowsAr[B].childNodes[E];if(D._treeCell&&D.firstChild.lastChild)D.firstChild.lastChild.innerHTML=A;else D.innerHTML=C.innerHTML;D._clearCell=false;D.chstate=C.chstate}});this._fake.combos=this.combos;this.setSizes();if(this.rowsBuffer[0])this._reset_view();this.attachEvent("onXLE",function(){this._fake._correctSplit()});this._fake._correctSplit()};dhtmlXGridObject.prototype._correctSplit=function(B){B=B||(this.obj.scrollWidth-this.objBox.scrollLeft);B=Math.min(this.globalBox.offsetWidth,B);if(B>-1){this.entBox.style.width=B+"px";this.objBox.style.width=B+"px";var A=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;this._fake.entBox.style.left=B+"px";this._fake.entBox.style.width=Math.max(0,this.globalBox.offsetWidth-B-(this.quirks?0:2)*A)+"px";if(this._fake.ftr)this._fake.ftr.parentNode.style.width=this._fake.entBox.style.width;if(_isIE){var C=_isIE&&!window.xmlHttpRequest,A=(this.globalBox.offsetWidth-this.globalBox.clientWidth);this._fake.hdrBox.style.width=this._fake.objBox.style.width=Math.max(0,this.globalBox.offsetWidth-(C?A:0)-B)+"px"}}};dhtmlXGridObject.prototype._correctRowHeight=function(A,C){if(!this.rowsAr[A]||!this._fake.rowsAr[A])return;var D=this.rowsAr[A].offsetHeight,E=this._fake.rowsAr[A].offsetHeight,B=Math.max(D,E);if(!B)return;this.rowsAr[A].style.height=this._fake.rowsAr[A].style.height=B+"px";if(window._KHTMLrv)this.rowsAr[A].childNodes[this._fake._cCount].style.height=this._fake.rowsAr[A].firstChild.style.height=B+"px"};dhtmlXGridObject.prototype.enableSmartRendering=function(C,A,B){if(arguments.length>2){if(A&&!this.rowsBuffer[A-1])this.rowsBuffer[A-1]=0;A=B}this._srnd=convertStringToBoolean(C);this._srdh=this._srdh||20;this._dpref=A||0};dhtmlXGridObject.prototype.enablePreRendering=function(A){this._srnd_pr=parseInt(A||50)};dhtmlXGridObject.prototype.forceFullLoading=function(B,C){for(var E=0;E<this.rowsBuffer.length;E++)if(!this.rowsBuffer[E]){var A=B||(this.rowsBuffer.length-E);if(this.callEvent("onDynXLS",[E,A])){var D=this;this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+E+"&count="+A,function(){window.setTimeout(function(){D.forceFullLoading(B,C)},100)},this._data_type)}return}if(C)C.call(this)};dhtmlXGridObject.prototype.setAwaitedRowHeight=function(A){this._srdh=parseInt(A)};dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2};dhtmlXGridObject.prototype._add_filler=function(G,D,B,C){if(!D)return null;var A="__filler__",E=this._prepareRow(A);E.firstChild.style.width="1px";for(var F=1;F<E.childNodes.length;F++)E.childNodes[F].style.display="none";E.firstChild.style.height=D*this._srdh+"px";B=B||this.rowsCol[G];if(B&&B.nextSibling)B.parentNode.insertBefore(E,B.nextSibling);else if(_isKHTML)this.obj.appendChild(E);else this.obj.rows[0].parentNode.appendChild(E);this.callEvent("onAddFiller",[G,D,E,B,C]);return[G,D,E]};dhtmlXGridObject.prototype._update_srnd_view=function(){var A=Math.floor(this.objBox.scrollTop/this._srdh),D=A+this._get_view_size();if(this.multiLine){var F=this.objBox.scrollTop;A=0;while(F>0){F-=this.rowsCol[A]?this.rowsCol[A].offsetHeight:this._srdh;A++}D=A+this._get_view_size();if(A>0)A--}D+=(this._srnd_pr||0);if(D>this.rowsBuffer.length)D=this.rowsBuffer.length;for(var G=A;G<D;G++)if(!this.rowsCol[G]){var B=this._add_from_buffer(G);if(B==-1){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[D-1]){var E=this._dpref?this._dpref:(D-G),C=Math.max(0,D-this._dpref);this._current_load=[C,D-C]}else this._current_load=[G,(this._dpref?this._dpref:(D-G))];if(this.callEvent("onDynXLS",this._current_load))this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}return}else{if(this._tgle){this._updateLine(this._h2.get[this.rowsBuffer[G].idd],this.rowsBuffer[G]);this._updateParentLine(this._h2.get[this.rowsBuffer[G].idd],this.rowsBuffer[G])}if(G&&G==(this._realfake?this._fake:this)["_r_select"])this.selectCell(G,this.cell?this.cell._cellIndex:0,true)}}if(this._fake&&!this._realfake&&this.multiLine)this._fake.objBox.scrollTop=this.objBox.scrollTop};dhtmlXGridObject.prototype._add_from_buffer=function(B){var C=this.render_row(B);if(C==-1)return-1;if(C._attrs["selected"]||C._attrs["select"]){this.selectRow(C,false,true);C._attrs["selected"]=C._attrs["select"]=null}if(!this._cssSP){if(this._cssEven&&B%2==0)C.className=this._cssEven+((C.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(C._css||"");else if(this._cssUnEven&&B%2==1)C.className=this._cssUnEven+((C.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(C._css||"")}else if(this._h2){var F=this._h2.get[C.idd];C.className+=" "+((F.level%2)?(this._cssUnEven+" "+this._cssUnEven):(this._cssEven+" "+this._cssEven))+"_"+F.level+(this.rowsAr[F.id]._css||"")}for(var E=0;E<this._fillers.length;E++){var A=this._fillers[E];if(A&&A[0]<=B&&(A[0]+A[1])>B){var D=B-A[0];if(D==0){this._insert_before(B,C,A[2]);this._update_fillers(E,-1,1)}else if(D==A[1]-1){this._insert_after(B,C,A[2]);this._update_fillers(E,-1,0)}else{this._fillers.push(this._add_filler(B+1,A[1]-D-1,A[2],1));this._insert_after(B,C,A[2]);this._update_fillers(E,-A[1]+D,0)}return}}};dhtmlXGridObject.prototype._update_fillers=function(B,D,C){var A=this._fillers[B];A[1]=A[1]+D;A[0]=A[0]+C;if(!A[1]){this.callEvent("onRemoveFiller",[A[2]]);A[2].parentNode.removeChild(A[2]);this._fillers.splice(B,1)}else{A[2].firstChild.style.height=parseFloat(A[2].firstChild.style.height)+D*this._srdh+"px";this.callEvent("onUpdateFiller",[A[2]])}};dhtmlXGridObject.prototype._insert_before=function(A,C,B){B.parentNode.insertBefore(C,B);this.rowsCol[A]=C;this.callEvent("onRowInserted",[C,null,B,"before"])};dhtmlXGridObject.prototype._insert_after=function(A,C,B){if(B.nextSibling)B.parentNode.insertBefore(C,B.nextSibling);else B.parentNode.appendChild(C);this.rowsCol[A]=C;this.callEvent("onRowInserted",[C,null,B,"after"])};dhtmlXGridObject.prototype.enableAutoSizeSaving=function(B,A){this.attachEvent("onResizeEnd",function(){this.saveSizeToCookie(B,A)})};dhtmlXGridObject.prototype.saveOpenStates=function(D,A){if(!D)D=this.entBox.id;var B=[];this._h2.forEachChild(0,function(A){if(A.state=="minus")B.push(A.id)});var C="gridOpen"+(D||"")+"="+B.join("|")+(A?(";"+A):"");document.cookie=C};dhtmlXGridObject.prototype.loadOpenStates=function(C,B){var A=this.getCookie(C,"gridOpen");if(!A)return;A=A.split("|");for(var E=0;E<A.length;E++){var D=this.getParentId(A[E]);if(!this.getOpenState(D))continue;this.openItem(A[E])}};dhtmlXGridObject.prototype.enableAutoHiddenColumnsSaving=function(B,A){this.attachEvent("onColumnHidden",function(){this.saveHiddenColumnsToCookie(B,A)})};dhtmlXGridObject.prototype.enableSortingSaving=function(B,A){this.attachEvent("onBeforeSorting",function(){var C=this;window.setTimeout(function(){C.saveSortingToCookie(B,A)},1);return true})};dhtmlXGridObject.prototype.enableOrderSaving=function(B,A){this.attachEvent("onAfterCMove",function(){this.saveOrderToCookie(B,A);this.saveSizeToCookie(B,A)})};dhtmlXGridObject.prototype.enableAutoSaving=function(B,A){this.enableOrderSaving(B,A);this.enableAutoSizeSaving(B,A);this.enableSortingSaving(B,A)};dhtmlXGridObject.prototype.saveSizeToCookie=function(B,A){if(this.cellWidthType=="px")var D=this.cellWidthPX.join(",");else D=this.cellWidthPC.join(",");var C=(this.initCellWidth||(new Array)).join(",");this.setCookie(B,A,0,D);this.setCookie(B,A,1,C)};dhtmlXGridObject.prototype.saveHiddenColumnsToCookie=function(C,B){var A=[].concat(this._hrrar||[]);if(this._fake&&this._fake._hrrar)for(var D=0;D<this._fake._cCount;D++)A[D]=this._fake._hrrar[D]?"1":"";this.setCookie(C,B,4,A.join(",").replace(/display:none;/g,"1"))};dhtmlXGridObject.prototype.loadHiddenColumnsFromCookie=function(A){var C=this._getCookie(A,4),B=(C||"").split(",");for(var D=0;D<this._cCount;D++)this.setColumnHidden(D,(B[D]?true:false))};dhtmlXGridObject.prototype.saveSortingToCookie=function(B,A){this.setCookie(B,A,2,(this.getSortingState()||[]).join(","))};dhtmlXGridObject.prototype.loadSortingFromCookie=function(A){var B=this._getCookie(A,2);B=(B||"").split(",");if(B.length>1&&B[0]<this._cCount){console.log(B[0]);this.sortRows(B[0],null,B[1]);this.setSortImgState(true,B[0],B[1])}};dhtmlXGridObject.prototype.saveOrderToCookie=function(B,A){if(!this._c_order){this._c_order=[];var C=this._cCount;for(var D=0;D<C;D++)this._c_order[D]=D}this.setCookie(B,A,3,((this._c_order||[]).slice(0,this._cCount)).join(","));this.saveSortingToCookie()};dhtmlXGridObject.prototype.loadOrderFromCookie=function(B){var D=this._getCookie(B,3);D=(D||"").split(",");if(D.length>1&&D.length<=this._cCount)for(var E=0;E<D.length;E++)if((!this._c_order&&D[E]!=E)||(this._c_order&&D[E]!=this._c_order[E])){var A=D[E];if(this._c_order)for(var C=0;C<this._c_order.length;C++)if(this._c_order[C]==D[E]){A=C;break}this.moveColumn(A*1,E)}};dhtmlXGridObject.prototype.loadSizeFromCookie=function(A){var B=this._getCookie(A,1);if(B)this.initCellWidth=B.split(",");B=this._getCookie(A,0);if((B)&&(B.length)){if(!this._fake&&this._hrrar)for(var C=0;C<B.length;C++)if(this._hrrar[C])B[C]=0;if(this.cellWidthType=="px")this.cellWidthPX=B.split(",");else this.cellWidthPC=B.split(",")}this.setSizes();return true};dhtmlXGridObject.prototype.clearConfigCookie=function(B){if(!B)B=this.entBox.id;var A="gridSettings"+B+"=||||";document.cookie=A};dhtmlXGridObject.prototype.clearSizeCookie=dhtmlXGridObject.prototype.clearConfigCookie;dhtmlXGridObject.prototype.setCookie=function(D,A,F,E){if(!D)D=this.entBox.id;var B=this.getCookie(D);B=(B||"||||").split("|");B[F]=E;var C="gridSettings"+D+"="+B.join("|")+(A?(";"+A):"");document.cookie=C};dhtmlXGridObject.prototype.getCookie=function(B,C){if(!B)B=this.entBox.id;B=(C||"gridSettings")+B;var A=B+"=";if(document.cookie.length>0){var D=document.cookie.indexOf(A);if(D!=-1){D+=A.length;var E=document.cookie.indexOf(";",D);if(E==-1)E=document.cookie.length;return document.cookie.substring(D,E)}}};dhtmlXGridObject.prototype._getCookie=function(A,B){return((this.getCookie(A)||"||||").split("|"))[B]};function dhtmlXGridFromTable(obj,init){if(typeof(obj)!="object")obj=document.getElementById(obj);var w=document.createElement("DIV");w.setAttribute("width",obj.getAttribute("gridWidth")||(obj.offsetWidth?(obj.offsetWidth+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["width"]:(obj.currentStyle?obj.currentStyle["width"]:0)));w.setAttribute("height",obj.getAttribute("gridHeight")||(obj.offsetHeight?(obj.offsetHeight+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["height"]:(obj.currentStyle?obj.currentStyle["height"]:0)));w.className=obj.className;obj.className="";if(obj.id)w.id=obj.id;var mr=obj,drag=obj.getAttribute("dragAndDrop");mr.parentNode.insertBefore(w,mr);var f=mr.getAttribute("name")||("name_"+(new Date()).valueOf()),windowf=new dhtmlXGridObject(w);window[f]=windowf;var acs=mr.getAttribute("onbeforeinit"),acs2=mr.getAttribute("oninit");if(acs)eval(acs);windowf.setImagePath(windowf.imgURL||(mr.getAttribute("imgpath")||mr.getAttribute("image_path")||""));var skin=mr.getAttribute("skin");if(skin)windowf.setSkin(skin);if(init)init(windowf);var hrow=mr.rows[0],za="",zb="",zc="",zd="",ze="";for(var i=0;i<hrow.cells.length;i++){za+=(za?",":"")+hrow.cells[i].innerHTML;var width=hrow.cells[i].getAttribute("width")||hrow.cells[i].offsetWidth||(window.getComputedStyle?window.getComputedStyle(hrow.cells[i],null)["width"]:(hrow.cells[i].currentStyle?hrow.cells[i].currentStyle["width"]:0));zb+=(zb?",":"")+(width=="*"?width:parseInt(width));zc+=(zc?",":"")+(hrow.cells[i].getAttribute("align")||"left");zd+=(zd?",":"")+(hrow.cells[i].getAttribute("type")||"ed");ze+=(ze?",":"")+(hrow.cells[i].getAttribute("sort")||"str");var f_a=hrow.cells[i].getAttribute("format");if(f_a)if(hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar")!=-1)windowf._dtmask=f_a;else windowf.setNumberFormat(f_a,i)}windowf.setHeader(za);windowf.setInitWidths(zb);windowf.setColAlign(zc);windowf.setColTypes(zd);windowf.setColSorting(ze);if(obj.getAttribute("gridHeight")=="auto")windowf.enableAutoHeigth(true);if(obj.getAttribute("multiline"))windowf.enableMultiline(true);var lmn=mr.getAttribute("lightnavigation");if(lmn)windowf.enableLightMouseNavigation(lmn);var evr=mr.getAttribute("evenrow"),uevr=mr.getAttribute("unevenrow");if(evr||uevr)windowf.enableAlterCss(evr,uevr);if(drag)windowf.enableDragAndDrop(true);windowf.init();if(obj.getAttribute("split"))windowf.splitAt(obj.getAttribute("split"));windowf._process_inner_html(mr,1);if(acs2)eval(acs2);if(obj.parentNode&&obj.parentNode.removeChild)obj.parentNode.removeChild(obj);return windowf}dhtmlXGridObject.prototype._process_html=function(C){if(C.tagName&&C.tagName=="TABLE")return this._process_inner_html(C,0);var B=document.createElement("DIV");B.innerHTML=C.xmlDoc.responseText;var A=B.getElementsByTagName("TABLE")[0];this._process_inner_html(A,0)};dhtmlXGridObject.prototype._process_inner_html=function(B,C){var E=B.rows.length;for(var D=C;D<E;D++){var A=B.rows[D].getAttribute("id")||D;this.rowsBuffer.push({idd:A,data:B.rows[D],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset();this.setSizes()};dhtmlXGridObject.prototype._process_html_row=function(B,D){var H=D.getElementsByTagName("TD"),A=[];B._attrs=this._xml_attrs(D);for(var F=0;F<H.length;F++){var C=H[F],E=C.getAttribute("type");if(B.childNodes[F]){if(E)B.childNodes[F]._cellType=E;B.childNodes[F]._attrs=this._xml_attrs(H[F])}if(C.firstChild)A.push(C.innerHTML);else A.push("");if(C.colSpan>1){B.childNodes[F]._attrs["colspan"]=C.colSpan;for(var G=1;G<C.colSpan;G++)A.push("")}}for(F<H.length;F<B.childNodes.length;F++)B.childNodes[F]._attrs={};this._fillRow(B,(this._c_order?this._swapColumns(A):A));return B};dhtmlXGridObject.prototype._get_html_data=function(B,A){B=B.firstChild;while(true){if(!B)return"";if(B.tagName=="TD")A--;if(A<0)break;B=B.nextSibling}return(B.firstChild?B.firstChild.data:"")};dhtmlxEvent(window,"load",function(){var B=document.getElementsByTagName("table");for(var A=0;A<B.length;A++)if(B[A].className=="dhtmlxGrid")dhtmlXGridFromTable(B[A])});dhtmlXGridObject.prototype.enableUndoRedo=function(){var B=this,A=function(){return B._onEditUndoRedo.apply(B,arguments)};this.attachEvent("onEditCell",A);var C=function(D,A,C){return B._onEditUndoRedo.apply(B,[2,D,A,(C?1:0),(C?0:1)])};this.attachEvent("onCheckbox",C);this._IsUndoRedoEnabled=true;this._UndoRedoData=[];this._UndoRedoPos=-1};dhtmlXGridObject.prototype.disableUndoRedo=function(){this._IsUndoRedoEnabled=false;this._UndoRedoData=[];this._UndoRedoPos=-1};dhtmlXGridObject.prototype._onEditUndoRedo=function(F,A,C,B,D){if(this._IsUndoRedoEnabled&&F==2&&D!=B){if(this._UndoRedoPos!==-1&&this._UndoRedoPos!=(this._UndoRedoData.length-1))this._UndoRedoData=this._UndoRedoData.slice(0,this._UndoRedoPos+1);else if(this._UndoRedoPos===-1&&this._UndoRedoData.length>0)this._UndoRedoData=[];var E={old_value:D,new_value:B,row_id:A,cell_index:C};this._UndoRedoData.push(E);this._UndoRedoPos++}return true};dhtmlXGridObject.prototype.doUndo=function(){if(this._UndoRedoPos===-1)return false;var B=this._UndoRedoData[this._UndoRedoPos--],A=this.cells(B.row_id,B.cell_index);if(this.getColType(B.cell_index)=="tree")A.setLabel(B.old_value);else A.setValue(B.old_value)};dhtmlXGridObject.prototype.doRedo=function(){if(this._UndoRedoPos==this._UndoRedoData.length-1)return false;var A=this._UndoRedoData[++this._UndoRedoPos];this.cells(A.row_id,A.cell_index).setValue(A.new_value)};dhtmlXGridObject.prototype.getRedo=function(){if(this._UndoRedoPos==this._UndoRedoData.length-1)return[];return this._UndoRedoData.slice(this._UndoRedoPos+1)};dhtmlXGridObject.prototype.getUndo=function(){if(this._UndoRedoPos==-1)return[];return this._UndoRedoData.slice(0,this._UndoRedoPos+1)};function eXcell_sub_row(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")};this._setState=function(B,A){(A||this.cell).innerHTML="<img src='"+this.grid.imgURL+B+"' width='18' height='18' />";(A||this.cell).firstChild.onclick=this.grid._expandMonolite};this.open=function(){this.cell.firstChild.onclick(null,true)};this.close=function(){this.cell.firstChild.onclick(null,false,true)};this.isOpen=function(){return!!this.cell.parentNode._expanded};this.setValue=function(A){if(A)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",A);this._setState(A?"plus.gif":"blanc.gif")};this.setContent=function(A){if(this.cell.parentNode._expanded){this.cell.parentNode._expanded.innerHTML=A;this.resize()}else{this.cell._previous_content=null;this.setValue(A);this.cell._sub_row_type=null}};this.resize=function(){this.grid._detectHeight(this.cell.parentNode._expanded,this.cell,this.cell.parentNode._expanded.scrollHeight)},this.isDisabled=function(){return true};this.getTitle=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")?"click to expand|collapse":""}}eXcell_sub_row.prototype=new eXcell;function eXcell_sub_row_ajax(A){this.base=eXcell_sub_row;this.base(A);this.setValue=function(A){if(A)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",A);this.cell._sub_row_type="ajax";this.cell._previous_content=null;this._setState(A?"plus.gif":"blanc.gif")}}eXcell_sub_row_ajax.prototype=new eXcell_sub_row;function eXcell_sub_row_grid(A){this.base=eXcell_sub_row;this.base(A);this.setValue=function(A){if(A)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",A);this.cell._sub_row_type="grid";this._setState(A?"plus.gif":"blanc.gif")};this.getSubGrid=function(){if(!A._sub_grid)return null;return A._sub_grid}}eXcell_sub_row_grid.prototype=new eXcell_sub_row;dhtmlXGridObject.prototype._expandMonolite=function(F,G,D){var H=this.parentNode,I=H.parentNode,A=I.grid;if(F||window.event){if(!D&&!I._expanded)A.editStop();(F||event).cancelBubble=true}var E=A.getUserData(I.idd,"__sub_row");if(!A._sub_row_editor)A._sub_row_editor=new eXcell_sub_row(H);if(!E)return;if(I._expanded&&!G){A._sub_row_editor._setState("plus.gif",H);H._previous_content=I._expanded;A.objBox.removeChild(I._expanded);I._expanded=false;I.style.height=(I.oldHeight||20)+"px";H.style.height=(I.oldHeight||20)+"px";if(A._fake)A._fake.rowsAr[I.idd].style.height=(I.oldHeight||20)+"px";for(var J=0;J<I.cells.length;J++){I.cells[J].style.verticalAlign="middle";I.cells[J].style.paddingTop="0px"}delete A._flow[I.idd];A._correctMonolite();I._expanded.ctrl=null}else if(!I._expanded&&!D){A._sub_row_editor._setState("minus.gif",H);I.oldHeight=H.offsetHeight;if(H._previous_content){var B=H._previous_content;B.ctrl=H;A.objBox.appendChild(B);A._detectHeight(B,H,parseInt(B.style.height))}else{B=document.createElement("DIV");B.ctrl=H;if(H._sub_row_type)A._sub_row_render[H._sub_row_type](A,B,H,E);else B.innerHTML=E;B.style.cssText="position:absolute;left:0px;top:0px;overflow:auto;font-family:Tahoma;font-size:8pt;margin-top:2px;margin-left:4px;";B.className="dhx_sub_row";A.objBox.appendChild(B);A._detectHeight(B,H)}if(!A._flow){A.attachEvent("onGridReconstructed",function(){if(this.pagingOn||this._srnd)this._collapsMonolite();else this._correctMonolite()});A.attachEvent("onResizeEnd",function(){this._correctMonolite(true)});A.attachEvent("onAfterCMove",function(){this._correctMonolite(true)});A.attachEvent("onDrop",function(){this._correctMonolite(true)});A.attachEvent("onBeforePageChanged",function(){this._collapsMonolite();return true});A.attachEvent("onGroupStateChanged",function(){this._correctMonolite();return true});A.attachEvent("onFilterEnd",function(){this._collapsMonolite()});A.attachEvent("onUnGroup",function(){this._collapsMonolite()});A.attachEvent("onPageChanged",function(){this._collapsMonolite()});A.attachEvent("onXLE",function(){this._collapsMonolite()});A.attachEvent("onClearAll",function(){for(var A in this._flow)if(this._flow[A]&&this._flow[A].parentNode)this._flow[A].parentNode.removeChild(this._flow[A]);this._flow=[]});A.attachEvent("onEditCell",function(C,A,B){if((C!==2)&&this._flow[A]&&this.cellType[B]!="ch"&&this.cellType[B]!="ra")this._expandMonolite.apply(this._flow[A].ctrl.firstChild,[0,false,true]);return true});A.attachEvent("onCellChanged",function(A,C){if(!this._flow[A])return;var B=this.cells(A,C).cell;B.style.verticalAlign="top";B.style.paddingTop="3px"});A._flow=[]}A._flow[I.idd]=B;A._correctMonolite();for(J=0;J<I.cells.length;J++){I.cells[J].style.verticalAlign="top";I.cells[J].style.paddingTop="3px"}if(A._fake){var C=A._fake.rowsAr[I.idd];for(J=0;J<C.cells.length;J++){C.cells[J].style.verticalAlign="top";C.cells[J].style.paddingTop="3px"}}H.style.paddingTop="1px";I._expanded=B}if(A._ahgr)A.setSizes();if(A.parentGrid)A.callEvent("onGridReconstructed",[]);A.callEvent("onSubRowOpen",[I.idd,(!!I._expanded)])};dhtmlXGridObject.prototype._sub_row_render={"ajax":function(that,d,td,c){d.innerHTML="Loading...";var xml=new dtmlXMLLoaderObject(function(){d.innerHTML=xml.xmlDoc.responseText;var z=xml.xmlDoc.responseText.match(/<script[^>]*>([^<]+)<\/script>/g);if(z)for(var i=0;i<z.length;i++)eval(z[i].replace(/<([\/]{0,1})s[^>]*>/g,""));that._detectHeight(d,td);that._correctMonolite();that.setUserData(td.parentNode.idd,"__sub_row",xml.xmlDoc.responseText);td._sub_row_type=null;if(that._ahgr)that.setSizes();that.callEvent("onSubAjaxLoad",[td.parentNode.idd,xml.xmlDoc.responseText])},this,true,true);xml.loadXML(c)},"grid":function(A,B,D,C){D._sub_grid=new dhtmlXGridObject(B);if(A.skin_name)D._sub_grid.setSkin(A.skin_name);D._sub_grid.parentGrid=A;D._sub_grid.setImagePath(A.imgURL);D._sub_grid.enableAutoHeight(true);D._sub_grid._delta_x=D._sub_grid._delta_y=null;D._sub_grid.attachEvent("onGridReconstructed",function(){A._detectHeight(B,D,D._sub_grid.objBox.scrollHeight+D._sub_grid.hdr.offsetHeight+(this.ftr?this.ftr.offsetHeight:0));A._correctMonolite();this.setSizes();if(A.parentGrid)A.callEvent("onGridReconstructed",[])});if(!A.callEvent("onSubGridCreated",[D._sub_grid,D.parentNode.idd,D._cellIndex,C]))return;D._sub_grid.loadXML(C,function(){A._detectHeight(B,D,D._sub_grid.objBox.scrollHeight+D._sub_grid.hdr.offsetHeight+(D._sub_grid.ftr?D._sub_grid.ftr.offsetHeight:0));D._sub_grid.objBox.style.overflow="hidden";A._correctMonolite();D._sub_row_type=null;if(!A.callEvent("onSubGridLoaded",[D._sub_grid,D.parentNode.idd,D._cellIndex,C]))return;if(A._ahgr)A.setSizes()})}};dhtmlXGridObject.prototype._detectHeight=function(A,D,F){var C=D.offsetLeft+D.offsetWidth;A.style.left=C+"px";A.style.width=Math.max(0,D.parentNode.offsetWidth-C-4)+"px";var F=F||A.scrollHeight;A.style.overflow="hidden";A.style.height=F+"px";var E=D.parentNode;D.parentNode.style.height=(E.oldHeight||20)+3+F*1+"px";D.style.height=(E.oldHeight||20)+3+F*1+"px";if(this._fake){var B=this._fake.rowsAr[D.parentNode.idd];B.style.height=(E.oldHeight||20)+3+F*1+"px"}};dhtmlXGridObject.prototype._correctMonolite=function(C){if(this._in_correction)return;this._in_correction=true;for(var A in this._flow)if(this._flow[A]&&this._flow[A].tagName=="DIV")if(this.rowsAr[A]){if(this.rowsAr[A].style.display=="none"){this.cells4(this._flow[A].ctrl).close();continue}this._flow[A].style.top=this.rowsAr[A].offsetTop+(this.rowsAr[A].oldHeight||20)+"px";if(C){var B=this._flow[A].ctrl.offsetLeft+this._flow[A].ctrl.offsetWidth;this._flow[A].style.left=B+"px";this._flow[A].style.width=this.rowsAr[A].offsetWidth-B-4+"px"}}else{this._flow[A].ctrl=null;this.objBox.removeChild(this._flow[A]);delete this._flow[A]}this._in_correction=false};dhtmlXGridObject.prototype._collapsMonolite=function(){for(var A in this._flow)if(this._flow[A]&&this._flow[A].tagName=="DIV")if(this.rowsAr[A])this.cells4(this._flow[A].ctrl).close()};dhtmlxValidation=function(){};dhtmlxValidation.prototype={trackInput:function(A,B,D,C){dhtmlxEvent(A,"keyup",function(E){if(dhtmlxValidation._timer){window.clearTimeout(dhtmlxValidation._timer);dhtmlxValidation._timer=null}dhtmlxValidation._timer=window.setTimeout(function(){if(!dhtmlxValidation.checkInput(A,B)){if(!D||D(A,A.value,B))A.className+=" dhtmlx_live_validation_error"}else{A.className=A.className.replace(/[ ]*dhtmlx_live_validation_error/g,"");if(C)C(A,A.value,B)}},250)})},checkInput:function(A,B){return this.checkValue(A.value,B)},checkValue:function(C,B){if(typeof B=="string")B=B.split(",");var A=true;for(var D=0;D<B.length;D++)if(!this["is"+B[D]])alert("Incorrect validation rule: "+B[D]);else A=A&&this["is"+B[D]](C);return A},isEmpty:function(A){return A==""},isNotEmpty:function(A){return!A==""},isValidBoolean:function(A){return!!A.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(A){return!!A.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(A){return!!A.toString().match(/(^-?\d+$)/)},isValidNumeric:function(A){return!!A.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(A){return!!A.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(B){var A=B.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return A&&!!(A[1]<=9999&&A[2]<=12&&A[3]<=31&&A[4]<=59&&A[5]<=59&&A[6]<=59)||false},isValidDate:function(B){var A=B.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return A&&!!(A[1]<=9999&&A[2]<=12&&A[3]<=31)||false},isValidTime:function(B){var A=B.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return A&&!!(A[1]<=24&&A[2]<=59&&A[3]<=59)||false},isValidIPv4:function(A){var B=A.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return B&&!!(B[1]<=255&&B[2]<=255&&B[3]<=255&&B[4]<=255)||false},isValidCurrency:function(A){return A.toString().match(/^\$?\s?\d+?[\.,\,]?\d+?\s?\$?$/)&&true||false},isValidSSN:function(A){return A.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&true||false},isValidSIN:function(A){return A.toString().match(/^\d{9}$/)&&true||false}};dhtmlxValidation=new dhtmlxValidation();dhtmlXGridObject.prototype.enableValidation=function(B,A){B=convertStringToBoolean(B);if(B)this._validators={data:[]};else this._validators=false;if(arguments.length>1)this._validators._live=A;if(!this._validators._event)this._validators._event=this.attachEvent("onEditCell",this.validationEvent)};dhtmlXGridObject.prototype.setColValidators=function(A){if(!this._validators)this.enableValidation(true);if(typeof A=="string")A=A.split(this.delim);this._validators.data=A};dhtmlXGridObject.prototype.validationEvent=function(H,A,D,C,G){var B=this._validators;if(!B)return true;var E=(B.data[D]||this.cells(A,D).getAttribute("validate"))||"";if(H==1&&E){var I=this.editor||(this._fake||{}).editor;if(!I)return true;I.cell.className=I.cell.className.replace(/[ ]*dhtmlx_validation_error/g,"");if(B._live){var F=this;dhtmlxValidation.trackInput(I.getInput(),E,function(B,E,C){return F.callEvent("onLiveValidationError",[A,D,E,B,C])},function(B,E,C){return F.callEvent("onLiveValidationCorrect",[A,D,E,B,C])})}}if(H==2)this.validateCell(A,D,E,C);return true};dhtmlXGridObject.prototype.validateCell=function(A,C,E,F){E=E||(this._validators.data[C]||this.cells(A,C).getAttribute("validate"));F=F||this.cells(A,C).getValue();if(!E)return;var D=this.cells(A,C).cell,B=true;if(typeof E=="string")E=E.split(this.delim);for(var G=0;G<E.length;G++)if(!dhtmlxValidation.checkValue(F,E[G])){if(this.callEvent("onValidationError",[A,C,F,E[G]]))D.className+=" dhtmlx_validation_error";B=false}if(B){this.callEvent("onValidationCorrect",[A,C,F,E]);D.className=D.className.replace(/[ ]*dhtmlx_validation_error/g,"")}return B};dhtmlXGridObject.prototype.startFastOperations=function(){this._disF=["setSizes","callEvent","_fixAlterCss","cells4","forEachRow"];this._disA=[];for(var A=this._disF.length-1;A>=0;A--){this._disA[A]=this[this._disF[A]];this[this._disF[A]]=function(){return true}}this._cellCache=[];this.cells4=function(B){var A=this._cellCache[B._cellIndex];if(!A){A=this._cellCache[B._cellIndex]=this._disA[3].apply(this,[B]);A.destructor=function(){return true};A.setCValue=function(B){A.cell.innerHTML=B}}A.cell=B;A.combo=B._combo||this.combos[B._cellIndex];return A}};dhtmlXGridObject.prototype.stopFastOperations=function(){if(!this._disF)return;for(var A=this._disF.length-1;A>=0;A--)this[this._disF[A]]=this._disA[A];this.setSizes();this.callEvent("onGridReconstructed",[])};function eXcell_dhxCalendar(B){if(B){this.cell=B;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var D=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[D]);var A=this.grid;D.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){A.editStop()},1);return true});var C=function(A){(A||event).cancelBubble=true};dhtmlxEvent(D.base,"click",C);D=null}}}eXcell_dhxCalendar.prototype=new eXcell;eXcell_dhxCalendar.prototype.edit=function(){var B=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);this.grid._grid_calendarA.setPosition(B[0],B[1]+this.cell.offsetHeight);this.grid._grid_calendarA._last_operation_calendar=false;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var A=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val||(new Date()));this.grid._grid_calendarA.draw=A};eXcell_dhxCalendar.prototype.getDate=function(){if(this.cell.val)return this.cell.val;return null};eXcell_dhxCalendar.prototype.getValue=function(){if(this.cell._clearCell)return"";if(this.grid._dtmask_inc&&this.cell.val)return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString();return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendar.prototype.detach=function(){if(!this.grid._grid_calendarA)return;this.grid._grid_calendarA.hide();if(this.cell._cediton)this.cell._cediton=false;else return;if(this.grid._grid_calendarA._last_operation_calendar){var B=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y")),C=this.grid._grid_calendarA.getDate();this.cell.val=new Date(C);this.setCValue(B,C);this.cell._clearCell=!B;var A=this.val;this.val=this._val;return(this.cell.val.valueOf()!=A)}return false};eXcell_dhxCalendar.prototype.setValue=function(A){if(A&&typeof A=="object"){this.cell.val=A;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),A).toString(),this.cell.val);return}if(!A||A.toString()._dhx_trim()==""){A="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),A.toString(),null,true));if(this.grid._dtmask_inc)A=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell._clearCell=true;this.cell.val=new Date();this.setCValue("&nbsp;",0)}else this.setCValue((A||"").toString(),this.cell.val)};function eXcell_dhxCalendarA(B){if(B){this.cell=B;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var D=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[D]);var A=this.grid;D.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){A.editStop()},1);return true});var C=function(A){(A||event).cancelBubble=true};dhtmlxEvent(D.base,"click",C)}}}eXcell_dhxCalendarA.prototype=new eXcell;eXcell_dhxCalendarA.prototype.edit=function(){var B=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);this.grid._grid_calendarA.setPosition(B[0]*1+this.cell.offsetWidth,B[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=false;this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var A=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=A;this.grid._grid_calendarA.draw();this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=(this.cell.offsetHeight-(_isIE?4:2))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(A){(A||event).cancelBubble=true};this.obj.onmousedown=function(A){(A||event).cancelBubble=true};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onselectstart=function(A){if(!A)A=event;A.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};eXcell_dhxCalendarA.prototype.getDate=function(){if(this.cell.val)return this.cell.val;return null};eXcell_dhxCalendarA.prototype.getValue=function(){if(this.cell._clearCell)return"";if(this.grid._dtmask_inc&&this.cell.val)return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString();return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendarA.prototype.detach=function(){if(!this.grid._grid_calendarA)return;this.grid._grid_calendarA.hide();if(this.cell._cediton)this.cell._cediton=false;else return;if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=false;var B=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),C=this.grid._grid_calendarA.getDate();this.cell.val=new Date(C);this.setCValue(B,C);this.cell._clearCell=!B;var A=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(A|"").valueOf())}this.setValue(this.obj.value);A=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(A||"").valueOf())};eXcell_dhxCalendarA.prototype.setValue=function(A){if(A&&typeof A=="object"){this.cell.val=A;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),A).toString(),this.cell.val);return}if(!A||A.toString()._dhx_trim()==""){A="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),A.toString(),null,true));if(this.grid._dtmask_inc)A=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell.val=new Date();this.cell._clearCell=true;this.setCValue("&nbsp;",0)}else this.setCValue((A||"").toString(),this.cell.val)};dhtmlXGridObject.prototype._init_point_bcg=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){if(!window.dhx_globalImgPath)window.dhx_globalImgPath=this.imgURL;this._col_combos=[];for(var A=0;A<this._cCount;A++)if(this.cellType[A].indexOf("combo")==0)this._col_combos[A]=eXcell_combo.prototype.initCombo.call({grid:this},A);if(!this._loading_handler_set)this._loading_handler_set=this.attachEvent("onXLE",function(C,A,B,D){eXcell_combo.prototype.fillColumnCombos(this,D);this.detachEvent(this._loading_handler_set);this._loading_handler_set=null});if(this._init_point_bcg)this._init_point_bcg()};function eXcell_combo(A){if(!A)return;this.cell=A;this.grid=A.parentNode.grid;this._combo_pre="";this.edit=function(){if(!window.dhx_globalImgPath)window.dhx_globalImgPath=this.grid.imgURL;this.val=this.getValue();var A=this.getText();if(this.cell._clearCell)A="";this.cell.innerHTML="";if(!this.cell._brval)this.combo=(this.grid._realfake?this.grid._fake:this.grid)._col_combos[this.cell._cellIndex];else this.combo=this.cell._brval;this.cell.appendChild(this.combo.DOMParent);this.combo.DOMParent.style.margin="0";this.combo.DOMelem_input.focus();this.combo.setSize(this.cell.offsetWidth-2);if(!this.combo._xml){if(this.combo.getIndexByValue(this.cell.combo_value)!=-1)this.combo.selectOption(this.combo.getIndexByValue(this.cell.combo_value));else if(this.combo.getOptionByLabel(A))this.combo.selectOption(this.combo.getIndexByValue(this.combo.getOptionByLabel(A).value));else this.combo.setComboText(A)}else this.combo.setComboText(A);this.combo.openSelect()};this.selectComboOption=function(A,B){B.selectOption(B.getIndexByValue(B.getOptionByLabel(A).value))};this.getValue=function(A){return this.cell.combo_value};this.getText=function(A){var B=this.cell;if(this._combo_pre==""&&B.childNodes[1])B=B.childNodes[1];else B.childNodes[0].childNodes[1];return(_isIE?B.innerText:B.textContent)};this.setValue=function(A){if(typeof(A)=="object"){this.cell._brval=this.initCombo();var B=this.cell._cellIndex,D=this.cell.parentNode.idd;if(!A.firstChild){this.cell.combo_value="&nbsp;";this.cell._clearCell=true}else this.cell.combo_value=A.firstChild.data;this.setComboOptions(this.cell._brval,A,this.grid,B,D)}else{this.cell.combo_value=A;var C=null;if((C=this.cell._brval)&&(typeof(this.cell._brval)=="object"))A=(C.getOption(A)||{}).text||A;else if(C=this.grid._col_combos[this.cell._cellIndex]||((this.grid._fake)&&(C=this.grid._fake._col_combos[this.cell._cellIndex])))A=(C.getOption(A)||{}).text||A;if((A||"").toString()._dhx_trim()=="")A=null;if(A!==null)this.setComboCValue(A);else{this.setComboCValue("&nbsp;","");this.cell._clearCell=true}}};this.detach=function(){this.cell.removeChild(this.combo.DOMParent);var A=this.cell.combo_value;if(!this.combo.getComboText()||this.combo.getComboText().toString()._dhx_trim()==""){this.setComboCValue("&nbsp;");this.cell._clearCell=true}else{this.setComboCValue(this.combo.getComboText(),this.combo.getActualValue());this.cell._clearCell=false}this.combo._confirmSelection();this.cell.combo_value=this.combo.getActualValue();this.combo.closeAll();this.grid._still_active=true;this.grid.setActive(1);return A!=this.cell.combo_value}}eXcell_combo.prototype=new eXcell;eXcell_combo_v=function(A){var B=new eXcell_combo(A);A.style.paddingLeft="0px";A.style.paddingRight="0px";B._combo_pre="<img src='"+(window.dhx_globalImgPath?window.dhx_globalImgPath:this.grid.imgURL)+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif' style='position:absolute;z-index:1;top:0px;right:0px;'/>";return B};eXcell_combo.prototype.initCombo=function(A){var B=document.createElement("DIV"),E=this.grid.defVal[arguments.length?A:this.cell._cellIndex],D=new dhtmlXCombo(B,"combo",0,E);this.grid.defVal[arguments.length?A:this.cell._cellIndex]="";D.DOMelem.className+=" fake_editable";var C=this.grid;D.DOMelem.onselectstart=function(){event.cancelBubble=true;return true};D.attachEvent("onKeyPressed",function(A){if(A==13||A==27){C.editStop();if(C._fake)C._fake.editStop()}});dhtmlxEvent(D.DOMlist,"click",function(){C.editStop();if(C._fake)C._fake.editStop()});D.DOMelem.style.border="0px";D.DOMelem.style.height="18px";return D};eXcell_combo.prototype.fillColumnCombos=function(A,B){if(!B)return;A.combo_columns=A.combo_columns||[];columns=A.xmlLoader.doXPath("//column",B);for(var C=0;C<columns.length;C++)if((columns[C].getAttribute("type")||"").indexOf("combo")==0){A.combo_columns[A.combo_columns.length]=C;this.setComboOptions(A._col_combos[C],columns[C],A,C)}};eXcell_combo.prototype.setComboCValue=function(A,B){if(this._combo_pre!="")A="<div style='width:100%;position:relative;height:100%;overflow:hidden;line-height:20px'>"+this._combo_pre+"<span>"+A+"</span></div>";if(arguments.length>1)this.setCValue(A,B);else this.setCValue(A)};eXcell_combo.prototype.setComboOptions=function(J,I,H,B,F){if(convertStringToBoolean(I.getAttribute("xmlcontent")))if(!I.getAttribute("source")){options=I.childNodes;var C=[];for(var K=0;K<options.length;K++)if(options[K].tagName=="option"){var E=options[K].firstChild?options[K].firstChild.data:"";C[C.length]=[options[K].getAttribute("value"),E]}J.addOption(C);if(arguments.length==4)H.forEachRow(function(A){var C=H.cells(A,B);if(!C.cell._brval&&!C.cell._cellType&&(C.cell._cellIndex==B))if(C.cell.combo_value=="")C.setComboCValue("&nbsp;","");else if(!J.getOption(C.cell.combo_value))C.setComboCValue(C.cell.combo_value);else C.setComboCValue(J.getOption(C.cell.combo_value).text)});else{var D=(this.cell)?this:H.cells(F,B);if(I.getAttribute("text")){if(I.getAttribute("text")._dhx_trim()=="")D.setComboCValue("&nbsp;","");else D.setComboCValue(I.getAttribute("text"))}else if((!D.cell.combo_value)||(D.cell.combo_value._dhx_trim()==""))D.setComboCValue("&nbsp;","");else if(!J.getOption(D.cell.combo_value))D.setComboCValue(D.cell.combo_value);else D.setComboCValue(J.getOption(D.cell.combo_value).text)}}if(I.getAttribute("source"))if(I.getAttribute("auto")&&convertStringToBoolean(I.getAttribute("auto"))){if(I.getAttribute("xmlcontent")){D=(this.cell)?this:H.cells(F,B);if(I.getAttribute("text"))D.setComboCValue(I.getAttribute("text"))}else H.forEachRow(function(A){var E=H.cells(A,B);if(!E.cell._brval&&!E.cell._cellType){var C=E.cell.combo_value.toString();if(C.indexOf("^")!=-1){var D=C.split("^");E.cell.combo_value=D[0];E.setComboCValue(D[1])}}});J.enableFilteringMode(true,I.getAttribute("source"),convertStringToBoolean(I.getAttribute("cache")||true),convertStringToBoolean(I.getAttribute("sub")||false))}else{var A=this,G=arguments.length;J.loadXML(I.getAttribute("source"),function(){if(G==4)H.forEachRow(function(A){var C=H.cells(A,B);if(!C.cell._brval&&!C.cell._cellType)if(J.getOption(C.cell.combo_value))C.setComboCValue(J.getOption(C.cell.combo_value).text);else if((C.cell.combo_value||"").toString()._dhx_trim()==""){C.setComboCValue("&nbsp;","");C.cell._clearCell=true}else C.setComboCValue(C.cell.combo_value)});else{var A=H.cells(F,B);if(J.getOption(A.cell.combo_value))A.setComboCValue(J.getOption(A.cell.combo_value).text);else A.setComboCValue(A.cell.combo_value)}})}if(!I.getAttribute("auto")||!convertStringToBoolean(I.getAttribute("auto"))){if(I.getAttribute("editable")&&!convertStringToBoolean(I.getAttribute("editable")))J.readonly(true);if(I.getAttribute("filter")&&convertStringToBoolean(I.getAttribute("filter")))J.enableFilteringMode(true)}};eXcell_combo.prototype.getCellCombo=function(){if(this.cell._brval)return this.cell._brval;else{this.cell._brval=this.initCombo();return this.cell._brval}};dhtmlXGridObject.prototype.getColumnCombo=function(A){if(this._col_combos&&this._col_combos[A])return this._col_combos[A];else{if(!this._col_combos)this._col_combos=[];this._col_combos[A]=eXcell_combo.prototype.initCombo.call({grid:this},A);return this._col_combos[A]}};function eXcell_cntr(A){this.cell=A;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=true;if(this.grid._h2)this.grid.attachEvent("onOpenEn",function(B){this.resetCounter(A._cellIndex)});this.grid.attachEvent("onBeforeSorting",function(){var B=this;window.setTimeout(function(){if(!B.resetCounter)return;if(B._fake&&!B._realfake&&A._cellIndex<B._fake._cCount)B._fake.resetCounter(A._cellIndex);else B.resetCounter(A._cellIndex)},1);return true})}this.edit=function(){};this.getValue=function(){return this.cell.innerHTML};this.setValue=function(A){this.cell.style.paddingRight="2px";var B=this.cell;window.setTimeout(function(){if(!B.parentNode)return;var A=B.parentNode.rowIndex;if(B.parentNode.grid.currentPage||A<0||B.parentNode.grid._srnd)A=B.parentNode.grid.rowsBuffer._dhx_find(B.parentNode)+1;if(A<=0)return;B.innerHTML=A;if(B.parentNode.grid._fake&&B._cellIndex<B.parentNode.grid._fake._cCount&&B.parentNode.grid._fake.rowsAr[B.parentNode.idd])B.parentNode.grid._fake.cells(B.parentNode.idd,B._cellIndex).setCValue(A);B=null},100)}}dhtmlXGridObject.prototype.resetCounter=function(A){if(this._fake&&!this._realfake&&A<this._fake._cCount)this._fake.resetCounter(A,this.currentPage);var B=arguments[0]||0;if(this.currentPage)B=(this.currentPage-1)*this.rowsBufferOutSize;for(B=0;B<this.rowsBuffer.length;B++)if(this.rowsBuffer[B]&&this.rowsBuffer[B].tagName=="TR"&&this.rowsAr[this.rowsBuffer[B].idd])this.rowsAr[this.rowsBuffer[B].idd].childNodes[A].innerHTML=B+1};eXcell_cntr.prototype=new eXcell;function eXcell_link(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return true};this.edit=function(){};this.getValue=function(){if(this.cell.firstChild.getAttribute){var A=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(A?("^"+A):"")}else return""};this.setValue=function(A){if((typeof(A)!="number")&&(!A||A.toString()._dhx_trim()=="")){this.setCValue("&nbsp;",B);return(this.cell._clearCell=true)}var B=A.split("^");if(B.length==1)B[1]="";else if(B.length>1){B[1]="href='"+B[1]+"'";if(B.length==3)B[1]+=" target='"+B[2]+"'";else B[1]+=" target='_blank'"}this.setCValue("<a "+B[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+B[0]+"</a>",B)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var A=this.cell.firstChild;return((A&&A.tagName)?A.getAttribute("href"):"")};eXcell_link.prototype.getContent=function(){var A=this.cell.firstChild;return((A&&A.tagName)?A.innerHTML:"")};function eXcell_clist(A){try{this.cell=A;this.grid=this.cell.parentNode.grid}catch(B){}this.edit=function(){this.val=this.getValue();var E=(this.cell._combo||this.grid.clists[this.cell._cellIndex]);if(!E)return;this.obj=document.createElement("DIV");var C=this.val.split(","),A="";for(var G=0;G<E.length;G++){var B=false;for(var F=0;F<C.length;F++)if(E[G]==C[F])B=true;if(B)A+="<div><input type='checkbox' checked='true' /><label>"+E[G]+"</label></div>";else A+="<div><input type='checkbox' id='ch_lst_"+G+"'/><label>"+E[G]+"</label></div>"}A+="<div><input type='button' value='Apply' style='width:100px;font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";this.obj.editor=this;this.obj.innerHTML=A;document.body.appendChild(this.obj);this.obj.style.position="absolute";this.obj.className="dhx_clist";this.obj.onclick=function(A){(A||event).cancelBubble=true;return true};var D=this.grid.getPosition(this.cell);this.obj.style.left=D[0]+"px";this.obj.style.top=D[1]+this.cell.offsetHeight+"px";this.obj.getValue=function(){var A="";for(var B=0;B<this.childNodes.length-1;B++)if(this.childNodes[B].childNodes[0].checked){if(A)A+=",";A+=this.childNodes[B].childNodes[1].innerHTML}return A}};this.getValue=function(){if(this.cell._clearCell)return"";return this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(A){if(this.obj){this.setValue(this.obj.getValue());this.obj.editor=null;this.obj.parentNode.removeChild(this.obj);this.obj=null}return this.val!=this.getValue()}}eXcell_clist.prototype=new eXcell;eXcell_clist.prototype.setValue=function(A){if(typeof(A)=="object"){var B=this.grid.xmlLoader.doXPath("./option",A);if(B.length)this.cell._combo=[];for(var C=0;C<B.length;C++)this.cell._combo.push(B[C].firstChild?B[C].firstChild.data:"");A=A.firstChild.data}if(A===""||A===this.undefined){this.setCTxtValue(" ",A);this.cell._clearCell=true}else{this.setCValue(A);this.cell._clearCell=false}};dhtmlXGridObject.prototype.registerCList=function(A,B){if(!this.clists)this.clists=new Array();if(typeof(B)!="object")B=B.split(",");this.clists[A]=B};function xmlPointer(A){this.d=A}xmlPointer.prototype={text:function(){if(!_isFF)return this.d.xml;var A=new XMLSerializer();return A.serializeToString(this.d)},get:function(A){return this.d.getAttribute(A)},exists:function(){return!!this.d},content:function(){return this.d.firstChild?this.d.firstChild.data:""},each:function(E,A,B,F){var D=this.d.childNodes,C=new xmlPointer();if(D.length)for(F=F||0;F<D.length;F++)if(D[F].tagName==E){C.d=D[F];if(A.apply(B,[C,F])==-1)return}},get_all:function(){var B={},A=this.d.attributes;for(var C=0;C<A.length;C++)B[A[C].name]=A[C].value;return B},sub:function(C){var B=this.d.childNodes,A=new xmlPointer();if(B.length)for(var D=0;D<B.length;D++)if(B[D].tagName==C){A.d=B[D];return A}},up:function(A){return new xmlPointer(this.d.parentNode)},set:function(B,A){this.d.setAttribute(B,A)},clone:function(A){return new xmlPointer(this.d)},sub_exists:function(B){var A=this.d.childNodes;if(A.length)for(var C=0;C<A.length;C++)if(A[C].tagName==B)return true;return false},through:function(H,G,C,B,D){var F=this.d.childNodes;if(F.length)for(var I=0;I<F.length;I++){if(F[I].tagName==H&&F[I].getAttribute(G)!=null&&F[I].getAttribute(G)!=""&&(!C||F[I].getAttribute(G)==C)){var E=new xmlPointer(F[I]);B.apply(D,[E,I])}var A=this.d;this.d=F[I];this.through(H,G,C,B,D);this.d=A}}};function dhtmlXTreeObject(A,E,C,D){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(B){}}if(typeof(A)!="object")this.parentObject=document.getElementById(A);else this.parentObject=A;this.parentObject.style.overflow="hidden";this._itim_dg=true;this.dlmtr=",";this.dropLower=false;this.enableIEImageFix();this.xmlstate=0;this.mytype="tree";this.smcheck=true;this.width=E;this.height=C;this.rootId=D;this.childCalc=null;this.def_img_x="18px";this.def_img_y="18px";this.def_line_img_x="18px";this.def_line_img_y="18px";this._dragged=new Array();this._selected=new Array();this.style_pointer="pointer";this._aimgs=true;this.htmlcA=" [";this.htmlcB="]";this.lWin=window;this.cMenu=0;this.mlitems=0;this.iconURL="";this.dadmode=0;this.slowParse=false;this.autoScroll=true;this.hfMode=0;this.nodeCut=new Array();this.XMLsource=0;this.XMLloadingWarning=0;this._idpull={};this._pullSize=0;this.treeLinesOn=true;this.tscheck=false;this.timgen=true;this.dpcpy=false;this._ld_id=null;this._oie_onXLE=[];this.imPath=window.dhx_globalImgPath||"";this.checkArray=new Array("iconUncheckAll.gif","iconCheckAll.gif","iconCheckGray.gif","iconUncheckDis.gif","iconCheckDis.gif","iconCheckDis.gif");this.radioArray=new Array("radio_off.gif","radio_on.gif","radio_on.gif","radio_off.gif","radio_on.gif","radio_on.gif");this.lineArray=new Array("line2.gif","line3.gif","line4.gif","blank.gif","blank.gif","line1.gif");this.minusArray=new Array("minus2.gif","minus3.gif","minus4.gif","minus.gif","minus5.gif");this.plusArray=new Array("plus2.gif","plus3.gif","plus4.gif","plus.gif","plus5.gif");this.imageArray=new Array("leaf.gif","folderOpen.gif","folderClosed.gif");this.cutImg=new Array(0,0,0);this.cutImage="but_cut.gif";dhtmlxEventable(this);this.dragger=new dhtmlDragAndDropObject();this.htmlNode=new dhtmlXTreeItemObject(this.rootId,"",0,this);this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display="none";this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className="hiddenRow";this.allTree=this._createSelf();this.allTree.appendChild(this.htmlNode.htmlNode);if(_isFF){this.allTree.childNodes[0].width="100%";this.allTree.childNodes[0].style.overflow="hidden"}var F=this;this.allTree.onselectstart=new Function("return false;");if(_isMacOS)this.allTree.oncontextmenu=function(A){return F._doContClick(A||window.event,true)};this.allTree.onmousedown=function(A){return F._doContClick(A||window.event)};this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(_isIE)this.preventIECashing(true);this.selectionBar=document.createElement("DIV");this.selectionBar.className="selectionBar";this.selectionBar.innerHTML="&nbsp;";this.selectionBar.style.display="none";this.allTree.appendChild(this.selectionBar);if(window.addEventListener)window.addEventListener("unload",function(){try{F.destructor()}catch(A){}},false);if(window.attachEvent)window.attachEvent("onunload",function(){try{F.destructor()}catch(A){}});this.setImagesPath=this.setImagePath;this.setIconsPath=this.setIconPath;if(dhtmlx.image_path)this.setImagePath(dhtmlx.image_path);if(dhtmlx.skin)this.setSkin(dhtmlx.skin);return this}dhtmlXTreeObject.prototype.setDataMode=function(A){this._datamode=A};dhtmlXTreeObject.prototype._doContClick=function(A,G){if(!G&&A.button!=2){if(this._acMenu)if(this._acMenu.hideContextMenu)this._acMenu.hideContextMenu();else this.cMenu._contextEnd();return true}var B=(_isIE?A.srcElement:A.target);while((B)&&(B.tagName!="BODY")){if(B.parentObject)break;B=B.parentNode}if((!B)||(!B.parentObject))return true;var E=B.parentObject;if(!this.callEvent("onRightClick",[E.id,A]))(A.srcElement||A.target).oncontextmenu=function(A){(A||event).cancelBubble=true;return false};this._acMenu=(E.cMenu||this.cMenu);if(this._acMenu){if(!(this.callEvent("onBeforeContextMenu",[E.id])))return true;(A.srcElement||A.target).oncontextmenu=function(A){(A||event).cancelBubble=true;return false};if(this._acMenu.showContextMenu){var D=window.document.documentElement,F=window.document.body,C=new Array((D.scrollLeft||F.scrollLeft),(D.scrollTop||F.scrollTop));if(_isIE)var I=A.clientX+C[0],H=A.clientY+C[1];else I=A.pageX,H=A.pageY;this._acMenu.showContextMenu(I-1,H-1);this.contextID=E.id;A.cancelBubble=true;this._acMenu._skip_hide=true}else{B.contextMenuId=E.id;B.contextMenu=this._acMenu;B.a=this._acMenu._contextStart;B.a(B,A);B.a=null}return false}return true};dhtmlXTreeObject.prototype.enableIEImageFix=function(A){if(!A){this._getImg=function(A){return document.createElement((A==this.rootId)?"div":"img")};this._setSrc=function(B,A){B.src=A};this._getSrc=function(A){return A.src}}else{this._getImg=function(){var A=document.createElement("DIV");A.innerHTML="&nbsp;";A.className="dhx_bg_img_fix";return A};this._setSrc=function(B,A){B.style.backgroundImage="url("+A+")"};this._getSrc=function(A){var B=A.style.backgroundImage;return B.substr(4,B.length-5).replace(/(^")|("$)/g,"")}}};dhtmlXTreeObject.prototype.destructor=function(){for(var A in this._idpull){var B=this._idpull[A];if(!B)continue;B.parentObject=null;B.treeNod=null;B.childNodes=null;B.span=null;B.tr.nodem=null;B.tr=null;B.htmlNode.objBelong=null;B.htmlNode=null;this._idpull[A]=null}this.parentObject.innerHTML="";if(this.XMLLoader)this.XMLLoader.destructor();this.allTree.onselectstart=null;this.allTree.oncontextmenu=null;this.allTree.onmousedown=null;for(A in this)this[A]=null};function cObject(){return this}cObject.prototype=new Object;cObject.prototype.clone=function(){function A(){}A.prototype=this;return new A()};function dhtmlXTreeItemObject(C,B,A,F,D,E){this.htmlNode="";this.acolor="";this.scolor="";this.tr=0;this.childsCount=0;this.tempDOMM=0;this.tempDOMU=0;this.dragSpan=0;this.dragMove=0;this.span=0;this.closeble=1;this.childNodes=new Array();this.userData=new cObject();this.checkstate=0;this.treeNod=F;this.label=B;this.parentObject=A;this.actionHandler=D;this.images=new Array(F.imageArray[0],F.imageArray[1],F.imageArray[2]);this.id=F._globalIdStorageAdd(C,this);if(this.treeNod.checkBoxOff)this.htmlNode=this.treeNod._createItem(1,this,E);else this.htmlNode=this.treeNod._createItem(0,this,E);this.htmlNode.objBelong=this;return this}dhtmlXTreeObject.prototype._globalIdStorageAdd=function(A,B){if(this._globalIdStorageFind(A,1,1)){A=A+"_"+(new Date()).valueOf();return this._globalIdStorageAdd(A,B)}this._idpull[A]=B;this._pullSize++;return A};dhtmlXTreeObject.prototype._globalIdStorageSub=function(A){if(this._idpull[A]){this._unselectItem(this._idpull[A]);this._idpull[A]=null;this._pullSize--}if((this._locker)&&(this._locker[A]))this._locker[A]=false};dhtmlXTreeObject.prototype._globalIdStorageFind=function(E,C,B,A){var F=this._idpull[E];if(F){if((F.unParsed)&&(!B))this.reParse(F,0);if(this._srnd&&!F.htmlNode)this._buildSRND(F,B);if((A)&&(this._edsbpsA))for(var D=0;D<this._edsbpsA.length;D++)if(this._edsbpsA[D][2]==E){dhtmlxError.throwError("getItem","Requested item still in parsing process.",E);return null}return F}if((this.slowParse)&&(E!=0)&&(!C))return this.preParse(E);else return null};dhtmlXTreeObject.prototype._getSubItemsXML=function(A){var B=[];A.each("item",function(A){B.push(A.get("id"))},this);return B.join(this.dlmtr)};dhtmlXTreeObject.prototype.enableSmartXMLParsing=function(A){this.slowParse=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.findXML=function(C,B,A){};dhtmlXTreeObject.prototype._getAllCheckedXML=function(A,B,D){var C=[];if(D==2)A.through("item","checked",-1,function(A){C.push(A.get("id"))},this);if(D==1)A.through("item","id",null,function(A){if(A.get("checked")&&(A.get("checked")!=-1))C.push(A.get("id"))},this);if(D==0)A.through("item","id",null,function(A){if(!A.get("checked")||A.get("checked")==0)C.push(A.get("id"))},this);if(C.length)return B+(B?this.dlmtr:"")+C.join(this.dlmtr);if(B)return B;else return""};dhtmlXTreeObject.prototype._setSubCheckedXML=function(C,B){var A=C?"1":"";B.through("item","id",null,function(B){B.set("checked",A)},this)};dhtmlXTreeObject.prototype._getAllScraggyItemsXML=function(B,D){var C=[],A=function(B){if(!B.sub_exists("item"))C.push(B.get("id"));else B.each("item",A,this)};A(B);return C.join(",")};dhtmlXTreeObject.prototype._getAllFatItemsXML=function(B,D){var C=[],A=function(B){if(!B.sub_exists("item"))return;C.push(B.get("id"));B.each("item",A,this)};A(B);return C.join(",")};dhtmlXTreeObject.prototype._getAllSubItemsXML=function(B,C,A){var C=[];A.through("item","id",null,function(A){C.push(A.get("id"))},this);return C.join(",")};dhtmlXTreeObject.prototype.reParse=function(B){var A=this;if(!this.parsCount)A.callEvent("onXLS",[A,B.id]);this.xmlstate=1;var G=B.unParsed;B.unParsed=0;this.XMLloadingWarning=1;var I=this.parsingOn,C=this.waitUpdateXML,F=this.parsedArray;this.parsedArray=new Array();this.waitUpdateXML=false;this.parsingOn=B.id;this.parsedArray=new Array();this.setCheckList="";this._parse(G,B.id,2);var D=this.setCheckList.split(this.dlmtr);for(var H=0;H<this.parsedArray.length;H++)B.htmlNode.childNodes[0].appendChild(this.parsedArray[H]);if(G.get("order")&&G.get("order")!="none")this._reorderBranch(B,G.get("order"),true);this.oldsmcheck=this.smcheck;this.smcheck=false;for(var E=0;E<D.length;E++)if(D[E])this.setCheck(D[E],1);this.smcheck=this.oldsmcheck;this.parsingOn=I;this.waitUpdateXML=C;this.parsedArray=F;this.XMLloadingWarning=0;this._redrawFrom(this,B);if(this._srnd&&!B._sready)this.prepareSR(B.id);this.xmlstate=0;return true};dhtmlXTreeObject.prototype.preParse=function(C){if(!C||!this._p)return null;var A=false;this._p.clone().through("item","id",C,function(B){this._globalIdStorageFind(B.up().get("id"));return A=true},this);if(A){var B=this._globalIdStorageFind(C,true,false);if(!B)dhtmlxError.throwError("getItem","The item "+C+" not operable. Seems you have non-unique|incorrect IDs in tree's XML.",C)}return B};dhtmlXTreeObject.prototype._escape=function(A){switch(this.utfesc){case"none":return A;break;case"utf8":return encodeURIComponent(A);break;default:return escape(A);break}};dhtmlXTreeObject.prototype._drawNewTr=function(B,A){var C=document.createElement("tr"),D=document.createElement("td"),E=document.createElement("td");D.appendChild(document.createTextNode(" "));E.colSpan=3;E.appendChild(B);C.appendChild(D);C.appendChild(E);return C};dhtmlXTreeObject.prototype.loadXMLString=function(C,B){var A=this;if(!this.parsCount)this.callEvent("onXLS",[A,null]);this.xmlstate=1;if(B)this.XMLLoader.waitCall=B;this.XMLLoader.loadXMLString(C)};dhtmlXTreeObject.prototype.loadXML=function(C,B){if(this._datamode&&this._datamode!="xml")return this["load"+this._datamode.toUpperCase()](C,B);var A=this;if(!this.parsCount)this.callEvent("onXLS",[A,this._ld_id]);this._ld_id=null;this.xmlstate=1;this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(B)this.XMLLoader.waitCall=B;this.XMLLoader.loadXML(C)};dhtmlXTreeObject.prototype._attachChildNode=function(J,K,Q,B,O,N,T,C,R,G,P){if(G&&G.parentObject)J=G.parentObject;if(((J.XMLload==0)&&(this.XMLsource))&&(!this.XMLloadingWarning)){J.XMLload=1;this._loadDynXML(J.id)}var E=J.childsCount,S=J.childNodes;if(P&&P.tr.previousSibling)if(P.tr.previousSibling.previousSibling)G=P.tr.previousSibling.nodem;else C=C.replace("TOP","")+",TOP";if(G){var I,M;for(I=0;I<E;I++)if(S[I]==G){for(M=E;M!=I;M--)S[1+M]=S[M];break}I++;E=I}if(C){var A=C.split(",");for(var L=0;L<A.length;L++)switch(A[L]){case"TOP":if(J.childsCount>0){G=new Object;G.tr=J.childNodes[0].tr.previousSibling}J._has_top=true;for(I=E;I>0;I--)S[I]=S[I-1];E=0;break}}var H;if(!(H=this._idpull[K])||H.span!=-1){H=S[E]=new dhtmlXTreeItemObject(K,Q,J,this,B,1);K=S[E].id;J.childsCount++}if(!H.htmlNode){H.label=Q;H.htmlNode=this._createItem((this.checkBoxOff?1:0),H);H.htmlNode.objBelong=H}if(O)H.images[0]=O;if(N)H.images[1]=N;if(T)H.images[2]=T;var F=this._drawNewTr(H.htmlNode);if((this.XMLloadingWarning)||(this._hAdI))H.htmlNode.parentNode.parentNode.style.display="none";if((G)&&G.tr&&(G.tr.nextSibling))J.htmlNode.childNodes[0].insertBefore(F,G.tr.nextSibling);else if(this.parsingOn==J.id)this.parsedArray[this.parsedArray.length]=F;else J.htmlNode.childNodes[0].appendChild(F);if((G)&&(!G.span))G=null;if(this.XMLsource)if((R)&&(R!=0))H.XMLload=0;else H.XMLload=1;H.tr=F;F.nodem=H;if(J.itemId==0)F.childNodes[0].className="hiddenRow";if((J._r_logic)||(this._frbtr))this._setSrc(H.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0],this.imPath+this.radioArray[0]);if(C){A=C.split(",");for(L=0;L<A.length;L++)switch(A[L]){case"SELECT":this.selectItem(K,false);break;case"CALL":this.selectItem(K,true);break;case"CHILD":H.XMLload=0;break;case"CHECKED":if(this.XMLloadingWarning)this.setCheckList+=this.dlmtr+K;else this.setCheck(K,1);break;case"HCHECKED":this._setCheck(H,"unsure");break;case"OPEN":H.openMe=1;break}}if(!this.XMLloadingWarning){if((this._getOpenState(J)<0)&&(!this._hAdI))this.openItem(J.id);if(G){this._correctPlus(G);this._correctLine(G)}this._correctPlus(J);this._correctLine(J);this._correctPlus(H);if(J.childsCount>=2){this._correctPlus(S[J.childsCount-2]);this._correctLine(S[J.childsCount-2])}if(J.childsCount!=2)this._correctPlus(S[0]);if(this.tscheck)this._correctCheckStates(J);if(this._onradh)if(this.xmlstate==1){var D=this.onXLE;this.onXLE=function(A){this._onradh(K);if(D)D(A)}}else this._onradh(K)}return H};dhtmlXTreeObject.prototype.enableContextMenu=function(A){if(A)this.cMenu=A};dhtmlXTreeObject.prototype.setItemContextMenu=function(D,A){var C=D.toString().split(this.dlmtr);for(var E=0;E<C.length;E++){var B=this._globalIdStorageFind(C[E]);if(!B)continue;B.cMenu=A}};dhtmlXTreeObject.prototype.insertNewItem=function(C,I,H,B,E,D,J,A,F){var G=this._globalIdStorageFind(C);if(!G)return(-1);var K=this._attachChildNode(G,I,H,B,E,D,J,A,F);if(!this._idpull[this.rootId].XMLload)this._idpull[this.rootId].XMLload=1;if((!this.XMLloadingWarning)&&(this.childCalc))this._fixChildCountLabel(G);return K};dhtmlXTreeObject.prototype.insertNewChild=function(C,H,G,B,E,D,I,A,F){return this.insertNewItem(C,H,G,B,E,D,I,A,F)};dhtmlXTreeObject.prototype._parseXMLTree=function(E,B,C,A,F){var D=new xmlPointer(F.getXMLTopNode("tree"));E._parse(D);E._p=D};dhtmlXTreeObject.prototype._parseItem=function(D,G,I,B){var A;if(this._srnd&&(!this._idpull[A=D.get("id")]||!this._idpull[A].span)){this._addItemSRND(G.id,A,D);return}var E=D.get_all();if((typeof(this.waitUpdateXML)=="object")&&(!this.waitUpdateXML[E.id])){this._parse(D,E.id,1);return}if((E.text===null)||(typeof(E.text)=="undefined")){E.text=D.sub("itemtext");if(E.text)E.text=E.text.content()}var H=[];if(E.select)H.push("SELECT");if(E.top)H.push("TOP");if(E.call)this.nodeAskingCall=E.id;if(E.checked==-1)H.push("HCHECKED");else if(E.checked)H.push("CHECKED");if(E.open)H.push("OPEN");if(this.waitUpdateXML){if(this._globalIdStorageFind(E.id))var J=this.updateItem(E.id,E.text,E.im0,E.im1,E.im2,E.checked,E.child);else{if(this.npl==0)H.push("TOP");else I=G.childNodes[this.npl];J=this._attachChildNode(G,E.id,E.text,0,E.im0,E.im1,E.im2,H.join(","),E.child,0,I);E.id=J.id;I=null}}else J=this._attachChildNode(G,E.id,E.text,0,E.im0,E.im1,E.im2,H.join(","),E.child,(B||0),I);if(E.tooltip)J.span.parentNode.parentNode.title=E.tooltip;if(E.style)if(J.span.style.cssText)J.span.style.cssText+=(";"+E.style);else J.span.setAttribute("style",J.span.getAttribute("style")+";"+E.style);if(E.radio)J._r_logic=true;if(E.nocheckbox){var F=J.span.parentNode.previousSibling.previousSibling;F.childNodes[0].style.display="none";if(window._KHTMLrv)F.style.display="none";J.nocheckbox=true}if(E.disabled){if(E.checked!=null)this._setCheck(J,E.checked);this.disableCheckbox(J,1)}J._acc=E.child||0;if(this.parserExtension)this.parserExtension._parseExtension.call(this,D,E,(G?G.id:0));this.setItemColor(J,E.aCol,E.sCol);if(E.locked=="1")this.lockItem(J.id,true,true);if((E.imwidth)||(E.imheight))this.setIconSize(E.imwidth,E.imheight,J);if((E.closeable=="0")||(E.closeable=="1"))this.setItemCloseable(J,E.closeable);var C="";if(E.topoffset)this.setItemTopOffset(J,E.topoffset);if((!this.slowParse)||(typeof(this.waitUpdateXML)=="object")){if(D.sub_exists("item"))C=this._parse(D,E.id,1)}else{if((!J.childsCount)&&D.sub_exists("item"))J.unParsed=D.clone();D.each("userdata",function(A){this.setUserData(E.id,A.get("name"),A.content())},this)}if(C!="")this.nodeAskingCall=C;D.each("userdata",function(A){this.setUserData(D.get("id"),A.get("name"),A.content())},this)};dhtmlXTreeObject.prototype._parse=function(I,F,G,H){if(this._srnd&&!this.parentObject.offsetHeight){var C=this;return window.setTimeout(function(){C._parse(I,F,G,H)},100)}if(!I.exists())return;this.skipLock=true;if(!F){F=I.get("id");var J=I.get("dhx_security");if(J)dhtmlx.security_key=J;if(I.get("radio"))this.htmlNode._r_logic=true;this.parsingOn=F;this.parsedArray=new Array();this.setCheckList="";this.nodeAskingCall=""}var K=this._globalIdStorageFind(F);if(!K)return dhtmlxError.throwError("DataStructure","XML refers to not existing parent");this.parsCount=this.parsCount?(this.parsCount+1):1;this.XMLloadingWarning=1;if((K.childsCount)&&(!H)&&(!this._edsbps)&&(!K._has_top))var M=0;else M=0;this.npl=0;I.each("item",function(A,B){K.XMLload=1;this._parseItem(A,K,0,M);if((this._edsbps)&&(this.npl==this._edsbpsC)){this._distributedStart(I,B+1,F,G,K.childsCount);return-1}this.npl++},this,H);if(!G){I.each("userdata",function(A){this.setUserData(I.get("id"),A.get("name"),A.content())},this);K.XMLload=1;if(this.waitUpdateXML){this.waitUpdateXML=false;for(var D=K.childsCount-1;D>=0;D--)if(K.childNodes[D]._dmark)this.deleteItem(K.childNodes[D].id)}var L=this._globalIdStorageFind(this.parsingOn);for(D=0;D<this.parsedArray.length;D++)K.htmlNode.childNodes[0].appendChild(this.parsedArray[D]);this.parsedArray=[];this.lastLoadedXMLId=F;this.XMLloadingWarning=0;var A=this.setCheckList.split(this.dlmtr);for(var B=0;B<A.length;B++)if(A[B])this.setCheck(A[B],1);if((this.XMLsource)&&(this.tscheck)&&(this.smcheck)&&(K.id!=this.rootId))if(K.checkstate===0)this._setSubChecked(0,K);else if(K.checkstate===1)this._setSubChecked(1,K);this._redrawFrom(this,null,H);if(I.get("order")&&I.get("order")!="none")this._reorderBranch(K,I.get("order"),true);if(this.nodeAskingCall!="")this.callEvent("onClick",[this.nodeAskingCall,this.getSelectedItemId()]);if(this._branchUpdate)this._branchUpdateNext(I)}if(this.parsCount==1){this.parsingOn=null;if(this._srnd&&K.id!=this.rootId){this.prepareSR(K.id);if(this.XMLsource)this.openItem(K.id)}I.through("item","open",null,function(A){this.openItem(A.get("id"))},this);if((!this._edsbps)||(!this._edsbpsA.length)){var E=this;window.setTimeout(function(){E.callEvent("onXLE",[E,F])},1);this.xmlstate=0}this.skipLock=false}this.parsCount--;E=this;if(this._edsbps)window.setTimeout(function(){E._distributedStep(F)},this._edsbpsD);if(!G&&this.onXLE)this.onXLE(this,F);return this.nodeAskingCall};dhtmlXTreeObject.prototype._branchUpdateNext=function(A){A.each("item",function(A){var B=A.get("id");if(this._idpull[B]&&(!this._idpull[B].XMLload))return;this._branchUpdate++;this.smartRefreshItem(A.get("id"),A)},this);this._branchUpdate--};dhtmlXTreeObject.prototype.checkUserData=function(B,A){if((B.nodeType==1)&&(B.tagName=="userdata")){var C=B.getAttribute("name");if((C)&&(B.childNodes[0]))this.setUserData(A,C,B.childNodes[0].data)}};dhtmlXTreeObject.prototype._redrawFrom=function(H,G,C,D){if(!G){var B=H._globalIdStorageFind(H.lastLoadedXMLId);H.lastLoadedXMLId=-1;if(!B)return 0}else B=G;var E=0;for(var F=(C?C-1:0);F<B.childsCount;F++){if((!this._branchUpdate)||(this._getOpenState(B)==1))if((!G)||(D==1))B.childNodes[F].htmlNode.parentNode.parentNode.style.display="";if(B.childNodes[F].openMe==1){this._openItem(B.childNodes[F]);B.childNodes[F].openMe=0}H._redrawFrom(H,B.childNodes[F]);if(this.childCalc!=null){if((B.childNodes[F].unParsed)||((!B.childNodes[F].XMLload)&&(this.XMLsource)))if(B.childNodes[F]._acc)B.childNodes[F].span.innerHTML=B.childNodes[F].label+this.htmlcA+B.childNodes[F]._acc+this.htmlcB;else B.childNodes[F].span.innerHTML=B.childNodes[F].label;if((B.childNodes[F].childNodes.length)&&(this.childCalc)){if(this.childCalc==1)B.childNodes[F].span.innerHTML=B.childNodes[F].label+this.htmlcA+B.childNodes[F].childsCount+this.htmlcB;if(this.childCalc==2){var A=B.childNodes[F].childsCount-(B.childNodes[F].pureChilds||0);if(A)B.childNodes[F].span.innerHTML=B.childNodes[F].label+this.htmlcA+A+this.htmlcB;if(B.pureChilds)B.pureChilds++;else B.pureChilds=1}if(this.childCalc==3)B.childNodes[F].span.innerHTML=B.childNodes[F].label+this.htmlcA+B.childNodes[F]._acc+this.htmlcB;if(this.childCalc==4){A=B.childNodes[F]._acc;if(A)B.childNodes[F].span.innerHTML=B.childNodes[F].label+this.htmlcA+A+this.htmlcB}}else if(this.childCalc==4)E++;E+=B.childNodes[F]._acc;if(this.childCalc==3)E++}}if((!B.unParsed)&&((B.XMLload)||(!this.XMLsource)))B._acc=E;H._correctLine(B);H._correctPlus(B);if((this.childCalc)&&(!G))H._fixChildCountLabel(B)};dhtmlXTreeObject.prototype._createSelf=function(){var A=document.createElement("div");A.className="containerTableStyle";A.style.width=this.width;A.style.height=this.height;this.parentObject.appendChild(A);return A};dhtmlXTreeObject.prototype._xcloseAll=function(D){if(D.unParsed)return;if(this.rootId!=D.id){if(!D.htmlNode)return;var B=D.htmlNode.childNodes[0].childNodes,A=B.length;for(var C=1;C<A;C++)B[C].style.display="none";this._correctPlus(D)}for(C=0;C<D.childsCount;C++)if(D.childNodes[C].childsCount)this._xcloseAll(D.childNodes[C])};dhtmlXTreeObject.prototype._xopenAll=function(B){this._HideShow(B,2);for(var A=0;A<B.childsCount;A++)this._xopenAll(B.childNodes[A])};dhtmlXTreeObject.prototype._correctPlus=function(E){if(!E.htmlNode)return;var D=E.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild,A=E.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0],C=this.lineArray;if((this.XMLsource)&&(!E.XMLload)){C=this.plusArray;this._setSrc(A,this.iconURL+E.images[2]);if(this._txtimg)return(D.innerHTML="[+]")}else if((E.childsCount)||(E.unParsed)){if((E.htmlNode.childNodes[0].childNodes[1])&&(E.htmlNode.childNodes[0].childNodes[1].style.display!="none")){if(!E.wsign)C=this.minusArray;this._setSrc(A,this.iconURL+E.images[1]);if(this._txtimg)return(D.innerHTML="[-]")}else{if(!E.wsign)C=this.plusArray;this._setSrc(A,this.iconURL+E.images[2]);if(this._txtimg)return(D.innerHTML="[+]")}}else this._setSrc(A,this.iconURL+E.images[0]);var B=2;if(!E.treeNod.treeLinesOn)this._setSrc(D,this.imPath+C[3]);else{if(E.parentObject)B=this._getCountStatus(E.id,E.parentObject);this._setSrc(D,this.imPath+C[B])}};dhtmlXTreeObject.prototype._correctLine=function(C){if(!C.htmlNode)return;var A=C.parentObject;if(A)if((this._getLineStatus(C.id,A)==0)||(!this.treeLinesOn)){for(var B=1;B<=C.childsCount;B++){if(!C.htmlNode.childNodes[0].childNodes[B])break;C.htmlNode.childNodes[0].childNodes[B].childNodes[0].style.backgroundImage="";C.htmlNode.childNodes[0].childNodes[B].childNodes[0].style.backgroundRepeat=""}}else for(B=1;B<=C.childsCount;B++){if(!C.htmlNode.childNodes[0].childNodes[B])break;C.htmlNode.childNodes[0].childNodes[B].childNodes[0].style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";C.htmlNode.childNodes[0].childNodes[B].childNodes[0].style.backgroundRepeat="repeat-y"}};dhtmlXTreeObject.prototype._getCountStatus=function(A,B){if(B.childsCount<=1)if(B.id==this.rootId)return 4;else return 0;if(B.childNodes[0].id==A)if(B.id==this.rootId)return 2;else return 1;if(B.childNodes[B.childsCount-1].id==A)return 0;return 1};dhtmlXTreeObject.prototype._getLineStatus=function(A,B){if(B.childNodes[B.childsCount-1].id==A)return 0;return 1};dhtmlXTreeObject.prototype._HideShow=function(E,D){if((this.XMLsource)&&(!E.XMLload)){if(D==1)return;E.XMLload=1;this._loadDynXML(E.id);return}if(E.unParsed)this.reParse(E);var B=E.htmlNode.childNodes[0].childNodes,A=B.length;if(A>1){if(((B[1].style.display!="none")||(D==1))&&(D!=2)){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";nodestyle="none"}else nodestyle="";for(var C=1;C<A;C++)B[C].style.display=nodestyle}this._correctPlus(E)};dhtmlXTreeObject.prototype._getOpenState=function(B){if(!B.htmlNode)return 0;var A=B.htmlNode.childNodes[0].childNodes;if(A.length<=1)return 0;if(A[1].style.display!="none")return 1;else return-1};dhtmlXTreeObject.prototype.onRowClick2=function(){var A=this.parentObject.treeNod;if(!A.callEvent("onDblClick",[this.parentObject.id,A]))return false;if((this.parentObject.closeble)&&(this.parentObject.closeble!="0"))A._HideShow(this.parentObject);else A._HideShow(this.parentObject,2);if(A.checkEvent("onOpenEnd"))if(!A.xmlstate)A.callEvent("onOpenEnd",[this.parentObject.id,A._getOpenState(this.parentObject)]);else{A._oie_onXLE.push(A.onXLE);A.onXLE=A._epnFHe}return false};dhtmlXTreeObject.prototype.onRowClick=function(){var A=this.parentObject.treeNod;if(!A.callEvent("onOpenStart",[this.parentObject.id,A._getOpenState(this.parentObject)]))return 0;if((this.parentObject.closeble)&&(this.parentObject.closeble!="0"))A._HideShow(this.parentObject);else A._HideShow(this.parentObject,2);if(A.checkEvent("onOpenEnd"))if(!A.xmlstate)A.callEvent("onOpenEnd",[this.parentObject.id,A._getOpenState(this.parentObject)]);else{A._oie_onXLE.push(A.onXLE);A.onXLE=A._epnFHe}};dhtmlXTreeObject.prototype._epnFHe=function(B,A,C){if(A!=this.rootId)this.callEvent("onOpenEnd",[A,B.getOpenState(A)]);B.onXLE=B._oie_onXLE.pop();if(!C&&!B._oie_onXLE.length)if(B.onXLE)B.onXLE(B,A)};dhtmlXTreeObject.prototype.onRowClickDown=function(B){B=B||window.event;var A=this.parentObject.treeNod;A._selectItem(this.parentObject,B)};dhtmlXTreeObject.prototype.getSelectedItemId=function(){var A=new Array();for(var B=0;B<this._selected.length;B++)A[B]=this._selected[B].id;return(A.join(this.dlmtr))};dhtmlXTreeObject.prototype._selectItem=function(A,B){if(this.checkEvent("onSelect"))this._onSSCFold=this.getSelectedItemId();if((!this._amsel)||(!B)||((!B.ctrlKey)&&(!B.metaKey)&&(!B.shiftKey)))this._unselectItems();if((A.i_sel)&&(this._amsel)&&(B)&&(B.ctrlKey||B.metaKey))this._unselectItem(A);else if((!A.i_sel)&&((!this._amselS)||(this._selected.length==0)||(this._selected[0].parentObject==A.parentObject)))if((this._amsel)&&(B)&&(B.shiftKey)&&(this._selected.length!=0)&&(this._selected[this._selected.length-1].parentObject==A.parentObject)){var E=this._getIndex(this._selected[this._selected.length-1]),C=this._getIndex(A);if(C<E){var D=E;E=C;C=D}for(var G=E;G<=C;G++)if(!A.parentObject.childNodes[G].i_sel)this._markItem(A.parentObject.childNodes[G])}else this._markItem(A);if(this.checkEvent("onSelect")){var F=this.getSelectedItemId();if(F!=this._onSSCFold)this.callEvent("onSelect",[F])}};dhtmlXTreeObject.prototype._markItem=function(A){if(A.scolor)A.span.style.color=A.scolor;A.span.className="selectedTreeRow";A.i_sel=true;this._selected[this._selected.length]=A};dhtmlXTreeObject.prototype.getIndexById=function(A){var B=this._globalIdStorageFind(A);if(!B)return null;return this._getIndex(B)};dhtmlXTreeObject.prototype._getIndex=function(A){var B=A.parentObject;for(var C=0;C<B.childsCount;C++)if(B.childNodes[C]==A)return C};dhtmlXTreeObject.prototype._unselectItem=function(A){if((A)&&(A.i_sel)){A.span.className="standartTreeRow";if(A.acolor)A.span.style.color=A.acolor;A.i_sel=false;for(var B=0;B<this._selected.length;B++)if(!this._selected[B].i_sel){this._selected.splice(B,1);break}}};dhtmlXTreeObject.prototype._unselectItems=function(){for(var B=0;B<this._selected.length;B++){var A=this._selected[B];A.span.className="standartTreeRow";if(A.acolor)A.span.style.color=A.acolor;A.i_sel=false}this._selected=new Array()};dhtmlXTreeObject.prototype.onRowSelect=function(C,B,F){C=C||window.event;var E=this.parentObject;if(B)E=B.parentObject;var A=E.treeNod,D=A.getSelectedItemId();if((!C)||(!C.skipUnSel))A._selectItem(E,C);if(!F)if(E.actionHandler)E.actionHandler(E.id,D);else A.callEvent("onClick",[E.id,D])};dhtmlXTreeObject.prototype._correctCheckStates=function(E){if(!this.tscheck)return;if(!E)return;if(E.id==this.rootId)return;var B=E.childNodes,A=0,D=0;if(E.childsCount==0)return;for(var C=0;C<E.childsCount;C++){if(B[C].dscheck)continue;if(B[C].checkstate==0)A=1;else if(B[C].checkstate==1)D=1;else{A=1;D=1;break}}if((A)&&(D))this._setCheck(E,"unsure");else if(A)this._setCheck(E,false);else this._setCheck(E,true);this._correctCheckStates(E.parentObject)};dhtmlXTreeObject.prototype.onCheckBoxClick=function(A){if(!this.treeNod.callEvent("onBeforeCheck",[this.parentObject.id,this.parentObject.checkstate]))return;if(this.parentObject.dscheck)return true;if(this.treeNod.tscheck){if(this.parentObject.checkstate==1)this.treeNod._setSubChecked(false,this.parentObject);else this.treeNod._setSubChecked(true,this.parentObject)}else if(this.parentObject.checkstate==1)this.treeNod._setCheck(this.parentObject,false);else this.treeNod._setCheck(this.parentObject,true);this.treeNod._correctCheckStates(this.parentObject.parentObject);return this.treeNod.callEvent("onCheck",[this.parentObject.id,this.parentObject.checkstate])};dhtmlXTreeObject.prototype._createItem=function(L,M,F){var E=document.createElement("table");E.cellSpacing=0;E.cellPadding=0;E.border=0;if(this.hfMode)E.style.tableLayout="fixed";E.style.margin=0;E.style.padding=0;var G=document.createElement("tbody"),C=document.createElement("tr"),H=document.createElement("td");H.className="standartTreeImage";if(this._txtimg){var A=document.createElement("div");H.appendChild(A);A.className="dhx_tree_textSign"}else{A=this._getImg(M.id);A.border="0";if(A.tagName=="IMG")A.align="absmiddle";H.appendChild(A);A.style.padding=0;A.style.margin=0;A.style.width=this.def_line_img_x;A.style.height=this.def_line_img_y}var I=document.createElement("td"),B=this._getImg(this.cBROf?this.rootId:M.id);B.checked=0;this._setSrc(B,this.imPath+this.checkArray[0]);B.style.width="16px";B.style.height="16px";if(!L)((!_isIE)?I:B).style.display="none";I.appendChild(B);if((!this.cBROf)&&(B.tagName=="IMG"))B.align="absmiddle";B.onclick=this.onCheckBoxClick;B.treeNod=this;B.parentObject=M;if(!window._KHTMLrv)I.width="20px";else I.width="16px";var J=document.createElement("td");J.className="standartTreeImage";var D=this._getImg(this.timgen?M.id:this.rootId);D.onmousedown=this._preventNsDrag;D.ondragstart=this._preventNsDrag;D.border="0";if(this._aimgs){D.parentObject=M;if(D.tagName=="IMG")D.align="absmiddle";D.onclick=this.onRowSelect}if(!F)this._setSrc(D,this.iconURL+this.imageArray[0]);J.appendChild(D);D.style.padding=0;D.style.margin=0;if(this.timgen){J.style.width=D.style.width=this.def_img_x;D.style.height=this.def_img_y}else{D.style.width="0px";D.style.height="0px";if(_isOpera||window._KHTMLrv)J.style.display="none"}var K=document.createElement("td");K.className="standartTreeRow";M.span=document.createElement("span");M.span.className="standartTreeRow";if(this.mlitems){M.span.style.width=this.mlitems;M.span.style.display="block"}else K.noWrap=true;if(_isIE&&_isIE>7)K.style.width="999999px";else if(!window._KHTMLrv)K.style.width="100%";M.span.innerHTML=M.label;K.appendChild(M.span);K.parentObject=M;H.parentObject=M;K.onclick=this.onRowSelect;H.onclick=this.onRowClick;K.ondblclick=this.onRowClick2;if(this.ettip)C.title=M.label;if(this.dragAndDropOff){if(this._aimgs){this.dragger.addDraggableItem(J,this);J.parentObject=M}this.dragger.addDraggableItem(K,this)}M.span.style.paddingLeft="5px";M.span.style.paddingRight="5px";K.style.verticalAlign="";K.style.fontSize="10pt";K.style.cursor=this.style_pointer;C.appendChild(H);C.appendChild(I);C.appendChild(J);C.appendChild(K);G.appendChild(C);E.appendChild(G);if(this.ehlt||this.checkEvent("onMouseIn")||this.checkEvent("onMouseOut")){C.onmousemove=this._itemMouseIn;C[(_isIE)?"onmouseleave":"onmouseout"]=this._itemMouseOut}return E};dhtmlXTreeObject.prototype.setImagePath=function(A){this.imPath=A;this.iconURL=A};dhtmlXTreeObject.prototype.setIconPath=function(A){this.iconURL=A};dhtmlXTreeObject.prototype._getLeafCount=function(A){var C=0;for(var B=0;B<A.childsCount;B++)if(A.childNodes[B].childsCount==0)C++;return C};dhtmlXTreeObject.prototype._getChildCounterValue=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;if((A.unParsed)||((!A.XMLload)&&(this.XMLsource)))return A._acc;switch(this.childCalc){case 1:return A.childsCount;break;case 2:return this._getLeafCount(A);break;case 3:return A._acc;break;case 4:return A._acc;break}};dhtmlXTreeObject.prototype._fixChildCountLabel=function(A,B){if(this.childCalc==null)return;if((A.unParsed)||((!A.XMLload)&&(this.XMLsource))){if(A._acc)A.span.innerHTML=A.label+this.htmlcA+A._acc+this.htmlcB;else A.span.innerHTML=A.label;return}switch(this.childCalc){case 1:if(A.childsCount!=0)A.span.innerHTML=A.label+this.htmlcA+A.childsCount+this.htmlcB;else A.span.innerHTML=A.label;break;case 2:var E=this._getLeafCount(A);if(E!=0)A.span.innerHTML=A.label+this.htmlcA+E+this.htmlcB;else A.span.innerHTML=A.label;break;case 3:if(A.childsCount!=0){var D=0;for(var C=0;C<A.childsCount;C++){if(!A.childNodes[C]._acc)A.childNodes[C]._acc=0;D+=A.childNodes[C]._acc*1}D+=A.childsCount*1;A.span.innerHTML=A.label+this.htmlcA+D+this.htmlcB;A._acc=D}else{A.span.innerHTML=A.label;A._acc=0}if((A.parentObject)&&(A.parentObject!=this.htmlNode))this._fixChildCountLabel(A.parentObject);break;case 4:if(A.childsCount!=0){D=0;for(C=0;C<A.childsCount;C++){if(!A.childNodes[C]._acc)A.childNodes[C]._acc=1;D+=A.childNodes[C]._acc*1}A.span.innerHTML=A.label+this.htmlcA+D+this.htmlcB;A._acc=D}else{A.span.innerHTML=A.label;A._acc=1}if((A.parentObject)&&(A.parentObject!=this.htmlNode))this._fixChildCountLabel(A.parentObject);break}};dhtmlXTreeObject.prototype.setChildCalcMode=function(A){switch(A){case"child":this.childCalc=1;break;case"leafs":this.childCalc=2;break;case"childrec":this.childCalc=3;break;case"leafsrec":this.childCalc=4;break;case"disabled":this.childCalc=null;break;default:this.childCalc=4}};dhtmlXTreeObject.prototype.setChildCalcHTML=function(B,A){this.htmlcA=B;this.htmlcB=A};dhtmlXTreeObject.prototype.setOnRightClickHandler=function(A){this.attachEvent("onRightClick",A)};dhtmlXTreeObject.prototype.setOnClickHandler=function(A){this.attachEvent("onClick",A)};dhtmlXTreeObject.prototype.setOnSelectStateChange=function(A){this.attachEvent("onSelect",A)};dhtmlXTreeObject.prototype.setXMLAutoLoading=function(A){this.XMLsource=A};dhtmlXTreeObject.prototype.setOnCheckHandler=function(A){this.attachEvent("onCheck",A)};dhtmlXTreeObject.prototype.setOnOpenHandler=function(A){this.attachEvent("onOpenStart",A)};dhtmlXTreeObject.prototype.setOnOpenStartHandler=function(A){this.attachEvent("onOpenStart",A)};dhtmlXTreeObject.prototype.setOnOpenEndHandler=function(A){this.attachEvent("onOpenEnd",A)};dhtmlXTreeObject.prototype.setOnDblClickHandler=function(A){this.attachEvent("onDblClick",A)};dhtmlXTreeObject.prototype.openAllItems=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;this._xopenAll(A)};dhtmlXTreeObject.prototype.getOpenState=function(B){var A=this._globalIdStorageFind(B);if(!A)return"";return this._getOpenState(A)};dhtmlXTreeObject.prototype.closeAllItems=function(B){if(B===window.undefined)B=this.rootId;var A=this._globalIdStorageFind(B);if(!A)return 0;this._xcloseAll(A);this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype.setUserData=function(D,A,B){var C=this._globalIdStorageFind(D,0,true);if(!C)return;if(A=="hint")C.htmlNode.childNodes[0].childNodes[0].title=B;if(typeof(C.userData["t_"+A])=="undefined")if(!C._userdatalist)C._userdatalist=A;else C._userdatalist+=","+A;C.userData["t_"+A]=B};dhtmlXTreeObject.prototype.getUserData=function(C,A){var B=this._globalIdStorageFind(C,0,true);if(!B)return;return B.userData["t_"+A]};dhtmlXTreeObject.prototype.getItemColor=function(C){var B=this._globalIdStorageFind(C);if(!B)return 0;var A=new Object();if(B.acolor)A.acolor=B.acolor;if(B.scolor)A.scolor=B.scolor;return A};dhtmlXTreeObject.prototype.setItemColor=function(D,B,A){if((D)&&(D.span))var C=D;else C=this._globalIdStorageFind(D);if(!C)return 0;else{if(C.i_sel){if(A)C.span.style.color=A}else if(B)C.span.style.color=B;if(A)C.scolor=A;if(B)C.acolor=B}};dhtmlXTreeObject.prototype.getItemText=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;return(A.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML)};dhtmlXTreeObject.prototype.getParentId=function(B){var A=this._globalIdStorageFind(B);if((!A)||(!A.parentObject))return"";return A.parentObject.id};dhtmlXTreeObject.prototype.changeItemId=function(C,B){if(C==B)return;var A=this._globalIdStorageFind(C);if(!A)return 0;A.id=B;A.span.contextMenuId=B;this._idpull[B]=this._idpull[C];delete this._idpull[C]};dhtmlXTreeObject.prototype.doCut=function(){if(this.nodeCut)this.clearCut();this.nodeCut=(new Array()).concat(this._selected);for(var B=0;B<this.nodeCut.length;B++){var A=this.nodeCut[B];A._cimgs=new Array();A._cimgs[0]=A.images[0];A._cimgs[1]=A.images[1];A._cimgs[2]=A.images[2];A.images[0]=A.images[1]=A.images[2]=this.cutImage;this._correctPlus(A)}};dhtmlXTreeObject.prototype.doPaste=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;for(var C=0;C<this.nodeCut.length;C++){if(this._checkPNodes(A,this.nodeCut[C]))continue;this._moveNode(this.nodeCut[C],A)}this.clearCut()};dhtmlXTreeObject.prototype.clearCut=function(){for(var B=0;B<this.nodeCut.length;B++){var A=this.nodeCut[B];A.images[0]=A._cimgs[0];A.images[1]=A._cimgs[1];A.images[2]=A._cimgs[2];this._correctPlus(A)}this.nodeCut=new Array()};dhtmlXTreeObject.prototype._moveNode=function(F,A){var E=this.dadmodec;if(E==1){var D=A;if(this.dadmodefix<0){while(true){D=this._getPrevNode(D);if((D==-1)){D=this.htmlNode;break}if((D.tr==0)||(D.tr.style.display=="")||(!D.parentObject))break}var C=D,B=A}else{if((D.tr)&&(D.tr.nextSibling)&&(D.tr.nextSibling.nodem)&&!this._getOpenState(D))D=D.tr.nextSibling.nodem;else{D=this._getNextNode(D);if((D==-1))D=this.htmlNode}B=D,C=A}if(this._getNodeLevel(C,0)>this._getNodeLevel(B,0)){if(!this.dropLower)return this._moveNodeTo(F,C.parentObject);else if(B.id!=this.rootId)return this._moveNodeTo(F,B.parentObject,B);else return this._moveNodeTo(F,this.htmlNode,null)}else return this._moveNodeTo(F,B.parentObject,B)}else return this._moveNodeTo(F,A)};dhtmlXTreeObject.prototype._fixNodesCollection=function(D,G){var B=0,C=0,F=D.childNodes,A=D.childsCount-1;if(G==F[A])return;for(var H=0;H<A;H++)if(F[H]==F[A]){F[H]=F[H+1];F[H+1]=F[A]}for(H=0;H<A+1;H++)if(B){var E=F[H];F[H]=B;B=E}else if(F[H]==G){B=F[H];F[H]=F[A]}};dhtmlXTreeObject.prototype._recreateBranch=function(I,A,D,C){var H,F="";if(D){for(H=0;H<A.childsCount;H++)if(A.childNodes[H]==D)break;if(H!=0)D=A.childNodes[H-1];else{F="TOP";D=""}}var B=this._onradh;this._onradh=null;var G=this._attachChildNode(A,I.id,I.label,0,I.images[0],I.images[1],I.images[2],F,0,D);G._userdatalist=I._userdatalist;G.userData=I.userData.clone();if(I._attrs){G._attrs={};for(var E in I._attrs)G._attrs[E]=I._attrs[E]}G.XMLload=I.XMLload;if(B){this._onradh=B;this._onradh(G.id)}if(I.treeNod.dpcpy)I.treeNod._globalIdStorageFind(I.id);else G.unParsed=I.unParsed;this._correctPlus(G);for(H=0;H<I.childsCount;H++)this._recreateBranch(I.childNodes[H],G,0,1);if((!C)&&(this.childCalc))this._redrawFrom(this,A);return G};dhtmlXTreeObject.prototype._moveNodeTo=function(L,A,E){if(L.treeNod._nonTrivialNode)return L.treeNod._nonTrivialNode(this,A,E,L);if(this._checkPNodes(A,L))return false;if(A.mytype)var M=(L.treeNod.lWin!=A.lWin);else M=(L.treeNod.lWin!=A.treeNod.lWin);if(!this.callEvent("onDrag",[L.id,A.id,(E?E.id:null),L.treeNod,A.treeNod]))return false;if((A.XMLload==0)&&(this.XMLsource)){A.XMLload=1;this._loadDynXML(A.id)}this.openItem(A.id);var B=L.treeNod,F=L.parentObject.childsCount,J=L.parentObject;if((M)||(B.dpcpy)){var K=L.id;L=this._recreateBranch(L,A,E);if(!B.dpcpy)B.deleteItem(K)}else{var C=A.childsCount,I=A.childNodes;if(C==0)A._open=true;B._unselectItem(L);I[C]=L;L.treeNod=A.treeNod;A.childsCount++;var G=this._drawNewTr(I[C].htmlNode);if(!E){A.htmlNode.childNodes[0].appendChild(G);if(this.dadmode==1)this._fixNodesCollection(A,E)}else{A.htmlNode.childNodes[0].insertBefore(G,E.tr);this._fixNodesCollection(A,E);I=A.childNodes}}if((!B.dpcpy)&&(!M)){var D=L.tr;if((document.all)&&(navigator.appVersion.search(/MSIE\ 5\.0/gi)!=-1))window.setTimeout(function(){D.parentNode.removeChild(D)},250);else L.parentObject.htmlNode.childNodes[0].removeChild(L.tr);if((!E)||(A!=L.parentObject)){for(var H=0;H<J.childsCount;H++)if(J.childNodes[H].id==L.id){J.childNodes[H]=0;break}}else J.childNodes[J.childsCount-1]=0;B._compressChildList(J.childsCount,J.childNodes);J.childsCount--}if((!M)&&(!B.dpcpy)){L.tr=G;G.nodem=L;L.parentObject=A;if(B!=A.treeNod){if(L.treeNod._registerBranch(L,B))return;this._clearStyles(L);this._redrawFrom(this,L.parentObject);if(this._onradh)this._onradh(L.id)}this._correctPlus(A);this._correctLine(A);this._correctLine(L);this._correctPlus(L);if(E)this._correctPlus(E);else if(A.childsCount>=2){this._correctPlus(I[A.childsCount-2]);this._correctLine(I[A.childsCount-2])}this._correctPlus(I[A.childsCount-1]);if(this.tscheck)this._correctCheckStates(A);if(B.tscheck)B._correctCheckStates(J)}if(F>1){B._correctPlus(J.childNodes[F-2]);B._correctLine(J.childNodes[F-2])}B._correctPlus(J);B._correctLine(J);this._fixChildCountLabel(A);B._fixChildCountLabel(J);this.callEvent("onDrop",[L.id,A.id,(E?E.id:null),B,A.treeNod]);return L.id};dhtmlXTreeObject.prototype._clearStyles=function(D){if(!D.htmlNode)return;var A=D.htmlNode.childNodes[0].childNodes[0].childNodes[1],B=A.nextSibling.nextSibling;D.span.innerHTML=D.label;D.i_sel=false;if(D._aimgs)this.dragger.removeDraggableItem(A.nextSibling);if(this.checkBoxOff){A.childNodes[0].style.display="";A.childNodes[0].onclick=this.onCheckBoxClick;this._setSrc(A.childNodes[0],this.imPath+this.checkArray[D.checkstate])}else A.childNodes[0].style.display="none";A.childNodes[0].treeNod=this;this.dragger.removeDraggableItem(B);if(this.dragAndDropOff)this.dragger.addDraggableItem(B,this);if(this._aimgs)this.dragger.addDraggableItem(A.nextSibling,this);B.childNodes[0].className="standartTreeRow";B.onclick=this.onRowSelect;B.ondblclick=this.onRowClick2;A.previousSibling.onclick=this.onRowClick;this._correctLine(D);this._correctPlus(D);for(var C=0;C<D.childsCount;C++)this._clearStyles(D.childNodes[C])};dhtmlXTreeObject.prototype._registerBranch=function(C,A){if(A)A._globalIdStorageSub(C.id);C.id=this._globalIdStorageAdd(C.id,C);C.treeNod=this;for(var B=0;B<C.childsCount;B++)this._registerBranch(C.childNodes[B],A);return 0};dhtmlXTreeObject.prototype.enableThreeStateCheckboxes=function(A){this.tscheck=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.setOnMouseInHandler=function(A){this.ehlt=true;this.attachEvent("onMouseIn",A)};dhtmlXTreeObject.prototype.setOnMouseOutHandler=function(A){this.ehlt=true;this.attachEvent("onMouseOut",A)};dhtmlXTreeObject.prototype.enableMercyDrag=function(A){this.dpcpy=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.enableTreeImages=function(A){this.timgen=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.enableFixedMode=function(A){this.hfMode=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.enableCheckBoxes=function(B,A){this.checkBoxOff=convertStringToBoolean(B);this.cBROf=(!(this.checkBoxOff||convertStringToBoolean(A)))};dhtmlXTreeObject.prototype.setStdImages=function(B,A,C){this.imageArray[0]=B;this.imageArray[1]=A;this.imageArray[2]=C};dhtmlXTreeObject.prototype.enableTreeLines=function(A){this.treeLinesOn=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.setImageArrays=function(D,B,A,E,C,F){switch(D){case"plus":this.plusArray[0]=B;this.plusArray[1]=A;this.plusArray[2]=E;this.plusArray[3]=C;this.plusArray[4]=F;break;case"minus":this.minusArray[0]=B;this.minusArray[1]=A;this.minusArray[2]=E;this.minusArray[3]=C;this.minusArray[4]=F;break}};dhtmlXTreeObject.prototype.openItem=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;else return this._openItem(A)};dhtmlXTreeObject.prototype._openItem=function(A){var B=this._getOpenState(A);if((B<0)||(((this.XMLsource)&&(!A.XMLload)))){if(!this.callEvent("onOpenStart",[A.id,B]))return 0;this._HideShow(A,2);if(this.checkEvent("onOpenEnd")){if(this.onXLE==this._epnFHe)this._epnFHe(this,A.id,true);if(!this.xmlstate||!this.XMLsource)this.callEvent("onOpenEnd",[A.id,this._getOpenState(A)]);else{this._oie_onXLE.push(this.onXLE);this.onXLE=this._epnFHe}}}else if(this._srnd)this._HideShow(A,2);if(A.parentObject&&!this._skip_open_parent)this._openItem(A.parentObject)};dhtmlXTreeObject.prototype.closeItem=function(B){if(this.rootId==B)return 0;var A=this._globalIdStorageFind(B);if(!A)return 0;if(A.closeble)this._HideShow(A,1)};dhtmlXTreeObject.prototype.getLevel=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;return this._getNodeLevel(A,0)};dhtmlXTreeObject.prototype.setItemCloseable=function(C,A){A=convertStringToBoolean(A);if((C)&&(C.span))var B=C;else B=this._globalIdStorageFind(C);if(!B)return 0;B.closeble=A};dhtmlXTreeObject.prototype._getNodeLevel=function(B,A){if(B.parentObject)return this._getNodeLevel(B.parentObject,A+1);return(A)};dhtmlXTreeObject.prototype.hasChildren=function(B){var A=this._globalIdStorageFind(B);if(!A)return 0;else if((this.XMLsource)&&(!A.XMLload))return true;else return A.childsCount};dhtmlXTreeObject.prototype._getLeafCount=function(A){var C=0;for(var B=0;B<A.childsCount;B++)if(A.childNodes[B].childsCount==0)C++;return C};dhtmlXTreeObject.prototype.setItemText=function(D,A,C){var B=this._globalIdStorageFind(D);if(!B)return 0;B.label=A;B.span.innerHTML=A;if(this.childCalc)this._fixChildCountLabel(B);B.span.parentNode.parentNode.title=C||""};dhtmlXTreeObject.prototype.getItemTooltip=function(B){var A=this._globalIdStorageFind(B);if(!A)return"";return(A.span.parentNode.parentNode._dhx_title||A.span.parentNode.parentNode.title||"")};dhtmlXTreeObject.prototype.refreshItem=function(B){if(!B)B=this.rootId;var A=this._globalIdStorageFind(B);this.deleteChildItems(B);this._loadDynXML(B)};dhtmlXTreeObject.prototype.setItemImage2=function(D,B,A,E){var C=this._globalIdStorageFind(D);if(!C)return 0;C.images[1]=A;C.images[2]=E;C.images[0]=B;this._correctPlus(C)};dhtmlXTreeObject.prototype.setItemImage=function(D,B,A){var C=this._globalIdStorageFind(D);if(!C)return 0;if(A){C.images[1]=B;C.images[2]=A}else C.images[0]=B;this._correctPlus(C)};dhtmlXTreeObject.prototype.getSubItems=function(B){var A=this._globalIdStorageFind(B,0,1);if(!A)return 0;if(A.unParsed)return(this._getSubItemsXML(A.unParsed));var C="";for(i=0;i<A.childsCount;i++)if(!C)C=A.childNodes[i].id;else C+=this.dlmtr+A.childNodes[i].id;return C};dhtmlXTreeObject.prototype._getAllScraggyItems=function(A){var C="";for(var D=0;D<A.childsCount;D++)if((A.childNodes[D].unParsed)||(A.childNodes[D].childsCount>0)){if(A.childNodes[D].unParsed)var B=this._getAllScraggyItemsXML(A.childNodes[D].unParsed,1);else B=this._getAllScraggyItems(A.childNodes[D]);if(B)if(C)C+=this.dlmtr+B;else C=B}else if(!C)C=A.childNodes[D].id;else C+=this.dlmtr+A.childNodes[D].id;return C};dhtmlXTreeObject.prototype._getAllFatItems=function(A){var C="";for(var D=0;D<A.childsCount;D++)if((A.childNodes[D].unParsed)||(A.childNodes[D].childsCount>0)){if(!C)C=A.childNodes[D].id;else C+=this.dlmtr+A.childNodes[D].id;if(A.childNodes[D].unParsed)var B=this._getAllFatItemsXML(A.childNodes[D].unParsed,1);else B=this._getAllFatItems(A.childNodes[D]);if(B)C+=this.dlmtr+B}return C};dhtmlXTreeObject.prototype._getAllSubItems=function(D,E,A){if(A)C=A;else var C=this._globalIdStorageFind(D);if(!C)return 0;E="";for(var F=0;F<C.childsCount;F++){if(!E)E=C.childNodes[F].id;else E+=this.dlmtr+C.childNodes[F].id;var B=this._getAllSubItems(0,E,C.childNodes[F]);if(B)E+=this.dlmtr+B}if(C.unParsed)E=this._getAllSubItemsXML(D,E,C.unParsed);return E};dhtmlXTreeObject.prototype.selectItem=function(C,E,D){E=convertStringToBoolean(E);var B=this._globalIdStorageFind(C);if((!B)||(!B.parentObject))return 0;if(this.XMLloadingWarning)B.parentObject.openMe=1;else this._openItem(B.parentObject);var A=null;if(D){A=new Object;A.ctrlKey=true;if(B.i_sel)A.skipUnSel=true}if(E)this.onRowSelect(A,B.htmlNode.childNodes[0].childNodes[0].childNodes[3],false);else this.onRowSelect(A,B.htmlNode.childNodes[0].childNodes[0].childNodes[3],true)};dhtmlXTreeObject.prototype.getSelectedItemText=function(){var A=new Array();for(var B=0;B<this._selected.length;B++)A[B]=this._selected[B].span.innerHTML;return(A.join(this.dlmtr))};dhtmlXTreeObject.prototype._compressChildList=function(A,B){A--;for(var C=0;C<A;C++)if(B[C]==0){B[C]=B[C+1];B[C+1]=0}};dhtmlXTreeObject.prototype._deleteNode=function(H,A,G){if((!A)||(!A.parentObject))return 0;var E=0,D=0;if(A.tr.nextSibling)E=A.tr.nextSibling.nodem;if(A.tr.previousSibling)D=A.tr.previousSibling.nodem;var C=A.parentObject,B=C.childsCount,F=C.childNodes;for(var I=0;I<B;I++)if(F[I].id==H){if(!G)C.htmlNode.childNodes[0].removeChild(F[I].tr);F[I]=0;break}this._compressChildList(B,F);if(!G)C.childsCount--;if(E){this._correctPlus(E);this._correctLine(E)}if(D){this._correctPlus(D);this._correctLine(D)}if(this.tscheck)this._correctCheckStates(C);if(!G)this._globalIdStorageRecSub(A)};dhtmlXTreeObject.prototype.setCheck=function(C,A){var B=this._globalIdStorageFind(C,0,1);if(!B)return;if(A==="unsure")this._setCheck(B,A);else{A=convertStringToBoolean(A);if((this.tscheck)&&(this.smcheck))this._setSubChecked(A,B);else this._setCheck(B,A)}if(this.smcheck)this._correctCheckStates(B.parentObject)};dhtmlXTreeObject.prototype._setCheck=function(B,A){if(!B)return;if(((B.parentObject._r_logic)||(this._frbtr))&&(A))if(this._frbtrs){if(this._frbtrL)this.setCheck(this._frbtrL.id,0);this._frbtrL=B}else for(var D=0;D<B.parentObject.childsCount;D++)this._setCheck(B.parentObject.childNodes[D],0);var C=B.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(A=="unsure")B.checkstate=2;else if(A)B.checkstate=1;else B.checkstate=0;if(B.dscheck)B.checkstate=B.dscheck;this._setSrc(C,this.imPath+((B.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[B.checkstate])};dhtmlXTreeObject.prototype.setSubChecked=function(C,A){var B=this._globalIdStorageFind(C);this._setSubChecked(A,B);this._correctCheckStates(B.parentObject)};dhtmlXTreeObject.prototype._setSubChecked=function(A,B){A=convertStringToBoolean(A);if(!B)return;if(((B.parentObject._r_logic)||(this._frbtr))&&(A))for(var D=0;D<B.parentObject.childsCount;D++)this._setSubChecked(0,B.parentObject.childNodes[D]);if(B.unParsed)this._setSubCheckedXML(A,B.unParsed);if(B._r_logic||this._frbtr)this._setSubChecked(A,B.childNodes[0]);else for(D=0;D<B.childsCount;D++)this._setSubChecked(A,B.childNodes[D]);var C=B.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(A)B.checkstate=1;else B.checkstate=0;if(B.dscheck)B.checkstate=B.dscheck;this._setSrc(C,this.imPath+((B.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[B.checkstate])};dhtmlXTreeObject.prototype.isItemChecked=function(B){var A=this._globalIdStorageFind(B);if(!A)return;return A.checkstate};dhtmlXTreeObject.prototype.deleteChildItems=function(C){var A=this._globalIdStorageFind(C);if(!A)return;var B=A.childsCount;for(var D=0;D<B;D++)this._deleteNode(A.childNodes[0].id,A.childNodes[0])};dhtmlXTreeObject.prototype.deleteItem=function(B,A){if((!this._onrdlh)||(this._onrdlh(B))){var C=this._deleteItem(B,A);if(C)this._fixChildCountLabel(C)}this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype._deleteItem=function(E,C,D){C=convertStringToBoolean(C);var B=this._globalIdStorageFind(E);if(!B)return;var A=this.getParentId(E),F=B.parentObject;this._deleteNode(E,B,D);if(this._editCell&&this._editCell.id==E)this._editCell=null;this._correctPlus(F);this._correctLine(F);if((C)&&(A!=this.rootId))this.selectItem(A,1);return F};dhtmlXTreeObject.prototype._globalIdStorageRecSub=function(C){for(var B=0;B<C.childsCount;B++){this._globalIdStorageRecSub(C.childNodes[B]);this._globalIdStorageSub(C.childNodes[B].id)}this._globalIdStorageSub(C.id);var A=C;A.span=null;A.tr.nodem=null;A.tr=null;A.htmlNode=null};dhtmlXTreeObject.prototype.insertNewNext=function(I,F,H,B,D,C,J,A,E){var G=this._globalIdStorageFind(I);if((!G)||(!G.parentObject))return(0);var K=this._attachChildNode(0,F,H,B,D,C,J,A,E,G);if((!this.XMLloadingWarning)&&(this.childCalc))this._fixChildCountLabel(G.parentObject);return K};dhtmlXTreeObject.prototype.getItemIdByIndex=function(B,A){var C=this._globalIdStorageFind(B);if((!C)||(A>=C.childsCount))return null;return C.childNodes[A].id};dhtmlXTreeObject.prototype.getChildItemIdByIndex=function(B,A){var C=this._globalIdStorageFind(B);if((!C)||(A>=C.childsCount))return null;return C.childNodes[A].id};dhtmlXTreeObject.prototype.setDragHandler=function(A){this.attachEvent("onDrag",A)};dhtmlXTreeObject.prototype._clearMove=function(){if(this._lastMark){this._lastMark.className=this._lastMark.className.replace(/dragAndDropRow/g,"");this._lastMark=null}this.selectionBar.style.display="none";this.allTree.className=this.allTree.className.replace(" selectionBox","")};dhtmlXTreeObject.prototype.enableDragAndDrop=function(B,A){if(B=="temporary_disabled"){this.dADTempOff=false;B=true}else this.dADTempOff=true;this.dragAndDropOff=convertStringToBoolean(B);if(this.dragAndDropOff)this.dragger.addDragLanding(this.allTree,this);if(arguments.length>1)this._ddronr=(!convertStringToBoolean(A))};dhtmlXTreeObject.prototype._setMove=function(A,G,F){if(A.parentObject.span){var B=getAbsoluteTop(A),C=getAbsoluteTop(this.allTree)-this.allTree.scrollTop;this.dadmodec=this.dadmode;this.dadmodefix=0;if(this.dadmode==2){var E=F-B+(document.body.scrollTop||document.documentElement.scrollTop)-2-A.offsetHeight/2;if((Math.abs(E)-A.offsetHeight/6)>0){this.dadmodec=1;if(E<0)this.dadmodefix=0-A.offsetHeight}else this.dadmodec=0}if(this.dadmodec==0){var D=A.parentObject.span;D.className+=" dragAndDropRow";this._lastMark=D}else{this._clearMove();this.selectionBar.style.top=(B-C+((parseInt(A.parentObject.span.parentNode.previousSibling.childNodes[0].style.height)||18)-1)+this.dadmodefix)+"px";this.selectionBar.style.left="5px";if(this.allTree.offsetWidth>20)this.selectionBar.style.width=(this.allTree.offsetWidth-(_isFF?30:25))+"px";this.selectionBar.style.display=""}this._autoScroll(null,B,C)}};dhtmlXTreeObject.prototype._autoScroll=function(A,B,C){if(this.autoScroll){if(A){B=getAbsoluteTop(A);C=getAbsoluteTop(this.allTree)-this.allTree.scrollTop}if((B-C-parseInt(this.allTree.scrollTop))>(parseInt(this.allTree.offsetHeight)-50))this.allTree.scrollTop=parseInt(this.allTree.scrollTop)+20;if((B-C)<(parseInt(this.allTree.scrollTop)+30))this.allTree.scrollTop=parseInt(this.allTree.scrollTop)-20}};dhtmlXTreeObject.prototype._createDragNode=function(C,D){if(!this.dADTempOff)return null;var E=C.parentObject;if(!this.callEvent("onBeforeDrag",[E.id,D]))return null;if(!E.i_sel)this._selectItem(E,D);this._checkMSelectionLogic();var A=document.createElement("div"),B=new Array();if(this._itim_dg){for(var F=0;F<this._selected.length;F++)B[F]="<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='"+this._getSrc(this._selected[F].span.parentNode.previousSibling.childNodes[0])+"'></td><td>"+this._selected[F].span.innerHTML+"</td></tr></table>"}else B=this.getSelectedItemText().split(this.dlmtr);A.innerHTML=B.join("");A.style.position="absolute";A.className="dragSpanDiv";this._dragged=(new Array()).concat(this._selected);return A};dhtmlXTreeObject.prototype._focusNode=function(A){var B=getAbsoluteTop(A.htmlNode)-getAbsoluteTop(this.allTree);if((B>(this.allTree.offsetHeight-30))||(B<0))this.allTree.scrollTop=B+this.allTree.scrollTop};dhtmlXTreeObject.prototype._preventNsDrag=function(A){if((A)&&(A.preventDefault)){A.preventDefault();return false}return false};dhtmlXTreeObject.prototype._drag=function(B,H,A){if(this._autoOpenTimer)clearTimeout(this._autoOpenTimer);if(!A.parentObject){A=this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];this.dadmodec=0}this._clearMove();var F=B.parentObject.treeNod;if((F)&&(F._clearMove))F._clearMove("");if((!this.dragMove)||(this.dragMove())){if((!F)||(!F._clearMove)||(!F._dragged))var C=new Array(B.parentObject);else C=F._dragged;var E=A.parentObject;for(var G=0;G<C.length;G++){var D=this._moveNode(C[G],E);if((this.dadmodec)&&(D!==false))E=this._globalIdStorageFind(D,true,true);if((D)&&(!this._sADnD))this.selectItem(D,0,1)}}if(F)F._dragged=new Array()};dhtmlXTreeObject.prototype._dragIn=function(A,C,H,F){if(!this.dADTempOff)return 0;var E=C.parentObject,B=A.parentObject;if((!B)&&(this._ddronr))return;if(!this.callEvent("onDragIn",[E.id,B?B.id:null,E.treeNod,this])){if(B)this._autoScroll(A);return 0}if(!B)this.allTree.className+=" selectionBox";else{if(E.childNodes==null){this._setMove(A,H,F);return A}var D=E.treeNod;for(var G=0;G<D._dragged.length;G++)if(this._checkPNodes(B,D._dragged[G])){this._autoScroll(A);return 0}this.selectionBar.parentNode.removeChild(this.selectionBar);B.span.parentNode.appendChild(this.selectionBar);this._setMove(A,H,F);if(this._getOpenState(B)<=0){this._autoOpenId=B.id;this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1000)}}return A};dhtmlXTreeObject.prototype._autoOpenItem=function(A,B){B.openItem(B._autoOpenId)};dhtmlXTreeObject.prototype._dragOut=function(A){this._clearMove();if(this._autoOpenTimer)clearTimeout(this._autoOpenTimer)};dhtmlXTreeObject.prototype._getNextNode=function(A,B){if((!B)&&(A.childsCount))return A.childNodes[0];if(A==this.htmlNode)return-1;if((A.tr)&&(A.tr.nextSibling)&&(A.tr.nextSibling.nodem))return A.tr.nextSibling.nodem;return this._getNextNode(A.parentObject,true)};dhtmlXTreeObject.prototype._lastChild=function(A){if(A.childsCount)return this._lastChild(A.childNodes[A.childsCount-1]);else return A};dhtmlXTreeObject.prototype._getPrevNode=function(A,B){if((A.tr)&&(A.tr.previousSibling)&&(A.tr.previousSibling.nodem))return this._lastChild(A.tr.previousSibling.nodem);if(A.parentObject)return A.parentObject;else return-1};dhtmlXTreeObject.prototype.findItem=function(B,A,D){var C=this._findNodeByLabel(B,A,(D?this.htmlNode:null));if(C){this.selectItem(C.id,true);this._focusNode(C);return C.id}else return null};dhtmlXTreeObject.prototype.findItemIdByLabel=function(B,A,D){var C=this._findNodeByLabel(B,A,(D?this.htmlNode:null));if(C)return C.id;else return null};dhtmlXTreeObject.prototype.findStrInXML=function(B,A,C){if(!B.childNodes&&B.item)return this.findStrInJSON(B,A,C);if(!B.childNodes)return false;for(var E=0;E<B.childNodes.length;E++)if(B.childNodes[E].nodeType==1){var D=B.childNodes[E].getAttribute(A);if(!D&&B.childNodes[E].tagName=="itemtext")D=B.childNodes[E].firstChild.data;if((D)&&(D.toLowerCase().search(C)!=-1))return true;if(this.findStrInXML(B.childNodes[E],A,C))return true}return false};dhtmlXTreeObject.prototype.findStrInJSON=function(B,A,C){for(var E=0;E<B.item.length;E++){var D=B.item[E].text;if((D)&&(D.toLowerCase().search(C)!=-1))return true;if(B.item[E].item&&this.findStrInJSON(B.item[E],A,C))return true}return false};dhtmlXTreeObject.prototype._findNodeByLabel=function(D,A,B){var D=D.replace(new RegExp("^( )+"),"").replace(new RegExp("( )+$"),"");D=new RegExp(D.replace(/([\?\*\+\\\[\]\(\)]{1})/gi,"\\$1").replace(/ /gi,".*"),"gi");if(!B){B=this._selected[0];if(!B)B=this.htmlNode}var C=B;if(!A){if((B.unParsed)&&(this.findStrInXML(B.unParsed.d,"text",D)))this.reParse(B);B=this._getNextNode(C);if(B==-1)B=this.htmlNode.childNodes[0]}else{var E=this._getPrevNode(C);if(E==-1)E=this._lastChild(this.htmlNode);if((E.unParsed)&&(this.findStrInXML(E.unParsed.d,"text",D))){this.reParse(E);B=this._getPrevNode(C)}else B=E;if(B==-1)B=this._lastChild(this.htmlNode)}while((B)&&(B!=C)){if((B.label)&&(B.label.search(D)!=-1))return(B);if(!A){if(B==-1){if(C==this.htmlNode)break;B=this.htmlNode.childNodes[0]}if((B.unParsed)&&(this.findStrInXML(B.unParsed.d,"text",D)))this.reParse(B);B=this._getNextNode(B);if(B==-1)B=this.htmlNode}else{E=this._getPrevNode(B);if(E==-1)E=this._lastChild(this.htmlNode);if((E.unParsed)&&(this.findStrInXML(E.unParsed.d,"text",D))){this.reParse(E);B=this._getPrevNode(B)}else B=E;if(B==-1)B=this._lastChild(this.htmlNode)}}return null};dhtmlXTreeObject.prototype.moveItem=function(E,H,C,G){var B=this._globalIdStorageFind(E);if(!B)return(0);switch(H){case"right":alert("Not supported yet");break;case"item_child":var D=(G||this)._globalIdStorageFind(C);if(!D)return(0);(G||this)._moveNodeTo(B,D,0);break;case"item_sibling":D=(G||this)._globalIdStorageFind(C);if(!D)return(0);(G||this)._moveNodeTo(B,D.parentObject,D);break;case"item_sibling_next":D=(G||this)._globalIdStorageFind(C);if(!D)return(0);if((D.tr)&&(D.tr.nextSibling)&&(D.tr.nextSibling.nodem))(G||this)._moveNodeTo(B,D.parentObject,D.tr.nextSibling.nodem);else(G||this)._moveNodeTo(B,D.parentObject);break;case"left":if(B.parentObject.parentObject)this._moveNodeTo(B,B.parentObject.parentObject,B.parentObject);break;case"up":var F=this._getPrevNode(B);if((F==-1)||(!F.parentObject))return;this._moveNodeTo(B,F.parentObject,F);break;case"up_strict":F=this._getIndex(B);if(F!=0)this._moveNodeTo(B,B.parentObject,B.parentObject.childNodes[F-1]);break;case"down_strict":var F=this._getIndex(B),A=B.parentObject.childsCount-2;if(F==A)this._moveNodeTo(B,B.parentObject);else if(F<A)this._moveNodeTo(B,B.parentObject,B.parentObject.childNodes[F+2]);break;case"down":F=this._getNextNode(this._lastChild(B));if((F==-1)||(!F.parentObject))return;if(F.parentObject==B.parentObject)F=this._getNextNode(F);if(F==-1)this._moveNodeTo(B,B.parentObject);else{if((F==-1)||(!F.parentObject))return;this._moveNodeTo(B,F.parentObject,F)}break}if(_isIE&&_isIE<8){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}};dhtmlXTreeObject.prototype.setDragBehavior=function(B,A){this._sADnD=(!convertStringToBoolean(A));switch(B){case"child":this.dadmode=0;break;case"sibling":this.dadmode=1;break;case"complex":this.dadmode=2;break}};dhtmlXTreeObject.prototype._loadDynXML=function(A,C){C=C||this.XMLsource;var B=(new Date()).valueOf();this._ld_id=A;if(this.xmlalb=="function"){if(C)C(this._escape(A))}else if(this.xmlalb=="name")this.loadXML(C+this._escape(A));else if(this.xmlalb=="xmlname")this.loadXML(C+this._escape(A)+".xml?uid="+B);else this.loadXML(C+getUrlSymbol(C)+"uid="+B+"&id="+this._escape(A))};dhtmlXTreeObject.prototype.enableMultiselection=function(B,A){this._amsel=convertStringToBoolean(B);this._amselS=convertStringToBoolean(A)};dhtmlXTreeObject.prototype._checkMSelectionLogic=function(){var A=new Array();for(var C=0;C<this._selected.length;C++)for(var B=0;B<this._selected.length;B++)if((C!=B)&&(this._checkPNodes(this._selected[B],this._selected[C])))A[A.length]=this._selected[B];for(C=0;C<A.length;C++)this._unselectItem(A[C])};dhtmlXTreeObject.prototype._checkPNodes=function(B,A){if(this._dcheckf)return false;if(A==B)return 1;if(B.parentObject)return this._checkPNodes(B.parentObject,A);else return 0};dhtmlXTreeObject.prototype.disableDropCheck=function(A){this._dcheckf=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.enableDistributedParsing=function(C,A,B){this._edsbps=convertStringToBoolean(C);this._edsbpsA=new Array();this._edsbpsC=A||10;this._edsbpsD=B||250};dhtmlXTreeObject.prototype.getDistributedParsingState=function(){return(!((!this._edsbpsA)||(!this._edsbpsA.length)))};dhtmlXTreeObject.prototype.getItemParsingState=function(A){var B=this._globalIdStorageFind(A,true,true);if(!B)return 0;if(this._edsbpsA)for(var C=0;C<this._edsbpsA.length;C++)if(this._edsbpsA[C][2]==A)return-1;return 1};dhtmlXTreeObject.prototype._distributedStart=function(B,D,A,C,E){if(!this._edsbpsA)this._edsbpsA=new Array();this._edsbpsA[this._edsbpsA.length]=[B,D,A,C,E]};dhtmlXTreeObject.prototype._distributedStep=function(A){var E=this;if((!this._edsbpsA)||(!this._edsbpsA.length)){E.XMLloadingWarning=0;return}var F=this._edsbpsA[0];this.parsedArray=new Array();this._parse(F[0],F[2],F[3],F[1]);var B=this._globalIdStorageFind(F[2]);this._redrawFrom(this,B,F[4],this._getOpenState(B));var C=this.setCheckList.split(this.dlmtr);for(var D=0;D<C.length;D++)if(C[D])this.setCheck(C[D],1);this._edsbpsA=(new Array()).concat(this._edsbpsA.slice(1));if((!this._edsbpsA.length)){window.setTimeout(function(){if(E.onXLE)E.onXLE(E,A);E.callEvent("onXLE",[E,A])},1);E.xmlstate=0}};dhtmlXTreeObject.prototype.enableTextSigns=function(A){this._txtimg=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.preventIECaching=function(A){this.no_cashe=convertStringToBoolean(A);this.XMLLoader.rSeed=this.no_cashe};dhtmlXTreeObject.prototype.preventIECashing=dhtmlXTreeObject.prototype.preventIECaching;dhtmlXTreeObject.prototype.disableCheckbox=function(B,C){if(typeof(B)!="object")var A=this._globalIdStorageFind(B,0,1);else A=B;if(!A)return;A.dscheck=convertStringToBoolean(C)?(((A.checkstate||0)%3)+3):((A.checkstate>2)?(A.checkstate-3):A.checkstate);this._setCheck(A);if(A.dscheck<3)A.dscheck=false};dhtmlXTreeObject.prototype.smartRefreshBranch=function(B,A){this._branchUpdate=1;this.smartRefreshItem(B,A)};dhtmlXTreeObject.prototype.smartRefreshItem=function(C,A){var B=this._globalIdStorageFind(C);for(var D=0;D<B.childsCount;D++)B.childNodes[D]._dmark=true;this.waitUpdateXML=true;if(A&&A.exists)this._parse(A,C);else this._loadDynXML(C,A)};dhtmlXTreeObject.prototype.refreshItems=function(B,A){var C=B.toString().split(this.dlmtr);this.waitUpdateXML=new Array();for(var D=0;D<C.length;D++)this.waitUpdateXML[C[D]]=true;this.loadXML((A||this.XMLsource)+getUrlSymbol(A||this.XMLsource)+"ids="+this._escape(B))};dhtmlXTreeObject.prototype.updateItem=function(H,E,D,C,B,G,A){var F=this._globalIdStorageFind(H);F.userData=new cObject();if(E)F.label=E;F.images=new Array(D||this.imageArray[0],C||this.imageArray[1],B||this.imageArray[2]);this.setItemText(H,E);if(G)this._setCheck(F,true);if(A=="1")F.XMLload=0;this._correctPlus(F);F._dmark=false;return F};dhtmlXTreeObject.prototype.setDropHandler=function(A){this.attachEvent("onDrop",A)};dhtmlXTreeObject.prototype.setOnLoadingStart=function(A){this.attachEvent("onXLS",A)};dhtmlXTreeObject.prototype.setOnLoadingEnd=function(A){this.attachEvent("onXLE",A)};dhtmlXTreeObject.prototype.setXMLAutoLoadingBehaviour=function(A){this.xmlalb=A};dhtmlXTreeObject.prototype.enableSmartCheckboxes=function(A){this.smcheck=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.getXMLState=function(){return(this.xmlstate==1)};dhtmlXTreeObject.prototype.setItemTopOffset=function(D,C){var B;if(typeof(D)!="object")B=this._globalIdStorageFind(D);else B=D;var E=B.span.parentNode.parentNode;B.span.style.paddingBottom="1px";for(var F=0;F<E.childNodes.length;F++){if(F!=0){if(_isIE){E.childNodes[F].style.height="18px";E.childNodes[F].style.paddingTop=parseInt(C)+"px"}else E.childNodes[F].style.height=18+parseInt(C)+"px"}else{var A=E.childNodes[F].firstChild;if(E.childNodes[F].firstChild.tagName!="DIV"){A=document.createElement("DIV");E.childNodes[F].insertBefore(A,E.childNodes[F].firstChild)}A.style.height=parseInt(C)+"px";if((B.parentObject.id!=this.rootId||B.parentObject.childNodes[0]!=B)&&this.treeLinesOn)A.style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";A.innerHTML="&nbsp;";A.style.overflow="hidden";if(parseInt(C)==0)E.childNodes[F].removeChild(A)}if(!_isIE)E.childNodes[F].style.verticalAlign="bottom";if(_isIE){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}}};dhtmlXTreeObject.prototype.setIconSize=function(C,A,E){if(E){if((E)&&(E.span))var D=E;else D=this._globalIdStorageFind(E);if(!D)return(0);var B=D.span.parentNode.previousSibling.childNodes[0];if(C){B.style.width=C;if(window._KHTMLrv)B.parentNode.style.width=C}if(A){B.style.height=A;if(window._KHTMLrv)B.parentNode.style.height=A}}else{this.def_img_x=C;this.def_img_y=A}};dhtmlXTreeObject.prototype.getItemImage=function(E,B,D){var A=this._globalIdStorageFind(E);if(!A)return"";var C=A.images[B||0];if(D)C=this.iconURL+C;return C};dhtmlXTreeObject.prototype.enableRadioButtons=function(B,D){if(arguments.length==1){this._frbtr=convertStringToBoolean(B);this.checkBoxOff=this.checkBoxOff||this._frbtr;return}var A=this._globalIdStorageFind(B);if(!A)return"";D=convertStringToBoolean(D);if((D)&&(!A._r_logic)){A._r_logic=true;for(var C=0;C<A.childsCount;C++)this._setCheck(A.childNodes[C],A.childNodes[C].checkstate)}if((!D)&&(A._r_logic)){A._r_logic=false;for(C=0;C<A.childsCount;C++)this._setCheck(A.childNodes[C],A.childNodes[C].checkstate)}};dhtmlXTreeObject.prototype.enableSingleRadioMode=function(A){this._frbtrs=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.openOnItemAdded=function(A){this._hAdI=!convertStringToBoolean(A)};dhtmlXTreeObject.prototype.openOnItemAdding=function(A){this._hAdI=!convertStringToBoolean(A)};dhtmlXTreeObject.prototype.enableMultiLineItems=function(A){if(A===true)this.mlitems="100%";else this.mlitems=A};dhtmlXTreeObject.prototype.enableAutoTooltips=function(A){this.ettip=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.clearSelection=function(A){if(A)this._unselectItem(this._globalIdStorageFind(A));else this._unselectItems()};dhtmlXTreeObject.prototype.showItemSign=function(C,A){var B=this._globalIdStorageFind(C);if(!B)return 0;var D=B.span.parentNode.previousSibling.previousSibling.previousSibling;if(!convertStringToBoolean(A)){this._openItem(B);B.closeble=false;B.wsign=true}else{B.closeble=true;B.wsign=false}this._correctPlus(B)};dhtmlXTreeObject.prototype.showItemCheckbox=function(D,C){if(!D)for(var B in this._idpull)this.showItemCheckbox(this._idpull[B],C);if(typeof(D)!="object")D=this._globalIdStorageFind(D,0,0);if(!D)return 0;D.nocheckbox=!convertStringToBoolean(C);var A=D.span.parentNode.previousSibling.previousSibling.childNodes[0];A.style.display=(!D.nocheckbox)?"":"none";if(window._KHTMLrv)A.parentNode.style.display=(!D.nocheckbox)?"":"none"};dhtmlXTreeObject.prototype.setListDelimeter=function(A){this.dlmtr=A};dhtmlXTreeObject.prototype.setEscapingMode=function(A){this.utfesc=A};dhtmlXTreeObject.prototype.enableHighlighting=function(A){this.ehlt=true;this.ehlta=convertStringToBoolean(A)};dhtmlXTreeObject.prototype._itemMouseOut=function(){var A=this.childNodes[3].parentObject,B=A.treeNod;B.callEvent("onMouseOut",[A.id]);if(A.id==B._l_onMSI)B._l_onMSI=null;if(!B.ehlta)return;A.span.className=A.span.className.replace("_lor","")};dhtmlXTreeObject.prototype._itemMouseIn=function(){var A=this.childNodes[3].parentObject,B=A.treeNod;if(B._l_onMSI!=A.id)B.callEvent("onMouseIn",[A.id]);B._l_onMSI=A.id;if(!B.ehlta)return;A.span.className=A.span.className.replace("_lor","");A.span.className=A.span.className.replace(/((standart|selected)TreeRow)/,"$1_lor")};dhtmlXTreeObject.prototype.enableActiveImages=function(A){this._aimgs=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.focusItem=function(B){var A=this._globalIdStorageFind(B);if(!A)return(0);this._focusNode(A)};dhtmlXTreeObject.prototype.getAllSubItems=function(A){return this._getAllSubItems(A)};dhtmlXTreeObject.prototype.getAllChildless=function(){return this._getAllScraggyItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllLeafs=dhtmlXTreeObject.prototype.getAllChildless;dhtmlXTreeObject.prototype._getAllScraggyItems=function(A){var C="";for(var D=0;D<A.childsCount;D++)if((A.childNodes[D].unParsed)||(A.childNodes[D].childsCount>0)){if(A.childNodes[D].unParsed)var B=this._getAllScraggyItemsXML(A.childNodes[D].unParsed,1);else B=this._getAllScraggyItems(A.childNodes[D]);if(B)if(C)C+=this.dlmtr+B;else C=B}else if(!C)C=A.childNodes[D].id;else C+=this.dlmtr+A.childNodes[D].id;return C};dhtmlXTreeObject.prototype._getAllFatItems=function(A){var C="";for(var D=0;D<A.childsCount;D++)if((A.childNodes[D].unParsed)||(A.childNodes[D].childsCount>0)){if(!C)C=A.childNodes[D].id;else C+=this.dlmtr+A.childNodes[D].id;if(A.childNodes[D].unParsed)var B=this._getAllFatItemsXML(A.childNodes[D].unParsed,1);else B=this._getAllFatItems(A.childNodes[D]);if(B)C+=this.dlmtr+B}return C};dhtmlXTreeObject.prototype.getAllItemsWithKids=function(){return this._getAllFatItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllFatItems=dhtmlXTreeObject.prototype.getAllItemsWithKids;dhtmlXTreeObject.prototype.getAllChecked=function(){return this._getAllChecked("","",1)};dhtmlXTreeObject.prototype.getAllUnchecked=function(A){if(A)A=this._globalIdStorageFind(A);return this._getAllChecked(A,"",0)};dhtmlXTreeObject.prototype.getAllPartiallyChecked=function(){return this._getAllChecked("","",2)};dhtmlXTreeObject.prototype.getAllCheckedBranches=function(){var B=[this._getAllChecked("","",1)],A=this._getAllChecked("","",2);if(A)B.push(A);return B.join(this.dlmtr)};dhtmlXTreeObject.prototype._getAllChecked=function(A,B,E){if(!A)A=this.htmlNode;if(A.checkstate==E)if(!A.nocheckbox)if(B)B+=this.dlmtr+A.id;else B=A.id;var C=A.childsCount;for(var D=0;D<C;D++)B=this._getAllChecked(A.childNodes[D],B,E);if(A.unParsed)B=this._getAllCheckedXML(A.unParsed,B,E);if(B)return B;else return""};dhtmlXTreeObject.prototype.setItemStyle=function(D,A,C){var C=C||false,B=this._globalIdStorageFind(D);if(!B)return 0;if(!B.span.style.cssText)B.span.setAttribute("style",B.span.getAttribute("style")+";"+A);else B.span.style.cssText=C?A:B.span.style.cssText+";"+A};dhtmlXTreeObject.prototype.enableImageDrag=function(A){this._itim_dg=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.setOnDragIn=function(A){this.attachEvent("onDragIn",A)};dhtmlXTreeObject.prototype.enableDragAndDropScrolling=function(A){this.autoScroll=convertStringToBoolean(A)};dhtmlXTreeObject.prototype.setSkin=function(A){var B=this.parentObject.className.replace(/dhxtree_[^ ]*/gi,"");this.parentObject.className=B+" dhxtree_"+A;if(A=="dhx_terrace")this.enableTreeLines(false)};(function(){dhtmlx.extend_api("dhtmlXTreeObject",{_init:function(A){return[A.parent,(A.width||"100%"),(A.height||"100%"),(A.root_id||0)]},auto_save_selection:"enableAutoSavingSelected",auto_tooltip:"enableAutoTooltips",checkbox:"enableCheckBoxes",checkbox_3_state:"enableThreeStateCheckboxes",checkbox_smart:"enableSmartCheckboxes",context_menu:"enableContextMenu",distributed_parsing:"enableDistributedParsing",drag:"enableDragAndDrop",drag_copy:"enableMercyDrag",drag_image:"enableImageDrag",drag_scroll:"enableDragAndDropScrolling",editor:"enableItemEditor",hover:"enableHighlighting",images:"enableTreeImages",image_fix:"enableIEImageFix",image_path:"setImagePath",lines:"enableTreeLines",loading_item:"enableLoadingItem",multiline:"enableMultiLineItems",multiselect:"enableMultiselection",navigation:"enableKeyboardNavigation",radio:"enableRadioButtons",radio_single:"enableSingleRadioMode",rtl:"enableRTL",search:"enableKeySearch",smart_parsing:"enableSmartXMLParsing",smart_rendering:"enableSmartRendering",text_icons:"enableTextSigns",xml:"loadXML",skin:"setSkin"},{})})();dhtmlXTreeObject.prototype._dp_init=function(A){A.attachEvent("insertCallback",function(E,A,D){var C=this._loader.doXPath(".//item",E),B=C[0].getAttribute("text");this.obj.insertNewItem(D,A,B,0,0,0,0,"CHILD")});A.attachEvent("updateCallback",function(E,A,D){var C=this._loader.doXPath(".//item",E),B=C[0].getAttribute("text");this.obj.setItemText(A,B);if(this.obj.getParentId(A)!=D)this.obj.moveItem(A,"item_child",D);this.setUpdated(A,true,"updated")});A.attachEvent("deleteCallback",function(C,A,B){this.obj.setUserData(A,this.action_param,"true_deleted");this.obj.deleteItem(A,false)});A._methods=["setItemStyle","","changeItemId","deleteItem"];this.attachEvent("onEdit",function(C,B){if(C==3)A.setUpdated(B,true);return true});this.attachEvent("onDrop",function(B,F,D,C,E){if(C==E)A.setUpdated(B,true)});this._onrdlh=function(B){var C=A.getState(B);if(C=="inserted"){A.set_invalid(B,false);A.setUpdated(B,false);return true}if(C=="true_deleted"){A.setUpdated(B,false);return true}A.setUpdated(B,true,"deleted");return false};this._onradh=function(B){A.setUpdated(B,true,"inserted")};A._getRowData=function(C){var A={},D=this.obj._globalIdStorageFind(C),B=D.parentObject,E=0;for(E=0;E<B.childsCount;E++)if(B.childNodes[E]==D)break;A["tr_id"]=D.id;A["tr_pid"]=B.id;A["tr_order"]=E;A["tr_text"]=D.span.innerHTML;B=(D._userdatalist||"").split(",");for(E=0;E<B.length;E++)A[B[E]]=D.userData["t_"+B[E]];return A}};dhtmlXTreeObject.prototype.parserExtension={_parseExtension:function(B,A,C){this._idpull[A.id]._attrs=A}};dhtmlXTreeObject.prototype.getAttribute=function(A,C){this._globalIdStorageFind(A);var B=this._idpull[A]._attrs;return B?B[C]:window.undefined};dhtmlXTreeObject.prototype.setAttribute=function(A,C,D){this._globalIdStorageFind(A);var B=(this._idpull[A]._attrs)||{};B[C]=D;this._idpull[A]._attrs=B};dhtmlXTreeObject.prototype.makeDraggable=function(B,A){if(typeof(B)!="object")B=document.getElementById(B);dragger=new dhtmlDragAndDropObject();dropper=new dhx_dragSomethingInTree();dragger.addDraggableItem(B,dropper);B.dragLanding=null;B.ondragstart=dropper._preventNsDrag;B.onselectstart=new Function("return false;");B.parentObject=new Object;B.parentObject.img=B;B.parentObject.treeNod=dropper;dropper._customDrop=A};dhtmlXTreeObject.prototype.makeDragable=dhtmlXTreeObject.prototype.makeDraggable;dhtmlXTreeObject.prototype.makeAllDraggable=function(A){var B=document.getElementsByTagName("div");for(var C=0;C<B.length;C++)if(B[C].getAttribute("dragInDhtmlXTree"))this.makeDragable(B[C],A)};function dhx_dragSomethingInTree(){this.lWin=window;this._createDragNode=function(B){var A=document.createElement("div");A.style.position="absolute";A.innerHTML=(B.innerHTML||B.value);A.className="dragSpanDiv";return A};this._preventNsDrag=function(A){(A||window.event).cancelBubble=true;if((A)&&(A.preventDefault)){A.preventDefault();return false}return false};this._nonTrivialNode=function(D,E,G,C){if(this._customDrop)return this._customDrop(D,C.img.id,E.id,G?G.id:null);var F=(C.img.getAttribute("image")||""),A=C.img.id||"new",B=(C.img.getAttribute("text")||(_isIE?C.img.innerText:C.img.textContent));D[G?"insertNewNext":"insertNewItem"](G?G.id:E.id,A,B,"",F,F,F)}}dhtmlXTreeObject.prototype.enableItemEditor=function(A){this._eItEd=convertStringToBoolean(A);if(!this._eItEdFlag){this._edn_click_IE=true;this._edn_dblclick=true;this._ie_aFunc=this.aFunc;this._ie_dblclickFuncHandler=this.dblclickFuncHandler;this.setOnDblClickHandler(function(B,A){if(this._edn_dblclick)this._editItem(B,A);return true});this.setOnClickHandler(function(B,A){this._stopEditItem(B,A);if((this.ed_hist_clcik==B)&&(this._edn_click_IE))this._editItem(B,A);this.ed_hist_clcik=B;return true});this._eItEdFlag=true}};dhtmlXTreeObject.prototype.setOnEditHandler=function(A){this.attachEvent("onEdit",A)};dhtmlXTreeObject.prototype.setEditStartAction=function(B,A){this._edn_click_IE=convertStringToBoolean(B);this._edn_dblclick=convertStringToBoolean(A)};dhtmlXTreeObject.prototype._stopEdit=function(C,F){if(this._editCell){this.dADTempOff=this.dADTempOffEd;if(this._editCell.id!=C){var B=true;if(!F)B=this.callEvent("onEdit",[2,this._editCell.id,this,this._editCell.span.childNodes[0].value]);else{B=false;this.callEvent("onEditCancel",[this._editCell.id,this._editCell._oldValue])}if(B===true)B=this._editCell.span.childNodes[0].value;else if(B===false)B=this._editCell._oldValue;var E=(B!=this._editCell._oldValue);this._editCell.span.innerHTML=B;this._editCell.label=this._editCell.span.innerHTML;var D=this._editCell.i_sel?"selectedTreeRow":"standartTreeRow";this._editCell.span.className=D;this._editCell.span.parentNode.className="standartTreeRow";this._editCell.span.style.paddingRight=this._editCell.span.style.paddingLeft="5px";this._editCell.span.onclick=this._editCell.span.ondblclick=function(){};var A=this._editCell.id;if(this.childCalc)this._fixChildCountLabel(this._editCell);this._editCell=null;if(!F)this.callEvent("onEdit",[3,A,this,E]);if(this._enblkbrd){this.parentObject.lastChild.focus();this.parentObject.lastChild.focus()}}}};dhtmlXTreeObject.prototype._stopEditItem=function(A,B){this._stopEdit(A)};dhtmlXTreeObject.prototype.stopEdit=function(A){if(this._editCell)this._stopEdit(this._editCell.id+"_non",A)};dhtmlXTreeObject.prototype.editItem=function(A){this._editItem(A,this)};dhtmlXTreeObject.prototype._editItem=function(A,B){if(this._eItEd){this._stopEdit();var C=this._globalIdStorageFind(A);if(!C)return;editText=this.callEvent("onEdit",[0,A,this,C.span.innerHTML]);if(editText===true)editText=(C.span.innerText||C.span.textContent);else if(editText===false)return;this.dADTempOffEd=this.dADTempOff;this.dADTempOff=false;this._editCell=C;C._oldValue=editText;C.span.innerHTML="<input type='text' class='intreeeditRow' />";C.span.style.paddingRight=C.span.style.paddingLeft="0px";C.span.onclick=C.span.ondblclick=function(A){(A||event).cancelBubble=true};C.span.childNodes[0].value=editText;C.span.childNodes[0].onselectstart=function(A){(A||event).cancelBubble=true;return true};C.span.childNodes[0].onmousedown=function(A){(A||event).cancelBubble=true;return true};C.span.childNodes[0].focus();C.span.childNodes[0].focus();C.span.onclick=function(A){(A||event).cancelBubble=true;return false};C.span.className="";C.span.parentNode.className="";var D=this;C.span.childNodes[0].onkeydown=function(A){if(!A)A=window.event;if(A.keyCode==13){A.cancelBubble=true;D._stopEdit(window.undefined)}else if(A.keyCode==27){D._editCell.span.childNodes[0].value=D._editCell._oldValue;D._stopEdit(window.undefined)}(A||event).cancelBubble=true};this.callEvent("onEdit",[1,A,this])}};function jsonPointer(A,B){this.d=A;this.dp=B}jsonPointer.prototype={text:function(){var A=function(C){var A=[];for(var D=0;D<C.length;D++)A.push("{"+B(C[D])+"}");return A.join(",")},B=function(E){var D=[];for(var C in E)if(typeof(E[C])=="object"){if(C.length)D.push("\""+C+"\":["+A(E[C])+"]");else D.push("\""+C+"\":{"+B(E[C])+"}")}else D.push("\""+C+"\":\""+E[C]+"\"");return D.join(",")};return"{"+B(this.d)+"}"},get:function(A){return this.d[A]},exists:function(){return!!this.d},content:function(){return this.d.content},each:function(E,A,B){var D=this.d[E],C=new jsonPointer();if(D)for(var F=0;F<D.length;F++){C.d=D[F];A.apply(B,[C,F])}},get_all:function(){return this.d},sub:function(A){return new jsonPointer(this.d[A],this.d)},sub_exists:function(A){return!!this.d[A]},each_x:function(F,E,A,B,G){var D=this.d[F],C=new jsonPointer(0,this.d);if(D)for(G=G||0;G<D.length;G++)if(D[G][E]){C.d=D[G];if(A.apply(B,[C,G])==-1)return}},up:function(A){return new jsonPointer(this.dp,this.d)},set:function(B,A){this.d[B]=A},clone:function(A){return new jsonPointer(this.d,this.dp)},through:function(H,G,C,B,D){var F=this.d[H];if(F.length)for(var I=0;I<F.length;I++){if(F[I][G]!=null&&F[I][G]!=""&&(!C||F[I][G]==C)){var E=new jsonPointer(F[I],this.d);B.apply(D,[E,I])}var A=this.d;this.d=F[I];if(this.sub_exists(H))this.through(H,G,C,B,D);this.d=A}}};dhtmlXTreeObject.prototype.loadJSArrayFile=function(file,afterCall){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){eval("var z="+arguments[4].xmlDoc.responseText);that.loadJSArray(z)},this,true,this.no_cashe);if(afterCall)this.XMLLoader.waitCall=afterCall;this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.loadCSV=function(C,B){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var A=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){A.loadCSVString(arguments[4].xmlDoc.responseText)},this,true,this.no_cashe);if(B)this.XMLLoader.waitCall=B;this.XMLLoader.loadXML(C)};dhtmlXTreeObject.prototype.loadJSArray=function(C,B){var D=[];for(var F=0;F<C.length;F++){if(!D[C[F][1]])D[C[F][1]]=[];D[C[F][1]].push({id:C[F][0],text:C[F][2]})}var E={id:this.rootId},A=function(C,A){if(D[C.id]){C.item=D[C.id];for(var B=0;B<C.item.length;B++)A(C.item[B],A)}};A(E,A);this.loadJSONObject(E,B)};dhtmlXTreeObject.prototype.loadCSVString=function(E,C){var F=[],D=E.split("\n");for(var H=0;H<D.length;H++){var B=D[H].split(",");if(!F[B[1]])F[B[1]]=[];F[B[1]].push({id:B[0],text:B[2]})}var G={id:this.rootId},A=function(C,A){if(F[C.id]){C.item=F[C.id];for(var B=0;B<C.item.length;B++)A(C.item[B],A)}};A(G,A);this.loadJSONObject(G,C)};dhtmlXTreeObject.prototype.loadJSONObject=function(A,B){if(!this.parsCount)this.callEvent("onXLS",[this,null]);this.xmlstate=1;var C=new jsonPointer(A);this._parse(C);this._p=C;if(B)B()};dhtmlXTreeObject.prototype.loadJSON=function(file,afterCall){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){try{eval("var t="+arguments[4].xmlDoc.responseText)}catch(e){dhtmlxError.throwError("LoadXML","Incorrect JSON",[(arguments[4].xmlDoc),this]);return}var p=new jsonPointer(t);that._parse(p);that._p=p},this,true,this.no_cashe);if(afterCall)this.XMLLoader.waitCall=afterCall;this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.serializeTreeToJSON=function(){var C=["{\"id\":\""+this.rootId+"\", \"item\":["],A=[];for(var B=0;B<this.htmlNode.childsCount;B++)A.push(this._serializeItemJSON(this.htmlNode.childNodes[B]));C.push(A.join(","));C.push("]}");return C.join("")};dhtmlXTreeObject.prototype._serializeItemJSON=function(B){var G=[];if(B.unParsed)return(B.unParsed.text());if(this._selected.length)var A=this._selected[0].id;else A="";var C=B.span.innerHTML;C=C.replace(/\"/g,"\\\"",C);if(!this._xfullXML)G.push("{\"id\":\""+B.id+"\", "+(this._getOpenState(B)==1?" \"open\":\"1\", ":"")+(A==B.id?" \"select\":\"1\",":"")+" \"text\":\""+C+"\""+(((this.XMLsource)&&(B.XMLload==0))?", \"child\":\"1\" ":""));else G.push("{\"id\":\""+B.id+"\", "+(this._getOpenState(B)==1?" \"open\":\"1\", ":"")+(A==B.id?" \"select\":\"1\",":"")+" \"text\":\""+C+"\", \"im0\":\""+B.images[0]+"\", \"im1\":\""+B.images[1]+"\", \"im2\":\""+B.images[2]+"\" "+(B.acolor?(", \"aCol\":\""+B.acolor+"\" "):"")+(B.scolor?(", \"sCol\":\""+B.scolor+"\" "):"")+(B.checkstate==1?", \"checked\":\"1\" ":(B.checkstate==2?", \"checked\":\"-1\"":""))+(B.closeable?", \"closeable\":\"1\" ":"")+(((this.XMLsource)&&(B.XMLload==0))?", \"child\":\"1\" ":""));if((this._xuserData)&&(B._userdatalist)){G.push(", \"userdata\":[");var D=B._userdatalist.split(","),E=[];for(var F=0;F<D.length;F++)E.push("{\"name\":\""+D[F]+"\" , \"content\":\""+B.userData["t_"+D[F]]+"\" }");G.push(E.join(","));G.push("]")}if(B.childsCount){G.push(", \"item\":[");E=[];for(F=0;F<B.childsCount;F++)E.push(this._serializeItemJSON(B.childNodes[F]));G.push(E.join(","));G.push("]\n")}G.push("}\n");return G.join("")};dhtmlXTreeObject.prototype.enableKeyboardNavigation=function(C){this._enblkbrd=convertStringToBoolean(C);if(this._enblkbrd){if(_isFF){var B=window.getComputedStyle(this.parentObject,null)["position"];if((B!="absolute")&&(B!="relative"))this.parentObject.style.position="relative"}this._navKeys=[["up",38],["down",40],["open",39],["close",37],["call",13],["edit",113]];var A=this,B=document.createElement("INPUT");B.className="a_dhx_hidden_input";B.autocomplete="off";if(window._KHTMLrv)B.style.color="white";this.parentObject.appendChild(B);this.parentObject[_isOpera?"onkeypress":"onkeydown"]=function(B){if(A.callEvent("onKeyPress",[(B||window.event).keyCode,(B||window.event)]))return A._onKeyDown(B||window.event)};this.parentObject.onclick=function(A){if(_isFF||_isIE)B.select();if(window._KHTMLrv||_isOpera)B.focus()}}else this.parentObject.onkeydown=null};dhtmlXTreeObject.prototype._onKeyDown=function(A){if(window.globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject.isActive)return true;var B=this;for(var C=0;C<this._navKeys.length;C++)if(this._navKeys[C][1]==A.keyCode){this["_onkey_"+this._navKeys[C][0]].apply(this,[this.getSelectedItemId()]);if(A.preventDefault)A.preventDefault();(A||event).cancelBubble=true;return false}if(this._textSearch)return this._searchItemByKey(A);return true};dhtmlXTreeObject.prototype._onkey_up=function(A){var C=this._globalIdStorageFind(A);if(!C)return;var B=this._getPrevVisibleNode(C);if(B.id==this.rootId)return;this.focusItem(B.id);this.selectItem(B.id,false)};dhtmlXTreeObject.prototype._onkey_down=function(A){var C=this._globalIdStorageFind(A);if(!C)return;var B=this._getNextVisibleNode(C);if(B.id==this.rootId)return;this.focusItem(B.id);this.selectItem(B.id,false)};dhtmlXTreeObject.prototype._onkey_open=function(A){this.openItem(A)};dhtmlXTreeObject.prototype._onkey_close=function(A){this.closeItem(A)};dhtmlXTreeObject.prototype._onkey_call=function(A){if(this.stopEdit){this.stopEdit();this.parentObject.lastChild.focus();this.parentObject.lastChild.focus();this.selectItem(A,true)}else this.selectItem(this.getSelectedItemId(),true)};dhtmlXTreeObject.prototype._onkey_edit=function(A){if(this.editItem)this.editItem(A)};dhtmlXTreeObject.prototype._getNextVisibleNode=function(A,B){if((!B)&&(this._getOpenState(A)>0))return A.childNodes[0];if((A.tr)&&(A.tr.nextSibling)&&(A.tr.nextSibling.nodem))return A.tr.nextSibling.nodem;if(A.parentObject)return this._getNextVisibleNode(A.parentObject,1);return A};dhtmlXTreeObject.prototype._getPrevVisibleNode=function(A){if((A.tr)&&(A.tr.previousSibling)&&(A.tr.previousSibling.nodem))return this._lastVisibleChild(A.tr.previousSibling.nodem);if(A.parentObject)return A.parentObject;else return A};dhtmlXTreeObject.prototype._lastVisibleChild=function(A){if(this._getOpenState(A)>0)return this._lastVisibleChild(A.childNodes[A.childsCount-1]);else return A};dhtmlXTreeObject.prototype._searchItemByKey=function(A){if(A.keyCode==8){this._textSearchString="";return true}var B=String.fromCharCode(A.keyCode).toUpperCase();if(B.match(/[A-Z,a-z,0-9\ ]/)){this._textSearchString+=B;this._textSearchInProgress=true;if(!(this.getSelectedItemText()||"").match(RegExp("^"+this._textSearchString,"i")))this.findItem("^"+this._textSearchString,0);this._textSearchInProgress=false;if(A.preventDefault)A.preventDefault();(A||event).cancelBubble=true;return false}return true};dhtmlXTreeObject.prototype.assignKeys=function(A){this._navKeys=A};dhtmlXTreeObject.prototype.enableKeySearch=function(B){this._textSearch=convertStringToBoolean(B);if(!this._textSearch)return;this._textSearchString="";var A=this;this._markItem2=this._markItem;this._markItem=function(B){if(!A._textSearchInProgress)A._textSearchString="";A._markItem2(B)}};dhtmlXTreeObject.prototype.enableLoadingItem=function(A){this.attachEvent("onXLS",this._showFakeItem);this.attachEvent("onXLE",this._hideFakeItem);this._tfi_text=A||"Loading..."};dhtmlXTreeObject.prototype._showFakeItem=function(B,A){if((A===null)||(this._globalIdStorageFind("fake_load_xml_"+A)))return;var C=this.XMLsource;this.XMLsource=null;this.insertNewItem(A,"fake_load_xml_"+A,this._tfi_text);this.XMLsource=C};dhtmlXTreeObject.prototype._hideFakeItem=function(B,A){if(A===null)return;this.deleteItem("fake_load_xml_"+A)};dhtmlXTreeObject.prototype.isLocked=function(A){if(!this._locker)this._init_lock();return(this._locker[A]==true)};dhtmlXTreeObject.prototype._lockItem=function(E,B,C){if(!this._locker)this._init_lock();if(B){if(this._locker[E.id]==true)return;this._locker[E.id]=true;E.bIm0=E.images[0];E.bIm1=E.images[1];E.bIm2=E.images[2];E.images[0]=this.lico0;E.images[1]=this.lico1;E.images[2]=this.lico2;var A=E.span.parentNode,D=A.previousSibling;this.dragger.removeDraggableItem(A);this.dragger.removeDraggableItem(D)}else{if(this._locker[E.id]!=true)return;this._locker[E.id]=false;E.images[0]=E.bIm0;E.images[1]=E.bIm1;E.images[2]=E.bIm2;A=E.span.parentNode,D=A.previousSibling;this.dragger.addDraggableItem(A,this);this.dragger.addDraggableItem(D,this)}if(!C)this._correctPlus(E)};dhtmlXTreeObject.prototype.lockItem=function(C,A){if(!this._locker)this._init_lock();this._lockOn=false;var B=this._globalIdStorageFind(C);this._lockOn=true;this._lockItem(B,convertStringToBoolean(A))};dhtmlXTreeObject.prototype.setLockedIcons=function(C,B,A){if(!this._locker)this._init_lock();this.lico0=C;this.lico1=B;this.lico2=A};dhtmlXTreeObject.prototype._init_lock=function(){this._locker=new Array();this._locker_count="0";this._lockOn=true;this._globalIdStorageFindA=this._globalIdStorageFind;this._globalIdStorageFind=this._lockIdFind;if(this._serializeItem){this._serializeItemA=this._serializeItem;this._serializeItem=this._serializeLockItem;this._serializeTreeA=this.serializeTree;this.serializeTree=this._serializeLockTree}this.setLockedIcons(this.imageArray[0],this.imageArray[1],this.imageArray[2])};dhtmlXTreeObject.prototype._lockIdFind=function(C,B,A){if(!this.skipLock)if((!A)&&(this._lockOn==true)&&(this._locker[C]==true))return null;return this._globalIdStorageFindA(C,B,A)};dhtmlXTreeObject.prototype._serializeLockItem=function(A){if(this._locker[A.id]==true)return"";return this._serializeItemA(A)};dhtmlXTreeObject.prototype._serializeLockTree=function(){var A=this._serializeTreeA();return A.replace(/<item[^>]+locked\=\"1\"[^>]+\/>/g,"")};dhtmlXTreeObject.prototype._moveNodeToA=dhtmlXTreeObject.prototype._moveNodeTo;dhtmlXTreeObject.prototype._moveNodeTo=function(C,A,B){if((A.treeNod.isLocked)&&(A.treeNod.isLocked(A.id)))return false;return this._moveNodeToA(C,A,B)};dhtmlXTreeObject.prototype.lockTree=function(A){if(convertStringToBoolean(A))this._initTreeLocker();else if(this._TreeLocker){this._TreeLocker.parentNode.removeChild(this._TreeLocker);this._TreeLocker=null}};dhtmlXTreeObject.prototype._initTreeLocker=function(B){if(this._TreeLocker)return;this.parentObject.style.overflow="hidden";if(this.parentObject.style.position!="absolute")this.parentObject.style.position="relative";var A=document.createElement("div");A.style.position="absolute";A.style.left="0px";A.style.top="0px";A.className="dhx_tree_opacity";A.style.width=this.allTree.offsetWidth+"px";A.style.backgroundColor="#FFFFFF";A.style.height=this.allTree.offsetHeight+"px";this._TreeLocker=A;this.parentObject.appendChild(this._TreeLocker)};dhtmlXTreeObject.prototype.enableRTL=function(B){var A=convertStringToBoolean(B);if(((A)&&(!this.rtlMode))||((!A)&&(this.rtlMode))){this.rtlMode=A;this._switchToRTL(this.rtlMode)}};dhtmlXTreeObject.prototype._switchToRTL=function(A){if(A){this.allTree.className=this._ltr_line=this.lineArray;this._ltr_min=this.minusArray;this._ltr_plus=this.plusArray;this.lineArray=new Array("line2_rtl.gif","line3_rtl.gif","line4_rtl.gif","blank.gif","blank.gif","line1_rtl.gif");this.minusArray=new Array("minus2_rtl.gif","minus3_rtl.gif","minus4_rtl.gif","minus.gif","minus5_rtl.gif");this.plusArray=new Array("plus2_rtl.gif","plus3_rtl.gif","plus4_rtl.gif","plus.gif","plus5_rtl.gif");this.allTree.className="containerTableStyleRTL"}else{this.allTree.className="containerTableStyle";this.lineArray=this._ltr_line;this.minusArray=this._ltr_min;this.plusArray=this._ltr_plus}if(this.htmlNode.childsCount)this._redrawFrom(this,this.htmlNode)};dhtmlXTreeObject.prototype.sortTree=function(A,B,C){var D=this._globalIdStorageFind(A);if(!D)return false;this._reorderBranch(D,(B.toString().toLowerCase()=="asc"),convertStringToBoolean(C))};dhtmlXTreeObject.prototype.setCustomSortFunction=function(A){this._csfunca=A};dhtmlXTreeObject.prototype._reorderBranch=function(A,C,D){var G=[],B=A.childsCount;if(!B)return;var E=A.childNodes[0].tr.parentNode;for(var H=0;H<B;H++){G[H]=A.childNodes[H];E.removeChild(G[H].tr)}var F=this;if(C==1){if(this._csfunca)G.sort(function(B,A){return F._csfunca(B.id,A.id)});else G.sort(function(B,A){return((B.span.innerHTML.toUpperCase()>A.span.innerHTML.toUpperCase())?1:((B.span.innerHTML.toUpperCase()==A.span.innerHTML.toUpperCase())?0:-1))})}else if(this._csfunca)G.sort(function(B,A){return F._csfunca(A.id,B.id)});else G.sort(function(B,A){return((B.span.innerHTML.toUpperCase()<A.span.innerHTML.toUpperCase())?1:((B.span.innerHTML.toUpperCase()==A.span.innerHTML.toUpperCase())?0:-1))});for(H=0;H<B;H++){E.appendChild(G[H].tr);A.childNodes[H]=G[H];if((D)&&(G[H].unParsed))G[H].unParsed.set("order",C?1:-1);else if((D)&&(G[H].childsCount))this._reorderBranch(G[H],C,D)}for(H=0;H<B;H++){this._correctPlus(G[H]);this._correctLine(G[H])}};dhtmlXTreeObject.prototype._reorderXMLBranch=function(A){var D=A.getAttribute("order");if(D=="none")return;var C=(D==1),B=A.childNodes.length;if(!B)return;var E=new Array(),F=0;for(var G=0;G<B;G++)if(A.childNodes[G].nodeType==1){E[F]=A.childNodes[G];F++}for(G=B-1;G!=0;G--)A.removeChild(A.childNodes[G]);if(C)E.sort(function(B,A){return((B.getAttribute("text")>A.getAttribute("text"))?1:((B.getAttribute("text")==A.getAttribute("text"))?0:-1))});else E.sort(function(B,A){return((B.getAttribute("text")<A.getAttribute("text"))?1:((B.getAttribute("text")==A.getAttribute("text"))?0:-1))});for(G=0;G<F;G++){E[G].setAttribute("order",D);A.appendChild(E[G])}A.setAttribute("order","none")};dhtmlXTreeObject.prototype.enableSmartRendering=function(){this.enableSmartXMLParsing(true);this._srnd=true;this.itemHeight=18;var A=this;this.allTree.onscroll=function(){if(A._srndT)return;A._srndT=window.setTimeout(function(){A._srndT=null;A._renderState()},300)};this.attachEvent("onXLE",function(){A._renderState()});this._singleTimeSRND()};dhtmlXTreeObject.prototype._renderState=function(){if(!this._idpull[this.rootId]._sready)this.prepareSR(this.rootId,true);var C=this.allTree.scrollTop,B=Math.floor(C/this.itemHeight),A=Math.ceil(this.allTree.offsetHeight/this.itemHeight);this._group_render=true;this._getItemByPos(C,this.itemHeight,A,null,false,this._renderItemSRND);this._group_render=false};dhtmlXTreeObject.prototype._renderItemSRND=function(D,B){if(!D.span){D.span=-1;var F=D.parentObject.htmlNode.childNodes[0].childNodes,A=B*this.itemHeight,J=null;for(var I=1;I<F.length;I++){J=F[I];var H=J.nodem?this.itemHeight:(J.offsetHeight||parseInt(J.childNodes[1].firstChild.style.height));A-=H;if(A<0){if(A==-1){A++;continue}var G=J.childNodes[1].firstChild;G.style.height=(parseInt(G.style.height)-(H-Math.abs(A)+this.itemHeight))+"px";if(Math.abs(A)!=H){var C=this._drawNewHolder(A+H,true);J.parentNode.insertBefore(C,J)}J.tr={nextSibling:J};break}}if(G&&G.style.height!="0px"&&!J.offsetHeight){var E=this._hAdI;this._hAdI=true}this._parseItem(D._sxml,D.parentObject,null,J);if(G&&G.style.height!="0px"&&!J.offsetHeight)this._hAdI=E;if(D.unParsed)this._correctPlus(D);if(G&&G.style.height=="0px")J.parentNode.removeChild(J)}};dhtmlXTreeObject.prototype._buildSRND=function(B,A){if(B.parentObject)this._globalIdStorageFind(B.parentObject.id);if(!this._idpull[this.rootId]._sready)this.prepareSR(this.rootId,true);this._renderItemSRND(B,this._getIndex(B));if((B.unParsed)&&(!A))this.reParse(B,0);if(!B.prepareSR)this.prepareSR(B.id)};dhtmlXTreeObject.prototype._getIndex=function(B){for(var A=0;A<B.parentObject.childsCount;A++)if(B.parentObject.childNodes[A]==B)return A};dhtmlXTreeObject.prototype.prepareSR=function(A,C){A=this._idpull[A];if(A._sready)return;var B=this._drawNewHolder(this.itemHeight*A.childsCount,C);A.htmlNode.childNodes[0].appendChild(B);A._sready=true};dhtmlXTreeObject.prototype._drawNewHolder=function(C,F){var A=document.createElement("TR"),B=document.createElement("TD"),D=document.createElement("TD"),E=document.createElement("DIV");E.innerHTML="&nbsp;";B.appendChild(E);A.appendChild(D);A.appendChild(B);if(!F)A.style.display="none";E.style.height=C+"px";return A};dhtmlXTreeObject.prototype._getNextNodeSR=function(A,B){if((!B)&&(A.childsCount))return A.childNodes[0];if(A==this.htmlNode)return-1;if((A.tr)&&(A.tr.nextSibling)&&(A.tr.nextSibling.nodem))return A.tr.nextSibling.nodem;return this._getNextNode(A.parentObject,true)};dhtmlXTreeObject.prototype._getItemByPos=function(G,E,B,F,C,A){if(!F){this._pos_c=G;F=this._idpull[this.rootId]}for(var D=0;D<F.childsCount;D++){this._pos_c-=E;if(this._pos_c<=0)C=true;if(C){A.apply(this,[F.childNodes[D],D]);B--}if(B<0)return B;if(F.childNodes[D]._open){B=this._getItemByPos(null,E,B,F.childNodes[D],C,A);if(B<0)return B}}return B};dhtmlXTreeObject.prototype._addItemSRND=function(E,A,C){var D=this._idpull[E],B=D.childsCount,F=D.childNodes;F[B]=new dhtmlXTreeItemObject(A,"",D,this,null,1);itemId=F[B].id;F[B]._sxml=C.clone();D.childsCount++};dhtmlXTreeObject.prototype._singleTimeSRND=function(){this._redrawFrom=function(){};var A=dhtmlXTreeItemObject;this._singleTimeSRND=function(){};window.dhtmlXTreeItemObject=function(D,C,B,G,E,F){if(!G._srnd)return A.call(this,D,C,B,G,E,F);this.htmlNode="";this.acolor="";this.scolor="";this.tr=0;this.childsCount=0;this.tempDOMM=0;this.tempDOMU=0;this.dragSpan=0;this.dragMove=0;this.span=0;this.closeble=1;this.childNodes=new Array();this.userData=new cObject();this.checkstate=0;this.treeNod=G;this.label=C;this.parentObject=B;this.actionHandler=E;this.images=new Array(G.imageArray[0],G.imageArray[1],G.imageArray[2]);this.id=G._globalIdStorageAdd(D,this);if(D==G.rootId){if(this.treeNod.checkBoxOff)this.htmlNode=this.treeNod._createItem(1,this,F);else this.htmlNode=this.treeNod._createItem(0,this,F);this.htmlNode.objBelong=this}return this};this.setCheckSR=this.setCheck;this.setCheck=function(B,A){this._globalIdStorageFind(B);return this.setCheckSR(B,A)};this._get_srnd_p=function(A){var B=[];while(A!=this.rootId){var C=this.getParentId(A);for(var D=0;D<this._idpull[C].childsCount;D++)if(this._idpull[C].childNodes[D].id==A){B.push([C,D]);break}A=C}B.reverse();return B};this._get_srnd_p_last=function(A,B,C){B=B||[];var E=0;while(true){var D=this._idpull[A];if(D._sxml&&this.findStrInXML(D._sxml.d,"text",C))this._globalIdStorageFind(D.id);E=D.childsCount;if(!E)break;B.push([A,E-1]);A=D.childNodes[E-1].id}return B};this._get_prev_srnd=function(B,D){var A;if(!B.length){B.push.apply(B,this._get_srnd_p_last(this.rootId,null,D));A=B[B.length-1];return this._idpull[A[0]].childNodes[A[1]]}A=B[B.length-1];if(A[1]){A[1]--;var C=this._idpull[A[0]].childNodes[A[1]];this._get_srnd_p_last(C.id,B,D);A=B[B.length-1];return this._idpull[A[0]].childNodes[A[1]]}else{B.pop();if(!B.length)return this._get_prev_srnd(B,D);A=B[B.length-1];return this._idpull[A[0]].childNodes[A[1]]}};this._get_next_srnd=function(B,D){if(!B.length){B.push([this.rootId,0]);return this._idpull[this.rootId].childNodes[0]}var A=B[B.length-1],C=this._idpull[A[0]].childNodes[A[1]];if(C.childsCount&&!D){B.push([C.id,0]);return C.childNodes[0]}A[1]++;C=this._idpull[A[0]].childNodes[A[1]];if(C)return C;B.pop();if(!B.length)return this.htmlNode;return this._get_next_srnd(B,true)};this._findNodeByLabel=function(E,A,C){var E=E.replace(new RegExp("^( )+"),"").replace(new RegExp("( )+$"),"");E=new RegExp(E.replace(/([\*\+\\\[\]\(\)]{1})/gi,"\\$1").replace(/ /gi,".*"),"gi");if(!C){C=this._selected[0];if(!C)C=this.htmlNode}var D=C,B=this._get_srnd_p(D.id);while(C=(A?this._get_prev_srnd(B,E):this._get_next_srnd(B))){if(C.label){if(C.label.search(E)!=-1)return C}else if(C._sxml){if(C._sxml.get("text").search(E)!=-1)return C;if(this.findStrInXML(C._sxml.d,"text",E))this._globalIdStorageFind(C.id)}if((C.unParsed)&&(this.findStrInXML(C.unParsed.d,"text",E)))this.reParse(C);if(D.id==C.id)break;if(A&&B.length==1&&B[0][1]==0)break}return null};this.deleteChildItems=function(A){if(this.rootId==A){this._selected=new Array();this._idpull={};this._p=this._pos_c=this._pullSize=null;this.allTree.removeChild(this.htmlNode.htmlNode);this.htmlNode=new dhtmlXTreeItemObject(this.rootId,"",0,this);this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display="none";this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className="hiddenRow";this.allTree.insertBefore(this.htmlNode.htmlNode,this.selectionBar);if(_isFF){this.allTree.childNodes[0].width="100%";this.allTree.childNodes[0].style.overflow="hidden"}}};this._HideShow=function(F,E){if((this.XMLsource)&&(!F.XMLload)){if(E==1)return;F.XMLload=1;this._loadDynXML(F.id);return}if(!F.span)this._buildSRND(F);if(F.unParsed){this.reParse(F);this.prepareSR(F.id)}if(F.childsCount==0)return;var C=F.htmlNode.childNodes[0].childNodes,A=C.length;if(A>1){if(((C[1].style.display!="none")||(E==1))&&(E!=2)){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";var B="none";F._open=false}else{B="";F._open=true}for(var D=1;D<A;D++)C[D].style.display=B;this._renderState()}this._correctPlus(F)}};function dhtmlXTreeFromHTML(obj){if(typeof(obj)!="object")obj=document.getElementById(obj);var n=obj,id=n.id,cont="";for(var j=0;j<obj.childNodes.length;j++)if(obj.childNodes[j].nodeType=="1"){if(obj.childNodes[j].tagName=="XMP"){var cHead=obj.childNodes[j];for(var m=0;m<cHead.childNodes.length;m++)cont+=cHead.childNodes[m].data}else if(obj.childNodes[j].tagName.toLowerCase()=="ul")cont=dhx_li2trees(obj.childNodes[j],new Array(),0);break}obj.innerHTML="";var t=new dhtmlXTreeObject(obj,"100%","100%",0),z_all=new Array();for(b in t)z_all[b.toLowerCase()]=b;var atr=obj.attributes;for(var a=0;a<atr.length;a++)if((atr[a].name.indexOf("set")==0)||(atr[a].name.indexOf("enable")==0)){var an=atr[a].name;if(!t[an])an=z_all[atr[a].name];t[an].apply(t,atr[a].value.split(","))}if(typeof(cont)=="object"){t.XMLloadingWarning=1;for(var i=0;i<cont.length;i++){n=t.insertNewItem(cont[i][0],cont[i][3],cont[i][1]);if(cont[i][2])t._setCheck(n,cont[i][2])}t.XMLloadingWarning=0;t.lastLoadedXMLId=0;t._redrawFrom(t)}else t.loadXMLString("<tree id='0'>"+cont+"</tree>");window[id]=t;var oninit=obj.getAttribute("oninit");if(oninit)eval(oninit);return t}function dhx_init_trees(){var A=document.getElementsByTagName("div");for(var B=0;B<A.length;B++)if(A[B].className=="dhtmlxTree")dhtmlXTreeFromHTML(A[B])}function dhx_li2trees(F,G,E){for(var J=0;J<F.childNodes.length;J++){var I=F.childNodes[J];if((I.nodeType==1)&&(I.tagName.toLowerCase()=="li")){var D="",A=null,B=I.getAttribute("checked");for(var H=0;H<I.childNodes.length;H++){var C=I.childNodes[H];if(C.nodeType==3)D+=C.data;else if(C.tagName.toLowerCase()!="ul")D+=dhx_outer_html(C);else A=C}G[G.length]=[E,D,B,(I.id||(G.length+1))];if(A)G=dhx_li2trees(A,G,(I.id||G.length))}}return G}function dhx_outer_html(A){if(A.outerHTML)return A.outerHTML;var B=document.createElement("DIV");B.appendChild(A.cloneNode(true));B=B.innerHTML;return B}if(window.addEventListener)window.addEventListener("load",dhx_init_trees,false);else if(window.attachEvent)window.attachEvent("onload",dhx_init_trees);dhtmlXTreeObject.prototype._serEnts=[["&","&amp;"],["<","&lt;"],[">","&gt;"]];dhtmlXTreeObject.prototype.registerXMLEntity=function(A,B){this._serEnts[this._serEnts.length]=[A,B,new RegExp(A,"g")]};dhtmlXTreeObject.prototype.setSerializationLevel=function(D,B,C,A,E){this._xuserData=convertStringToBoolean(D);this._xfullXML=convertStringToBoolean(B);this._dtd=E;this._xescapeEntities=convertStringToBoolean(C);if(convertStringToBoolean(A)){this._apreUC="<![CDATA[";this._apstUC="]]>"}for(var F=0;F<this._serEnts.length;F++)this._serEnts[F][2]=new RegExp(this._serEnts[F][0],"g")};dhtmlXTreeObject.prototype.serializeTree=function(){if(this.stopEdit)this.stopEdit();this._apreUC=this._apreUC||"";this._apstUC=this._apstUC||"";var C="<?xml version=\"1.0\"?>";if(this._dtd)C+="<!DOCTYPE tree SYSTEM \""+this._dtd+"\">";C+="<tree id=\""+this.rootId+"\">";if((this._xuserData)&&(this._idpull[this.rootId]._userdatalist)){var A=this._idpull[this.rootId]._userdatalist.split(",");for(var B=0;B<A.length;B++)C+="<userdata name=\""+A[B]+"\">"+this._apreUC+this._idpull[this.rootId].userData["t_"+A[B]]+this._apstUC+"</userdata>"}for(B=0;B<this.htmlNode.childsCount;B++)C+=this._serializeItem(this.htmlNode.childNodes[B]);C+="</tree>";return C};dhtmlXTreeObject.prototype._serializeItem=function(B){if(B.unParsed)if(document.all)return B.unParsed.d.xml;else{var D=new XMLSerializer();return D.serializeToString(B.unParsed.d)}var G="";if(this._selected.length)var A=this._selected[0].id;else A="\"";var C=B.span.innerHTML;if(this._xescapeEntities)for(var F=0;F<this._serEnts.length;F++)C=C.replace(this._serEnts[F][2],this._serEnts[F][1]);if(!this._xfullXML)G="<item id=\""+B.id+"\" "+(this._getOpenState(B)==1?" open=\"1\" ":"")+(A==B.id?" select=\"1\"":"")+" text=\""+C+"\""+(((this.XMLsource)&&(B.XMLload==0))?" child=\"1\" ":"")+">";else G="<item id=\""+B.id+"\" "+(this._getOpenState(B)==1?" open=\"1\" ":"")+(A==B.id?" select=\"1\"":"")+" text=\""+C+"\" im0=\""+B.images[0]+"\" im1=\""+B.images[1]+"\" im2=\""+B.images[2]+"\" "+(B.acolor?("aCol=\""+B.acolor+"\" "):"")+(B.scolor?("sCol=\""+B.scolor+"\" "):"")+(B.checkstate==1?"checked=\"1\" ":(B.checkstate==2?"checked=\"-1\"":""))+(B.closeable?"closeable=\"1\" ":"")+(((this.XMLsource)&&(B.XMLload==0))?" child=\"1\" ":"")+">";if((this._xuserData)&&(B._userdatalist)){var E=B._userdatalist.split(",");for(F=0;F<E.length;F++)G+="<userdata name=\""+E[F]+"\">"+this._apreUC+B.userData["t_"+E[F]]+this._apstUC+"</userdata>"}for(F=0;F<B.childsCount;F++)G+=this._serializeItem(B.childNodes[F]);G+="</item>";return G};dhtmlXTreeObject.prototype.saveSelectedItem=function(B,A){B=B||"";this.setCookie("treeStateSelected"+B,this.getSelectedItemId(),A)};dhtmlXTreeObject.prototype.restoreSelectedItem=function(A){A=A||"";var B=this.getCookie("treeStateSelected"+A);this.selectItem(B,false)};dhtmlXTreeObject.prototype.enableAutoSavingSelected=function(B,A){this.assMode=convertStringToBoolean(B);if((this.assMode)&&(!this.oldOnSelect)){this.oldOnSelect=this.onRowSelect;this.onRowSelect=function(B,A,C){if(!A)A=this;A.parentObject.treeNod.oldOnSelect(B,A,C);if(A.parentObject.treeNod.assMode)A.parentObject.treeNod.saveSelectedItem(A.parentObject.treeNod.assCookieName)}}this.assCookieName=A};dhtmlXTreeObject.prototype.saveState=function(C,B){var D=this._escape(this.serializeTree()),A=4000;if(D.length>A){if(navigator.appName.indexOf("Microsoft")!=-1)return false;this.setCookie("treeStatex"+C,Math.ceil(D.length/A));for(var E=0;E<Math.ceil(D.length/A);E++)this.setCookie("treeStatex"+C+"x"+E,D.substr(E*A,A),B)}else this.setCookie("treeStatex"+C,D,B);D=this.getCookie("treeStatex"+C);if(!D){this.setCookie("treeStatex"+C,"",B);return false}return true};dhtmlXTreeObject.prototype.loadState=function(A){var C=this.getCookie("treeStatex"+A);if(!C)return false;if(C.length){if(C.toString().length<4){var B="";for(var D=0;D<C;D++)B+=this.getCookie("treeStatex"+A+"x"+D);C=B}this.loadXMLString((this.utfesc=="utf8")?decodeURI(C):unescape(C))}return true};dhtmlXTreeObject.prototype.setCookie=function(C,D,A){var B=C+"="+D+(A?(";"+A):"");document.cookie=B};dhtmlXTreeObject.prototype.getCookie=function(B){var A=B+"=";if(document.cookie.length>0){var C=document.cookie.indexOf(A);if(C!=-1){C+=A.length;var D=document.cookie.indexOf(";",C);if(D==-1)D=document.cookie.length;return document.cookie.substring(C,D)}}};dhtmlXTreeObject.prototype.saveOpenStates=function(B,A){var C=[];for(var D=0;D<this.htmlNode.childsCount;D++)C=C.concat(this._collectOpenStates(this.htmlNode.childNodes[D]));C=C.join(this.dlmtr);this.setCookie("treeOpenStatex"+B,C,A)};dhtmlXTreeObject.prototype.loadOpenStates=function(C){for(var E=0;E<this.htmlNode.childsCount;E++)this._xcloseAll(this.htmlNode.childNodes[E]);this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";var D=getCookie("treeOpenStatex"+C);if(D){var A=D.split(this.dlmtr);for(E=0;E<A.length;E++){var B=this._globalIdStorageFind(A[E]);if(B)if((this.XMLsource)&&(!B.XMLload)&&(B.id!=this.rootId)){this._delayedLoad(B,"loadOpenStates('"+C+"')");return}else this.openItem(A[E])}}this.callEvent("onAllOpenDynamic",[])};dhtmlXTreeObject.prototype._delayedLoad=function(A,B){this.afterLoadMethod=B;this.onLoadReserve=this.onXLE;this.onXLE=this._delayedLoadStep2;this._loadDynXML(A.id)};dhtmlXTreeObject.prototype._delayedLoadStep2=function(tree){tree.onXLE=tree.onLoadReserve;window.setTimeout(function(){eval("tree."+tree.afterLoadMethod)},100);if(tree.onXLE)tree.onXLE(tree);tree.callEvent("onXLE",[tree])};dhtmlXTreeObject.prototype._collectOpenStates=function(A){var B=[];if(this._getOpenState(A)==1){B.push(A.id);for(var C=0;C<A.childsCount;C++)B=B.concat(this._collectOpenStates(A.childNodes[C]))}return B};function setCookie(A,B){document.cookie=A+"="+B}function getCookie(B){var A=B+"=";if(document.cookie.length>0){var C=document.cookie.indexOf(A);if(C!=-1){C+=A.length;var D=document.cookie.indexOf(";",C);if(D==-1)D=document.cookie.length;return(document.cookie.substring(C,D))}}}dhtmlXTreeObject.prototype.openAllItemsDynamic=function(B){this.ClosedElem=new Array();this.G_node=null;var A=this._globalIdStorageFind(B||this.rootId);if(A.id!=this.rootId&&this.getOpenState(A.id)!=0)this.openItem(B);this._openAllNodeChilds(A,0);if(this.ClosedElem.length>0){this.onLoadReserve=this.onXLE;this.onXLE=this._loadAndOpen;this._loadAndOpen(this)}};dhtmlXTreeObject.prototype._openAllNodeChilds=function(A){if((A.XMLload==0)||(A.unParsed))this.ClosedElem.push(A);for(var B=0;B<A.childsCount;B++){if(this._getOpenState(A.childNodes[B])<0)this._HideShow(A.childNodes[B],2);if(A.childNodes[B].childsCount>0)this._openAllNodeChilds(A.childNodes[B]);if((A.childNodes[B].XMLload==0)||(A.childNodes[B].unParsed))this.ClosedElem.push(A.childNodes[B])}};dhtmlXTreeObject.prototype._loadAndOpen=function(A){if(A.G_node){A._openItem(A.G_node);A._openAllNodeChilds(A.G_node);A.G_node=null}if(A.ClosedElem.length>0)A.G_node=A.ClosedElem.shift();if(A.G_node){if(A.G_node.unParsed)A.reParse(A.G_node);else window.setTimeout(function(){A._loadDynXML(A.G_node.id)},100)}else{A.onXLE=A.onLoadReserve;if(A.onXLE)A.onXLE(A);A.callEvent("onAllOpenDynamic",[A])}};dhtmlXTreeObject.prototype.openItemsDynamic=function(B,A){if(this.onXLE==this._stepOpen)return;this._opnItmsDnmcFlg=convertStringToBoolean(A);this.onLoadReserve=this.onXLE;this.onXLE=this._stepOpen;this.ClosedElem=B.split(",").reverse();this._stepOpen(this)};dhtmlXTreeObject.prototype._stepOpen=function(A){if(!A.ClosedElem.length){A.onXLE=A.onLoadReserve;if(A._opnItmsDnmcFlg)A.selectItem(A.G_node,true);if((A.onXLE)&&(arguments[1]))A.onXLE.apply(A,arguments);A.callEvent("onOpenDynamicEnd",[]);return}A.G_node=A.ClosedElem.pop();var B=A._globalIdStorageFind(A.G_node);if(B.XMLload===0)A.openItem(A.G_node);else{A.openItem(A.G_node);A._stepOpen(A)}};dhtmlXGridObject.prototype._updateTGRState=function(A){if(!A.update||A.id==0)return;if(this.rowsAr[A.id].imgTag)this.rowsAr[A.id].imgTag.src=this.imgURL+A.state+".gif";A.update=false};dhtmlXGridObject.prototype.doExpand=function(B){this.editStop();var C=B.parentNode.parentNode.parentNode,A=this._h2.get[C.idd];if(!this.callEvent("onOpen",[C.idd,(A.state=="plus"?-1:1)]))return;if(A.state=="plus")this.expandKids(C);else if((A.state=="minus")&&(!A._closeable))this.collapseKids(C)};function dhtmlxHierarchy(){var A={id:0,childs:[],level:-1,parent:null,index:0,state:dhtmlXGridObject._emptyLineImg};this.order=[A];this.get={"0":A};this.swap=function(C,A){var B=C.parent,D=C.index;B.childs[D]=A;B.childs[A.index]=C;C.index=A.index;A.index=D};this.forEachChildF=function(A,D,B,C){var E=this.get[A];for(var F=0;F<E.childs.length;F++){if(!D.apply((B||this),[E.childs[F]]))continue;if(E.childs[F].childs.length)this.forEachChildF(E.childs[F].id,D,B,C);if(C)C.call((B||this),E.childs[F])}};this.forEachChild=function(A,C,B){var D=this.get[A];for(var E=0;E<D.childs.length;E++){C.apply((B||this),[D.childs[E]]);if(D.childs[E].childs.length)this.forEachChild(D.childs[E].id,C,B)}};this.change=function(B,C,A){var D=this.get[B];if(D[C]==A)return;D[C]=A;D.update=true};this.add=function(A,B){return this.addAfter(A,B)};this.addAfter=function(A,B,E,D){var F=this.get[B||0];if(E)var C=this.get[E].index+(D?0:1);else C=F.childs.length;var H={id:A,childs:[],level:F.level+1,parent:F,index:C,state:dhtmlXGridObject._emptyLineImg};if(F.state==dhtmlXGridObject._emptyLineImg)this.change(B,"state",(B==0?"minus":"plus"));if(E){for(var G=C;G<F.childs.length;G++)F.childs[G].index++;F.childs=F.childs.slice(0,C).concat([H]).concat(F.childs.slice(C,F.childs.length))}else F.childs.push(H);this.get[A]=H;return H};this.addBefore=function(A,B,C){return this.addAfter(A,B,C,true)};this.remove=function(A){var B=this.get[A||0];for(var C=0;C<B.childs.length;C++)this.deleteAll(B.childs[C].id);B.childs=[];B.parent.childs=B.parent.childs.slice(0,B.index).concat(B.parent.childs.slice(B.index+1));for(C=B.index;C<B.parent.childs.length;C++)B.parent.childs[C].index--;delete this.get[A]};this.deleteAll=function(A){var B=this.get[A||0];for(var C=0;C<B.childs.length;C++)this.deleteAll(B.childs[C].id);B.childs=[];delete this.get[A]};return this}dhtmlXGridObject.prototype._getOpenLenght=function(A,B){var C=this._h2.get[A].childs;B+=C.length;for(var D=0;D<C.length;D++)if(C[D].childs.length&&C[D].state=="minus")B+=this._getOpenLenght(C[D].id,0);return B};dhtmlXGridObject.prototype.collapseKids=function(D){var B=this._h2.get[D.idd];if(B.state!="minus")return;if(!this.callEvent("onOpenStart",[D.idd,1]))return;var A=D.rowIndex;if(A<0)A=this.rowsCol._dhx_find(D)+1;this._h2.change(B.id,"state","plus");this._updateTGRState(B);if(this._srnd||this.pagingOn){this._h2_to_buff();this._renderSort()}else{var C=this._getOpenLenght(this.rowsCol[A-1].idd,0);for(var E=0;E<C;E++)this.rowsCol[A+E].parentNode.removeChild(this.rowsCol[A+E]);this.rowsCol.splice(A,C)}this.callEvent("onGridReconstructed",[]);this.setSizes();this._h2_to_buff();this.callEvent("onOpenEnd",[D.idd,-1])};dhtmlXGridObject.prototype._massInsert=function(F,E,D,H){var C=[],A=(_isKHTML?this.obj:this.obj.rows[0].parentNode);this._h2_to_buff();if(this._srnd||this.pagingOn)return this._renderSort();var G=this._getOpenLenght(F.id,0);for(var I=0;I<G;I++){var B=this.render_row(D+I);if(E)E.parentNode.insertBefore(B,E);else A.appendChild(B);C.push(B)}this.rowsCol=dhtmlxArray(this.rowsCol.slice(0,D).concat(C).concat(this.rowsCol.slice(D)));return F.childs.length+C.length};dhtmlXGridObject.prototype.expandKids=function(E,C){var B=this._h2.get[E.idd];if((!B.childs.length)&&(!B._xml_await))return;if(B.state!="plus")return;if(!B._loading&&!C)if(!this.callEvent("onOpenStart",[B.id,-1]))return;var A=this.getRowIndex(B.id)+1;if(B.childs.length){B._loading=false;this._h2.change(B.id,"state","minus");this._updateTGRState(B);var D=this._massInsert(B,this.rowsCol[A],A);this.callEvent("onGridReconstructed",[])}else if(B._xml_await){B._loading=true;if(this.callEvent("onDynXLS",[B.id]))this.load(this.kidsXmlFile+""+(this.kidsXmlFile.indexOf("?")!=-1?"&":"?")+"id="+B.id,this._data_type)}this.setSizes();if(!B._loading)this.callEvent("onOpenEnd",[B.id,1]);this._fixAlterCss()};dhtmlXGridObject.prototype.kidsXmlFile="";dhtmlXGridObject.prototype.sortTreeRows=function(B,G,C){var F="getValue";if(this.cells5({parentNode:{grid:this}},this.getColType(B)).getDate){F="getDate";G="str"}this.forEachRow(function(A){var D=this._h2.get[A];if(!D)return;var C=this._get_cell_value(D.buff,B,F);if(G=="int"){D._sort=parseFloat(C);D._sort=isNaN(D._sort)?-99999999999999:D._sort}else D._sort=C});var E=this,H=1,A=-1;if(C=="des"){H=-1;A=1}var D=null;if(G=="cus")D=function(D,A){return E._customSorts[B](D._sort,A._sort,C,D.id,A.id)};if(G=="str")D=function(C,B){return(C._sort<B._sort?A:(C._sort==B._sort?0:H))};if(G=="int")D=function(C,B){return(C._sort<B._sort?A:(C._sort==B._sort?0:H))};if(G=="date")D=function(B,A){return(Date.parse(new Date(B._sort||"01/01/1900"))-Date.parse(new Date(A._sort||"01/01/1900")))*H};this._sortTreeRows(D,0);this._renderSort(0,true);this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._sortTreeRows=function(C,A){var B=this._h2.get[A].childs;if(this.rowsCol.stablesort)this.rowsCol.stablesort.call(B,C);else B.sort(C);for(var D=0;D<B.length;D++){if(B[D].childs.length)this._sortTreeRows(C,B[D].id);B[D].index=D}};dhtmlXGridObject.prototype._renderSort=function(A,C){this._h2_to_buff();var B=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=B};dhtmlXGridObject.prototype._fixAlterCssTGR=function(){if(!this._realfake)this._h2.forEachChild(0,function(B){if(B.buff.tagName=="TR"){var A=(this._cssSP?(B.level%2):(B.index%2))?this._cssUnEven:this._cssEven;this.rowsAr[B.id].className=(A+(this._cssSU?(" "+A+"_"+B.level):""))+" "+(this.rowsAr[B.id]._css||"")+((this.rowsAr[B.id].className.indexOf("rowselected")!=-1)?" rowselected":"")}},this)};dhtmlXGridObject.prototype.moveRowUDTG=function(A,E){var I=this._h2.get[A],F=I.parent.childs[I.index+E];if((!F)||(F.parent!=I.parent))return;var G=[I.state,F.state];this.collapseKids(this.rowsAr[I.id]);this.collapseKids(this.rowsAr[F.id]);var D=this.rowsCol._dhx_find(this.rowsAr[A]),C=this.rowsBuffer._dhx_find(this.rowsAr[A]),B=this.obj.rows[0].parentNode.removeChild(this.rowsCol[D]),H=this.rowsCol[D+((E==1)?2:E)];if(H)H.parentNode.insertBefore(B,H);else this.obj.rows[0].parentNode.appendChild(B);this.rowsCol._dhx_swapItems(D,D+E);this.rowsBuffer._dhx_swapItems(C,C+E);this._h2.swap(F,I);if(G[0]=="minus")this.expandKids(this.rowsAr[I.id]);if(G[1]=="minus")this.expandKids(this.rowsAr[F.id]);this._fixAlterCss(Math.min(D,D+E))};function eXcell_tree(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.isDisabled=function(){return this.cell._disabled||this.grid._edtc};this.edit=function(){if((this.er)||(this.grid._edtc))return;this.er=this.cell.parentNode.valTag;this.val=this.getLabel();this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.er.innerHTML="<"+this.cell.atag+" class='dhx_combo_edit' type='text' style='height:"+(this.cell.offsetHeight-6)+"px;width:100%;border:0px;margin:0px;padding:0px;padding-top:"+(_isFF?1:2)+"px;overflow:hidden;'></"+this.cell.atag+">";this.er.childNodes[0].onmousedown=function(A){(A||event).cancelBubble=true};this.er.childNodes[0].onselectstart=function(A){if(!A)A=event;A.cancelBubble=true;return true};if(_isFF)this.er.style.top="1px";this.er.className+=" editable";this.er.firstChild.onclick=function(A){(A||event).cancelBubble=true};this.er.firstChild.value=this.val;this.obj=this.er.firstChild;this.er.firstChild.style.width=Math.max(0,this.cell.offsetWidth-this.er.offsetLeft)+"px";this.er.firstChild.focus();if(_isIE)this.er.firstChild.focus()};this.detach=function(){if(!this.er)return;this.setLabel(this.er.firstChild.value);this.er.className=this.er.className.replace("editable","");var A=(this.val!=this.er.innerHTML);if(_isFF)this.er.style.top="2px";this.obj=this.er=null;return(A)};this.getValue=function(){return this.getLabel()};this.setImage=function(A){this.cell.parentNode.imgTag.nextSibling.src=this.grid.iconURL+A;this.grid._h2.get[this.cell.parentNode.idd].image=A};this.getImage=function(){this.grid._h2.get[this.cell.parentNode.idd].image};this.setLabel=function(A){this.setValueA(A)};this.getLabel=function(A){return this.cell.parentNode.valTag.innerHTML}}eXcell_tree.prototype=new eXcell;eXcell_tree.prototype.setValueA=function(A){this.cell.parentNode.valTag.innerHTML=A;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,A])};eXcell_tree.prototype.setValue=function(D){if(this.cell.parentNode.imgTag)return this.setLabel(D);if((this.grid._tgc.imgURL==null)||(this.grid._tgc.imgURL!=this.grid.imgURL)){var A={};A.spacer="<img src='"+this.grid.imgURL+"blank.gif' align='absmiddle' class='space'>";A.imst="<img src='"+this.grid.imgURL;A.imsti="<img src='"+(this.grid.iconURL||this.grid.imgURL);A.imact="' align='absmiddle' onclick='this."+(_isKHTML?"":"parentNode.")+"parentNode.parentNode.parentNode.parentNode.grid.doExpand(this);event.cancelBubble=true;'>";A.plus=A.imst+"plus.gif"+A.imact;A.minus=A.imst+"minus.gif"+A.imact;A.blank=A.imst+"blank.gif"+A.imact;A.start="<div class='treegrid_cell' style='overflow:hidden;white-space : nowrap;height:"+(_isIE?20:18)+"px;'>";A.itemim="' align='absmiddle' "+(this.grid._img_height?(" height=\""+this.grid._img_height+"\""):"")+(this.grid._img_width?(" width=\""+this.grid._img_width+"\""):"")+" ><span "+((_isFF||_isOpera)?"style='position:relative;top:2px;'":"")+"id='nodeval'>";A.close="</span></div>";this.grid._tgc=A}var E=this.grid._h2,A=this.grid._tgc,B=this.cell.parentNode.idd,F=this.grid._h2.get[B];if(this.grid.kidsXmlFile||this.grid._slowParse){F.has_kids=(F.has_kids||(this.cell.parentNode._attrs["xmlkids"]&&(F.state!="minus")));F._xml_await=!!F.has_kids}F.image=F.image||(this.cell._attrs["image"]||"leaf.gif");F.label=D;var C=[A.start];for(var G=0;G<F.level;G++)C.push(A.spacer);if(F.has_kids){C.push(A.plus);F.state="plus"}else C.push(A.imst+F.state+".gif"+A.imact);C.push(A.imsti);C.push(F.image);C.push(A.itemim);C.push(F.label);C.push(A.close);this.cell.innerHTML=C.join("");this.cell._treeCell=true;this.cell.parentNode.imgTag=this.cell.childNodes[0].childNodes[F.level];this.cell.parentNode.valTag=this.cell.childNodes[0].childNodes[F.level+2];if(_isKHTML)this.cell.vAlign="top";if(F.parent.id!=0&&F.parent.state=="plus"){this.grid._updateTGRState(F.parent,false);this.cell.parentNode._skipInsert=true}this.grid.callEvent("onCellChanged",[B,this.cell._cellIndex,D])};dhtmlXGridObject.prototype._process_tree_xml=function(D,I,C){this._parsing=true;var H=false;if(!I){this.render_row=this.render_row_tree;H=true;I=D.getXMLTopNode(this.xml.top);C=I.getAttribute("parent")||0;if(C=="0")C=0;if(!this._h2)this._h2=new dhtmlxHierarchy();if(this._fake)this._fake._h2=this._h2}var G=D.doXPath(this.xml.row,I);this._open=this._open||[];for(var F=0;F<G.length;F++){var A=G[F].getAttribute("id");if(!A){A=this.uid();G[F].setAttribute("id",A)}var E=this._h2.add(A,C);E.buff={idd:A,data:G[F],_parser:this._process_xml_row,_locator:this._get_xml_data};if(G[F].getAttribute("open")){E.state="minus";this._open.push(A)}this.rowsAr[A]=E.buff;this._process_tree_xml(D,G[F],A)}if(H){if(!G.length)this._h2.change(C,"state",dhtmlXGridObject._emptyLineImg);else if(C!=0&&!this._srnd)this._h2.change(C,"state","minus");for(F=0;F<this._open.length;F++){var B=this._h2.get[this._open[F]];if(!B.childs.length)B.state=dhtmlXGridObject._emptyLineImg}this._updateTGRState(this._h2.get[C]);this._h2_to_buff();if(C!=0&&this._srnd)this.openItem(C);else if(this.pagingOn)this._renderSort();else this.render_dataset();if(this.kidsXmlFile)for(F=0;F<this._open.length;F++){B=this._h2.get[this._open[F]];if(B._xml_await)this.expandKids({idd:B.id})}this._open=[];if(this._slowParse===false)this.forEachRow(function(A){this.render_row_tree(0,A)});this._parsing=false;if(C!=0&&!this._srnd)this.callEvent("onOpenEnd",[C,1])}return D.xmlDoc.responseXML?D.xmlDoc.responseXML:D.xmlDoc};dhtmlXGridObject.prototype._h2_to_buff=function(B){if(!B){B=this._h2.get[0];this.rowsBuffer=new dhtmlxArray();if(this._fake&&!this._realfake)this._fake.rowsBuffer=this.rowsBuffer}for(var A=0;A<B.childs.length;A++){this.rowsBuffer.push(B.childs[A].buff);if(B.childs[A].state=="minus")this._h2_to_buff(B.childs[A])}};dhtmlXGridObject.prototype.render_row_tree=function(C,A){if(A){var B=this._h2.get[A];B=B?B.buff:B}else B=this.rowsBuffer[C];if(!B)return-1;if(B._parser){if(this.rowsAr[B.idd]&&this.rowsAr[B.idd].tagName=="TR")return this._h2.get[B.idd].buff=this.rowsBuffer[C]=this.rowsAr[B.idd];var D=this._prepareRow(B.idd);this.rowsAr[B.idd]=D;if(!A)this.rowsBuffer[C]=D;this._h2.get[B.idd].buff=D;B._parser.call(this,D,B.data);this._postRowProcessing(D);return D}return B};dhtmlXGridObject.prototype._removeTrGrRow=function(A,E){if(E){this._h2.forEachChild(E.id,function(A){this._removeTrGrRow(null,A);delete this.rowsAr[A.id]},this);return}var B=this.getRowIndex(A.idd),E=this._h2.get[A.idd];if(B!=-1&&B!==this.undefined){var C=1;if(E&&E.state=="minus")C+=this._getOpenLenght(E.id,0);for(var D=0;D<C;D++)if(this.rowsCol[D+B])this.rowsCol[D+B].parentNode.removeChild(this.rowsCol[D+B]);if(this._fake){for(D=0;D<C;D++)if(this._fake.rowsCol[D+B])this._fake.rowsCol[D+B].parentNode.removeChild(this._fake.rowsCol[D+B]);if(C>1)this._fake.rowsCol.splice(B+1,C-1)}this.rowsCol.splice(B,C);this.rowsBuffer.splice(B,C)}if(!E)return;this._removeTrGrRow(null,E);delete this.rowsAr[E.id];if(E.parent.childs.length==1){this._h2.change(E.parent.id,"state",dhtmlXGridObject._emptyLineImg);this._updateTGRState(E.parent)}this._h2.remove(E.id)};dhtmlXGridObject.prototype.openItem=function(A){var B=this._h2.get[A||0],C=this.getRowById(A||0);if(!C)return;if(B.parent&&B.parent.id!=0)this.openItem(B.parent.id);this.expandKids(C)};dhtmlXGridObject.prototype._addRowClassic=dhtmlXGridObject.prototype.addRow;dhtmlXGridObject.prototype.addRow=function(E,B,C,H,F,A){if(!this._h2)return this._addRowClassic(E,B,C);H=H||0;var D=this.cellType._dhx_find("tree");if(typeof(B)=="string")B=B.split(this.delim);var G=this._h2.get[E];if(!G)if(H==0)C=this.rowsBuffer.length;else{C=this.getRowIndex(H)+1;if(this._h2.get[H].state=="minus")C+=this._getOpenLenght(H,0);else this._skipInsert=true}G=G||this._h2.add(E,H);G.image=F;G.has_kids=A;return G.buff=this._addRowClassic(E,B,C)};dhtmlXGridObject.prototype.addRowBefore=function(F,B,D,G,A){var E=this.rowsAr[D];if(!E)return;if(!this._h2)return this.addRow(F,B,this.getRowIndex(D));var H=this._h2.get[D].parent.id,C=this.getRowIndex(D);if(C==-1)this._skipInsert=true;this._h2.addBefore(F,H,D);return this.addRow(F,B,C,this._h2.get[D].parent.id,G,A)};dhtmlXGridObject.prototype.addRowAfter=function(F,B,D,G,A){var E=this.rowsAr[D];if(!E)return;if(!this._h2)return this.addRow(F,B,this.getRowIndex(D)+1);var H=this._h2.get[D].parent.id,C=this.getRowIndex(D);if(C==-1)this._skipInsert=true;if(this._h2.get[D].state=="minus")C+=this._getOpenLenght(D,0)+1;else C++;this._h2.addAfter(F,H,D);return this.addRow(F,B,C,H,G,A)};dhtmlXGridObject.prototype.enableSmartXMLParsing=function(A){this._slowParse=convertStringToBoolean(A)};dhtmlXGridObject.prototype._copyTreeGridRowContent=function(D,A,C){var B=this.cellType._dhx_find("tree");for(i=0;i<D.cells.length;i++)if(i!=B)this.cells(C,i).setValue(this.cells(A,i).getValue());else this.cells(C,i).setValueA(this.cells(A,i).getValue())};dhtmlXGridObject.prototype.closeItem=function(A){var B=this.getRowById(A);if(!B)return;this.collapseKids(B)};dhtmlXGridObject.prototype.deleteChildItems=function(A){var B=this._h2.get[A];if(!B)return;while(B.childs.length)this.deleteRow(B.childs[0].id)};dhtmlXGridObject.prototype.getAllSubItems=function(B){var A=[],C=this._h2.get[B||0];if(C)for(var D=0;D<C.childs.length;D++){A.push(C.childs[D].id);if(C.childs[D].childs.length)A=A.concat(this.getAllSubItems(C.childs[D].id).split(this.delim))}return A.join(this.delim)};dhtmlXGridObject.prototype.getChildItemIdByIndex=function(B,A){var C=this._h2.get[B||0];if(!C)return null;return(C.childs[A]?C.childs[A].id:null)};dhtmlXGridObject.prototype.getItemText=function(A){return this.cells(A,this.cellType._dhx_find("tree")).getLabel()};dhtmlXGridObject.prototype.getOpenState=function(A){var B=this._h2.get[A||0];if(!B)return;if(B.state=="minus")return true;return false};dhtmlXGridObject.prototype.getParentId=function(A){var B=this._h2.get[A||0];if((!B)||(!B.parent))return null;return B.parent.id};dhtmlXGridObject.prototype.getSubItems=function(B){var A=[],C=this._h2.get[B||0];if(C)for(var D=0;D<C.childs.length;D++)A.push(C.childs[D].id);return A.join(this.delim)};dhtmlXGridObject.prototype.expandAll=function(A){this._renderAllExpand(A||0);this._h2_to_buff();this._reset_view();this.setSizes();this.callEvent("onGridReconstructed",[]);if(this._redrawLines)this._redrawLines()};dhtmlXGridObject.prototype._renderAllExpand=function(A){var C=this._h2.get[A].childs;for(var B=0;B<C.length;B++)if(C[B].childs.length){this._h2.change(C[B].id,"state","minus");this._updateTGRState(C[B]);this._renderAllExpand(C[B].id)}};dhtmlXGridObject.prototype.collapseAll=function(A){this._h2.forEachChild((A||0),function(A){if(A&&A.state=="minus"){A.state="plus";A.update=true;this._updateTGRState(A)}},this);this._h2_to_buff();this._reset_view();this.setSizes();this.callEvent("onGridReconstructed",[]);if(this._redrawLines)this._redrawLines()};dhtmlXGridObject.prototype.hasChildren=function(A){var B=this._h2.get[A];if(B&&B.childs.length)return B.childs.length;if(B._xml_await)return-1;return 0};dhtmlXGridObject.prototype.setItemCloseable=function(B,A){var C=this._h2.get[B];if(!C)return;C._closeable=(!convertStringToBoolean(A))};dhtmlXGridObject.prototype.setItemText=function(B,A){return this.cells(B,this.cellType._dhx_find("tree")).setLabel(A)};dhtmlXGridObject.prototype.setItemImage=function(A,B){this._h2.get[A].image=B;this.rowsAr[A].imgTag.nextSibling.src=(this.iconURL||"")+B};dhtmlXGridObject.prototype.getItemImage=function(A){this.getRowById(A);return this._h2.get[A].image};dhtmlXGridObject.prototype.setImageSize=function(B,A){this._img_width=B;this._img_height=A};dhtmlXGridObject.prototype._getRowImage=function(A){return this._h2.get[A.idd].image};dhtmlXGridObject.prototype.setOnOpenStartHandler=function(A){this.attachEvent("onOpenStart",A)};dhtmlXGridObject.prototype.setOnOpenEndHandler=function(A){this.attachEvent("onOpenEnd",A)};dhtmlXGridObject.prototype.enableTreeCellEdit=function(A){this._edtc=!convertStringToBoolean(A)};dhtmlXGridObject.prototype.getLevel=function(A){var B=this._h2.get[A||0];if(!B)return-1;return B.level};dhtmlXGridObject.prototype._fixHiddenRowsAllTG=function(A,B){for(i in this.rowsAr)if((this.rowsAr[i])&&(this.rowsAr[i].childNodes))this.rowsAr[i].childNodes[A].style.display=B};dhtmlXGridObject._emptyLineImg="blank";dhtmlXGridObject.prototype._updateLine=function(C,D){D=D||this.rowsAr[C.id];if(!D)return;var B=D.imgTag;if(!B)return;if(C.state=="blank")return B.src=this.imgURL+"blank.gif";var A=1;if(C.index==0){if(C.level==0){if((C.parent.childs.length-1)>C.index)A=3;else A=1}else if((C.parent.childs.length-1)>C.index)A=3;else A=2}else if((C.parent.childs.length-1)>C.index)A=3;else A=2;B.src=this.imgURL+C.state+A+".gif"};dhtmlXGridObject.prototype._updateParentLine=function(B,C){C=C||this.rowsAr[B.id];if(!C)return;var A=C.imgTag;if(!A)return;for(var D=B.level;D>0;D--){if(B.id==0)break;A=A.previousSibling;B=B.parent;if((B.parent.childs.length-1)>B.index)A.src=this.imgURL+"line1.gif";else A.src=this.imgURL+"blank.gif"}};dhtmlXGridObject.prototype._renderSortA=dhtmlXGridObject.prototype._renderSort;dhtmlXGridObject.prototype._renderSort=function(){this._renderSortA.apply(this,arguments);this._redrawLines(0)};dhtmlXGridObject.prototype._redrawLines=function(A){if(this._tgle)this._h2.forEachChild((A||0),function(A){this._updateLine(A);this._updateParentLine(A)},this)};dhtmlXGridObject.prototype.enableTreeGridLines=function(){dhtmlXGridObject._emptyLineImg="line";this._updateTGRState=function(B,A){if(A||!B.update||B.id==0)return;if(this._tgle)this._updateLine(B,this.rowsAr[B.id]);B.update=false};this._tgle=true;this.attachEvent("onXLE",function(C,B,A){this._redrawLines(A)});this.attachEvent("onOpenEnd",function(A){this._redrawLines(A)});this.attachEvent("onRowAdded",function(A){var B=this._h2.get[A];this._updateLine(B);this._updateParentLine(B);if(B.index<(B.parent.childs.length-1)){B=B.parent.childs[B.index+1];this._updateLine(B);this._updateParentLine(B)}else if(B.index!=0){B=B.parent.childs[B.index-1];this._updateLine(B);this._updateParentLine(B);if(B.childs.length)this._h2.forEachChild(B.id,function(A){this._updateParentLine(A)},this)}});this.attachEvent("onOpen",function(A,B){if(B){var C=this._h2.get[A];for(var D=0;D<C.childs.length;D++)this._updateParentLine(C.childs[D])}return true});this.attachEvent("onBeforeRowDeleted",function(B){var C=this,D=this._h2.get[B],A=null;if(D.index!=0)A=D.parent.childs[D.index-1];D=D.parent;window.setTimeout(function(){D=C._h2.get[D.id];if(!D)return;C._updateLine(D);C._updateParentLine(D);if(A){C._updateLine(A);if(A.state=="minus")C._h2.forEachChild(A.id,function(A){C._updateParentLine(A)},C)}},1);return true})};dhtmlXGridObject.prototype.setFiltrationLevel=function(A,C,B){this._tr_strfltr=A;this._tr_fltr_c=C;this._tr_fltr_d=B;this.refreshFilters()};dhtmlXGridObject.prototype.filterTreeBy=function(D,C,F){var B=this._h2;if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;if(this._f_rowsBuffer){if(!F){this._h2=this._f_rowsBuffer;if(this._fake)this._fake._h2=this._h2}}else this._f_rowsBuffer=this._h2;var A=true;this.dma(true);this._fbf={};if(typeof(D)=="object"){for(var E=0;E<C.length;E++)this._filterTreeA(D[E],C[E])}else this._filterTreeA(D,C);this._fbf=null;this.dma(false);this._fix_filtered_images(this._h2,B);this._renderSort();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._filterTreeA=function(H,G){if(G=="")return;var B=true;if(typeof(G)=="function")B=false;else G=(G||"").toString().toLowerCase();var F=function(C,B,A){var D=A.get[C.parent.id];if(!D)D=F(C.parent,B,A);var A=I.get[C.id];if(!A){A={id:C.id,childs:[],level:C.level,parent:D,index:D.childs.length,image:C.image,state:C.state,buff:C.buff,has_kids:C.has_kids,_xml_await:C._xml_await};D.childs.push(A);I.get[A.id]=A}return A},E=this._fbf,I=new dhtmlxHierarchy(),C,J=this._tr_strfltr,A=this,D=function(B){for(var C=0;C<B.childs.length;C++)A.temp(B.childs[C])};switch(J.toString()){case"-2":C=function(A){if(E[A.id])return false;D(A);return true};break;case"-1":C=function(A){return!A.childs.length};break;default:C=function(A){return J==A.level};break}this.temp=function(A){if(A.id!=0&&C(A)){if(B?(this._get_cell_value(A.buff,H).toString().toLowerCase().indexOf(G)==-1):(!G(this._get_cell_value(A.buff,H),A.id))){E[A.id]=true;if(this._tr_fltr_c)F(A.parent,this._h2,I);return false}else{F(A,this._h2,I);if(A.childs&&J!=-2)this._h2.forEachChild(A.id,function(A){F(A,this._h2,I)},this);return true}}else{if(this._tr_fltr_d&&this._tr_strfltr>A.level&&A.id!=0)F(A,this._h2,I);D(A)}};this.temp(this._h2.get[0]);this._h2=I;if(this._fake)this._fake._h2=this._h2};dhtmlXGridObject.prototype._fix_filtered_images=function(B,A){B.forEachChild(0,function(B){if(!B.childs.length&&!B.has_kids){if(B.state!=dhtmlXGridObject._emptyLineImg){B.state=dhtmlXGridObject._emptyLineImg;B.update=true;this._updateTGRState(B)}}else if(B.buff.tagName=="TR"){var C=A.get[B.id];if(C&&C.state!=dhtmlXGridObject._emptyLineImg)B.state=C.state;B.update=true;this._updateTGRState(B)}},this)};dhtmlXGridObject.prototype.collectTreeValues=function(D){if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;this.dma(true);this._build_m_order();D=this._m_order?this._m_order[D]:D;var C={},A=[],B=this._f_rowsBuffer||this._h2;B.forEachChild(0,function(B){if(this._tr_strfltr==-2||(this._tr_strfltr==-1&&!B.childs.length)||(this._tr_strfltr==B.level)){var A=this._get_cell_value(B.buff,D);if(A)C[A]=true}},this);this.dma(false);var E=this.combos[D];for(d in C)if(C[d]===true)A.push(E?(E.get(d)||d):d);return A.sort()};dhtmlXGridObject.prototype._in_header_stat_tree_total=function(A,D,B){var C=function(){var A=0;this._h2.forEachChild(0,function(C){var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));A+=isNaN(B)?0:B},this);return this._maskArr[D]?this._aplNF(A,D):(Math.round(A*100)/100)};this._stat_in_header(A,C,D,B,B)};dhtmlXGridObject.prototype._in_header_stat_tree_total_leaf=function(A,D,B){var C=function(){var A=0;this._h2.forEachChild(0,function(C){if(C.childs.length)return;var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));A+=isNaN(B)?0:B},this);return this._maskArr[D]?this._aplNF(A,D):(Math.round(A*100)/100)};this._stat_in_header(A,C,D,B,B)};dhtmlXGridObject.prototype._in_header_stat_tree_multi_total=function(B,E,C){var A=C[1].split(":");C[1]="";var D=function(){var B=0;this._h2.forEachChild(0,function(D){var C=parseFloat(this._get_cell_value((D.buff||this.rowsAr[D.id]),A[0]))*parseFloat(this._get_cell_value((D.buff||this.rowsAr[D.id]),A[1]));B+=isNaN(C)?0:C},this);return this._maskArr[E]?this._aplNF(B,E):(Math.round(B*100)/100)};this._stat_in_header(B,D,E,C,C)};dhtmlXGridObject.prototype._in_header_stat_tree_multi_total_leaf=function(B,E,C){var A=C[1].split(":");C[1]="";var D=function(){var B=0;this._h2.forEachChild(0,function(D){if(D.childs.length)return;var C=parseFloat(this._get_cell_value((D.buff||this.rowsAr[D.id]),A[0]))*parseFloat(this._get_cell_value((D.buff||this.rowsAr[D.id]),A[1]));B+=isNaN(C)?0:C},this);return this._maskArr[E]?this._aplNF(B,E):(Math.round(B*100)/100)};this._stat_in_header(B,D,E,C,C)};dhtmlXGridObject.prototype._in_header_stat_tree_max=function(A,D,B){var C=function(){var A=-999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(C){var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));if(!isNaN(B))A=Math.max(A,B)},this);return this._maskArr[D]?this._aplNF(A,D):A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_min=function(A,D,B){var C=function(){var A=999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(C){var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));if(!isNaN(B))A=Math.min(A,B)},this);return this._maskArr[D]?this._aplNF(A,D):A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_average=function(A,D,B){var C=function(){var B=0,A=0;this._h2.forEachChild(0,function(E){var C=parseFloat(this._get_cell_value((E.buff||this.rowsAr[E.id]),D));B+=isNaN(C)?0:C;A++},this);return this._maskArr[D]?this._aplNF(B,D):(Math.round(B/A*100)/100)};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_max_leaf=function(A,D,B){var C=function(){var A=-999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(C){if(C.childs.length)return;var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));if(!isNaN(B))A=Math.max(A,B)},this);return this._maskArr[D]?this._aplNF(A,D):A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_min_leaf=function(A,D,B){var C=function(){var A=999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(C){if(C.childs.length)return;var B=parseFloat(this._get_cell_value((C.buff||this.rowsAr[C.id]),D));if(!isNaN(B))A=Math.min(A,B)},this);return this._maskArr[D]?this._aplNF(A,D):A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_average_leaf=function(A,D,B){var C=function(){var B=0,A=0;this._h2.forEachChild(0,function(E){if(E.childs.length)return;var C=parseFloat(this._get_cell_value((E.buff||this.rowsAr[E.id]),D));B+=isNaN(C)?0:C;A++},this);return this._maskArr[D]?this._aplNF(B,D):(Math.round(B/A*100)/100)};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_count=function(A,D,B){var C=function(){var A=0;this._h2.forEachChild(0,function(B){A++},this);return A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._in_header_stat_tree_count_leaf=function(A,D,B){var C=function(){var A=0;this._h2.forEachChild(0,function(B){if(!B.childs.length)A++},this);return A};this._stat_in_header(A,C,D,B)};dhtmlXGridObject.prototype._stat_in_header=function(C,E,F,D){var B=this,A=function(){this.dma(true);C.innerHTML=(D[0]?D[0]:"")+E.call(this)+(D[1]?D[1]:"");this.dma(false);this.callEvent("onStatReady",[])};if(!this._stat_events){this._stat_events=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var B=0;B<this._stat_events.length;B++)for(var A=0;A<4;A++)this.detachEvent(this._stat_events[B][A]);this._stat_events=[]}})}this._stat_events.push([this.attachEvent("onGridReconstructed",A),this.attachEvent("onXLE",A),this.attachEvent("onFilterEnd",A),this.attachEvent("onEditCell",function(D,B,C){if(D==2&&C==F)A.call(this);return true})]);C.innerHTML=""};function dhtmlXLayoutPanel(){}function dhtmlXLayoutObject(B,D,F){if(!window.dhtmlXContainer){alert(this.i18n.dhxcontalert);return}var A=this;this._autodetectSkin=function(){var B=document.createElement("DIV");B.className="dhxlayout_skin_detect";if(document.body.childNodes.length>0)document.body.insertBefore(B,document.body.childNodes[0]);else document.body.appendChild(B);var A=B.offsetWidth;document.body.removeChild(B);B=null;if(A==199)return"dhx_skyblue";if(A==299)return"dhx_blue";if(A==399)return"dhx_black";if(A==499)return"dhx_web";if(A==599)return"dhx_terrace";return"dhx_skyblue"};this.skin=(F!=null?F:(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:this._autodetectSkin()));this.setSkin=function(B){if(!this.skinParams[B])return;this.skin=B;this._CPanelHeight=this.skinParams[this.skin]["cpanel_height"];this._collapsedW=this.skinParams[this.skin]["cpanel_collapsed_width"];this._collapsedH=this.skinParams[this.skin]["cpanel_collapsed_height"];this.tpl.className="dhtmlxLayoutPolyContainer_"+this.skin+(this._r?" dhxlayout_rtl":"");this.sizer.className="dhxLayout_Sizer_"+this.skin;if(this.dhxWins)this.dhxWins.setSkin(this.skin);for(var A in this.polyObj)this.polyObj[A].skin=this.skin;this.base.skin=this.skin;this._fixIcons();this.setSizes()};this._isIPad=(navigator.userAgent.search(/iPad/gi)>=0);this._dblClickTM=600;this._mTop=0;this._mBottom=0;if(typeof(B)=="string")B=document.getElementById(B);if((B._isWindow==true||B._isCell)&&!this.base){if(B._isCell&&B.attachLayout)return B.attachLayout(D,F);if(B.isWindow)return B.attachLayout(D,F);this.base=B}if(B==document.body&&!this.base)document.body.style.overflow="hidden";if((typeof(B)=="object"||B==document.body)&&!this.base){var C=document.createElement("DIV");C.className="dhxcont_global_layout_area";B.appendChild(C);B._isLayout=true;this.cont=new dhtmlXContainer(B);this.cont.setContent(C);if(B==document.body){if(this.skin=="dhx_skyblue"||this.skin=="dhx_blue"){this.cont.obj._offsetTop=2;this.cont.obj._offsetLeft=2;this.cont.obj._offsetHeight=-4;this.cont.obj._offsetWidth=-4}if(this.skin=="dhx_web"){this.cont.obj._offsetTop=9;this.cont.obj._offsetLeft=9;this.cont.obj._offsetHeight=-18;this.cont.obj._offsetWidth=-18}if(this.skin=="dhx_terrace"){this.cont.obj._offsetTop=14;this.cont.obj._offsetLeft=14;this.cont.obj._offsetHeight=-28;this.cont.obj._offsetWidth=-28}document.body.className+=" dhxlayout_fullscreened"}B.adjustContent(B,this._mTop,null,null,this._mBottom);this.base=document.createElement("DIV");this.base.style.overflow="hidden";this.base.style.position="absolute";this.base.style.left="0px";this.base.style.top="0px";this.base.style.width=C.childNodes[0].style.width;this.base.style.height=C.childNodes[0].style.height;C.childNodes[0].appendChild(this.base);if(B==document.body){this._tmTime=null;this._lw=null;this._doOnResizeStart=function(){window.clearTimeout(this._tmTime);this._tmTime=window.setTimeout(function(){A._doOnResizeEnd()},200)};this._doOnResizeEnd=function(){this.setSizes(false)};if(_isIE)window.attachEvent("onresize",A._doOnResizeStart);else window.addEventListener("resize",A._doOnResizeStart,false)}B._doOnAttachToolbar=function(){if(A!=null&&typeof(A.setSizes)=="function")A.setSizes()}}this.items=new Array();this.cells=function(A){if(this.polyObj[A]!=null)return this.polyObj[A];return null};this.getIdByIndex=function(A){if(A<0)return null;if(A>=this.items.length)return null;return this.items[A]._idd};this.getIndexById=function(A){if(this.cells(A)!=null)return this.cells(A).getIndex();return null};this.imagePath=dhtmlx.image_path||"codebase/imgs/";this.setImagePath=function(A){this.imagePath=A};this.polyObj={};this.sepHor=new Array();this.sepVer=new Array();this._layoutView=(D!=null?String(D).toUpperCase():"3E");this._minWidth=40;this._minHeight=40;this._CPanelBtnsWidth=32;this.skinParams={"dhx_black":{"hor_sep_height":5,"ver_sep_width":5,"cpanel_height":34,"cpanel_collapsed_width":18,"cpanel_collapsed_height":18},"dhx_blue":{"hor_sep_height":5,"ver_sep_width":5,"cpanel_height":34,"cpanel_collapsed_width":18,"cpanel_collapsed_height":18},"dhx_skyblue":{"hor_sep_height":5,"ver_sep_width":5,"cpanel_height":26,"cpanel_collapsed_width":18,"cpanel_collapsed_height":18},"dhx_web":{"hor_sep_height":9,"ver_sep_width":9,"cpanel_height":27,"cpanel_collapsed_width":18,"cpanel_collapsed_height":18,"cell_pading_max":1,"cell_pading_min":0},"dhx_terrace":{"hor_sep_height":14,"ver_sep_width":14,"cpanel_height":37,"cpanel_collapsed_width":18,"cpanel_collapsed_height":18,"cell_pading_max":1,"cell_pading_min":0}};this._CPanelHeight=this.skinParams[this.skin]["cpanel_height"];this._collapsedW=this.skinParams[this.skin]["cpanel_collapsed_width"];this._collapsedH=this.skinParams[this.skin]["cpanel_collapsed_height"];this.tpl=document.createElement("TABLE");this.tpl.dir="ltr";this.tpl.className="dhtmlxLayoutPolyContainer_"+this.skin;this.tpl.cellSpacing=0;this.tpl.cellPadding=0;var E=document.createElement("TBODY");this.tpl.appendChild(E);this.tpl.border=0;this.tplSizes={};this._effects={"collapse":false,"resize":false,"highlight":true};this.sizer=document.createElement("DIV");this.sizer.className="dhxLayout_Sizer_"+this.skin;this.sizer.style.display="none";document.body.appendChild(this.sizer);this._attachSizer=function(B){A.sizer.style.left=getAbsoluteLeft(B)+"px";A.sizer.style.top=getAbsoluteTop(B)+"px";A.sizer.style.width=B.offsetWidth+"px";A.sizer.style.height=B.offsetHeight+"px";if(A._sizerML!=null)A.sizer.style.marginLeft=A._sizerML+"px";if(A._sizerMT!=null)A.sizer.style.marginTop=A._sizerMT+"px";A.sizer.style.display="";A.sizer.className="dhxLayout_Sizer_"+A.skin;if(B._dir!=null)A.sizer.className+=" "+(B._dir=="hor"?"dhxCursorNResize":"dhxCursorWResize")};this.listViews=function(){var A=new Array();for(var B in this.tplData)A[A.length]=B;return A};this._init=function(){this.obj=document.createElement("DIV");this.obj.className="dhtmlxLayoutObject";this.base.appendChild(this.obj);this.obj.appendChild(this.tpl);this.w=this.obj.offsetWidth;this.h=this.obj.offsetHeight;this._xmlLoader.loadXMLString(this.tplData[this._layoutView]!=null?this.tplData[this._layoutView]:this.tplData["3E"]);this._initWindows()};this._autoHor=new Array();this._autoVer=new Array();this._dimension=new Array(320,200);this._rowsRatio=100;this._colsRatio=100;this._xmlParser=function(){var I=new Array(),L=new Array(),F={},D=this.getXMLTopNode("layout");for(var b=0;b<D.childNodes.length;b++){if(D.childNodes[b].tagName=="row"){var W=D.childNodes[b],C=document.createElement("TR");A.tpl.childNodes[0].appendChild(C);for(var Y=0;Y<W.childNodes.length;Y++)if(W.childNodes[Y].tagName=="cell"){var U=W.childNodes[Y],G=document.createElement("TD");G._dir="null";if(U.getAttribute("obj")!=null){var f=U.getAttribute("obj"),P=String(U.getAttribute("wh")).split(","),O=isNaN(P[0]),g=(isNaN(P[0])?parseInt(A.polyObj[P[0]].style.width):0);for(var S=0;S<I.length;S++)for(var X=0;X<I[S].length;X++)if(I[S][X]==f){if(!O){O=true;var V=A.base.offsetWidth-F[f][0]*A.skinParams[A.skin]["ver_sep_width"];for(var a=0;a<I[S].length;a++)if(!isNaN(I[S][a])){V-=I[S][a];P[0]-=1}g=Math.ceil(V/P[0])}I[S][X]=g}G.style.width=g+"px";var O=isNaN(P[1]),B=(isNaN(P[1])?parseInt(A.polyObj[P[1]].style.height):0);for(S=0;S<L.length;S++)for(X=0;X<L[S].length;X++)if(L[S][X]==f){if(!O){O=true;var J=A.base.offsetHeight-F[f][1]*A.skinParams[A.skin]["hor_sep_height"];for(a=0;a<L.length;a++)if(!isNaN(L[a][X])){J-=L[a][X];P[1]-=1}B=Math.ceil(J/P[1])}L[S][X]=B}G.style.height=B+"px";G.className="dhtmlxLayoutSinglePoly";G.innerHTML="";G._minW=(U.getAttribute("minWidth")!=null?Number(U.getAttribute("minWidth")):A._minWidth);G._minH=(U.getAttribute("minHeight")!=null?Number(U.getAttribute("minHeight")):A._minHeight);G._initCPanel=(U.getAttribute("cpanel")!=null?(U.getAttribute("cpanel")=="false"?false:true):true);G._resize=U.getAttribute("resize");var H=String(U.getAttribute("neighbors")).split(";");for(var Q=0;Q<H.length;Q++){var c=String(H[Q]).split(",");if(c.length>1)H[Q]=c}G._rowData=H;A.polyObj[f]=G}if(U.getAttribute("sep")!=null){var e=U.getAttribute("sep");if(e=="hor"){G.className="dhtmlxLayoutPolySplitterHor";G._dir="hor";var N=U.getAttribute("top").split(";");for(Q=0;Q<N.length;Q++){c=String(N[Q]).split(",");if(c.length>1)N[Q]=c}G._top=N;var d=U.getAttribute("bottom").split(";");for(Q=0;Q<d.length;Q++){c=String(d[Q]).split(",");if(c.length>1)d[Q]=c}G._bottom=d;A.sepHor[A.sepHor.length]=G}else{G.className="dhtmlxLayoutPolySplitterVer";G._dir="ver";var K=U.getAttribute("left").split(";");for(Q=0;Q<K.length;Q++){c=String(K[Q]).split(",");if(c.length>1)K[Q]=c}G._left=K;var M=U.getAttribute("right").split(";");for(Q=0;Q<M.length;Q++){c=String(M[Q]).split(",");if(c.length>1)M[Q]=c}G._right=M;A.sepVer[A.sepVer.length]=G}G._dblClick=U.getAttribute("dblclick");G._isSep=true;G.innerHTML="<div style=\"height:2px;overflow:hidden;\">&nbsp;</div>"}if(U.getAttribute("colspan")!=null)G.colSpan=U.getAttribute("colspan");if(U.getAttribute("rowspan")!=null)G.rowSpan=U.getAttribute("rowspan");C.appendChild(G)}}if(D.childNodes[b].tagName=="autosize"){A._autoHor=(D.childNodes[b].getAttribute("hor")).split(";");A._autoVer=(D.childNodes[b].getAttribute("ver")).split(";");A._totalCols=D.childNodes[b].getAttribute("cols");A._totalRows=D.childNodes[b].getAttribute("rows");A._dimension[0]=A._totalCols*A._colsRatio;A._dimension[1]=A._totalRows*A._rowsRatio}if(D.childNodes[b].tagName=="table"){var E=D.childNodes[b].getAttribute("data"),a=String(E).split(";");for(S=0;S<a.length;S++){I[S]=new Array();L[S]=new Array();var R=String(a[S]).split(",");for(X=0;X<R.length;X++){I[S][X]=R[X];L[S][X]=R[X];if(F[R[X]]==null)F[R[X]]=new Array(0,0)}}for(var T in F){O=false;for(S=0;S<I.length;S++)for(X=0;X<I[S].length;X++)if(I[S][X]==T&&!O){O=true;for(var Z=0;Z<I[S].length;Z++)if(I[S][Z]!=T)F[T][0]++;for(Z=0;Z<I.length;Z++)if(I[Z][X]!=T)F[T][1]++}}}}I=null;L=null;A._buildSurface();this.destructor()};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this.listAutoSizes=function(){var D=this._availAutoSize[this._layoutView+"_hor"],C=this._availAutoSize[this._layoutView+"_ver"],B=(this._autoHor).join(";"),A=(this._autoVer).join(";");return new Array(B,A,D,C)};this.setAutoSize=function(E,D){if(E!=null){var A=false,C=this._availAutoSize[this._layoutView+"_hor"];for(var B=0;B<C.length;B++)A=A||(C[B]==E);if(A==true)this._autoHor=E.split(";")}if(D!=null){A=false,C=this._availAutoSize[this._layoutView+"_ver"];for(B=0;B<C.length;B++)A=A||(C[B]==D);if(A==true)this._autoVer=D.split(";")}};this._buildSurface=function(){for(var E=0;E<this.tpl.childNodes[0].childNodes.length;E++){var D=this.tpl.childNodes[0].childNodes[E];for(var C=0;C<D.childNodes.length;C++){var H=D.childNodes[C],B=this;if(!H._isSep){H._isCell=true;H.skin=this.skin;H.getId=function(){return this._idd};H.getIndex=function(){return this._ind};H.showHeader=function(){B.showPanel(this._idd)};H.hideHeader=function(){B.hidePanel(this._idd)};H.isHeaderVisible=function(){return B.isPanelVisible(this._idd)};H.setText=function(A){B.setText(this._idd,A)};H.getText=function(){return B.getText(this._idd)};H.expand=function(){if(!B._isCollapsed(this._idd))return;B._expand(this._idd,"hide")};H.collapse=function(){if(B._isCollapsed(this._idd))return;B._collapse(this._idd,"hide")};H.isCollapsed=function(){return B._isCollapsed(this._idd)};H.dock=function(){if(!B._isCollapsed(this._idd))return;B._expand(this._idd,"dock");B.dockWindow(this._idd)};H.undock=function(){if(B._isCollapsed(this._idd))return;B.unDockWindow(this._idd);B._collapse(this._idd,"dock")};H.setWidth=function(A){if(!Number(A))return;var C=this._isBlockedWidth||false;this._isBlockedWidth=false;B._setWidth(this._idd,A);this._isBlockedWidth=C};H.getWidth=function(){return parseInt(this.style.width)};H.setHeight=function(A){if(!Number(A))return;var C=this._isBlockedHeight||false;this._isBlockedHeight=false;B._setHeight(this._idd,A);this._isBlockedHeight=C};H.getHeight=function(){return parseInt(this.style.height)};H.fixSize=function(C,A){B._fixSize(this._idd,C,A)};H.progressOn=function(){B._progressControl(this._idd,true)};H.progressOff=function(){B._progressControl(this._idd,false)};H._doOnAttachMenu=function(){this.adjustContent(this.childNodes[0],(this._noHeader?0:B.skinParams[B.skin]["cpanel_height"]));this.updateNestedObjects()};H._doOnAttachToolbar=function(){this.adjustContent(this.childNodes[0],(this._noHeader?0:B.skinParams[B.skin]["cpanel_height"]));this.updateNestedObjects()};H._doOnAttachStatusBar=function(){this.adjustContent(this.childNodes[0],(this._noHeader?0:B.skinParams[B.skin]["cpanel_height"]));this.updateNestedObjects()};H._doOnFrameContentLoaded=function(){B.callEvent("onContentLoaded",[this._idd])};H._doOnResize=function(){this.adjustContent(this.childNodes[0],(this._noHeader?0:B.skinParams[B.skin]["cpanel_height"]));this.updateNestedObjects()};H._redraw=function(){};H.showArrow=function(){this.childNodes[0].childNodes[0].childNodes[4].style.display=""};H.hideArrow=function(){this.childNodes[0].childNodes[0].childNodes[4].style.display="none"};H.isArrowVisible=function(){return(this.childNodes[0].childNodes[0].childNodes[4].style.display!="none")}}if(H._dir=="ver"){H.onselectstart=function(A){A=A||event;A.returnValue=false};if(_isIE)H["ondblclick"]=function(){B._doOnDoubleClick(this)};H[this._isIPad?"ontouchstart":"onmousedown"]=function(E){E=E||event;if(!_isIE)if(!this._lastClick)this._lastClick=new Date().getTime();else{var D=this._lastClick;this._lastClick=new Date().getTime();if(D+B._dblClickTM>=this._lastClick)if(B._doOnDoubleClick(this)===true)return}var H=B._findDockCellsVer(this);B._resAreaData=new Array();if(H[0]!=null&&H[1]!=null){if(String(document.body.className).search("dhxCursorWResize")==-1)document.body.className+=" dhxCursorWResize";B._resObj=this;B._anyExpL=H[0];B._anyExpR=H[1];B._collectResAreaData(H);B._resX=(B._isIPad?E.touches[0].clientX:E.clientX);if(B._effects["resize"]==false){B._attachSizer(this);B.sizer._leftXStart=parseInt(B.sizer.style.left);var I=B.polyObj[B._anyExpL[0]];B._resXMaxWidthLeft=parseInt(I.style.width)-B._minWidth;var G=B.polyObj[B._anyExpR[0]];B._resXMaxWidthRight=parseInt(G.style.width)-B._minWidth;if(B._alterSizes.length>0)for(var F=0;F<B._alterSizes.length;F++){for(var A=0;A<B._anyExpL.length;A++)if(B._alterSizes[F][0]==B._anyExpL[A]){var C=B._resXMaxWidthLeft=parseInt(I.style.width)-B._alterSizes[F][1];if(C<B._resXMaxWidthLeft)B._resXMaxWidthLeft=C}for(A=0;A<B._anyExpR.length;A++)if(B._alterSizes[F][0]==B._anyExpR[A]){C=parseInt(G.style.width)-B._alterSizes[F][1];if(C<B._resXMaxWidthRight)B._resXMaxWidthRight=C}}B._resXStart=B._resX}B._resFunc=B._resizeVer;B._showCovers();if(B._isIPad)E.preventDefault()}};H.onmouseup=function(){if(B._effects["resize"]==true){B._resizeStop();B._anyExpL=null;B._anyExpR=null}}}if(H._dir=="hor"){H.onselectstart=function(A){A=A||event;A.returnValue=false};H[this._isIPad?"ontouchstart":"onmousedown"]=function(E){E=E||event;if(!this._lastClick)this._lastClick=new Date().getTime();else{var D=this._lastClick;this._lastClick=new Date().getTime();if(D+B._dblClickTM>=this._lastClick)if(B._doOnDoubleClick(this)===true)return}var H=B._findDockCellsHor(this);B._resAreaData=new Array();if(H[0]!=null&&H[1]!=null){if(String(document.body.className).search("dhxCursorNResize")==-1)document.body.className+=" dhxCursorNResize";B._resObj=this;B._anyExpT=H[0];B._anyExpB=H[1];B._collectResAreaData(H);B._resY=(B._isIPad?E.touches[0].clientY:E.clientY);if(B._effects["resize"]==false){B._attachSizer(this);B.sizer._topYStart=parseInt(B.sizer.style.top);var G=B.polyObj[B._anyExpT[0]];B._resYMaxHeightTop=parseInt(G.style.height)-B._minHeight;var I=B.polyObj[B._anyExpB[0]];B._resYMaxHeightBottom=parseInt(I.style.height)-B._minHeight;if(B._alterSizes.length>0)for(var F=0;F<B._alterSizes.length;F++){for(var A=0;A<B._anyExpT.length;A++)if(B._alterSizes[F][0]==B._anyExpT[A]){var C=parseInt(G.style.height)-B._alterSizes[F][2]-(G.childNodes[0].style.display!="none"?B.skinParams[B.skin]["cpanel_height"]:0);if(C<B._resYMaxHeightTop)B._resYMaxHeightTop=C}for(A=0;A<B._anyExpB.length;A++)if(B._alterSizes[F][0]==B._anyExpB[A]){C=parseInt(I.style.height)-B._alterSizes[F][2]-(I.childNodes[0].style.display!="none"?B.skinParams[B.skin]["cpanel_height"]:0);if(C<B._resYMaxHeightBottom)B._resYMaxHeightBottom=C}}B._resYStart=B._resY}B._resFunc=B._resizeHor;B._showCovers();if(B._isIPad)E.preventDefault()}};H.onmouseup=function(){if(B._effects["resize"]==true){B._resizeStop();B._anyExpT=null;B._anyExpB=null}}}}}for(var F in this.polyObj){this.polyObj[F]._collapsed=false;this.polyObj[F]._idd=F;this.polyObj[F]._ind=this.items.length;this.items[this.items.length]=this.polyObj[F];var A=document.createElement("DIV");A.style.position="relative";A.style.left="0px";A.style.top="0px";A.style.width=this.polyObj[F].style.width;A.style.height=this.polyObj[F].style.height;A.style.overflow="hidden";this.polyObj[F].appendChild(A);var J=document.createElement("DIV");J._dockCell=F;J._resize=this.polyObj[F]._resize;J.className="dhtmlxPolyInfoBar";J.innerHTML="<div class='dhtmlxInfoBarLabel'>"+F+"</div>"+"<div class='dhtmlxInfoBarButtonsFake'><div class='dhtmlxInfoBarButtonsFake2'></div></div>"+"<div class='dhtmlxInfoButtonDock' title='"+this.i18n.dock+"'></div>"+"<div class='dhtmlxInfoButtonUnDock' style='display: none;' title='"+this.i18n.undock+"'></div>"+"<div class='dhtmlxInfoButtonShowHide_"+J._resize+"' title='"+this.i18n.collapse+"'></div>"+"<div class='dhtmlxLineL'></div>"+"<div class='dhtmlxLineR'></div>";if(this.polyObj[F]._initCPanel==true){J._h=this._CPanelHeight;J.style.display=""}else{J._h=0;J.style.display="none"}this.polyObj[F].childNodes[0].appendChild(J);J.ondblclick=function(){B.callEvent("onDblClick",[this._dockCell])};J.childNodes[4].onclick=function(){var A=this.parentNode._dockCell;if(B._isCollapsed(A))B._expand(A,"hide");else B._collapse(A,"hide")};for(E=0;E<J.childNodes.length;E++)J.childNodes[E].onselectstart=function(A){A=A||event;A.returnValue=false};var G=document.createElement("DIV");G.className="dhxcont_global_content_area";this.polyObj[F].childNodes[0].appendChild(G);var I=new dhtmlXContainer(this.polyObj[F]);I.setContent(G);if(this.skin=="dhx_web")this.polyObj[F]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_layout_dhx_web");if(this.skin=="dhx_terrace")this.polyObj[F]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_layout_dhx_terrace");this.polyObj[F].adjustContent(this.polyObj[F].childNodes[0],this.skinParams[this.skin]["cpanel_height"])}this._fixIcons()};this._resX=null;this._resY=null;this._resObj=null;this._resFunc=null;this._anyExpL=null;this._anyExpR=null;this._anyExpT=null;this._anyExpB=null;this._expand=function(A,B){this._doExpand(this.polyObj[A]._resize,A,this.polyObj[A]._rowData,B)};this._collapse=function(A,B){if(this._isCollapsed(A))return;this.polyObj[A]._savedW=parseInt(this.polyObj[A].style.width);this.polyObj[A]._savedH=parseInt(this.polyObj[A].style.height);this._doCollapse(this.polyObj[A]._resize,A,this.polyObj[A]._rowData,B)};this._isCollapsed=function(A){return this.polyObj[A]._collapsed};this._checkAlterMinSize=function(D){this._alterSizes=new Array();for(var C=0;C<D.length;C++)for(var A=0;A<D[C].length;A++)if(this.polyObj[D[C][A]].vs[this.polyObj[D[C][A]].av].layout!=null){var B=this.polyObj[D[C][A]].vs[this.polyObj[D[C][A]].av].layout._defineWindowMinDimension(this.polyObj[D[C][A]],true);B[0]=D[C][A];this._alterSizes[this._alterSizes.length]=B}};this._findDockCellsVer=function(F){var B=new Array(null,null);if(F==null)return B;var H=null;for(var E=F._left.length-1;E>=0;E--)if(H==null)if(typeof(F._left[E])=="object"){var I=false;for(var A=0;A<F._left[E].length;A++)I=I||(this.polyObj[F._left[E][A]]._isBlockedWidth||false);if(!I)H=F._left[E]}else if(this.polyObj[F._left[E]]._collapsed==false)if(!this.polyObj[F._left[E]]._isBlockedWidth)H=F._left[E];var C=null;for(E=0;E<F._right.length;E++)if(C==null)if(typeof(F._right[E])=="object"){I=false;for(A=0;A<F._right[E].length;A++)I=I||(this.polyObj[F._right[E][A]]._isBlockedWidth||false);if(!I)C=F._right[E]}else if(this.polyObj[F._right[E]]._collapsed==false)if(!this.polyObj[F._right[E]]._isBlockedWidth)C=F._right[E];if(H==null||C==null)return B;if(typeof(H)=="string")H=new Array(H);if(typeof(C)=="string")C=new Array(C);B[0]=H;B[1]=C;this._checkAlterMinSize(B);this._minWLAlter=0;this._minWRAlter=0;if(this._alterSizes.length>0&&this._effects["resize"]==true){var G=new Array(),D=new Array();for(E=0;E<H.length;E++)G[E]=this.polyObj[H[E]];for(E=0;E<C.length;E++)D[E]=this.polyObj[C[E]];for(E=0;E<G.length;E++)for(A=0;A<this._alterSizes.length;A++)if(this._alterSizes[A][0]==G[E]._idd&&this._minWLAlter<this._alterSizes[A][1])this._minWLAlter=this._alterSizes[A][1];for(E=0;E<D.length;E++)for(A=0;A<this._alterSizes.length;A++)if(this._alterSizes[A][0]==D[E]._idd&&this._maxWRAlter<this._alterSizes[A][1])this._minWRAlter=this._alterSizes[A][1]}return B};this._findDockCellsHor=function(H){var D=new Array(null,null);if(H==null)return D;var B=null;for(var G=H._top.length-1;G>=0;G--)if(B==null)if(typeof(H._top[G])=="object"){var I=false;for(var A=0;A<H._top[G].length;A++)I=I||(this.polyObj[H._top[G][A]]._isBlockedHeight||false);if(!I)B=H._top[G]}else if(this.polyObj[H._top[G]]._collapsed==false)if(!this.polyObj[H._top[G]]._isBlockedHeight)B=H._top[G];var C=null;for(G=0;G<H._bottom.length;G++)if(C==null)if(typeof(H._bottom[G])=="object"){I=false;for(A=0;A<H._bottom[G].length;A++)I=I||(this.polyObj[H._bottom[G][A]]._isBlockedHeight||false);if(!I)C=H._bottom[G]}else if(this.polyObj[H._bottom[G]]._collapsed==false)if(!this.polyObj[H._bottom[G]]._isBlockedHeight)C=H._bottom[G];if(B==null||C==null)return D;if(typeof(B)=="string")B=new Array(B);if(typeof(C)=="string")C=new Array(C);D[0]=B;D[1]=C;this._checkAlterMinSize(D);this._minHTAlter=0;this._minHBAlter=0;if(this._alterSizes.length>0&&this._effects["resize"]==true){var E=new Array(),F=new Array();for(G=0;G<B.length;G++)E[G]=this.polyObj[B[G]];for(G=0;G<C.length;G++)F[G]=this.polyObj[C[G]];for(G=0;G<E.length;G++)for(A=0;A<this._alterSizes.length;A++)if(this._alterSizes[A][0]==E[G]._idd&&this._minHTAlter<this._alterSizes[A][2])this._minHTAlter=this._alterSizes[A][2];for(G=0;G<F.length;G++)for(A=0;A<this._alterSizes.length;A++)if(this._alterSizes[A][0]==F[G]._idd&&this._minHBAlter<this._alterSizes[A][2])this._minHBAlter=this._alterSizes[A][2]}return D};this._resizeVer=function(C){if(this._isIPad)C.preventDefault();if(this._resObj==null||this._anyExpL==null||this._anyExpR==null)return;var I=(this._isIPad?C.touches[0].clientX:C.clientX);if(this._effects["resize"]==false){this._resX=I;var E=I-this._resXStart;if(-E>this._resXMaxWidthLeft&&E<0){E=-this._resXMaxWidthLeft;this._resX=E+this._resXStart}if(E>this._resXMaxWidthRight&&E>0){E=this._resXMaxWidthRight;this._resX=E+this._resXStart}this.sizer.style.left=this.sizer._leftXStart+E+"px";return}var M=this._anyExpL,B=this._anyExpR,G=I,E=I-A._resX,N=new Array(),K=new Array();for(var L=0;L<M.length;L++)N[L]=this.polyObj[M[L]];for(L=0;L<B.length;L++)K[L]=this.polyObj[B[L]];var D=parseInt(N[0].style.width),J=parseInt(K[0].style.width);if(E<0){var H=D+E;if(H>N[0]._minW&&H>this._minWLAlter){var F=J+D-H;for(L=0;L<N.length;L++)this._setW(N[L],H);for(L=0;L<K.length;L++)this._setW(K[L],F);this._resX=G}}else if(E>0){F=J-E;if(F>K[0]._minW&&F>this._minWRAlter){H=D+J-F;for(L=0;L<N.length;L++)this._setW(N[L],H);for(L=0;L<K.length;L++)this._setW(K[L],F);this._resX=G}}};this._resizeHor=function(C){if(this._resObj==null||this._anyExpT==null||this._anyExpB==null)return;var G=(this._isIPad?C.touches[0].clientY:C.clientY);if(this._effects["resize"]==false){this._resY=G;var F=G-this._resYStart;if(-F>this._resYMaxHeightTop&&F<0){F=-this._resYMaxHeightTop;this._resY=F+this._resYStart}if(F>this._resYMaxHeightBottom&&F>0){F=this._resYMaxHeightBottom;this._resY=F+this._resYStart}this.sizer.style.top=this.sizer._topYStart+F+"px";return}var B=this._anyExpT,K=this._anyExpB,H=G,F=G-A._resY,L=new Array(),D=new Array();for(var M=0;M<B.length;M++)L[M]=this.polyObj[B[M]];for(M=0;M<K.length;M++)D[M]=this.polyObj[K[M]];var N=parseInt(L[0].style.height),I=parseInt(D[0].style.height);if(F<0){var J=N+F;if(J>L[0]._minH+this._minHTAlter){var E=I+N-J;for(M=0;M<L.length;M++)this._setH(L[M],J);for(M=0;M<D.length;M++)this._setH(D[M],E);this._resY=H}}else if(F>0){E=I-F;if(E>D[0]._minH+this._minHBAlter){J=N+I-E;for(M=0;M<L.length;M++)this._setH(L[M],J);for(M=0;M<D.length;M++)this._setH(D[M],E);this._resY=H}}};this._resizeStop=function(){var L=document.body.className;if(L.search("dhxCursorWResize")!==-1||L.search("dhxCursorNResize")!==-1)document.body.className=String(document.body.className).replace(/dhxCursorWResize/g,"").replace(/dhxCursorNResize/g,"");if(this._resObj==null)return;if(this._effects["resize"]==false){this.sizer.style.display="none";if(this._resObj._dir=="hor"){var M=(typeof(this._anyExpT[0])=="object"?this._anyExpT[0][0]:this._anyExpT[0]),B=this._resY-this._resYStart,N=parseInt(this.polyObj[M].style.height)+B;this._setHeight(M,N)}else{var H=(typeof(this._anyExpL[0])=="object"?this._anyExpL[0][0]:this._anyExpL[0]),C=this._resX-this._resXStart,E=parseInt(this.polyObj[H].style.width)+C;this._setWidth(H,E)}var J={},O=function(B){if(B!=null)for(var A=0;A<B.length;A++){if(typeof(B[A])=="object")O(B[A]);J[B[A]]=true}};O(this._anyExpT);O(this._anyExpB);O(this._anyExpL);O(this._anyExpR);var D=new Array();for(var F in J)D[D.length]=F;if(typeof(this._anyExpT)=="object"&&this._anyExpT!=null){this.updateNestedObjectsArray(this._anyExpT);this._anyExpT=null}if(typeof(this._anyExpB)=="object"&&this._anyExpB!=null){this.updateNestedObjectsArray(this._anyExpB);this._anyExpB=null}if(typeof(this._anyExpL)=="object"&&this._anyExpL!=null){this.updateNestedObjectsArray(this._anyExpL);this._anyExpL=null}if(typeof(this._anyExpR)=="object"&&this._anyExpR!=null){this.updateNestedObjectsArray(this._anyExpR);this._anyExpR=null}this._resObj=null;this._resFunc=null;this._hideCovers();this._fixToolbars();this._fixCollapsedText();this.callEvent("onPanelResizeFinish",[D]);return}var G=new Array();if(this._resObj._left!=null)for(var K=0;K<this._resObj._left.length;K++)G[G.length]=this._resObj._left[K];if(this._resObj._right!=null)for(K=0;K<this._resObj._right.length;K++)G[G.length]=this._resObj._right[K];if(this._resObj._top!=null)for(K=0;K<this._resObj._top.length;K++)G[G.length]=this._resObj._top[K];if(this._resObj._bottom!=null)for(K=0;K<this._resObj._bottom.length;K++)G[G.length]=this._resObj._bottom[K];this._resFunc=null;this._resObj=null;this._hideCovers();var A=new Array();for(K=0;K<G.length;K++)if(typeof(G[K])=="object"){for(var I=0;I<G[K].length;I++)A[A.length]=this.polyObj[G[K][I]]}else A[A.length]=this.polyObj[G[K]];for(K=0;K<A.length;K++)A[K].updateNestedObjects();this._fixCollapsedText();this.callEvent("onPanelResizeFinish",[])};this._showCovers=function(){for(var A in this.polyObj)if(this._effects["highlight"]&&this._isResizable(A))this.polyObj[A].showCoverBlocker();this._fixToolbars()};this._hideCovers=function(){for(var A in this.polyObj)this.polyObj[A].hideCoverBlocker();this._fixToolbars()};this._isResizable=function(B){var A=false;for(var C=0;C<this._resAreaData.length;C++)A=A||(this._resAreaData[C]==B);return A};this._collectResAreaData=function(B){for(var A=0;A<B.length;A++)if(typeof(B[A])=="string")this._resAreaData[this._resAreaData.length]=B[A];else if(typeof(B[A])=="object")this._collectResAreaData(B[A])};this._doOnDoubleClick=function(A){if(A._dblClick==null)return;if(this.polyObj[A._dblClick]==null)return;if(this.polyObj[A._dblClick]._noHeader)return;var B=this.polyObj[A._dblClick];if(B.childNodes[0].style.display=="none")return;if(B._collapsed==true)this._doExpand(B._resize,A._dblClick,B._rowData,"hide");else{B._savedW=parseInt(B.style.width);B._savedH=parseInt(B.style.height);this._doCollapse(B._resize,A._dblClick,B._rowData,"hide")}return true};this._doOnSelectStart=function(B){B=B||event;if(A._resObj!=null)B.returnValue=false};this._doOnMouseMove=function(B){B=B||event;if(A._resObj!=null&&A._resFunc!=null)A._resFunc(B)};this._doOnMouseUp=function(){A._resizeStop()};if(this._isIPad){document.addEventListener("touchmove",A._doOnMouseMove,false);document.addEventListener("touchend",A._doOnMouseUp,false)}else if(_isIE){document.body.attachEvent("onselectstart",A._doOnSelectStart);document.body.attachEvent("onmousemove",A._doOnMouseMove);document.body.attachEvent("onmouseup",A._doOnMouseUp)}else{document.body.addEventListener("mousemove",A._doOnMouseMove,false);document.body.addEventListener("mouseup",A._doOnMouseUp,false)}this._doExpand=function(F,D,A,C){if(A.length<=1)return;var G=-1;for(var H=0;H<A.length;H++)if(A[H]==D)G=H;if(G==-1)return;var B=null;for(H=G+1;H<A.length;H++)if(B==null)if(typeof(A[H])=="string"){if(this.polyObj[A[H]]._collapsed==false)B=A[H]}else B=A[H];if(B==null)for(H=G-1;H>=0;H--)if(B==null)if(typeof(A[H])=="string"){if(this.polyObj[A[H]]._collapsed==false)B=A[H]}else B=A[H];if(B==null)return;if(typeof(B)!="object")B=new Array(B);if(F=="hor"){var K=65536;for(H=0;H<B.length;H++){var E=(this.polyObj[B[H]].vs[this.polyObj[B[H]].av].layout!=null?this.polyObj[B[H]].vs[this.polyObj[B[H]].av].layout._defineWindowMinDimension(this.polyObj[B[H]],true):[0,0]),J=parseInt(this.polyObj[B[H]].style.width)-this._minWidth-E[1];if(J<K)K=J}var L=this.polyObj[D]._savedW;if(L>K)L=K;if(L<this._minWidth)return;var M=Math.round(L/3)}else{K=65536;for(H=0;H<B.length;H++){E=(this.polyObj[B[H]].vs[this.polyObj[B[H]].av].layout!=null?this.polyObj[B[H]].vs[this.polyObj[B[H]].av].layout._defineWindowMinDimension(this.polyObj[B[H]],true):[0,0,0]),J=parseInt(this.polyObj[B[H]].style.height)-this._minHeight-E[2];if(J<K)K=J}L=this.polyObj[D]._savedH;if(L>K)L=K;if(L<this._minHeight)return;M=Math.round(L/3)}this.polyObj[D].childNodes[0].childNodes[1].style.display="";this.polyObj[D].childNodes[0].childNodes[0].className="dhtmlxPolyInfoBar";this.polyObj[D].childNodes[0].childNodes[0].childNodes[1].style.display="";this.polyObj[D].childNodes[0].childNodes[0].childNodes[2].style.display="";this.polyObj[D].childNodes[0].childNodes[0].childNodes[4].style.display="";var I=new Array();for(H=0;H<B.length;H++)I[H]=this.polyObj[B[H]];if(this.polyObj[D].className=="dhtmlxLayoutSinglePolyTabbarCollapsed")this.polyObj[D].className="dhtmlxLayoutSinglePolyTabbar";this._expandEffect(this.polyObj[D],I,L,C,(this._effects["collapse"]==true?M:1000000),F)};this._doCollapse=function(C,A,G,I){if(G.length<=1)return;var B=-1;for(var D=0;D<G.length;D++)if(G[D]==A)B=D;if(B==-1)return;var F=null;for(D=B+1;D<G.length;D++)if(F==null)if(typeof(G[D])=="string"){if(this.polyObj[G[D]]._collapsed==false)F=G[D]}else F=G[D];if(F==null)for(D=B-1;D>=0;D--)if(F==null)if(typeof(G[D])=="string"){if(this.polyObj[G[D]]._collapsed==false)F=G[D]}else F=G[D];if(F==null)if(G[B+1]!=null)F=G[B+1];if(F==null)if(B-1>=0)if(G[B-1]!=null)F=G[B-1];if(F!=null){if(typeof(F)!="object"){if(this.polyObj[F]._collapsed==true){this.polyObj[F].childNodes[0].childNodes[1].style.display="";this.polyObj[F]._collapsed=false;this.polyObj[F].childNodes[0].childNodes[0].className="dhtmlxPolyInfoBar";this.polyObj[F].childNodes[0].childNodes[0].childNodes[1].style.display="";this.polyObj[F].childNodes[0].childNodes[0].childNodes[4].title=this.i18n.collapse;this.polyObj[F].childNodes[0].childNodes[0].childNodes[2].style.display="";this.polyObj[F].childNodes[0].childNodes[0].childNodes[3].style.display="none";this.polyObj[F].childNodes[0].childNodes[0].childNodes[4].style.display="";if(this.polyObj[F]._isUnDocked===true)this.dockWindow(F);if(this.polyObj[F].className=="dhtmlxLayoutSinglePolyTabbarCollapsed")this.polyObj[F].className="dhtmlxLayoutSinglePolyTabbar";this._fixSplitters();this._fixIcons();this.polyObj[F].removeAttribute("title");this._fixToolbars();this.callEvent("onExpand",[F])}F=new Array(F)}var E=new Array();for(D=0;D<F.length;D++)E[D]=this.polyObj[F[D]];if(C=="hor")var H=Math.round(Math.max(this.polyObj[A].offsetWidth,this.polyObj[F[0]].offsetWidth)/3);else H=Math.round(Math.max(this.polyObj[A].offsetHeight,this.polyObj[F[0]].offsetHeight)/3);this.polyObj[A].childNodes[0].childNodes[1].style.display="none";this._collapseEffect(this.polyObj[A],E,I,(this._effects["collapse"]==true?H:1000000),C)}};this.setEffect=function(A,B){if(this._effects[A]!=null&&typeof(B)=="boolean")this._effects[A]=B};this.getEffect=function(A){if(this._effects[A]!=null)return this._effects[A];return null};this._expandEffect=function(H,G,J,K,I,E){if(E=="hor")var D=parseInt(H.style.width),B=parseInt(G[0].style.width);else D=parseInt(H.style.height),B=parseInt(G[0].style.height);var C=D+I;if(C>J)C=J;if(E=="hor"){H.style.width=C+"px";H.childNodes[0].style.width=H.style.width}else{H.style.height=C+"px";H.childNodes[0].style.height=H.style.height}H.adjustContent(H.childNodes[0],(H._noHeader?0:this.skinParams[this.skin]["cpanel_height"]));for(var F=0;F<G.length;F++){if(E=="hor"){G[F].style.width=B+D-C+"px";G[F].childNodes[0].style.width=G[F].style.width}else{G[F].style.height=B+D-C+"px";G[F].childNodes[0].style.height=G[F].style.height}G[F].adjustContent(G[F].childNodes[0],(G[F]._noHeader?0:this.skinParams[this.skin]["cpanel_height"]))}if(C!=J)window.setTimeout(function(){A._expandEffect(H,G,J,K,I,E)},4);else{H._collapsed=false;for(F=0;F<G.length;F++)G[F].updateNestedObjects();this.polyObj[H._idd].updateNestedObjects();this.polyObj[H._idd].childNodes[0].childNodes[0].childNodes[4].title=this.i18n.collapse;this._fixSplitters();this._fixIcons();H.removeAttribute("title");this._fixToolbars();this.callEvent("onExpand",[H._idd])}};this._collapseEffect=function(H,G,J,I,E){if(E=="hor")var D=parseInt(H.style.width),B=parseInt(G[0].style.width);else D=parseInt(H.style.height),B=parseInt(G[0].style.height);var C=D-I;if(E=="hor"){if(C<this._collapsedW)C=this._collapsedW;H.style.width=C+"px";H.childNodes[0].style.width=H.style.width}else{if(C<this._collapsedH)C=this._collapsedH;H.style.height=C+"px";H.childNodes[0].style.height=H.style.height}for(var F=0;F<G.length;F++){if(E=="hor"){G[F].style.width=B+(D-C)+"px";G[F].childNodes[0].style.width=G[F].style.width}else{G[F].style.height=B+(D-C)+"px";G[F].childNodes[0].style.height=G[F].style.height}G[F].adjustContent(G[F].childNodes[0],(G[F]._noHeader?0:this.skinParams[this.skin]["cpanel_height"]))}if((C>this._collapsedW&&E=="hor")||(C>this._collapsedH&&E=="ver"))window.setTimeout(function(){A._collapseEffect(H,G,J,I,E)},4);else{for(F=0;F<G.length;F++){if(E=="hor"){G[F].style.width=B+(D-C)+"px";G[F].childNodes[0].style.width=G[F].style.width}else{G[F].style.height=B+(D-C)+"px";G[F].childNodes[0].style.height=G[F].style.height}G[F].adjustContent(G[F].childNodes[0],(G[F]._noHeader?0:this.skinParams[this.skin]["cpanel_height"]))}H._collapsed=true;if(E=="hor")H.childNodes[0].childNodes[0].className="dhtmlxPolyInfoBarCollapsedVer";else H.childNodes[0].childNodes[0].className="dhtmlxPolyInfoBarCollapsedHor";for(F=0;F<G.length;F++)G[F].updateNestedObjects();if(J=="hide"){H.childNodes[0].childNodes[0].childNodes[1].style.display="";H.childNodes[0].childNodes[0].childNodes[2].style.display="none";H.childNodes[0].childNodes[0].childNodes[3].style.display="none";H.childNodes[0].childNodes[0].childNodes[4].style.display=""}else{H.childNodes[0].childNodes[0].childNodes[1].style.display="";H.childNodes[0].childNodes[0].childNodes[2].style.display="";H.childNodes[0].childNodes[0].childNodes[3].style.display="none";H.childNodes[0].childNodes[0].childNodes[4].style.display="none"}if(H.className=="dhtmlxLayoutSinglePolyTabbar")H.className="dhtmlxLayoutSinglePolyTabbarCollapsed";this.polyObj[H._idd].childNodes[0].childNodes[0].childNodes[4].title=this.i18n.expand;this._fixSplitters();this._fixIcons();H.title=this.getTextTooltip(H._idd);this._fixToolbars();this._fixCollapsedText();this.callEvent("onCollapse",[H._idd])}};this._setW=function(B,A){B.style.width=A+"px";B.childNodes[0].style.width=B.style.width;B.adjustContent(B.childNodes[0],(B._noHeader?0:this.skinParams[this.skin]["cpanel_height"]))};this._setH=function(A,B){A.style.height=B+"px";A.childNodes[0].style.height=A.style.height;A.adjustContent(A.childNodes[0],(A._noHeader?0:this.skinParams[this.skin]["cpanel_height"]))};this._setWidth=function(H,D){if(this.polyObj[H]==null)return;if(!Number(D))return;var K=null;for(var I=0;I<this.sepVer.length;I++){var J=this.sepVer[I]._left;if(J[J.length-1]==H)K=new Array(this.sepVer[I],"left");else if(typeof(J[J.length-1])=="object"){var G=J[J.length-1];for(var B=0;B<G.length;B++)if(G[B]==H)K=new Array(this.sepVer[I],"left")}J=this.sepVer[I]._right;if(J[0]==H)K=new Array(this.sepVer[I],"right");else if(typeof(J[0])=="object"){G=J[0];for(B=0;B<G.length;B++)if(G[B]==H)K=new Array(this.sepVer[I],"right")}}if(K!=null){var C=this._findDockCellsVer(K[0]),L=C[0],A=C[1];if(L==null||A==null)return;var E=parseInt(this.polyObj[L[0]].style.width)+parseInt(this.polyObj[A[0]].style.width);if(D<this._minWidth)D=this._minWidth;else if(D>E-this._minWidth)D=E-this._minWidth;var F=E-D;for(I=0;I<L.length;I++){this._setW(this.polyObj[L[I]],(K[1]=="left"?D:F));this.polyObj[L[I]].updateNestedObjects()}for(I=0;I<A.length;I++){this._setW(this.polyObj[A[I]],(K[1]=="right"?D:F));this.polyObj[A[I]].updateNestedObjects()}}};this._setHeight=function(F,H){if(this.polyObj[F]==null)return;if(!Number(H))return;var K=null;for(var I=0;I<this.sepHor.length;I++){var J=this.sepHor[I]._top;if(J[J.length-1]==F)K=new Array(this.sepHor[I],"top");else if(typeof(J[J.length-1])=="object"){var E=J[J.length-1];for(var B=0;B<E.length;B++)if(E[B]==F)K=new Array(this.sepHor[I],"top")}J=this.sepHor[I]._bottom;if(J[0]==F)K=new Array(this.sepHor[I],"bottom");else if(typeof(J[0])=="object"){E=J[0];for(B=0;B<E.length;B++)if(E[B]==F)K=new Array(this.sepHor[I],"bottom")}}if(K!=null){var C=this._findDockCellsHor(K[0]),A=C[0],G=C[1];if(A==null||G==null)return;var D=parseInt(this.polyObj[A[0]].style.height)+parseInt(this.polyObj[G[0]].style.height);if(H<this._minHeight)H=this._minHeight;else if(H>D-this._minHeight)H=D-this._minHeight;var L=D-H;for(I=0;I<A.length;I++){this._setH(this.polyObj[A[I]],(K[1]=="top"?H:L));this.polyObj[A[I]].updateNestedObjects()}for(I=0;I<G.length;I++){this._setH(this.polyObj[G[I]],(K[1]=="bottom"?H:L));this.polyObj[G[I]].updateNestedObjects()}}};this.updateNestedObjectsArray=function(B){for(var A=0;A<B.length;A++)if(typeof(B[A])=="object")this.updateNestedObjectsArray(B[A]);else this.polyObj[B[A]].updateNestedObjects()};this.dockWindow=function(A){if(!this.dhxWins)return;if(!this.dhxWins.window(this.dhxWinsIdPrefix+A))return;this.dhxWins.window(this.dhxWinsIdPrefix+A).close();this.dhxWins.window(this.dhxWinsIdPrefix+A).moveContentTo(this.polyObj[A]);this.polyObj[A]._isUnDocked=false;this.callEvent("onDock",[A])};this.unDockWindow=function(A){this._initWindows(A);this.polyObj[A].moveContentTo(this.dhxWins.window(this.dhxWinsIdPrefix+A));this.polyObj[A]._isUnDocked=true;this.callEvent("onUnDock",[A])};this._initWindows=function(A){if(!window.dhtmlXWindows)return;if(!this.dhxWins){this.dhxWins=new dhtmlXWindows();this.dhxWins.setSkin(this.skin);this.dhxWins.setImagePath(this.imagePath);this.dhxWinsIdPrefix="";if(!A)return}var B=this.dhxWinsIdPrefix+A;if(!this.dhxWins.window(B)){var C=this,D=this.dhxWins.createWindow(B,20,20,320,200);D.setText(this.polyObj[A].getText());D.button("close").hide();D.attachEvent("onClose",function(A){A.hide()});D.button("dock").show();D.button("dock").attachEvent("onClick",function(B){C.polyObj[A].dock()});D.dockedCell=this.polyObj[A]}else this.dhxWins.window(B).show()};this.isPanelVisible=function(A){return(!this.polyObj[A]._noHeader)};this.showPanel=function(A){if(this.polyObj[A]==null)return;if(this.polyObj[A]._collapsed==true)return;var B=this.polyObj[A].childNodes[0].childNodes[0];B.style.display="";this.polyObj[A]._noHeader=false;if(this.skin=="dhx_web")this.polyObj[A]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_layout_dhx_web");if(this.skin=="dhx_terrace")this.polyObj[A]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_layout_dhx_terrace");this.polyObj[A].adjustContent(this.polyObj[A].childNodes[0],this.skinParams[this.skin]["cpanel_height"]);this.polyObj[A].updateNestedObjects()};this.hidePanel=function(A){if(this.polyObj[A]==null)return;if(this.polyObj[A]._collapsed==true)return;var B=this.polyObj[A].childNodes[0].childNodes[0];B.style.display="none";this.polyObj[A]._noHeader=true;if(this.skin=="dhx_web")this.polyObj[A]._setPadding(this.skinParams[this.skin]["cell_pading_min"],"");if(this.skin=="dhx_terrace")this.polyObj[A]._setPadding(this.skinParams[this.skin]["cell_pading_min"],"");this.polyObj[A].adjustContent(this.polyObj[A].childNodes[0],0);this.polyObj[A].updateNestedObjects()};this.setText=function(A,B){this._changeCPanelText(A,B)};this.getText=function(A){return this.polyObj[A].childNodes[0].childNodes[0].childNodes[0].innerHTML};this.getTextTooltip=function(A){var B=this.polyObj[A].childNodes[0].childNodes[0].childNodes[0];return(B.innerText||B.textContent)};this._changeCPanelText=function(B,C){var D=A;if(D.polyObj[B]==null)return;D.polyObj[B].childNodes[0].childNodes[0].childNodes[0].innerHTML=C;if(A.dhxWins!=null)if(A.dhxWins.window(A.dhxWinsIdPrefix+B)!=null)A.dhxWins.window(A.dhxWinsIdPrefix+B).setText(C)};this.forEachItem=function(B){for(var A=0;A<this.items.length;A++)B(this.items[A])};this._fixPositionInWin=function(A,B){this.base.style.width=A+"px";this.base.style.height=B+"px"};this.attachMenu=function(){if(this.base._isWindow)this.menu=this.base._window.attachMenu();else{this.cont.obj.skin=this.skin;this.menu=this.cont.obj.attachMenu();this.cont.obj.adjustContent(this.cont.obj,0);this.setSizes()}return this.menu};this.detachMenu=function(){if(!this.menu)return;this.cont.obj.detachMenu();this.setSizes();this.menu=null};this.showMenu=function(){if(!this.menu)return;this.cont.obj.showMenu();this.setSizes()};this.hideMenu=function(){if(!this.menu)return;this.cont.obj.hideMenu();this.setSizes()};this.attachToolbar=function(){if(this.base._isWindow)this.toolbar=this.base._window.attachToolbar();else{this.cont.obj.skin=this.skin;this.toolbar=this.cont.obj.attachToolbar();this.cont.obj.adjustContent(this.cont.obj,0);this.setSizes()}return this.toolbar};this.detachToolbar=function(){if(!this.toolbar)return;this.cont.obj.detachToolbar();this.setSizes();this.toolbar=null};this.showToolbar=function(){if(!this.toolbar)return;this.cont.obj.showToolbar();this.setSizes()};this.hideToolbar=function(){if(!this.toolbar)return;this.cont.obj.hideToolbar();this.setSizes()};this.attachStatusBar=function(){if(this.base._isWindow)this.statusbar=this.base._window.attachStatusBar();else{this.statusbar=this.cont.obj.attachStatusBar();this.cont.obj.adjustContent(this.cont.obj,0);this.setSizes()}return this.statusbar};this.detachStatusBar=function(){if(!this.statusbar)return;this.cont.obj.detachStatusBar();this.setSizes();this.statusbar=null};this.showStatusBar=function(){if(!this.statusbar)return;this.cont.obj.showStatusBar();this.setSizes()};this.hideStatusBar=function(){if(!this.statusbar)return;this.cont.obj.hideStatusBar();this.setSizes()};this.progressOn=function(){this._progressControlGlobal(true)};this.progressOff=function(){this._progressControlGlobal(false)};this._progressControl=function(A,D){if(this.polyObj[A]==null)return;if(this.polyObj[A]._progressCover==null){var C=document.createElement("DIV");C.className="dhtmlxLayoutPolyProgress";this.polyObj[A].childNodes[0].appendChild(C);var B=document.createElement("DIV");B.className="dhtmlxLayoutPolyProgressBGIMG";this.polyObj[A].childNodes[0].appendChild(B);this.polyObj[A]._progressCover=new Array(C,B)}this.polyObj[A]._progressCover[0].style.display=(D==true?"":"none");this.polyObj[A]._progressCover[1].style.display=this.polyObj[A]._progressCover[0].style.display};this._progressControlGlobal=function(C){if(this._progressCover==null){var B=document.createElement("DIV");B.className="dhtmlxLayoutPolyProgressGlobal_"+this.skin;this.obj.appendChild(B);var A=document.createElement("DIV");A.className="dhtmlxLayoutPolyProgressBGIMGGlobal_"+this.skin;this.obj.appendChild(A);this._progressCover=new Array(B,A)}this._progressCover[0].style.display=(C==true?"":"none");this._progressCover[1].style.display=this._progressCover[0].style.display};this._fixSize=function(A,C,B){if(this.polyObj[A]==null)return;this.polyObj[A]._isBlockedWidth=C;this.polyObj[A]._isBlockedHeight=B;this._fixSplitters()};this._fixSplitters=function(){for(var A=0;A<this.sepVer.length;A++){var B=this._findDockCellsVer(this.sepVer[A]);if(B[0]==null||B[1]==null){if(this.sepVer[A].className!="dhtmlxLayoutPolySplitterVerInactive")this.sepVer[A].className="dhtmlxLayoutPolySplitterVerInactive"}else if(this.sepVer[A].className!="dhtmlxLayoutPolySplitterVer")this.sepVer[A].className="dhtmlxLayoutPolySplitterVer"}for(A=0;A<this.sepHor.length;A++){B=this._findDockCellsHor(this.sepHor[A]);if(B[0]==null||B[1]==null){if(this.sepHor[A].className!="dhtmlxLayoutPolySplitterHorInactive")this.sepHor[A].className="dhtmlxLayoutPolySplitterHorInactive"}else if(this.sepHor[A].className!="dhtmlxLayoutPolySplitterHor")this.sepHor[A].className="dhtmlxLayoutPolySplitterHor"}};this._fixIcons=function(){for(var F in this.polyObj){var G=this.polyObj[F]._rowData,E=this.polyObj[F]._collapsed,B=-1;for(var D=0;D<G.length;D++)if(typeof(G[D])=="object");else if(G[D]==F)B=D;var A=null;if(B!=-1){for(D=B+1;D<G.length;D++)if(typeof(G[D])=="object")A=(this.polyObj[F]._resize=="ver"?(E?"b":"t"):(E?"r":"l"));else if(this.polyObj[G[D]]._collapsed==false)A=(this.polyObj[F]._resize=="ver"?(E?"b":"t"):(E?"r":"l"));if(A==null&&B>=1)for(D=B-1;D>=0;D--)if(typeof(G[D])=="object")A=(this.polyObj[F]._resize=="ver"?(E?"t":"b"):(E?"l":"r"));else if(this.polyObj[G[D]]._collapsed==false)A=(this.polyObj[F]._resize=="ver"?(E?"t":"b"):(E?"l":"r"))}if(A!=null){var C=this.polyObj[F]._resize;this.polyObj[F].childNodes[0].childNodes[0].childNodes[4].className="dhtmlxInfoButtonShowHide_"+C+" dhxLayoutButton_"+this.skin+"_"+C+(this.polyObj[F]._collapsed?"2":"1")+A}}};this._defineWindowMinDimension=function(G,E){if(E==true){var J=new Array();J[0]=parseInt(G.style.width);J[1]=parseInt(G.style.height)}else{J=G.getDimension();if(J[0]=="100%")J[0]=G.offsetWidth;if(J[1]=="100%")J[1]=G.offsetHeight}var O=A._getNearestParents("hor"),H=A._getNearestParents("ver");if(!E){var B=new Array(),P=new Array();for(var F in O)B[B.length]=F;for(F in H)P[P.length]=F;A._checkAlterMinSize(new Array(B,P));var C={},N={};for(var M=0;M<A._alterSizes.length;M++){var F=A._alterSizes[M][0],K=A._alterSizes[M][1],I=A._alterSizes[M][2];if(C[F]==null)C[F]=K;else if(K>C[F])C[F]=K;if(N[F]==null)N[F]=I;else if(I>N[F])N[F]=I}for(F in O)if(C[F]!=null)O[F]=O[F]-C[F]+A._minWidth;for(F in H)if(N[F]!=null)H[F]=H[F]-N[F]+A._minHeight-(A.polyObj[F].childNodes[0].style.display!="none"?A.skinParams[A.skin]["cpanel_height"]:0)}var D=65536;for(F in O)if(O[F]<D)D=O[F];D=D-A._minWidth;D=J[0]-D;if(D<A._dimension[0]&&!E)D=A._dimension[0];var L=65536;for(F in H)if(H[F]<L)L=H[F];L=L-A._minHeight;L=J[1]-L;if(L<A._dimension[1]&&!E)L=A._dimension[1];if(E==true)return["",D,L];G.setMinDimension(D,L)};this._getNearestParents=function(I){var G=(I=="hor"?this._autoHor:this._autoVer),E={};for(var F=0;F<G.length;F++){var B=G[F];if(this.polyObj[B]._collapsed==true&&this.polyObj[B]._resize==I){var H=this.polyObj[B]._rowData,C=-1;for(var A=0;A<H.length;A++)if(typeof(H[A])=="object")C=A;else if(H[A]==B)C=A;var D=C;B=null;if(C>0)for(A=C-1;A>=0;A--)if(typeof(H[A])=="object")B=H[A];else if(this.polyObj[H[A]]._collapsed==false&&B==null)B=H[A];if(B==null)for(A=D;A<H.length;A++)if(typeof(H[A])=="object")B=H[A];else if(this.polyObj[H[A]]._collapsed==false&&B==null)B=H[A]}if(B!=null){if(typeof(B)=="string")B=new Array(B);for(A=0;A<B.length;A++)E[B[A]]=parseInt(I=="hor"?this.polyObj[B[A]].style.width:this.polyObj[B[A]].style.height)}}return E};this.setSizes=function(B){var A=this._defineWindowMinDimension(this.base,true);this.cont.obj.setMinContentSize(A[1],A[2]);this.cont.obj.adjustContent(this.cont.obj,0);if(!this.base.offsetParent)return;if(this.cont&&B!==false)this.cont.obj.adjustContent(this.cont.obj,this._mTop,null,null,this._mBottom);var F=this.base.offsetParent.offsetWidth-this.base.offsetWidth+(this._baseWFix!=null?this._baseWFix:0),C=this.base.offsetParent.offsetHeight-this.base.offsetHeight+(this._baseHFix!=null?this._baseHFix:0);this.base.style.width=parseInt(this.base.style.width)+F+"px";this.base.style.height=parseInt(this.base.style.height)+C+"px";var D={};for(var E in this._getNearestParents("hor")){this.polyObj[E].style.width=Math.max(0,parseInt(this.polyObj[E].style.width)+F)+"px";this.polyObj[E].childNodes[0].style.width=this.polyObj[E].style.width;D[E]=1}for(E in this._getNearestParents("ver")){this.polyObj[E].style.height=Math.max(0,parseInt(this.polyObj[E].style.height)+C)+"px";this.polyObj[E].childNodes[0].style.height=this.polyObj[E].style.height;D[E]=1}for(E in D){this.polyObj[E].adjustContent(this.polyObj[E].childNodes[0],(this.polyObj[E]._noHeader?0:this.skinParams[this.skin]["cpanel_height"]));this.polyObj[E].updateNestedObjects()}this.callEvent("onResizeFinish",[]);return};dhtmlxEventable(this);this._init()}dhtmlXLayoutObject.prototype.unload=function(A){if(this._isIPad){document.removeEventListener("touchmove",this._doOnMouseMove,false);document.removeEventListener("touchend",this._doOnMouseUp,false)}else if(_isIE){document.body.detachEvent("onselectstart",this._doOnSelectStart);document.body.detachEvent("onmousemove",this._doOnMouseMove);document.body.detachEvent("onmouseup",this._doOnMouseUp)}else{document.body.removeEventListener("mousemove",this._doOnMouseMove,false);document.body.removeEventListener("mouseup",this._doOnMouseUp,false)}this._doOnSelectStart=null;this._doOnMouseMove=null;this._doOnMouseUp=null;for(var F in this.polyObj){var E=this.polyObj[F];E._isCell=null;E.skin=null;E.getId=null;E.getIndex=null;E.showHeader=null;E.hideHeader=null;E.isHeaderVisible=null;E.setText=null;E.getText=null;E.expand=null;E.collapse=null;E.isCollapsed=null;E.dock=null;E.undock=null;E.setWidth=null;E.getWidth=null;E.setHeight=null;E.getHeight=null;E.fixSize=null;E.progressOn=null;E.progressOff=null;E._doOnAttachMenu=null;E._doOnAttachToolbar=null;E._doOnAttachStatusBar=null;E._collapsed=null;E._idd=null;E._ind=null;E._rowData=null;E._dir=null;E._initCPanel=null;E._minW=null;E._minH=null;E._resize=null;E._savedH=null;E._savedW=null;E.ondblclick=null;var G=E.childNodes[0].childNodes[0];G.className="";G._dockCell=null;G._resize=null;G._h=null;G.ondblclick=null;G.childNodes[4].onclick=null;for(var C=0;C<G.childNodes.length;C++)G.childNodes[C].onselectstart=null;while(G.childNodes.length>0)G.removeChild(G.childNodes[0]);G.parentNode.removeChild(G);G=null;E._dhxContDestruct();E._dhxContDestruct=null;E.removeChild(E.childNodes[0]);E.parentNode.removeChild(E);E=null}for(F in this.polyObj)this.polyObj[F]=null;for(var D=0;D<this.items.length;D++)this.items[D]=null;this.polyObj=null;this.items=null;var B=this.tpl.childNodes[0];while(B.childNodes.length>0){while(B.childNodes[0].childNodes.length>0){C=B.childNodes[0].childNodes[0];C._top=null;C._bottom=null;C._left=null;C._right=null;C._dblClick=null;C._isSep=null;C._dir=null;C._lastClick=null;C.ondblclick=null;C.onmousedown=null;C.onmouseup=null;C.onselectstart=null;while(C.childNodes.length>0)C.removeChild(C.childNodes[0]);C.parentNode.removeChild(C);C=null}B.removeChild(B.childNodes[0])}B.parentNode.removeChild(B);B=null;this.tpl.parentNode.removeChild(this.tpl);this.tpl=null;for(F in this.sepHor)this.sepHor[F]=null;for(F in this.sepVer)this.sepVer[F]=null;this.sepHor=null;this.sepVer=null;if(this._ha){this.detachEvent(this._haEv);this._haEv=null;while(this._ha.childNodes.length>0)this._ha.removeChild(this._ha.childNodes[0]);this._ha.parentNode.removeChild(this._ha);this._ha=null}if(this._fa){this.detachEvent(this._faEv);this._faEv=null;while(this._fa.childNodes.length>0)this._fa.removeChild(this._fa.childNodes[0]);this._fa.parentNode.removeChild(this._fa);this._fa=null}this.attachHeader=null;this.attachFooter=null;this._autoHor=null;this._autoVer=null;this._availAutoSize=null;this._dimension=null;this._effects=null;this._layoutView=null;this._mBottom=null;this._mTop=null;this._minWidth=null;this._minHeight=null;this._resFunc=null;this._resObj=null;this._resX=null;this._resY=null;this._colsRatio=null;this._rowsRatio=null;this._totalCols=null;this._totalRows=null;this._xmlLoader=null;this.w=null;this.h=null;this.imagePath=null;this.skin=null;this.skinParams=null;this.tplData=null;this.tplSizes=null;this._CPanelBtnsWidth=null;this._CPanelHeight=null;if(this.sizer.parentNode)this.sizer.parentNode.removeChild(this.sizer);this.sizer=null;this._alterSizes=null;this._attachSizer=null;this._buildSurface=null;this._changeCPanelText=null;this._checkAlterMinSize=null;this._collapse=null;this._collapseEffect=null;this._collectResAreaData=null;this._defineWindowMinDimension=null;this._doCollapse=null;this._doExpand=null;this._expand=null;this._expandEffect=null;this._findDockCellsHor=null;this._findDockCellsVer=null;this._fixIcons=null;this._fixPositionInWin=null;this._fixSize=null;this._fixSplitters=null;this._getNearestParents=null;this._hideCovers=null;this._init=null;this._initWindows=null;this._isCollapsed=null;this._isResizable=null;this._progressControl=null;this._progressControlGlobal=null;this._resizeHor=null;this._resizeStop=null;this._resizeVer=null;this._resAreaData=null;this._setH=null;this._setHeight=null;this._setW=null;this._setWidth=null;this._showCovers=null;this._xmlParser=null;this.attachEvent=null;this.attachMenu=null;this.attachStatusBar=null;this.attachToolbar=null;this.callEvent=null;this.cells=null;this.checkEvent=null;this.detachEvent=null;this.dockWindow=null;this.eventCatcher=null;this.forEachItem=null;this.getEffect=null;this.getIdByIndex=null;this.getIndexById=null;this.getText=null;this.getTextTooltip=null;this.hidePanel=null;this.isPanelVisible=null;this.listAutoSizes=null;this.listViews=null;this.progressOff=null;this.progressOn=null;this.setAutoSize=null;this.setEffect=null;this.setImagePath=null;this.setSizes=null;this.setSkin=null;this.setText=null;this.showPanel=null;this.unDockWindow=null;this.unload=null;this.updateNestedObjectsArray=null;this.setCollapsedText=null;this.attachMenu=null;this.attachToolbar=null;this.attachStatusBar=null;this.detachMenu=null;this.detachToolbar=null;this.detachStatusBar=null;this.showMenu=null;this.showToolbar=null;this.showStatusBar=null;this.hideMenu=null;this.hideToolbar=null;this.hideStatusBar=null;this._cells=null;this._autosize=null;this._effect=null;this._isIPad=null;this.i18n=null;this.dhx_SeverCatcherPath=null;this._autodetectSkin=null;this._doOnDoubleClick=null;this._dblClickTM=null;this._collapsedH=null;this._collapsedW=null;this._minWLAlter=null;this._minWRAlter=null;this._minHBAlter=null;this._minHTAlter=null;this._resXStart=null;this._resYStart=null;this._resXMaxWidthLeft=null;this._resXMaxWidthRight=null;this._resYMaxHeightTop=null;this._resYMaxHeightBottom=null;if(this.obj){this.obj.parentNode.removeChild(this.obj);this.obj=null}if(this.base)if(this.base==document.body);else{this.base.parentNode.removeChild(this.base);this.base=null}if(this.cont){this.cont.obj._dhxContDestruct();this.cont=null}if(this.dhxWins){this.dhxWins.unload();this.dhxWins=null;this.dhxWinsIdPrefix=null}if(this._doOnResizeStart){if(_isIE)window.detachEvent("onresize",this._doOnResizeStart);else window.removeEventListener("resize",this._doOnResizeStart,false);this._doOnResizeStart=null;this._doOnResizeEnd=null;this._tmTime=null}this.detachAllEvents();this.detachAllEvents=null;that=null};dhtmlXLayoutObject.prototype.tplData={"1C":"<layout><autosize hor=\"a\" ver=\"a\" rows=\"1\" cols=\"1\"/><table data=\"a\"/><row><cell obj=\"a\" wh=\"1,1\" resize=\"ver\" neighbors=\"a\"/></row></layout>","2E":"<layout><autosize hor=\"a;b\" ver=\"b\" rows=\"2\" cols=\"1\"/><table data=\"a;b\"/><row><cell obj=\"a\" wh=\"1,2\" resize=\"ver\" neighbors=\"a;b\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a\" bottom=\"b\" dblclick=\"a\"/></row><row><cell obj=\"b\" wh=\"1,2\" resize=\"ver\" neighbors=\"a;b\"/></row></layout>","2U":"<layout><autosize hor=\"b\" ver=\"a;b\" rows=\"1\" cols=\"2\"/><table data=\"a,b\"/><row><cell obj=\"a\" wh=\"2,1\" resize=\"hor\" neighbors=\"a;b\"/><cell sep=\"ver\" left=\"a\" right=\"b\"/><cell obj=\"b\" wh=\"2,1\" resize=\"hor\" neighbors=\"a;b\"/></row></layout>","3E":"<layout><autosize hor=\"a;b;c\" ver=\"c\" rows=\"3\" cols=\"1\"/><table data=\"a;b;c\"/><row><cell obj=\"a\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b;c\"/></row><row sep=\"yes\"><cell sep=\"hor\" top=\"a\" bottom=\"b;c\" dblclick=\"a\"/></row><row><cell obj=\"b\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b;c\"/></row><row sep=\"yes\"><cell sep=\"hor\" top=\"a;b\" bottom=\"c\" dblclick=\"b\"/></row><row><cell obj=\"c\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b;c\"/></row></layout>","3W":"<layout><autosize hor=\"c\" ver=\"a;b;c\" rows=\"1\" cols=\"3\"/><table data=\"a,b,c\"/><row><cell obj=\"a\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b;c\"/><cell sep=\"ver\" left=\"a\" right=\"b;c\" dblclick=\"a\"/><cell obj=\"b\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b;c\"/><cell sep=\"ver\" left=\"a;b\" right=\"c\" dblclick=\"b\"/><cell obj=\"c\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b;c\"/></row></layout>","3J":"<layout><autosize hor=\"b\" ver=\"b;c\" rows=\"2\" cols=\"2\"/><table data=\"a,b;c,b\"/><row><cell obj=\"a\" wh=\"2,2\" resize=\"ver\" neighbors=\"a;c\"/><cell sep=\"ver\" left=\"a,c\" right=\"b\" dblclick=\"b\" rowspan=\"3\"/><cell obj=\"b\" wh=\"2,1\" resize=\"hor\" neighbors=\"a,c;b\" rowspan=\"3\"/></row><row sep=\"yes\"><cell sep=\"hor\" top=\"a\" bottom=\"c\" dblclick=\"a\"/></row><row><cell obj=\"c\" wh=\"2,2\" resize=\"ver\" neighbors=\"a;c\"/></row></layout>","3T":"<layout><autosize hor=\"a;c\" ver=\"b;c\" rows=\"2\" cols=\"2\"/><table data=\"a,a;b,c\"/><row><cell obj=\"a\" wh=\"1,2\" resize=\"ver\" neighbors=\"a;b,c\" colspan=\"3\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a\" bottom=\"b,c\" dblclick=\"a\" colspan=\"3\"/></row><row><cell obj=\"b\" wh=\"2,2\" resize=\"hor\" neighbors=\"b;c\"/><cell sep=\"ver\" left=\"b\" right=\"c\" dblclick=\"b\"/><cell obj=\"c\" wh=\"2,2\" resize=\"hor\" neighbors=\"b;c\"/></row></layout>","3L":"<layout><autosize hor=\"b;c\" ver=\"a;c\" rows=\"2\" cols=\"2\"/><table data=\"a,b;a,c\"/><row><cell obj=\"a\" wh=\"2,1\" resize=\"hor\" neighbors=\"a;b,c\" rowspan=\"3\"/><cell sep=\"ver\" left=\"a\" right=\"b,c\" dblclick=\"a\" rowspan=\"3\"/><cell obj=\"b\" wh=\"2,2\" resize=\"ver\" neighbors=\"b;c\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"b\" dblclick=\"b\" bottom=\"c\"/></row><row><cell obj=\"c\" wh=\"b,2\" resize=\"ver\" neighbors=\"b;c\"/></row></layout>","3U":"<layout><autosize hor=\"b;c\" ver=\"c\" rows=\"2\" cols=\"2\"/><table data=\"a,b;c,c\"/><row><cell obj=\"a\" wh=\"2,2\" resize=\"hor\" neighbors=\"a;b\"/><cell sep=\"ver\" left=\"a\" right=\"b\" dblclick=\"a\"/><cell obj=\"b\" wh=\"2,2\" resize=\"hor\" neighbors=\"a;b\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a,b\" bottom=\"c\" dblclick=\"c\" colspan=\"3\"/></row><row><cell obj=\"c\" wh=\"1,2\" resize=\"ver\" neighbors=\"a,b;c\" colspan=\"3\"/></row></layout>","4H":"<layout><autosize hor=\"d\" ver=\"a;c;d\" rows=\"2\" cols=\"3\"/><table data=\"a,b,d;a,c,d\"/><row><cell obj=\"a\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b,c;d\" rowspan=\"3\"/><cell sep=\"ver\" left=\"a\" right=\"b,c;d\" dblclick=\"a\" rowspan=\"3\"/><cell obj=\"b\" wh=\"3,2\" resize=\"ver\" neighbors=\"b;c\"/><cell sep=\"ver\" left=\"a;b,c\" right=\"d\" dblclick=\"d\" rowspan=\"3\"/><cell obj=\"d\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b,c;d\" rowspan=\"3\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"b\" dblclick=\"b\" bottom=\"c\"/></row><row><cell obj=\"c\" wh=\"3,2\" resize=\"ver\" neighbors=\"b;c\"/></row></layout>","4I":"<layout><autosize hor=\"a;c;d\" ver=\"d\" rows=\"3\" cols=\"2\"/><table data=\"a,a;b,c;d,d\"/><row><cell obj=\"a\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c;d\" colspan=\"3\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a\" bottom=\"b,c;d\" dblclick=\"a\" colspan=\"3\"/></row><row><cell obj=\"b\" wh=\"2,3\" resize=\"hor\" neighbors=\"b;c\"/><cell sep=\"ver\" left=\"b\" dblclick=\"b\" right=\"c\"/><cell obj=\"c\" wh=\"2,3\" resize=\"hor\" neighbors=\"b;c\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a;b,c\" bottom=\"d\" dblclick=\"d\" colspan=\"3\"/></row><row><cell obj=\"d\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c;d\" colspan=\"3\"/></row></layout>","4T":"<layout><autosize hor=\"a;d\" ver=\"b;c;d\" rows=\"2\" cols=\"3\"/><table data=\"a,a,a;b,c,d\"/><row><cell obj=\"a\" wh=\"1,2\" resize=\"ver\" neighbors=\"a;b,c,d\" colspan=\"5\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a\" bottom=\"b,c,d\" dblclick=\"a\" colspan=\"5\"/></row><row><cell obj=\"b\" wh=\"3,2\" resize=\"hor\" neighbors=\"b;c;d\"/><cell sep=\"ver\" left=\"b\" right=\"c;d\" dblclick=\"b\"/><cell obj=\"c\" wh=\"3,2\" resize=\"hor\" neighbors=\"b;c;d\"/><cell sep=\"ver\" left=\"b;c\" right=\"d\" dblclick=\"c\"/><cell obj=\"d\" wh=\"3,2\" resize=\"hor\" neighbors=\"b;c;d\"/></row></layout>","4U":"<layout><autosize hor=\"c;d\" ver=\"d\" rows=\"2\" cols=\"3\"/><table data=\"a,b,c;d,d,d\"/><row><cell obj=\"a\" wh=\"3,2\" resize=\"hor\" neighbors=\"a;b;c\"/><cell sep=\"ver\" left=\"a\" right=\"b;c\" dblclick=\"a\"/><cell obj=\"b\" wh=\"3,2\" resize=\"hor\" neighbors=\"a;b;c\"/><cell sep=\"ver\" left=\"a;b\" right=\"c\" dblclick=\"b\"/><cell obj=\"c\" wh=\"3,2\" resize=\"hor\" neighbors=\"a;b;c\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a,b,c\" bottom=\"d\" dblclick=\"d\" colspan=\"5\"/></row><row><cell obj=\"d\" wh=\"1,2\" resize=\"ver\" neighbors=\"a,b,c;d\" colspan=\"5\"/></row></layout>","5H":"<layout><autosize hor=\"b;c;d\" ver=\"a;c;e\" rows=\"3\" cols=\"3\"/><table data=\"a,b,e;a,c,e;a,d,e\"/><row><cell obj=\"a\" wh=\"3,1\" resize=\"hor\" neighbors=\"a;b,c,d\" rowspan=\"5\"/><cell sep=\"ver\" left=\"a\" right=\"b,c,d;e\" dblclick=\"a\" rowspan=\"5\"/><cell obj=\"b\" wh=\"3,3\" resize=\"ver\" neighbors=\"b;c;d\"/><cell sep=\"ver\" left=\"a;b,c,d\" right=\"e\" dblclick=\"e\" rowspan=\"5\"/><cell obj=\"e\" wh=\"3,1\" resize=\"hor\" neighbors=\"b,c,d;e\" rowspan=\"5\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"b\" dblclick=\"b\" bottom=\"c;d\"/></row><row><cell obj=\"c\" wh=\"3,3\" resize=\"ver\" neighbors=\"b;c;d\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"b;c\" dblclick=\"c\" bottom=\"d\"/></row><row><cell obj=\"d\" wh=\"3,3\" resize=\"ver\" neighbors=\"b;c;d\"/></row></layout>","5I":"<layout><autosize hor=\"a;d;e\" ver=\"e\" rows=\"3\" cols=\"3\"/><table data=\"a,a,a;b,c,d;e,e,e\"/><row><cell obj=\"a\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c,d;e\" colspan=\"5\"/></row><row sep=\"match\"><cell sep=\"hor\" top=\"a\" bottom=\"b,c,d;e\" dblclick=\"a\" colspan=\"5\"/></row><row><cell obj=\"b\" wh=\"3,3\" resize=\"hor\" neighbors=\"b;c;d\"/><cell sep=\"ver\" left=\"b\" right=\"c;d\" dblclick=\"b\"/><cell obj=\"c\" wh=\"3,3\" resize=\"hor\" neighbors=\"b;c;d\"/><cell sep=\"ver\" left=\"b;c\" right=\"d\" dblclick=\"c\"/><cell obj=\"d\" wh=\"3,3\" resize=\"hor\" neighbors=\"b;c;d\"/></row><row sep=\"match\"><cell sep=\"hor\" top=\"a;b,c,d\" bottom=\"e\" dblclick=\"e\" colspan=\"5\"/></row><row><cell obj=\"e\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c,d;e\" colspan=\"5\"/></row></layout>","6I":"<layout><autosize hor=\"a;e;f\" ver=\"f\" rows=\"3\" cols=\"4\"/><table data=\"a,a,a,a;b,c,d,e;f,f,f,f\"/><row><cell obj=\"a\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c,d,e;f\" colspan=\"7\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a\" bottom=\"b,c,d,e;f\" dblclick=\"a\" colspan=\"7\"/></row><row><cell obj=\"b\" wh=\"4,3\" resize=\"hor\" neighbors=\"b;c;d;e\"/><cell sep=\"ver\" left=\"b\" right=\"c;d;e\" dblclick=\"b\"/><cell obj=\"c\" wh=\"4,3\" resize=\"hor\" neighbors=\"b;c;d;e\"/><cell sep=\"ver\" left=\"b;c\" right=\"d;e\" dblclick=\"c\"/><cell obj=\"d\" wh=\"4,3\" resize=\"hor\" neighbors=\"b;c;d;e\"/><cell sep=\"ver\" left=\"b;c;d\" right=\"e\" dblclick=\"d\"/><cell obj=\"e\" wh=\"4,3\" resize=\"hor\" neighbors=\"b;c;d;e\"/></row><row sep=\"true\"><cell sep=\"hor\" top=\"a;b,c,d,e\" bottom=\"f\" dblclick=\"f\" colspan=\"7\"/></row><row><cell obj=\"f\" wh=\"1,3\" resize=\"ver\" neighbors=\"a;b,c,d,e;f\" colspan=\"7\"/></row></layout>"};dhtmlXLayoutObject.prototype._availAutoSize={"1C_hor":new Array("a"),"1C_ver":new Array("a"),"2E_hor":new Array("a;b"),"2E_ver":new Array("a","b"),"2U_hor":new Array("a","b"),"2U_ver":new Array("a;b"),"3E_hor":new Array("a;b;c"),"3E_ver":new Array("a","b","c"),"3W_hor":new Array("a","b","c"),"3W_ver":new Array("a;b;c"),"3J_hor":new Array("a;c","b"),"3J_ver":new Array("a;b","c;b"),"3T_hor":new Array("a;b","a;c"),"3T_ver":new Array("a","b;c"),"3L_hor":new Array("a","b;c"),"3L_ver":new Array("a;b","a;c"),"3U_hor":new Array("a;c","b;c"),"3U_ver":new Array("a;b","c"),"4H_hor":new Array("a","b;c","d"),"4H_ver":new Array("a;b;d","a;c;d"),"4I_hor":new Array("a;b;d","a;c;d"),"4I_ver":new Array("a","b;c","d"),"4T_hor":new Array("a;b","a;c","a;d"),"4T_ver":new Array("a","b;c;d"),"4U_hor":new Array("a;d","b;d","c;d"),"4U_ver":new Array("a;b;c","d"),"5H_hor":new Array("a","b;c;d","e"),"5H_ver":new Array("a;b;e","a;c;e","a;d;e"),"5I_hor":new Array("a;b;e","a;c;e","a;d;e"),"5I_ver":new Array("a","b;c;d","e"),"6I_hor":new Array("a;b;f","a;c;f","a;d;f","a;e;f"),"6I_ver":new Array("a","b;c;d;e","f")};dhtmlXLayoutObject.prototype.setCollapsedText=function(C,A){if(!this.polyObj[C])return;var D=this.polyObj[C].childNodes[0].childNodes[0];if(D.childNodes[D.childNodes.length-1]._ct===true)var B=D.childNodes[D.childNodes.length-1];else{B=document.createElement("DIV");B._ct=true;B.className="dhtmlxInfoBarLabel_collapsed_"+this.polyObj[C]._resize;D.appendChild(B)}B.innerHTML=A;this._fixCollapsedText();D=null};dhtmlXLayoutObject.prototype._fixCollapsedText=function(){for(var A in this.polyObj)if(this.polyObj[A]._resize=="hor"){var B=this.polyObj[A].childNodes[0].childNodes[0];if(B.childNodes[B.childNodes.length-1]._ct===true)B.childNodes[B.childNodes.length-1].style.width=Math.max(0,B.offsetHeight-B.childNodes[4].offsetTop-B.childNodes[4].offsetHeight-12)+"px"}};dhtmlXLayoutObject.prototype.i18n={dhxcontalert:"dhtmlxcontainer.js is missed on the page",collapse:"Collapse",expand:"Expand",dock:"Dock",undock:"UnDock"};(function(){dhtmlx.extend_api("dhtmlXLayoutObject",{_init:function(A){return[A.parent,A.pattern,A.skin]},image_path:"setImagePath",effect:"_effect",cells:"_cells",autosize:"_autosize"},{_cells:function(A){for(var B=0;B<A.length;B++){var D=A[B],C=this.cells(D.id);if(C){if(D.height)C.setHeight(D.height);if(D.width)C.setWidth(D.width);if(D.text)C.setText(D.text);if(D.collapse)C.collapse();if(D.fix_size)C.fixSize(D.fix_size[0],D.fix_size[1]);if(D.header===false)C.hideHeader()}}},_autosize:function(A){this.setAutoSize(A[0],A[1])},_effect:function(A){if(A.collapse)this.setEffect("collapse",A.collapse);if(A.resize)this.setEffect("resize",A.resize);if(A.highlight)this.setEffect("highlight",A.highlight)}})})();dhtmlXLayoutObject.prototype.attachHeader=function(A){if(this._ha)return;if(typeof(A)!="object")A=document.getElementById(A);var B=A.offsetHeight+(this.skin=="dhx_web"?9:2)+2;this.cont.obj._offsetTop=B;this.cont.obj._offsetHeight=-B;this.setSizes();this._ha=document.createElement("DIV");this._ha.style.position="absolute";this._ha.style.top="2px";this._ha.style.left=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.left;this._ha.style.width=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.width;this._ha.style.height=A.offsetHeight+"px";document.body.appendChild(this._ha);this._ha.appendChild(A);this._haEv=this.attachEvent("onResizeFinish",function(){this._ha.style.width=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.width})};dhtmlXLayoutObject.prototype.attachFooter=function(A){if(this._fa)return;if(typeof(A)!="object")A=document.getElementById(A);var B=A.offsetHeight+(this.skin=="dhx_web"?9:2)-2;this.cont.obj._offsetHeight=this.cont.obj._offsetHeight-B;this.setSizes();this._fa=document.createElement("DIV");this._fa.style.position="absolute";this._fa.style.bottom="2px";this._fa.style.left=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.left;this._fa.style.width=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.width;this._fa.style.height=A.offsetHeight+"px";document.body.appendChild(this._fa);this._fa.appendChild(A);this._faEv=this.attachEvent("onResizeFinish",function(){this._fa.style.width=this.cont.obj.vs[this.cont.obj.av].dhxcont.style.width})};dhtmlXLayoutObject.prototype._fixToolbars=function(){if(!_isIE)return;for(var A in this.polyObj)if(this.polyObj[A].vs[this.polyObj[A].av].toolbar!=null)this.polyObj[A].vs[this.polyObj[A].av].toolbar._fixSpacer()};dhtmlXLayoutObject.prototype._hideBorders=function(){if(this.skin!="dhx_terrace")return;this._cpm_old=this.skinParams[this.skin].cell_pading_max;this.skinParams[this.skin].cell_pading_max=[1,0,0,0];for(var A in this.polyObj){this.polyObj[A]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_layout_"+this.skin);this.polyObj[A].adjustContent(this.polyObj[A].childNodes[0],this.skinParams[this.skin]["cpanel_height"])}};function dhtmlXMenuObject(D,G){var C=this;this.addBaseIdAsContextZone=null;this.isDhtmlxMenuObject=true;this.skin=(G!=null?G:(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:"dhx_skyblue"));this.imagePath="";this._isIE6=false;if(_isIE)this._isIE6=(window.XMLHttpRequest==null?true:false);if(D==null)this.base=document.body;else{var E=(typeof(D)=="string"?document.getElementById(D):D);if(E!=null){this.base=E;if(!this.base.id)this.base.id=(new Date()).valueOf();while(this.base.childNodes.length>0)this.base.removeChild(this.base.childNodes[0]);this.base.className+=" dhtmlxMenu_"+this.skin+"_Middle dir_left";this.base._autoSkinUpdate=true;if(this.base.oncontextmenu)this.base._oldContextMenuHandler=this.base.oncontextmenu;this.addBaseIdAsContextZone=this.base.id;this.base.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.base.oncontextmenu=function(A){A=A||event;A.returnValue=false;return false}}else this.base=document.body}this.topId="dhxWebMenuTopId";if(!this.extendedModule){var A=function(){alert(this.i18n.dhxmenuextalert)},F=new Array("setItemEnabled","setItemDisabled","isItemEnabled","_changeItemState","getItemText","setItemText","loadFromHTML","hideItem","showItem","isItemHidden","_changeItemVisible","setUserData","getUserData","setOpenMode","setWebModeTimeout","enableDynamicLoading","_updateLoaderIcon","getItemImage","setItemImage","clearItemImage","setAutoShowMode","setAutoHideMode","setContextMenuHideAllMode","getContextMenuHideAllMode","setVisibleArea","setTooltip","getTooltip","setHotKey","getHotKey","setItemSelected","setTopText","setRTL","setAlign","setHref","clearHref","getCircuit","_clearAllSelectedSubItemsInPolygon","_checkArrowsState","_addUpArrow","_addDownArrow","_removeUpArrow","_removeDownArrow","_isArrowExists","_doScrollUp","_doScrollDown","_countPolygonItems","setOverflowHeight","_getRadioImgObj","_setRadioState","_radioOnClickHandler","getRadioChecked","setRadioChecked","addRadioButton","_getCheckboxState","_setCheckboxState","_readLevel","_updateCheckboxImage","_checkboxOnClickHandler","setCheckboxState","getCheckboxState","addCheckbox","serialize");for(var B=0;B<F.length;B++)if(!this[F[B]])this[F[B]]=A;F=null}this.fixedPosition=false;this.menuSelected=-1;this.menuLastClicked=-1;this.idPrefix="";this.itemTagName="item";this.itemTextTagName="itemtext";this.userDataTagName="userdata";this.itemTipTagName="tooltip";this.itemHotKeyTagName="hotkey";this.itemHrefTagName="href";this.dirTopLevel="bottom";this.dirSubLevel="right";this.menuX1=null;this.menuX2=null;this.menuY1=null;this.menuY2=null;this.menuMode="web";this.menuTimeoutMsec=400;this.menuTimeoutHandler=null;this.autoOverflow=false;this.idPull={};this.itemPull={};this.userData={};this.radio={};this._rtl=false;this._align="left";this.menuTouched=false;this.zIndInit=1200;this.zInd=this.zIndInit;this.zIndStep=50;this.menuModeTopLevelTimeout=true;this.menuModeTopLevelTimeoutTime=200;this._topLevelBottomMargin=1;this._topLevelRightMargin=0;this._topLevelOffsetLeft=1;this._arrowFFFix=(_isIE?(document.compatMode=="BackCompat"?0:-4):-4);this.setSkin=function(C){var B=this.skin;this.skin=C;switch(this.skin){case"dhx_black":case"dhx_blue":case"dhx_skyblue":case"dhx_web":this._topLevelBottomMargin=2;this._topLevelRightMargin=1;this._topLevelOffsetLeft=1;this._arrowFFFix=(_isIE?(document.compatMode=="BackCompat"?0:-4):-4);break;case"dhx_web":this._arrowFFFix=0;break;case"dhx_terrace":this._topLevelBottomMargin=0;this._topLevelRightMargin=0;this._topLevelOffsetLeft=0;this._arrowFFFix=(_isIE?(document.compatMode=="BackCompat"?0:-4):-4);break}if(this.base._autoSkinUpdate)this.base.className=this.base.className.replace("dhtmlxMenu_"+B+"_Middle","")+" dhtmlxMenu_"+this.skin+"_Middle";for(var A in this.idPull)this.idPull[A].className=String(this.idPull[A].className).replace(B,this.skin)};this.setSkin(this.skin);this.dLoad=false;this.dLoadUrl="";this.dLoadSign="?";this.loaderIcon=false;this.limit=0;this._scrollUpTM=null;this._scrollUpTMTime=20;this._scrollUpTMStep=3;this._scrollDownTM=null;this._scrollDownTMTime=20;this._scrollDownTMStep=3;this.context=false;this.contextZones={};this.contextMenuZoneId=false;this.contextAutoShow=true;this.contextAutoHide=true;this.contextHideAllMode=true;this._selectedSubItems=new Array();this._openedPolygons=new Array();this._addSubItemToSelected=function(D,A){var B=true;for(var C=0;C<this._selectedSubItems.length;C++)if((this._selectedSubItems[C][0]==D)&&(this._selectedSubItems[C][1]==A))B=false;if(B==true)this._selectedSubItems.push(new Array(D,A));return B};this._removeSubItemFromSelected=function(D,A){var E=new Array(),B=false;for(var C=0;C<this._selectedSubItems.length;C++)if((this._selectedSubItems[C][0]==D)&&(this._selectedSubItems[C][1]==A))B=true;else E[E.length]=this._selectedSubItems[C];if(B==true)this._selectedSubItems=E;return B};this._getSubItemToDeselectByPolygon=function(B){var E=new Array();for(var D=0;D<this._selectedSubItems.length;D++)if(this._selectedSubItems[D][1]==B){E[E.length]=this._selectedSubItems[D][0];E=E.concat(this._getSubItemToDeselectByPolygon(this._selectedSubItems[D][0]));var C=true;for(var A=0;A<this._openedPolygons.length;A++)if(this._openedPolygons[A]==this._selectedSubItems[D][0])C=false;if(C==true)this._openedPolygons[this._openedPolygons.length]=this._selectedSubItems[D][0];this._selectedSubItems[D][0]=-1;this._selectedSubItems[D][1]=-1}return E};this._hidePolygon=function(A){if(this.idPull["polygon_"+A]!=null){if(typeof(this._menuEffect)!="undefined"&&this._menuEffect!==false)this._hidePolygonEffect("polygon_"+A);else{if(this.idPull["polygon_"+A].style.display=="none")return;this.idPull["polygon_"+A].style.display="none";if(this.idPull["arrowup_"+A]!=null)this.idPull["arrowup_"+A].style.display="none";if(this.idPull["arrowdown_"+A]!=null)this.idPull["arrowdown_"+A].style.display="none";this._updateItemComplexState(A,true,false);if(this._isIE6)if(this.idPull["polygon_"+A+"_ie6cover"]!=null)this.idPull["polygon_"+A+"_ie6cover"].style.display="none"}A=String(A).replace(this.idPrefix,"");if(A==this.topId)A=null;this.callEvent("onHide",[A]);if(A!=null&&this.skin=="dhx_terrace"&&this.itemPull[this.idPrefix+A].parent==this.idPrefix+this.topId)this._improveTerraceButton(this.idPrefix+A,true)}};this._showPolygon=function(N,G){var T=this._countVisiblePolygonItems(N);if(T==0)return;var O="polygon_"+N;if((this.idPull[O]!=null)&&(this.idPull[N]!=null)){if(this.menuModeTopLevelTimeout&&this.menuMode=="web"&&!this.context)if(!this.idPull[N]._mouseOver&&G==this.dirTopLevel)return;if(!this.fixedPosition)this._autoDetectVisibleArea();var Q=0,L=0,A=null,H=null;this.idPull[O].style.visibility="hidden";this.idPull[O].style.left="0px";this.idPull[O].style.top="0px";this.idPull[O].style.display="";this.idPull[O].style.zIndex=this.zInd;if(this.autoOverflow)if(this.idPull[O].firstChild.offsetHeight>this.menuY1+this.menuY2){var B=Math.floor((this.menuY2-this.menuY1-35)/24);this.limit=B}else{this.limit=0;if(this.idPull["arrowup_"+N]!=null)this._removeUpArrow(String(N).replace(this.idPrefix,""));if(this.idPull["arrowdown_"+N]!=null)this._removeDownArrow(String(N).replace(this.idPrefix,""))}if(this.limit>0&&this.limit<T){if(this.idPull["arrowup_"+N]==null)this._addUpArrow(String(N).replace(this.idPrefix,""));if(this.idPull["arrowdown_"+N]==null)this._addDownArrow(String(N).replace(this.idPrefix,""));A=this.idPull["arrowup_"+N];A.style.visibility="hidden";A.style.display="";A.style.zIndex=this.zInd;Q=A.offsetHeight;H=this.idPull["arrowdown_"+N];H.style.visibility="hidden";H.style.display="";H.style.zIndex=this.zInd;L=H.offsetHeight}if(this.limit>0)if(this.limit<T){this.idPull[O].style.height=24*this.limit+"px";this.idPull[O].scrollTop=0}else this.idPull[O].style.height="";this.zInd+=this.zIndStep;if(this.itemPull[N]!=null)var P="polygon_"+this.itemPull[N]["parent"];else if(this.context)P=this.idPull[this.idPrefix+this.topId];var D=(this.idPull[N].tagName!=null?getAbsoluteLeft(this.idPull[N]):this.idPull[N][0]),C=(this.idPull[N].tagName!=null?getAbsoluteTop(this.idPull[N]):this.idPull[N][1]),J=(this.idPull[N].tagName!=null?this.idPull[N].offsetWidth:0),R=(this.idPull[N].tagName!=null?this.idPull[N].offsetHeight:0),V=0,U=0,M=this.idPull[O].offsetWidth,I=this.idPull[O].offsetHeight+Q+L;if(G=="bottom"){if(this._rtl)V=D+(J!=null?J:0)-M;else if(this._align=="right")V=D+J-M;else V=D-1+(G==this.dirTopLevel?this._topLevelRightMargin:0);U=C-1+R+this._topLevelBottomMargin}if(G=="right"){V=D+J-1;U=C+2}if(G=="left"){V=D-this.idPull[O].offsetWidth+2;U=C+2}if(G=="top"){V=D-1;U=C-I+2}if(this.fixedPosition)var E=65536,F=65536;else{E=(this.menuX2!=null?this.menuX2:0),F=(this.menuY2!=null?this.menuY2:0);if(E==0)if(window.innerWidth){E=window.innerWidth;F=window.innerHeight}else{E=document.body.offsetWidth;F=document.body.scrollHeight}}if(V+M>E&&!this._rtl)V=D-M+2;if(V<this.menuX1&&this._rtl)V=D+J-2;if(V<0)V=0;if(U+I>F&&this.menuY2!=null){U=Math.max(C+R-I+2,(this._isVisibleArea?this.menuY1+2:2));if(this.context&&this.idPrefix+this.topId==N&&H!=null)U=U-2;if(this.itemPull[N]!=null&&!this.context)if(this.itemPull[N]["parent"]==this.idPrefix+this.topId)U=U-this.base.offsetHeight}this.idPull[O].style.left=V+"px";this.idPull[O].style.top=U+Q+"px";if(typeof(this._menuEffect)!="undefined"&&this._menuEffect!==false)this._showPolygonEffect(O);else{this.idPull[O].style.visibility="";if(this.limit>0&&this.limit<T){A.style.left=V+"px";A.style.top=U+"px";A.style.width=M+this._arrowFFFix+"px";A.style.visibility="";H.style.left=V+"px";H.style.top=U+I-L+"px";H.style.width=M+this._arrowFFFix+"px";H.style.visibility="";this._checkArrowsState(N)}if(this._isIE6){var S=O+"_ie6cover";if(this.idPull[S]==null){var K=document.createElement("IFRAME");K.className="dhtmlxMenu_IE6CoverFix_"+this.skin;K.frameBorder=0;K.setAttribute("src","javascript:false;");document.body.insertBefore(K,document.body.firstChild);this.idPull[S]=K}this.idPull[S].style.left=V+"px";this.idPull[S].style.top=U+"px";this.idPull[S].style.width=M+"px";this.idPull[S].style.height=I+"px";this.idPull[S].style.zIndex=this.idPull[O].style.zIndex-1;this.idPull[S].style.display=""}}N=String(N).replace(this.idPrefix,"");if(N==this.topId)N=null;this.callEvent("onShow",[N]);if(N!=null&&this.skin=="dhx_terrace"&&this.itemPull[this.idPrefix+N].parent==this.idPrefix+this.topId)this._improveTerraceButton(this.idPrefix+N,false)}};this._redistribSubLevelSelection=function(A,B){while(this._openedPolygons.length>0)this._openedPolygons.pop();var E=this._getSubItemToDeselectByPolygon(B);this._removeSubItemFromSelected(-1,-1);for(var C=0;C<E.length;C++)if((this.idPull[E[C]]!=null)&&(E[C]!=A))if(this.itemPull[E[C]]["state"]=="enabled")this.idPull[E[C]].className="sub_item";for(C=0;C<this._openedPolygons.length;C++)if(this._openedPolygons[C]!=B)this._hidePolygon(this._openedPolygons[C]);if(this.itemPull[A]["state"]=="enabled"){this.idPull[A].className="sub_item_selected";if(this.itemPull[A]["complex"]&&this.dLoad&&(this.itemPull[A]["loaded"]=="no")){if(this.loaderIcon==true)this._updateLoaderIcon(A,true);var D=new dtmlXMLLoaderObject(this._xmlParser,window);this.itemPull[A]["loaded"]="get";this.callEvent("onXLS",[]);D.loadXML(this.dLoadUrl+this.dLoadSign+"action=loadMenu&parentId="+A.replace(this.idPrefix,"")+"&etc="+new Date().getTime())}if(this.itemPull[A]["complex"]||(this.dLoad&&(this.itemPull[A]["loaded"]=="yes")))if((this.itemPull[A]["complex"])&&(this.idPull["polygon_"+A]!=null)){this._updateItemComplexState(A,true,true);this._showPolygon(A,this.dirSubLevel)}this._addSubItemToSelected(A,B);this.menuSelected=A}};this._doOnClick=function(A,H,B){this.menuLastClicked=A;if(this.itemPull[this.idPrefix+A]["href_link"]!=null&&this.itemPull[this.idPrefix+A].state=="enabled"){var C=document.createElement("FORM"),I=String(this.itemPull[this.idPrefix+A]["href_link"]).split("?");C.action=I[0];if(I[1]!=null){var E=String(I[1]).split("&");for(var D=0;D<E.length;D++){var G=String(E[D]).split("="),F=document.createElement("INPUT");F.type="hidden";F.name=(G[0]||"");F.value=(G[1]||"");C.appendChild(F)}}if(this.itemPull[this.idPrefix+A]["href_target"]!=null)C.target=this.itemPull[this.idPrefix+A]["href_target"];C.style.display="none";document.body.appendChild(C);C.submit();if(C!=null){document.body.removeChild(C);C=null}return}if(H.charAt(0)=="c")return;if(H.charAt(1)=="d")return;if(H.charAt(2)=="s")return;if(this.checkEvent("onClick"))this.callEvent("onClick",[A,this.contextMenuZoneId,B]);else if((H.charAt(1)=="d")||(this.menuMode=="win"&&H.charAt(2)=="t"))return;if(this.context&&this._isContextMenuVisible()&&this.contextAutoHide)this._hideContextMenu();else if(this._clearAndHide)this._clearAndHide()};this._doOnTouchMenu=function(A){if(this.menuTouched==false){this.menuTouched=true;if(this.checkEvent("onTouch"))this.callEvent("onTouch",[A])}};this._searchMenuNode=function(A,C){var D=new Array();for(var B=0;B<C.length;B++)if(typeof(C[B])=="object"){if(C[B].length==5)if(typeof(C[B][0])!="object")if((C[B][0].replace(this.idPrefix,"")==A)&&(B==0))D=C;var E=this._searchMenuNode(A,C[B]);if(E.length>0)D=E}return D};this._getMenuNodes=function(A){var C=new Array;for(var B in this.itemPull)if(this.itemPull[B]["parent"]==A)C[C.length]=B;return C};this._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B+=D.charAt(Math.round(Math.random()*(D.length-1)));return B};this.getItemType=function(A){A=this.idPrefix+A;if(this.itemPull[A]==null)return null;return this.itemPull[A]["type"]};this.forEachItem=function(B){for(var A in this.itemPull)B(String(A).replace(this.idPrefix,""))};this._clearAndHide=function(){C.menuSelected=-1;C.menuLastClicked=-1;while(C._openedPolygons.length>0)C._openedPolygons.pop();for(var B=0;B<C._selectedSubItems.length;B++){var A=C._selectedSubItems[B][0];if(C.idPull[A]!=null)if(C.itemPull[A]["state"]=="enabled"){if(C.idPull[A].className=="sub_item_selected")C.idPull[A].className="sub_item";if(C.idPull[A].className=="dhtmlxMenu_"+C.skin+"_TopLevel_Item_Selected")if(C.itemPull[A]["cssNormal"]!=null)C.idPull[A].className=C.itemPull[A]["cssNormal"];else C.idPull[A].className="dhtmlxMenu_"+C.skin+"_TopLevel_Item_Normal"}C._hidePolygon(A)}C.menuTouched=false;if(C.context)if(C.contextHideAllMode){C._hidePolygon(C.idPrefix+C.topId);C.zInd=C.zIndInit}else C.zInd=C.zIndInit+C.zIndStep};this._doOnLoad=function(){};this.loadXML=function(B,A){if(A)this._doOnLoad=function(){A()};this.callEvent("onXLS",[]);this._xmlLoader.loadXML(B)};this.loadXMLString=function(B,A){if(A)this._doOnLoad=function(){A()};this._xmlLoader.loadXMLString(B)};this._buildMenu=function(E,B){var D=0;for(var G=0;G<E.childNodes.length;G++)if(E.childNodes[G].tagName==this.itemTagName){var F=E.childNodes[G],H={};H["id"]=this.idPrefix+(F.getAttribute("id")||this._genStr(24));H["title"]=F.getAttribute("text")||"";H["imgen"]=F.getAttribute("img")||"";H["imgdis"]=F.getAttribute("imgdis")||"";H["tip"]="";H["hotkey"]="";if(F.getAttribute("cssNormal")!=null)H["cssNormal"]=F.getAttribute("cssNormal");H["type"]=F.getAttribute("type")||"item";if(H["type"]=="checkbox"){H["checked"]=(F.getAttribute("checked")!=null);H["imgen"]="chbx_"+(H["checked"]?"1":"0");H["imgdis"]=H["imgen"]}if(H["type"]=="radio"){H["checked"]=(F.getAttribute("checked")!=null);H["imgen"]="rdbt_"+(H["checked"]?"1":"0");H["imgdis"]=H["imgen"];H["group"]=F.getAttribute("group")||this._genStr(24);if(this.radio[H["group"]]==null)this.radio[H["group"]]=new Array();this.radio[H["group"]][this.radio[H["group"]].length]=H["id"]}H["state"]=(F.getAttribute("enabled")!=null||F.getAttribute("disabled")!=null?(F.getAttribute("enabled")=="false"||F.getAttribute("disabled")=="true"?"disabled":"enabled"):"enabled");H["parent"]=(B!=null?B:this.idPrefix+this.topId);H["complex"]=(this.dLoad?(F.getAttribute("complex")!=null?true:false):(this._buildMenu(F,H["id"])>0));if(this.dLoad&&H["complex"])H["loaded"]="no";this.itemPull[H["id"]]=H;for(var A=0;A<F.childNodes.length;A++){var I=F.childNodes[A].tagName;if(I!=null)I=I.toLowerCase();if(I==this.userDataTagName){var C=F.childNodes[A];if(C.getAttribute("name")!=null)this.userData[H["id"]+"_"+C.getAttribute("name")]=(C.firstChild!=null&&C.firstChild.nodeValue!=null?C.firstChild.nodeValue:"")}if(I==this.itemTextTagName)H["title"]=F.childNodes[A].firstChild.nodeValue;if(I==this.itemTipTagName)H["tip"]=F.childNodes[A].firstChild.nodeValue;if(I==this.itemHotKeyTagName)H["hotkey"]=F.childNodes[A].firstChild.nodeValue;if(I==this.itemHrefTagName&&H["type"]=="item"){H["href_link"]=F.childNodes[A].firstChild.nodeValue;if(F.childNodes[A].getAttribute("target")!=null)H["href_target"]=F.childNodes[A].getAttribute("target")}}D++}return D};this._xmlParser=function(){if(C.dLoad){var D=this.getXMLTopNode("menu");parentId=(D.getAttribute("parentId")!=null?D.getAttribute("parentId"):null);if(parentId==null){C._buildMenu(D,null);C._initTopLevelMenu()}else{C._buildMenu(D,C.idPrefix+parentId);C._addSubMenuPolygon(C.idPrefix+parentId,C.idPrefix+parentId);if(C.menuSelected==C.idPrefix+parentId){var A=C.idPrefix+parentId,G=C.itemPull[C.idPrefix+parentId]["parent"]==C.idPrefix+C.topId,B=((G&&(!C.context))?C.dirTopLevel:C.dirSubLevel),H=false;if(G&&C.menuModeTopLevelTimeout&&C.menuMode=="web"&&!C.context){var E=C.idPull[C.idPrefix+parentId];if(E._mouseOver==true){var F=C.menuModeTopLevelTimeoutTime-(new Date().getTime()-E._dynLoadTM);if(F>1){E._menuOpenTM=window.setTimeout(function(){C._showPolygon(A,B)},F);H=true}}}if(!H)C._showPolygon(A,B)}C.itemPull[C.idPrefix+parentId]["loaded"]="yes";if(C.loaderIcon==true)C._updateLoaderIcon(C.idPrefix+parentId,false)}this.destructor();C.callEvent("onXLE",[])}else{D=this.getXMLTopNode("menu");C._buildMenu(D,null);C.init();C.callEvent("onXLE",[]);C._doOnLoad()}};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._showSubLevelItem=function(A,B){if(document.getElementById("arrow_"+this.idPrefix+A)!=null)document.getElementById("arrow_"+this.idPrefix+A).style.display=(B?"none":"");if(document.getElementById("image_"+this.idPrefix+A)!=null)document.getElementById("image_"+this.idPrefix+A).style.display=(B?"none":"");if(document.getElementById(this.idPrefix+A)!=null)document.getElementById(this.idPrefix+A).style.display=(B?"":"none")};this._hideSubLevelItem=function(A){this._showSubLevelItem(A,true)};this.idPrefix=this._genStr(12);this._bodyClick=function(A){A=A||event;if(A.button==2||(_isOpera&&A.ctrlKey==true))return;if(C.context){if(C.contextAutoHide&&(!_isOpera||(C._isContextMenuVisible()&&_isOpera)))C._hideContextMenu()}else if(C._clearAndHide)C._clearAndHide()};this._bodyContext=function(D){D=D||event;var B=(D.srcElement||D.target).className;if(B.search("dhtmlxMenu")!=-1&&B.search("SubLevelArea")!=-1)return;var E=true,A=D.target||D.srcElement;while(A!=null){if(A.id!=null)if(C.isContextZone(A.id))E=false;if(A==document.body)E=false;A=A.parentNode}if(E)C.hideContextMenu()};if(_isIE){document.body.attachEvent("onclick",this._bodyClick);document.body.attachEvent("oncontextmenu",this._bodyContext)}else{window.addEventListener("click",this._bodyClick,false);window.addEventListener("contextmenu",this._bodyContext,false)}this._UID=this._genStr(32);dhtmlxMenuObjectLiveInstances[this._UID]=this;dhtmlxEventable(this);return this}dhtmlXMenuObject.prototype.init=function(){if(this._isInited==true)return;if(this.dLoad){this.callEvent("onXLS",[]);this._xmlLoader.loadXML(this.dLoadUrl+this.dLoadSign+"action=loadMenu&etc="+new Date().getTime())}else{this._initTopLevelMenu();this._isInited=true}};dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(B){var C=0;for(var E in this.itemPull){var A=this.itemPull[E]["parent"],D=this.itemPull[E]["type"];if(this.idPull[E]!=null)if(A==B&&(D=="item"||D=="radio"||D=="checkbox")&&this.idPull[E].style.display!="none")C++}return C};dhtmlXMenuObject.prototype._redefineComplexState=function(A){if(this.idPrefix+this.topId==A)return;if((this.idPull["polygon_"+A]!=null)&&(this.idPull[A]!=null)){var B=this._countVisiblePolygonItems(A);if((B>0)&&(!this.itemPull[A]["complex"]))this._updateItemComplexState(A,true,false);if((B==0)&&(this.itemPull[A]["complex"]))this._updateItemComplexState(A,false,false)}};dhtmlXMenuObject.prototype._updateItemComplexState=function(A,E,B){if((!this.context)&&(this._getItemLevelType(A.replace(this.idPrefix,""))=="TopLevel")){this.itemPull[A]["complex"]=E;return}if((this.idPull[A]==null)||(this.itemPull[A]==null))return;this.itemPull[A]["complex"]=E;if(A==this.idPrefix+this.topId)return;var C=null,D=this.idPull[A].childNodes[this._rtl?0:2];if(D.childNodes[0])if(String(D.childNodes[0].className).search("complex_arrow")===0)C=D.childNodes[0];if(this.itemPull[A]["complex"]){if(C==null){C=document.createElement("DIV");C.className="complex_arrow";C.id="arrow_"+A;while(D.childNodes.length>0)D.removeChild(D.childNodes[0]);D.appendChild(C)}if(this.dLoad&&(this.itemPull[A]["loaded"]=="get")&&this.loaderIcon){if(C.className!="complex_arrow_loading")C.className="complex_arrow_loading"}else C.className="complex_arrow";return}if((!this.itemPull[A]["complex"])&&(C!=null)){D.removeChild(C);if(this.itemPull[A]["hotkey_backup"]!=null&&this.setHotKey)this.setHotKey(A.replace(this.idPrefix,""),this.itemPull[A]["hotkey_backup"])}};dhtmlXMenuObject.prototype._getItemLevelType=function(A){return(this.itemPull[this.idPrefix+A]["parent"]==this.idPrefix+this.topId?"TopLevel":"SubLevelArea")};dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(A,C){var D=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var B=0;B<D.length;B++){if(D[B]!=A)this._hidePolygon(D[B]);if((this.idPull[D[B]]!=null)&&(D[B]!=A))this.idPull[D[B]].className=this.idPull[D[B]].className.replace(/Selected/g,"Normal")}if(this.itemPull[this.idPrefix+A]["state"]=="enabled"){this.idPull[this.idPrefix+A].className="dhtmlxMenu_"+this.skin+"_TopLevel_Item_Selected";this._addSubItemToSelected(this.idPrefix+A,"parent");this.menuSelected=(this.menuMode=="win"?(this.menuSelected!=-1?A:this.menuSelected):A);if((this.itemPull[this.idPrefix+A]["complex"])&&(this.menuSelected!=-1))this._showPolygon(this.idPrefix+A,this.dirTopLevel)}};dhtmlXMenuObject.prototype._initTopLevelMenu=function(){this.dirTopLevel="bottom";this.dirSubLevel=(this._rtl?"left":"right");if(this.context){this.idPull[this.idPrefix+this.topId]=new Array(0,0);this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId)}else{var B=this._getMenuNodes(this.idPrefix+this.topId);for(var A=0;A<B.length;A++){if(this.itemPull[B[A]]["type"]=="item")this._renderToplevelItem(B[A],null);if(this.itemPull[B[A]]["type"]=="separator")this._renderSeparator(B[A],null)}}};dhtmlXMenuObject.prototype._renderToplevelItem=function(A,G){var E=this,F=document.createElement("DIV");F.id=A;if(this.itemPull[A]["state"]=="enabled"&&this.itemPull[A]["cssNormal"]!=null)F.className=this.itemPull[A]["cssNormal"];else F.className="dhtmlxMenu_"+this.skin+"_TopLevel_Item_"+(this.itemPull[A]["state"]=="enabled"?"Normal":"Disabled");if(this.itemPull[A]["title"]!=""){var B=document.createElement("DIV");B.className="top_level_text";B.innerHTML=this.itemPull[A]["title"];F.appendChild(B)}if(this.itemPull[A]["tip"].length>0)F.title=this.itemPull[A]["tip"];if((this.itemPull[A]["imgen"]!="")||(this.itemPull[A]["imgdis"]!="")){var C=this.itemPull[A][(this.itemPull[A]["state"]=="enabled")?"imgen":"imgdis"];if(C){var D=document.createElement("IMG");D.border="0";D.id="image_"+A;D.src=this.imagePath+C;D.className="dhtmlxMenu_TopLevel_Item_Icon";if(F.childNodes.length>0&&!this._rtl)F.insertBefore(D,F.childNodes[0]);else F.appendChild(D)}}F.onselectstart=function(A){A=A||event;A.returnValue=false;return false};F.oncontextmenu=function(A){A=A||event;A.returnValue=false;return false};if(!this.cont){this.cont=document.createElement("DIV");this.cont.dir="ltr";this.cont.className=(this._align=="right"?"align_right":"align_left");this.base.appendChild(this.cont)}if(G!=null){G++;if(G<0)G=0;if(G>this.cont.childNodes.length-1)G=null}if(G!=null)this.cont.insertBefore(F,this.cont.childNodes[G]);else this.cont.appendChild(F);this.idPull[F.id]=F;if(this.itemPull[A]["complex"]&&(!this.dLoad))this._addSubMenuPolygon(this.itemPull[A]["id"],this.itemPull[A]["id"]);F.onmouseover=function(){if(E.menuMode=="web")window.clearTimeout(E.menuTimeoutHandler);var D=E._getSubItemToDeselectByPolygon("parent");E._removeSubItemFromSelected(-1,-1);for(var A=0;A<D.length;A++){if(D[A]!=this.id)E._hidePolygon(D[A]);if((E.idPull[D[A]]!=null)&&(D[A]!=this.id))if(E.itemPull[D[A]]["cssNormal"]!=null)E.idPull[D[A]].className=E.itemPull[D[A]]["cssNormal"];else{if(E.idPull[D[A]].className=="sub_item_selected")E.idPull[D[A]].className="sub_item";E.idPull[D[A]].className=E.idPull[D[A]].className.replace(/Selected/g,"Normal")}}if(E.itemPull[this.id]["state"]=="enabled"){this.className="dhtmlxMenu_"+E.skin+"_TopLevel_Item_Selected";E._addSubItemToSelected(this.id,"parent");E.menuSelected=(E.menuMode=="win"?(E.menuSelected!=-1?this.id:E.menuSelected):this.id);if(E.dLoad&&(E.itemPull[this.id]["loaded"]=="no")){if(E.menuModeTopLevelTimeout&&E.menuMode=="web"&&!E.context){this._mouseOver=true;this._dynLoadTM=new Date().getTime()}var C=new dtmlXMLLoaderObject(E._xmlParser,window);E.itemPull[this.id]["loaded"]="get";E.callEvent("onXLS",[]);C.loadXML(E.dLoadUrl+E.dLoadSign+"action=loadMenu&parentId="+this.id.replace(E.idPrefix,"")+"&etc="+new Date().getTime())}if((!E.dLoad)||(E.dLoad&&(!E.itemPull[this.id]["loaded"]||E.itemPull[this.id]["loaded"]=="yes")))if((E.itemPull[this.id]["complex"])&&(E.menuSelected!=-1))if(E.menuModeTopLevelTimeout&&E.menuMode=="web"&&!E.context){this._mouseOver=true;var B=this.id;this._menuOpenTM=window.setTimeout(function(){E._showPolygon(B,E.dirTopLevel)},E.menuModeTopLevelTimeoutTime)}else E._showPolygon(this.id,E.dirTopLevel)}E._doOnTouchMenu(this.id.replace(E.idPrefix,""))};F.onmouseout=function(){if(!((E.itemPull[this.id]["complex"])&&(E.menuSelected!=-1))&&(E.itemPull[this.id]["state"]=="enabled"))if(E.itemPull[this.id]["cssNormal"]!=null)F.className=E.itemPull[this.id]["cssNormal"];else F.className="dhtmlxMenu_"+E.skin+"_TopLevel_Item_Normal";if(E.menuMode=="web"){window.clearTimeout(E.menuTimeoutHandler);E.menuTimeoutHandler=window.setTimeout(function(){E._clearAndHide()},E.menuTimeoutMsec,"JavaScript")}if(E.menuModeTopLevelTimeout&&E.menuMode=="web"&&!E.context){this._mouseOver=false;window.clearTimeout(this._menuOpenTM)}};F.onclick=function(B){if(E.menuMode=="web")window.clearTimeout(E.menuTimeoutHandler);if(E.menuMode!="web"&&E.itemPull[this.id]["state"]=="disabled")return;B=B||event;B.cancelBubble=true;B.returnValue=false;if(E.menuMode=="win")if(E.itemPull[this.id]["complex"]){if(E.menuSelected==this.id){E.menuSelected=-1;var C=false}else{E.menuSelected=this.id;C=true}if(C)E._showPolygon(this.id,E.dirTopLevel);else E._hidePolygon(this.id)}var D=(E.itemPull[this.id]["complex"]?"c":"-"),F=(E.itemPull[this.id]["state"]!="enabled"?"d":"-"),A={"ctrl":B.ctrlKey,"alt":B.altKey,"shift":B.shiftKey};E._doOnClick(this.id.replace(E.idPrefix,""),D+F+"t",A);return false};if(this.skin=="dhx_terrace")this._improveTerraceSkin()};dhtmlXMenuObject.prototype.setImagePath=function(){};dhtmlXMenuObject.prototype.setIconsPath=function(A){this.imagePath=A};dhtmlXMenuObject.prototype.setIconPath=dhtmlXMenuObject.prototype.setIconsPath;dhtmlXMenuObject.prototype._updateItemImage=function(A,C){A=this.idPrefix+A;var E=(this.itemPull[A]["parent"]==this.idPrefix+this.topId&&!this.context),B=null;if(E){for(var G=0;G<this.idPull[A].childNodes.length;G++){try{if(this.idPull[A].childNodes[G].className=="dhtmlxMenu_TopLevel_Item_Icon")B=this.idPull[A].childNodes[G]}catch(D){}}}else{try{B=this.idPull[A].childNodes[this._rtl?2:0].childNodes[0]}catch(D){}}if(this.itemPull[A]["type"]=="radio")var F=this.itemPull[A][(this.itemPull[A]["state"]=="enabled"?"imgen":"imgdis")];else F=this.itemPull[A][(this.itemPull[A]["state"]=="enabled"?"imgen":"imgdis")];if(F.length>0){if(B!=null)B.src=this.imagePath+F;else if(E){B=document.createElement("IMG");B.className="dhtmlxMenu_TopLevel_Item_Icon";B.src=this.imagePath+F;B.border="0";B.id="image_"+A;if(!this._rtl&&this.idPull[A].childNodes.length>0)this.idPull[A].insertBefore(B,this.idPull[A].childNodes[0]);else this.idPull[A].appendChild(B)}else{B=document.createElement("IMG");B.className="sub_icon";B.src=this.imagePath+F;B.border="0";B.id="image_"+A;var H=this.idPull[A].childNodes[this._rtl?2:0];while(H.childNodes.length>0)H.removeChild(H.childNodes[0]);H.appendChild(B)}}else if(B!=null)B.parentNode.removeChild(B)};dhtmlXMenuObject.prototype.removeItem=function(A,K,F){if(!K)A=this.idPrefix+A;var B=null;if(A!=this.idPrefix+this.topId){if(this.itemPull[A]==null)return;if(this.idPull["polygon_"+A]&&this.idPull["polygon_"+A]._tmShow)window.clearTimeout(this.idPull["polygon_"+A]._tmShow);var C=this.itemPull[A]["type"];if(C=="separator"){var J=this.idPull["separator_"+A];if(this.itemPull[A]["parent"]==this.idPrefix+this.topId){J.onclick=null;J.onselectstart=null;J.id=null;J.parentNode.removeChild(J)}else{J.childNodes[0].childNodes[0].onclick=null;J.childNodes[0].childNodes[0].onselectstart=null;J.childNodes[0].childNodes[0].id=null;J.childNodes[0].removeChild(J.childNodes[0].childNodes[0]);J.removeChild(J.childNodes[0]);J.parentNode.removeChild(J)}this.idPull["separator_"+A]=null;this.itemPull[A]=null;delete this.idPull["separator_"+A];delete this.itemPull[A];J=null}else{B=this.itemPull[A]["parent"];J=this.idPull[A];J.onclick=null;J.oncontextmenu=null;J.onmouseover=null;J.onmouseout=null;J.onselectstart=null;J.id=null;while(J.childNodes.length>0)J.removeChild(J.childNodes[0]);J.parentNode.removeChild(J);this.idPull[A]=null;this.itemPull[A]=null;delete this.idPull[A];delete this.itemPull[A];J=null}C=null}for(var I in this.itemPull)if(this.itemPull[I]["parent"]==A)this.removeItem(I,true,true);var D=new Array(A);if(B!=null&&!F)if(this.idPull["polygon_"+B]!=null)if(this.idPull["polygon_"+B].tbd.childNodes.length==0){D.push(B);this._updateItemComplexState(B,false,false)}for(var E=0;E<D.length;E++)if(this.idPull["polygon_"+D[E]]){var H=this.idPull["polygon_"+D[E]];H.onclick=null;H.oncontextmenu=null;H.tbl.removeChild(H.tbd);H.tbd=null;H.removeChild(H.tbl);H.tbl=null;H.id=null;H.parentNode.removeChild(H);H=null;if(this._isIE6){var G="polygon_"+D[E]+"_ie6cover";if(this.idPull[G]!=null){document.body.removeChild(this.idPull[G]);delete this.idPull[G]}}if(this.idPull["arrowup_"+A]!=null&&this._removeArrow)this._removeArrow("arrowup_"+A);if(this.idPull["arrowdown_"+A]!=null&&this._removeArrow)this._removeArrow("arrowdown_"+A);this.idPull["polygon_"+D[E]]=null;delete this.idPull["polygon_"+D[E]]}D=null;if(this.skin=="dhx_terrace"&&arguments.length==1)this._improveTerraceSkin()};dhtmlXMenuObject.prototype._getAllParents=function(A){var B=new Array();for(var E in this.itemPull)if(this.itemPull[E]["parent"]==A){B[B.length]=this.itemPull[E]["id"];if(this.itemPull[E]["complex"]){var C=this._getAllParents(this.itemPull[E]["id"]);for(var D=0;D<C.length;D++)B[B.length]=C[D]}}return B};dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.context=true;if(this.base._autoSkinUpdate==true){this.base.className=this.base.className.replace("dhtmlxMenu_"+this.skin+"_Middle","");this.base._autoSkinUpdate=false}if(this.addBaseIdAsContextZone!=null)this.addContextZone(this.addBaseIdAsContextZone)};dhtmlXMenuObject.prototype.addContextZone=function(E){if(E==document.body){E="document.body."+this.idPrefix;var D=document.body}else D=document.getElementById(E);var B=false;for(var A in this.contextZones)B=B||(A==E)||(this.contextZones[A]==D);if(B==true)return false;this.contextZones[E]=D;var C=this;if(_isOpera){this.operaContext=function(A){C._doOnContextMenuOpera(A,C)};D.addEventListener("mouseup",this.operaContext,false)}else{if(D.oncontextmenu!=null&&!D._oldContextMenuHandler)D._oldContextMenuHandler=D.oncontextmenu;D.oncontextmenu=function(A){for(var B in dhtmlxMenuObjectLiveInstances)if(B!=C._UID)if(dhtmlxMenuObjectLiveInstances[B].context)dhtmlxMenuObjectLiveInstances[B]._hideContextMenu();A=A||event;A.cancelBubble=true;A.returnValue=false;C._doOnContextBeforeCall(A,this);return false}}};dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(A,C){for(var B in dhtmlxMenuObjectLiveInstances)if(B!=C._UID)if(dhtmlxMenuObjectLiveInstances[B].context)dhtmlxMenuObjectLiveInstances[B]._hideContextMenu();A.cancelBubble=true;A.returnValue=false;if(A.button==0&&A.ctrlKey==true)C._doOnContextBeforeCall(A,this);return false};dhtmlXMenuObject.prototype.removeContextZone=function(C){if(!this.isContextZone(C))return false;if(C==document.body)C="document.body."+this.idPrefix;var B=this.contextZones[C];if(_isOpera)B.removeEventListener("mouseup",this.operaContext,false);else{B.oncontextmenu=(B._oldContextMenuHandler!=null?B._oldContextMenuHandler:null);B._oldContextMenuHandler=null}try{this.contextZones[C]=null;delete this.contextZones[C]}catch(A){}return true};dhtmlXMenuObject.prototype.isContextZone=function(B){if(B==document.body&&this.contextZones["document.body."+this.idPrefix]!=null)return true;var A=false;if(this.contextZones[B]!=null)if(this.contextZones[B]==document.getElementById(B))A=true;return A};dhtmlXMenuObject.prototype._isContextMenuVisible=function(){if(this.idPull["polygon_"+this.idPrefix+this.topId]==null)return false;return(this.idPull["polygon_"+this.idPrefix+this.topId].style.display=="")};dhtmlXMenuObject.prototype._showContextMenu=function(C,A,B){this._clearAndHide();if(this.idPull["polygon_"+this.idPrefix+this.topId]==null)return false;window.clearTimeout(this.menuTimeoutHandler);this.idPull[this.idPrefix+this.topId]=new Array(C,A);this._showPolygon(this.idPrefix+this.topId,"bottom");this.callEvent("onContextMenu",[B])};dhtmlXMenuObject.prototype._hideContextMenu=function(){if(this.idPull["polygon_"+this.idPrefix+this.topId]==null)return false;this._clearAndHide();this._hidePolygon(this.idPrefix+this.topId);this.zInd=this.zIndInit};dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(B,A){this.contextMenuZoneId=A.id;this._clearAndHide();this._hideContextMenu();var E=(B.srcElement||B.target),C=(_isIE||_isOpera||_KHTMLrv?B.offsetX:B.layerX),D=(_isIE||_isOpera||_KHTMLrv?B.offsetY:B.layerY),F=getAbsoluteLeft(E)+C,G=getAbsoluteTop(E)+D;if(this.checkEvent("onBeforeContextMenu")){if(this.callEvent("onBeforeContextMenu",[A.id,B]))if(this.contextAutoShow){this._showContextMenu(F,G);this.callEvent("onAfterContextMenu",[A.id,B])}}else if(this.contextAutoShow){this._showContextMenu(F,G);this.callEvent("onAfterContextMenu",[A.id])}};dhtmlXMenuObject.prototype.showContextMenu=function(B,A){this._showContextMenu(B,A,false)};dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()};dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(this._isVisibleArea)return;this.menuX1=document.body.scrollLeft;this.menuX2=this.menuX1+(window.innerWidth||document.body.clientWidth);this.menuY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.menuY2=this.menuY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};dhtmlXMenuObject.prototype.getItemPosition=function(A){A=this.idPrefix+A;var E=-1;if(this.itemPull[A]==null)return E;var C=this.itemPull[A]["parent"],D=(this.idPull["polygon_"+C]!=null?this.idPull["polygon_"+C].tbd:this.cont);for(var B=0;B<D.childNodes.length;B++)if(D.childNodes[B]==this.idPull["separator_"+A]||D.childNodes[B]==this.idPull[A])E=B;return E};dhtmlXMenuObject.prototype.setItemPosition=function(A,G){A=this.idPrefix+A;if(this.idPull[A]==null)return;var F=(this.itemPull[A]["parent"]==this.idPrefix+this.topId),B=this.idPull[A],E=this.getItemPosition(A.replace(this.idPrefix,"")),C=this.itemPull[A]["parent"],D=(this.idPull["polygon_"+C]!=null?this.idPull["polygon_"+C].tbd:this.cont);D.removeChild(D.childNodes[E]);if(G<0)G=0;if(F&&G<1)G=1;if(G<D.childNodes.length)D.insertBefore(B,D.childNodes[G]);else D.appendChild(B)};dhtmlXMenuObject.prototype.getParentId=function(A){A=this.idPrefix+A;if(this.itemPull[A]==null)return null;return((this.itemPull[A]["parent"]!=null?this.itemPull[A]["parent"]:this.topId).replace(this.idPrefix,""))};dhtmlXMenuObject.prototype.addNewSibling=function(C,G,D,H,F,E){var A=this.idPrefix+(G!=null?G:this._genStr(24)),B=this.idPrefix+(C!=null?this.getParentId(C):this.topId);this._addItemIntoGlobalStrorage(A,B,D,"item",H,F,E);if((B==this.idPrefix+this.topId)&&(!this.context))this._renderToplevelItem(A,this.getItemPosition(C));else this._renderSublevelItem(A,this.getItemPosition(C))};dhtmlXMenuObject.prototype.addNewChild=function(A,G,E,B,F,D,C){if(A==null)if(this.context)A=this.topId;else{this.addNewSibling(A,E,B,F,D,C);if(G!=null)this.setItemPosition(E,G);return}E=this.idPrefix+(E!=null?E:this._genStr(24));if(this.setHotKey)this.setHotKey(A,"");A=this.idPrefix+A;this._addItemIntoGlobalStrorage(E,A,B,"item",F,D,C);if(this.idPull["polygon_"+A]==null)this._renderSublevelPolygon(A,A);this._renderSublevelItem(E,G-1);this._redefineComplexState(A)};dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(G,A,F,D,H,E,B){var C={id:G,title:F,imgen:(E!=null?E:""),imgdis:(B!=null?B:""),type:D,state:(H==true?"disabled":"enabled"),parent:A,complex:false,hotkey:"",tip:""};this.itemPull[C.id]=C};dhtmlXMenuObject.prototype._addSubMenuPolygon=function(A,B){var D=this._renderSublevelPolygon(A,B),F=this._getMenuNodes(B);for(E=0;E<F.length;E++)if(this.itemPull[F[E]]["type"]=="separator")this._renderSeparator(F[E],null);else this._renderSublevelItem(F[E],null);if(A==B)var C="topLevel";else C="subLevel";for(var E=0;E<F.length;E++)if(this.itemPull[F[E]]["complex"])this._addSubMenuPolygon(A,this.itemPull[F[E]]["id"])};dhtmlXMenuObject.prototype._renderSublevelPolygon=function(B,C){var D=document.createElement("DIV");D.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_Polygon "+(this._rtl?"dir_right":"");D.dir="ltr";D.oncontextmenu=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};D.id="polygon_"+C;D.onclick=function(A){A=A||event;A.cancelBubble=true};D.style.display="none";document.body.insertBefore(D,document.body.firstChild);var A=document.createElement("TABLE");A.className="dhtmlxMebu_SubLevelArea_Tbl";A.cellSpacing=0;A.cellPadding=0;A.border=0;var E=document.createElement("TBODY");A.appendChild(E);D.appendChild(A);D.tbl=A;D.tbd=E;this.idPull[D.id]=D;if(this.sxDacProc!=null){this.idPull["sxDac_"+C]=new this.sxDacProc(D,D.className);if(_isIE){this.idPull["sxDac_"+C]._setSpeed(this.dacSpeedIE);this.idPull["sxDac_"+C]._setCustomCycle(this.dacCyclesIE)}else{this.idPull["sxDac_"+C]._setSpeed(this.dacSpeed);this.idPull["sxDac_"+C]._setCustomCycle(this.dacCycles)}}return D};dhtmlXMenuObject.prototype._renderSublevelItem=function(M,K){var J=this,G=document.createElement("TR");G.className=(this.itemPull[M]["state"]=="enabled"?"sub_item":"sub_item_dis");var E=document.createElement("TD");E.className="sub_item_icon";var C=this.itemPull[M][(this.itemPull[M]["state"]=="enabled"?"imgen":"imgdis")];if(C!=""){var H=this.itemPull[M]["type"];if(H=="checkbox"||H=="radio"){var I=document.createElement("DIV");I.id="image_"+this.itemPull[M]["id"];I.className="sub_icon "+C;E.appendChild(I)}if(!(H=="checkbox"||H=="radio")){I=document.createElement("IMG");I.id="image_"+this.itemPull[M]["id"];I.className="sub_icon";I.src=this.imagePath+C;E.appendChild(I)}}var D=document.createElement("TD");D.className="sub_item_text";if(this.itemPull[M]["title"]!=""){var A=document.createElement("DIV");A.className="sub_item_text";A.innerHTML=this.itemPull[M]["title"];D.appendChild(A)}else D.innerHTML="&nbsp;";var B=document.createElement("TD");B.className="sub_item_hk";if(this.itemPull[M]["complex"]){var F=document.createElement("DIV");F.className="complex_arrow";F.id="arrow_"+this.itemPull[M]["id"];B.appendChild(F)}else if(this.itemPull[M]["hotkey"].length>0&&!this.itemPull[M]["complex"]){var N=document.createElement("DIV");N.className="sub_item_hk";N.innerHTML=this.itemPull[M]["hotkey"];B.appendChild(N)}else B.innerHTML="&nbsp;";G.appendChild(this._rtl?B:E);G.appendChild(D);G.appendChild(this._rtl?E:B);G.id=this.itemPull[M]["id"];G.parent=this.itemPull[M]["parent"];if(this.itemPull[M]["tip"].length>0)G.title=this.itemPull[M]["tip"];if(!this._hideTMData)this._hideTMData={};G.onselectstart=function(A){A=A||event;A.returnValue=false;return false};G.onmouseover=function(A){if(J.menuMode=="web"){if(J._hideTMData[this.id])window.clearTimeout(J._hideTMData[this.id]);window.clearTimeout(J.menuTimeoutHandler)}if(!this._visible)J._redistribSubLevelSelection(this.id,this.parent);this._visible=true};if(J.menuMode=="web")G.onmouseout=function(){if(J.menuTimeoutHandler)window.clearTimeout(J.menuTimeoutHandler);J.menuTimeoutHandler=window.setTimeout(function(){J._clearAndHide()},J.menuTimeoutMsec,"JavaScript");var A=this;if(J._hideTMData[this.id])window.clearTimeout(J._hideTMData[this.id]);J._hideTMData[this.id]=window.setTimeout(function(){A._visible=false},50)};G.onclick=function(B){if(!J.checkEvent("onClick")&&J.itemPull[this.id]["complex"])return;B=B||event;B.cancelBubble=true;B.returnValue=false;tc=(J.itemPull[this.id]["complex"]?"c":"-");td=(J.itemPull[this.id]["state"]=="enabled"?"-":"d");var A={"ctrl":B.ctrlKey,"alt":B.altKey,"shift":B.shiftKey};switch(J.itemPull[this.id]["type"]){case"checkbox":J._checkboxOnClickHandler(this.id.replace(J.idPrefix,""),tc+td+"n",A);break;case"radio":J._radioOnClickHandler(this.id.replace(J.idPrefix,""),tc+td+"n",A);break;case"item":J._doOnClick(this.id.replace(J.idPrefix,""),tc+td+"n",A);break}return false};var L=this.idPull["polygon_"+this.itemPull[M]["parent"]];if(K!=null){K++;if(K<0)K=0;if(K>L.tbd.childNodes.length-1)K=null}if(K!=null&&L.tbd.childNodes[K]!=null)L.tbd.insertBefore(G,L.tbd.childNodes[K]);else L.tbd.appendChild(G);this.idPull[G.id]=G};dhtmlXMenuObject.prototype._renderSeparator=function(B,I){var C=(this.context?"SubLevelArea":(this.itemPull[B]["parent"]==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"));if(C=="TopLevel"&&this.context)return;var F=this;if(C!="TopLevel"){var E=document.createElement("TR");E.className="sub_sep";var G=document.createElement("TD");G.colSpan="3";E.appendChild(G)}var H=document.createElement("DIV");H.id="separator_"+B;H.className=(C=="TopLevel"?"top_sep":"sub_sep");H.onselectstart=function(A){A=A||event;A.returnValue=false};H.onclick=function(B){B=B||event;B.cancelBubble=true;var A={"ctrl":B.ctrlKey,"alt":B.altKey,"shift":B.shiftKey};F._doOnClick(this.id.replace("separator_"+F.idPrefix,""),"--s",A)};if(C=="TopLevel"){if(I!=null){I++;if(I<0)I=0;if(this.cont.childNodes[I]!=null)this.cont.insertBefore(H,this.cont.childNodes[I]);else this.cont.appendChild(H)}else{var D=this.cont.childNodes[this.cont.childNodes.length-1];if(String(D).search("TopLevel_Text")==-1)this.cont.appendChild(H);else this.cont.insertBefore(H,D)}this.idPull[H.id]=H}else{var A=this.idPull["polygon_"+this.itemPull[B]["parent"]];if(I!=null){I++;if(I<0)I=0;if(I>A.tbd.childNodes.length-1)I=null}if(I!=null&&A.tbd.childNodes[I]!=null)A.tbd.insertBefore(E,A.tbd.childNodes[I]);else A.tbd.appendChild(E);G.appendChild(H);this.idPull[H.id]=E}};dhtmlXMenuObject.prototype.addNewSeparator=function(B,C){C=this.idPrefix+(C!=null?C:this._genStr(24));var A=this.idPrefix+this.getParentId(B);this._addItemIntoGlobalStrorage(C,A,"","separator",false,"","");this._renderSeparator(C,this.getItemPosition(B))};dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()};dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,true);this._isInited=false;this.idPrefix=this._genStr(12)};dhtmlXMenuObject.prototype.unload=function(){if(_isIE){document.body.detachEvent("onclick",this._bodyClick);document.body.detachEvent("oncontextmenu",this._bodyContext)}else{window.removeEventListener("click",this._bodyClick,false);window.removeEventListener("contextmenu",this._bodyContext,false)}this._bodyClick=null;this._bodyContext=null;this.removeItem(this.idPrefix+this.topId,true);this.itemPull=null;this.idPull=null;if(this.context)for(var B in this.contextZones)this.removeContextZone(B);if(this.cont!=null){this.cont.className="";this.cont.parentNode.removeChild(this.cont);this.cont=null}if(this.base!=null){this.base.className="";if(!this.context)this.base.oncontextmenu=(this.base._oldContextMenuHandler||null);this.base.onselectstart=null;this.base=null}this.setSkin=null;this.detachAllEvents();if(this._xmlLoader){this._xmlLoader.destructor();this._xmlLoader=null}this._align=null;this._arrowFFFix=null;this._isIE6=null;this._isInited=null;this._rtl=null;this._scrollDownTMStep=null;this._scrollDownTMTime=null;this._scrollUpTMStep=null;this._scrollUpTMTime=null;this._topLevelBottomMargin=null;this._topLevelOffsetLeft=null;this._topLevelBottomMargin=null;this._topLevelRightMargin=null;this.addBaseIdAsContextZone=null;this.context=null;this.contextAutoHide=null;this.contextAutoShow=null;this.contextHideAllMode=null;this.contextMenuZoneId=null;this.dLoad=null;this.dLoadSign=null;this.dLoadUrl=null;this.loaderIcon=null;this.fixedPosition=null;this.dirSubLevel=null;this.dirTopLevel=null;this.limit=null;this.menuSelected=null;this.menuLastClicked=null;this.idPrefix=null;this.imagePath=null;this.menuMode=null;this.menuModeTopLevelTimeout=null;this.menuModeTopLevelTimeoutTime=null;this.menuTimeoutHandler=null;this.menuTimeoutMsec=null;this.menuTouched=null;this.isDhtmlxMenuObject=null;this.itemHotKeyTagName=null;this.itemHrefTagName=null;this.itemTagName=null;this.itemTextTagName=null;this.itemTipTagName=null;this.userDataTagName=null;this.skin=null;this.topId=null;this.dacCycles=null;this.dacCyclesIE=null;this.dacSpeed=null;this.dacSpeedIE=null;this.zInd=null;this.zIndInit=null;this.zIndStep=null;this._enableDacSupport=null;this._selectedSubItems=null;this._openedPolygons=null;this._addSubItemToSelected=null;this._removeSubItemFromSelected=null;this._getSubItemToDeselectByPolygon=null;this._hidePolygon=null;this._showPolygon=null;this._redistribSubLevelSelection=null;this._doOnClick=null;this._doOnTouchMenu=null;this._searchMenuNode=null;this._getMenuNodes=null;this._genStr=null;this._clearAndHide=null;this._doOnLoad=null;this.getItemType=null;this.forEachItem=null;this.init=null;this.loadXML=null;this.loadXMLString=null;this._buildMenu=null;this._xmlParser=null;this._showSubLevelItem=null;this._hideSubLevelItem=null;this._countVisiblePolygonItems=null;this._redefineComplexState=null;this._updateItemComplexState=null;this._getItemLevelType=null;this._redistribTopLevelSelection=null;this._initTopLevelMenu=null;this._renderToplevelItem=null;this.setImagePath=null;this.setIconsPath=null;this.setIconPath=null;this._updateItemImage=null;this.removeItem=null;this._getAllParents=null;this.renderAsContextMenu=null;this.addContextZone=null;this.removeContextZone=null;this.isContextZone=null;this._isContextMenuVisible=null;this._showContextMenu=null;this._doOnContextBeforeCall=null;this._autoDetectVisibleArea=null;this._addItemIntoGlobalStrorage=null;this._addSubMenuPolygon=null;this._renderSublevelPolygon=null;this._renderSublevelItem=null;this._renderSeparator=null;this._hideContextMenu=null;this.clearAll=null;this.getItemPosition=null;this.setItemPosition=null;this.getParentId=null;this.addNewSibling=null;this.addNewChild=null;this.addNewSeparator=null;this.attachEvent=null;this.callEvent=null;this.checkEvent=null;this.eventCatcher=null;this.detachEvent=null;this.dhx_Event=null;this.unload=null;this.items=null;this.radio=null;this.detachAllEvents=null;this.hide=null;this.showContextMenu=null;this.hideContextMenu=null;this._changeItemState=null;this._changeItemVisible=null;this._updateLoaderIcon=null;this._clearAllSelectedSubItemsInPolygon=null;this._checkArrowsState=null;this._addUpArrow=null;this._addDownArrow=null;this._removeUpArrow=null;this._removeDownArrow=null;this._isArrowExists=null;this._doScrollUp=null;this._doScrollDown=null;this._countPolygonItems=null;this._getRadioImgObj=null;this._setRadioState=null;this._radioOnClickHandler=null;this._getCheckboxState=null;this._setCheckboxState=null;this._readLevel=null;this._updateCheckboxImage=null;this._checkboxOnClickHandler=null;this._removeArrow=null;this.setItemEnabled=null;this.setItemDisabled=null;this.isItemEnabled=null;this.getItemText=null;this.setItemText=null;this.loadFromHTML=null;this.hideItem=null;this.showItem=null;this.isItemHidden=null;this.setUserData=null;this.getUserData=null;this.setOpenMode=null;this.setWebModeTimeout=null;this.enableDynamicLoading=null;this.getItemImage=null;this.setItemImage=null;this.clearItemImage=null;this.setAutoShowMode=null;this.setAutoHideMode=null;this.setContextMenuHideAllMode=null;this.getContextMenuHideAllMode=null;this.setVisibleArea=null;this.setTooltip=null;this.getTooltip=null;this.setHotKey=null;this.getHotKey=null;this.setItemSelected=null;this.setTopText=null;this.setRTL=null;this.setAlign=null;this.setHref=null;this.clearHref=null;this.getCircuit=null;this.contextZones=null;this.setOverflowHeight=null;this.userData=null;this.getRadioChecked=null;this.setRadioChecked=null;this.addRadioButton=null;this.setCheckboxState=null;this.getCheckboxState=null;this.addCheckbox=null;this.serialize=null;this.extendedModule=null;dhtmlxMenuObjectLiveInstances[this._UID]=null;try{delete dhtmlxMenuObjectLiveInstances[this._UID]}catch(A){}this._UID=null};var dhtmlxMenuObjectLiveInstances={};dhtmlXMenuObject.prototype.i18n={dhxmenuextalert:"dhtmlxmenu_ext.js required"};(function(){dhtmlx.extend_api("dhtmlXMenuObject",{_init:function(A){return[A.parent,A.skin]},align:"setAlign",top_text:"setTopText",context:"renderAsContextMenu",icon_path:"setIconsPath",open_mode:"setOpenMode",rtl:"setRTL",skin:"setSkin",dynamic:"enableDynamicLoading",xml:"loadXML",items:"items",overflow:"setOverflowHeight"},{items:function(A,D){var F=100000,B=null;for(var E=0;E<A.length;E++){var C=A[E];if(C.type=="separator"){this.addNewSeparator(B,F,C.id);B=C.id}else{this.addNewChild(D,F,C.id,C.text,C.disabled,C.img,C.img_disabled);B=C.id;if(C.items)this.items(C.items,C.id)}}}})})();dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var C in this.itemPull)if(this.itemPull[C].parent==this.idPrefix+this.topId&&this.idPull[C]!=null){var B=false,D=false;if(this.idPull[C].parentNode.firstChild==this.idPull[C])B=true;if(this.idPull[C].parentNode.lastChild==this.idPull[C])D=true;for(var A in this.itemPull)if(this.itemPull[A].type=="separator"&&this.itemPull[A].parent==this.idPrefix+this.topId){if(this.idPull[C].nextSibling==this.idPull["separator_"+A])D=true;if(this.idPull[C].previousSibling==this.idPull["separator_"+A])B=true}this.idPull[C].style.borderLeft=(B?"1px solid #cecece":"0px solid white");this.idPull[C].style.borderTopLeftRadius=this.idPull[C].style.borderBottomLeftRadius=(B?"5px":"0px");this.idPull[C].style.borderTopRightRadius=this.idPull[C].style.borderBottomRightRadius=(D?"5px":"0px");this.idPull[C]._bl=B;this.idPull[C]._br=D}};dhtmlXMenuObject.prototype._improveTerraceButton=function(A,B){if(B){this.idPull[A].style.borderBottomLeftRadius=(this.idPull[A]._bl?"5px":"0px");this.idPull[A].style.borderBottomRightRadius=(this.idPull[A]._br?"5px":"0px")}else{this.idPull[A].style.borderBottomLeftRadius="0px";this.idPull[A].style.borderBottomRightRadius="0px"}};dhtmlXMenuObject.prototype.extendedModule="DHXMENUEXT";dhtmlXMenuObject.prototype.setItemEnabled=function(A){this._changeItemState(A,"enabled",this._getItemLevelType(A))};dhtmlXMenuObject.prototype.setItemDisabled=function(A){this._changeItemState(A,"disabled",this._getItemLevelType(A))};dhtmlXMenuObject.prototype.isItemEnabled=function(A){return(this.itemPull[this.idPrefix+A]!=null?(this.itemPull[this.idPrefix+A]["state"]=="enabled"):false)};dhtmlXMenuObject.prototype._changeItemState=function(A,E,B){var C=false,D=this.idPrefix+A;if((this.itemPull[D]!=null)&&(this.idPull[D]!=null))if(this.itemPull[D]["state"]!=E){this.itemPull[D]["state"]=E;if(this.itemPull[D]["parent"]==this.idPrefix+this.topId&&!this.context)this.idPull[D].className="dhtmlxMenu_"+this.skin+"_TopLevel_Item_"+(this.itemPull[D]["state"]=="enabled"?"Normal":"Disabled");else this.idPull[D].className="sub_item"+(this.itemPull[D]["state"]=="enabled"?"":"_dis");this._updateItemComplexState(this.idPrefix+A,this.itemPull[this.idPrefix+A]["complex"],false);this._updateItemImage(A,B);if((this.idPrefix+this.menuLastClicked==D)&&(B!="TopLevel"))this._redistribSubLevelSelection(D,this.itemPull[D]["parent"]);if(B=="TopLevel"&&!this.context);}return C};dhtmlXMenuObject.prototype.getItemText=function(A){return(this.itemPull[this.idPrefix+A]!=null?this.itemPull[this.idPrefix+A]["title"]:"")};dhtmlXMenuObject.prototype.setItemText=function(A,B){A=this.idPrefix+A;if((this.itemPull[A]!=null)&&(this.idPull[A]!=null)){this._clearAndHide();this.itemPull[A]["title"]=B;if(this.itemPull[A]["parent"]==this.idPrefix+this.topId&&!this.context){var E=null;for(var D=0;D<this.idPull[A].childNodes.length;D++){try{if(this.idPull[A].childNodes[D].className=="top_level_text")E=this.idPull[A].childNodes[D]}catch(C){}}if(String(this.itemPull[A]["title"]).length==""||this.itemPull[A]["title"]==null){if(E!=null)E.parentNode.removeChild(E)}else{if(!E){E=document.createElement("DIV");E.className="top_level_text";if(this._rtl&&this.idPull[A].childNodes.length>0)this.idPull[A].insertBefore(E,this.idPull[A].childNodes[0]);else this.idPull[A].appendChild(E)}E.innerHTML=this.itemPull[A]["title"]}}else{E=null;for(D=0;D<this.idPull[A].childNodes[1].childNodes.length;D++)if(String(this.idPull[A].childNodes[1].childNodes[D].className||"")=="sub_item_text")E=this.idPull[A].childNodes[1].childNodes[D];if(String(this.itemPull[A]["title"]).length==""||this.itemPull[A]["title"]==null){if(E){E.parentNode.removeChild(E);E=null;this.idPull[A].childNodes[1].innerHTML="&nbsp;"}}else{if(!E){E=document.createElement("DIV");E.className="sub_item_text";this.idPull[A].childNodes[1].innerHTML="";this.idPull[A].childNodes[1].appendChild(E)}E.innerHTML=this.itemPull[A]["title"]}}}};dhtmlXMenuObject.prototype.loadFromHTML=function(C,B,A){this.itemTagName="DIV";if(typeof(C)=="string")C=document.getElementById(C);this._buildMenu(C,null);this.init();if(B)C.parentNode.removeChild(C);if(A!=null)A()};dhtmlXMenuObject.prototype.hideItem=function(A){this._changeItemVisible(A,false)};dhtmlXMenuObject.prototype.showItem=function(A){this._changeItemVisible(A,true)};dhtmlXMenuObject.prototype.isItemHidden=function(B){var A=null;if(this.idPull[this.idPrefix+B]!=null)A=(this.idPull[this.idPrefix+B].style.display=="none");return A};dhtmlXMenuObject.prototype._changeItemVisible=function(A,B){var C=this.idPrefix+A;if(this.itemPull[C]==null)return;if(this.itemPull[C]["type"]=="separator")C="separator_"+C;if(this.idPull[C]==null)return;this.idPull[C].style.display=(B?"":"none");this._redefineComplexState(this.itemPull[this.idPrefix+A]["parent"])};dhtmlXMenuObject.prototype.setUserData=function(A,B,C){this.userData[this.idPrefix+A+"_"+B]=C};dhtmlXMenuObject.prototype.getUserData=function(A,B){return(this.userData[this.idPrefix+A+"_"+B]!=null?this.userData[this.idPrefix+A+"_"+B]:null)};dhtmlXMenuObject.prototype.setOpenMode=function(A){if(A=="win"||A=="web")this.menuMode=A;else this.menuMode=="web"};dhtmlXMenuObject.prototype.setWebModeTimeout=function(A){this.menuTimeoutMsec=(!isNaN(A)?A:400)};dhtmlXMenuObject.prototype.enableDynamicLoading=function(B,A){this.dLoad=true;this.dLoadUrl=B;this.dLoadSign=(String(this.dLoadUrl).search(/\?/)==-1?"?":"&");this.loaderIcon=A;this.init()};dhtmlXMenuObject.prototype._updateLoaderIcon=function(A,D){if(this.idPull[A]==null)return;if(String(this.idPull[A].className).search("TopLevel_Item")>=0)return;var B=(this._rtl?0:2);if(!this.idPull[A].childNodes[B])return;if(!this.idPull[A].childNodes[B].childNodes[0])return;var C=this.idPull[A].childNodes[B].childNodes[0];if(String(C.className).search("complex_arrow")===0)C.className="complex_arrow"+(D?"_loading":"")};dhtmlXMenuObject.prototype.getItemImage=function(A){var B=new Array(null,null);A=this.idPrefix+A;if(this.itemPull[A]["type"]=="item"){B[0]=this.itemPull[A]["imgen"];B[1]=this.itemPull[A]["imgdis"]}return B};dhtmlXMenuObject.prototype.setItemImage=function(A,C,B){if(this.itemPull[this.idPrefix+A]["type"]!="item")return;this.itemPull[this.idPrefix+A]["imgen"]=C;this.itemPull[this.idPrefix+A]["imgdis"]=B;this._updateItemImage(A,this._getItemLevelType(A))};dhtmlXMenuObject.prototype.clearItemImage=function(A){this.setItemImage(A,"","")};dhtmlXMenuObject.prototype.setAutoShowMode=function(A){this.contextAutoShow=(A==true?true:false)};dhtmlXMenuObject.prototype.setAutoHideMode=function(A){this.contextAutoHide=(A==true?true:false)};dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(A){this.contextHideAllMode=(A==true?true:false)};dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.contextHideAllMode};dhtmlXMenuObject.prototype.setVisibleArea=function(D,C,A,B){this._isVisibleArea=true;this.menuX1=D;this.menuX2=C;this.menuY1=A;this.menuY2=B};dhtmlXMenuObject.prototype.setTooltip=function(A,B){A=this.idPrefix+A;if(!(this.itemPull[A]!=null&&this.idPull[A]!=null))return;this.idPull[A].title=(B.length>0?B:null);this.itemPull[A]["tip"]=B};dhtmlXMenuObject.prototype.getTooltip=function(A){if(this.itemPull[this.idPrefix+A]==null)return null;return this.itemPull[this.idPrefix+A]["tip"]};dhtmlXMenuObject.prototype.setHotKey=function(A,F){A=this.idPrefix+A;if(!(this.itemPull[A]!=null&&this.idPull[A]!=null))return;if(this.itemPull[A]["parent"]==this.idPrefix+this.topId&&!this.context)return;if(this.itemPull[A]["complex"])return;var C=this.itemPull[A]["type"];if(!(C=="item"||C=="checkbox"||C=="radio"))return;var E=null;try{if(this.idPull[A].childNodes[this._rtl?0:2].childNodes[0].className=="sub_item_hk")E=this.idPull[A].childNodes[this._rtl?0:2].childNodes[0]}catch(B){}if(F.length==0){this.itemPull[A]["hotkey_backup"]=this.itemPull[A]["hotkey"];this.itemPull[A]["hotkey"]="";if(E!=null)E.parentNode.removeChild(E)}else{this.itemPull[A]["hotkey"]=F;this.itemPull[A]["hotkey_backup"]=null;if(E==null){E=document.createElement("DIV");E.className="sub_item_hk";var D=this.idPull[A].childNodes[this._rtl?0:2];while(D.childNodes.length>0)D.removeChild(D.childNodes[0]);D.appendChild(E)}E.innerHTML=F}};dhtmlXMenuObject.prototype.getHotKey=function(A){if(this.itemPull[this.idPrefix+A]==null)return null;return this.itemPull[this.idPrefix+A]["hotkey"]};dhtmlXMenuObject.prototype.setItemSelected=function(A){if(this.itemPull[this.idPrefix+A]==null)return null};dhtmlXMenuObject.prototype.setTopText=function(A){if(this.context)return;if(this._topText==null){this._topText=document.createElement("DIV");this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this._rtl?"left":(this._align=="left"?"right":"left"));this.base.appendChild(this._topText)}this._topText.innerHTML=A};dhtmlXMenuObject.prototype.setAlign=function(A){if(this._align==A)return;if(A=="left"||A=="right"){this._align=A;if(this.cont)this.cont.className=(this._align=="right"?"align_right":"align_left");if(this._topText!=null)this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this._align=="left"?"right":"left")}};dhtmlXMenuObject.prototype.setHref=function(B,C,A){if(this.itemPull[this.idPrefix+B]==null)return;this.itemPull[this.idPrefix+B]["href_link"]=C;if(A!=null)this.itemPull[this.idPrefix+B]["href_target"]=A};dhtmlXMenuObject.prototype.clearHref=function(A){if(this.itemPull[this.idPrefix+A]==null)return;delete this.itemPull[this.idPrefix+A]["href_link"];delete this.itemPull[this.idPrefix+A]["href_target"]};dhtmlXMenuObject.prototype.getCircuit=function(A){var B=new Array(A);while(this.getParentId(A)!=this.topId){A=this.getParentId(A);B[B.length]=A}return B.reverse()};dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(A){var C=this._getSubItemToDeselectByPolygon(A);for(var B=0;B<this._openedPolygons.length;B++)if(this._openedPolygons[B]!=A)this._hidePolygon(this._openedPolygons[B]);for(B=0;B<C.length;B++)if(this.idPull[C[B]]!=null)if(this.itemPull[C[B]]["state"]=="enabled")this.idPull[C[B]].className="dhtmlxMenu_"+this.skin+"_SubLevelArea_Item_Normal"};dhtmlXMenuObject.prototype._checkArrowsState=function(B){var A=this.idPull["polygon_"+B],C=this.idPull["arrowup_"+B],D=this.idPull["arrowdown_"+B];if(A.scrollTop==0)C.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp_Disabled";else C.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp"+(C.over?"_Over":"");if(A.scrollTop+A.offsetHeight<A.scrollHeight)D.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown"+(D.over?"_Over":"");else D.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown_Disabled"};dhtmlXMenuObject.prototype._addUpArrow=function(A){var C=this,B=document.createElement("DIV");B.pId=this.idPrefix+A;B.id="arrowup_"+this.idPrefix+A;B.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp";B.innerHTML="<div class='dhtmlxMenu_"+this.skin+"_SubLevelArea_Arrow'><div class='dhtmlxMenu_SubLevelArea_Arrow_Icon'></div></div>";B.style.display="none";B.over=false;B.onselectstart=function(A){A=A||event;A.returnValue=false;return false};B.oncontextmenu=function(A){A=A||event;A.returnValue=false;return false};B.onmouseover=function(){if(C.menuMode=="web")window.clearTimeout(C.menuTimeoutHandler);C._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className=="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowUp_Disabled")return;this.className="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowUp_Over";this.over=true;C._canScrollUp=true;C._doScrollUp(this.pId,true)};B.onmouseout=function(){if(C.menuMode=="web"){window.clearTimeout(C.menuTimeoutHandler);C.menuTimeoutHandler=window.setTimeout(function(){C._clearAndHide()},C.menuTimeoutMsec,"JavaScript")}this.over=false;C._canScrollUp=false;if(this.className=="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowUp_Disabled")return;this.className="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowUp";window.clearTimeout(C._scrollUpTM)};B.onclick=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};document.body.insertBefore(B,document.body.firstChild);this.idPull[B.id]=B};dhtmlXMenuObject.prototype._addDownArrow=function(A){var C=this,B=document.createElement("DIV");B.pId=this.idPrefix+A;B.id="arrowdown_"+this.idPrefix+A;B.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown";B.innerHTML="<div class='dhtmlxMenu_"+this.skin+"_SubLevelArea_Arrow'><div class='dhtmlxMenu_SubLevelArea_Arrow_Icon'></div></div>";B.style.display="none";B.over=false;B.onselectstart=function(A){A=A||event;A.returnValue=false;return false};B.oncontextmenu=function(A){A=A||event;A.returnValue=false;return false};B.onmouseover=function(){if(C.menuMode=="web")window.clearTimeout(C.menuTimeoutHandler);C._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className=="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowDown_Disabled")return;this.className="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowDown_Over";this.over=true;C._canScrollDown=true;C._doScrollDown(this.pId,true)};B.onmouseout=function(){if(C.menuMode=="web"){window.clearTimeout(C.menuTimeoutHandler);C.menuTimeoutHandler=window.setTimeout(function(){C._clearAndHide()},C.menuTimeoutMsec,"JavaScript")}this.over=false;C._canScrollDown=false;if(this.className=="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowDown_Disabled")return;this.className="dhtmlxMenu_"+C.skin+"_SubLevelArea_ArrowDown";window.clearTimeout(C._scrollDownTM)};B.onclick=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};document.body.insertBefore(B,document.body.firstChild);this.idPull[B.id]=B};dhtmlXMenuObject.prototype._removeUpArrow=function(B){var A="arrowup_"+this.idPrefix+B;this._removeArrow(A)};dhtmlXMenuObject.prototype._removeDownArrow=function(B){var A="arrowdown_"+this.idPrefix+B;this._removeArrow(A)};dhtmlXMenuObject.prototype._removeArrow=function(A){var C=this.idPull[A];C.onselectstart=null;C.oncontextmenu=null;C.onmouseover=null;C.onmouseout=null;C.onclick=null;if(C.parentNode)C.parentNode.removeChild(C);C=null;this.idPull[A]=null;try{delete this.idPull[A]}catch(B){}};dhtmlXMenuObject.prototype._isArrowExists=function(A){if(this.idPull["arrowup_"+A]!=null&&this.idPull["arrowdown_"+A]!=null)return true;return false};dhtmlXMenuObject.prototype._doScrollUp=function(B,D){var A=this.idPull["polygon_"+B];if(this._canScrollUp&&A.scrollTop>0){var E=false,F=A.scrollTop-this._scrollUpTMStep;if(F<0){E=true;F=0}A.scrollTop=F;if(!E){var C=this;this._scrollUpTM=window.setTimeout(function(){C._doScrollUp(B,false)},this._scrollUpTMTime)}}else{this._canScrollUp=false;this._checkArrowsState(B)}if(D)this._checkArrowsState(B)};dhtmlXMenuObject.prototype._doScrollDown=function(B,D){var A=this.idPull["polygon_"+B];if(this._canScrollDown&&A.scrollTop+A.offsetHeight<=A.scrollHeight){var E=false,F=A.scrollTop+this._scrollDownTMStep;if(F+A.offsetHeight>A.scollHeight){E=true;F=A.scollHeight-A.offsetHeight}A.scrollTop=F;if(!E){var C=this;this._scrollDownTM=window.setTimeout(function(){C._doScrollDown(B,false)},this._scrollDownTMTime)}}else{this._canScrollDown;this._checkArrowsState(B)}if(D)this._checkArrowsState(B)};dhtmlXMenuObject.prototype._countPolygonItems=function(B){var C=0;for(var E in this.itemPull){var A=this.itemPull[E]["parent"],D=this.itemPull[E]["type"];if(A==this.idPrefix+B&&(D=="item"||D=="radio"||D=="checkbox"))C++}return C};dhtmlXMenuObject.prototype.setOverflowHeight=function(C){if(C==="auto"){this.limit=0;this.autoOverflow=true;return}if(this.limit==0&&C<=0)return;this._clearAndHide();if(this.limit>=0&&C>0){this.limit=C;return}if(this.limit>0&&C<=0){for(var B in this.itemPull)if(this._isArrowExists(B)){var A=String(B).replace(this.idPrefix,"");this._removeUpArrow(A);this._removeDownArrow(A);this.idPull["polygon_"+B].style.height=""}this.limit=0;return}};dhtmlXMenuObject.prototype._getRadioImgObj=function(A){try{var B=this.idPull[this.idPrefix+A].childNodes[(this._rtl?2:0)].childNodes[0]}catch(C){B=null}return B};dhtmlXMenuObject.prototype._setRadioState=function(A,C){var B=this._getRadioImgObj(A);if(B!=null){var D=this.itemPull[this.idPrefix+A];D["checked"]=C;D["imgen"]="rdbt_"+(D["checked"]?"1":"0");D["imgdis"]=D["imgen"];B.className="sub_icon "+D["imgen"]}};dhtmlXMenuObject.prototype._radioOnClickHandler=function(A,D,B){if(D.charAt(1)=="d"||this.itemPull[this.idPrefix+A]["group"]==null)return;var C=this.itemPull[this.idPrefix+A]["group"];if(this.checkEvent("onRadioClick")){if(this.callEvent("onRadioClick",[C,this.getRadioChecked(C),A,this.contextMenuZoneId,B]))this.setRadioChecked(C,A)}else this.setRadioChecked(C,A);if(this.checkEvent("onClick"))this.callEvent("onClick",[A])};dhtmlXMenuObject.prototype.getRadioChecked=function(E){var A=null;for(var C=0;C<this.radio[E].length;C++){var D=this.radio[E][C].replace(this.idPrefix,""),B=this._getRadioImgObj(D);if(B!=null){var F=(B.className).match(/rdbt_1$/gi);if(F!=null)A=D}}return A};dhtmlXMenuObject.prototype.setRadioChecked=function(D,A){if(this.radio[D]==null)return;for(var B=0;B<this.radio[D].length;B++){var C=this.radio[D][B].replace(this.idPrefix,"");this._setRadioState(C,(C==A))}};dhtmlXMenuObject.prototype.addRadioButton=function(F,B,G,E,J,L,C,M){if(this.context&&B==this.topId);else{if(this.itemPull[this.idPrefix+B]==null)return;if(F=="child"&&this.itemPull[this.idPrefix+B]["type"]!="item")return}var H=this.idPrefix+(E!=null?E:this._genStr(24)),D="rdbt_"+(C?"1":"0"),A=D;if(F=="sibling"){var I=this.idPrefix+this.getParentId(B);this._addItemIntoGlobalStrorage(H,I,J,"radio",M,D,A);this._renderSublevelItem(H,this.getItemPosition(B))}else{I=this.idPrefix+B;this._addItemIntoGlobalStrorage(H,I,J,"radio",M,D,A);if(this.idPull["polygon_"+I]==null)this._renderSublevelPolygon(I,I);this._renderSublevelItem(H,G-1);this._redefineComplexState(I)}var K=(L!=null?L:this._genStr(24));this.itemPull[H]["group"]=K;if(this.radio[K]==null)this.radio[K]=new Array();this.radio[K][this.radio[K].length]=H;if(C==true)this.setRadioChecked(K,String(H).replace(this.idPrefix,""))};dhtmlXMenuObject.prototype._getCheckboxState=function(A){if(this.itemPull[this.idPrefix+A]==null)return null;return this.itemPull[this.idPrefix+A]["checked"]};dhtmlXMenuObject.prototype._setCheckboxState=function(A,B){if(this.itemPull[this.idPrefix+A]==null)return;this.itemPull[this.idPrefix+A]["checked"]=B};dhtmlXMenuObject.prototype._updateCheckboxImage=function(A){if(this.idPull[this.idPrefix+A]==null)return;this.itemPull[this.idPrefix+A]["imgen"]="chbx_"+(this._getCheckboxState(A)?"1":"0");this.itemPull[this.idPrefix+A]["imgdis"]=this.itemPull[this.idPrefix+A]["imgen"];try{this.idPull[this.idPrefix+A].childNodes[(this._rtl?2:0)].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+A]["imgen"]}catch(B){}};dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(A,D,B){if(D.charAt(1)=="d")return;if(this.itemPull[this.idPrefix+A]==null)return;var C=this._getCheckboxState(A);if(this.checkEvent("onCheckboxClick")){if(this.callEvent("onCheckboxClick",[A,C,this.contextMenuZoneId,B]))this.setCheckboxState(A,!C)}else this.setCheckboxState(A,!C);if(this.checkEvent("onClick"))this.callEvent("onClick",[A])};dhtmlXMenuObject.prototype.setCheckboxState=function(A,B){this._setCheckboxState(A,B);this._updateCheckboxImage(A)};dhtmlXMenuObject.prototype.getCheckboxState=function(A){return this._getCheckboxState(A)};dhtmlXMenuObject.prototype.addCheckbox=function(K,D,J,H,G,F,I){if(this.context&&D==this.topId);else{if(this.itemPull[this.idPrefix+D]==null)return;if(K=="child"&&this.itemPull[this.idPrefix+D]["type"]!="item")return}var E="chbx_"+(F?"1":"0"),C=E;if(K=="sibling"){var A=this.idPrefix+(H!=null?H:this._genStr(24)),B=this.idPrefix+this.getParentId(D);this._addItemIntoGlobalStrorage(A,B,G,"checkbox",I,E,C);this.itemPull[A]["checked"]=F;this._renderSublevelItem(A,this.getItemPosition(D))}else{A=this.idPrefix+(H!=null?H:this._genStr(24)),B=this.idPrefix+D;this._addItemIntoGlobalStrorage(A,B,G,"checkbox",I,E,C);this.itemPull[A]["checked"]=F;if(this.idPull["polygon_"+B]==null)this._renderSublevelPolygon(B,B);this._renderSublevelItem(A,J-1);this._redefineComplexState(B)}};dhtmlXMenuObject.prototype._readLevel=function(A){var I="";for(var F in this.itemPull)if(this.itemPull[F]["parent"]==A){var C="",B="",D="",J=String(this.itemPull[F]["id"]).replace(this.idPrefix,""),E="",H=(this.itemPull[F]["title"]!=""?" text=\""+this.itemPull[F]["title"]+"\"":""),G="";if(this.itemPull[F]["type"]=="item"){if(this.itemPull[F]["imgen"]!="")C=" img=\""+this.itemPull[F]["imgen"]+"\"";if(this.itemPull[F]["imgdis"]!="")B=" imgdis=\""+this.itemPull[F]["imgdis"]+"\"";if(this.itemPull[F]["hotkey"]!="")D="<hotkey>"+this.itemPull[F]["hotkey"]+"</hotkey>"}if(this.itemPull[F]["type"]=="separator")E=" type=\"separator\"";else if(this.itemPull[F]["state"]=="disabled")G=" enabled=\"false\"";if(this.itemPull[F]["type"]=="checkbox")E=" type=\"checkbox\""+(this.itemPull[F]["checked"]?" checked=\"true\"":"");if(this.itemPull[F]["type"]=="radio")E=" type=\"radio\" group=\""+this.itemPull[F]["group"]+"\" "+(this.itemPull[F]["checked"]?" checked=\"true\"":"");I+="<item id='"+J+"'"+H+E+C+B+G+">";I+=D;if(this.itemPull[F]["complex"])I+=this._readLevel(F);I+="</item>"}return I};dhtmlXMenuObject.prototype.serialize=function(){var A="<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>";return A};function dhtmlXToolbarObject(B,C){var A=this;this.cont=(typeof(B)!="object")?document.getElementById(B):B;while(this.cont.childNodes.length>0)this.cont.removeChild(this.cont.childNodes[0]);this.cont.dir="ltr";this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div>"+"<div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>";this.base=document.createElement("DIV");this.base.className="float_left";this.cont.appendChild(this.base);this.align="left";this.setAlign=function(A){this.align=(A=="right"?"right":"left");this.base.className=(A=="right"?"float_right":"float_left");if(this._spacer)this._spacer.className="dhxtoolbar_spacer "+(A=="right"?" float_left":" float_right")};this._isIE6=false;if(_isIE)this._isIE6=(window.XMLHttpRequest==null?true:false);this._isIPad=(navigator.userAgent.search(/iPad/gi)>=0);if(this._isIPad)this.cont.ontouchstart=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};this.iconSize=18;this.setIconSize=function(A){this.iconSize=({18:true,24:true,32:true,48:true}[A]?A:18);this.setSkin(this.skin,true);this.callEvent("_onIconSizeChange",[this.iconSize])};this.selectPolygonOffsetTop=0;this.selectPolygonOffsetLeft=0;this._improveTerraceSkin=function(B){var H=null;if(B!=null){H={};H[B]=B}var A={buttonInput:true,separator:true,text:true};for(var F in(H||this.objPull))if(this.objPull[F]!=null&&this.objPull[F].obj!=null){if(this.objPull[F].type=="buttonInput")this.objPull[F].obj.className=this.objPull[F].obj.className.replace(/dhx_toolbar_btn/,"dhx_toolbar_inp");var C=this.objPull[F][this.objPull[F].type=="buttonSelect"?"arw":"obj"],G=false,E=false;if(!A[this.objPull[F].type]){if(C==C.parentNode.lastChild)G=true;if(C.nextSibling!=null){var I=null;for(var D in this.objPull)if(this.objPull[D].obj==C.nextSibling)I=this.objPull[D].type;if(A[I])G=true}if(this.objPull[F].obj==C.parentNode.firstChild)E=true;if(this.objPull[F].obj.previousSibling!=null){I=null;for(D in this.objPull)if(this.objPull[D].obj==this.objPull[F].obj.previousSibling)I=this.objPull[D].type;if(A[I])E=true}}C.style.borderRight=(G?"1px solid #cecece":"");C.style.borderTopRightRadius=C.style.borderBottomRightRadius=(G?"5px":"0px");this.objPull[F].obj.style.borderTopLeftRadius=this.objPull[F].obj.style.borderBottomLeftRadius=(E?"5px":"0px");this.objPull[F].obj._br=G;this.objPull[F].obj._bl=E;C=null}};this._improveTerraceButtonSelect=function(A,C){var B=this.objPull[A];if(C==true){B.obj.style.borderBottomLeftRadius=(B.obj._bl?"5px":"0px");B.arw.style.borderBottomRightRadius=(B.obj._br?"5px":"0px")}else{B.obj.style.borderBottomLeftRadius="0px";B.arw.style.borderBottomRightRadius="0px"}B=null};this.setSkin=function(D,C){if(C===true)this.cont.className=this.cont.className.replace(/dhx_toolbar_base_\d{1,}_/,"dhx_toolbar_base_"+this.iconSize+"_");else{this.skin=D;if(this.skin=="dhx_skyblue")this.selectPolygonOffsetTop=1;if(this.skin=="dhx_web"){this.selectPolygonOffsetTop=1;this.selectPolygonOffsetLeft=1}if(this.skin=="dhx_terrace"){this.selectPolygonOffsetTop=-1;this.selectPolygonOffsetLeft=0}this.cont.className="dhx_toolbar_base_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":"")}for(var B in this.objPull){var A=this.objPull[B];if(A["type"]=="slider"){A.pen._detectLimits();A.pen._definePos();A.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"")}if(A["type"]=="buttonSelect")A.polygon.className="dhx_toolbar_poly_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":"")}if(D=="dhx_terrace")this._improveTerraceSkin()};this.setSkin(C!=null?C:(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:"dhx_skyblue"));this.objPull={};this.anyUsed="none";this.imagePath="";this.setIconsPath=function(A){this.imagePath=A};this.setIconPath=this.setIconsPath;this._doOnLoad=function(){};this.loadXML=function(B,A){if(A!=null)this._doOnLoad=function(){A()};this.callEvent("onXLS",[]);this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXML(B)};this.loadXMLString=function(B,A){if(A!=null)this._doOnLoad=function(){A()};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXMLString(B)};this._xmlParser=function(){var H=this.getXMLTopNode("toolbar"),F=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"],J=["id","type","enabled","disabled","action","selected","img","text"];for(var I=0;I<H.childNodes.length;I++)if(H.childNodes[I].tagName=="item"){var D={};for(var B=0;B<F.length;B++)D[F[B]]=H.childNodes[I].getAttribute(F[B]);D.items=[];D.userdata=[];for(var E=0;E<H.childNodes[I].childNodes.length;E++){if(H.childNodes[I].childNodes[E].tagName=="item"&&D.type=="buttonSelect"){var C={};for(B=0;B<J.length;B++)C[J[B]]=H.childNodes[I].childNodes[E].getAttribute(J[B]);try{C.itemText=H.childNodes[I].childNodes[E].getElementsByTagName("itemText")[0].firstChild.nodeValue}catch(K){}var L=H.childNodes[I].childNodes[E].getElementsByTagName("userdata");for(B=0;B<L.length;B++){if(!C.userdata)C.userdata={};var G={};try{G.name=L[B].getAttribute("name")}catch(K){G.name=""}try{G.value=L[B].firstChild.nodeValue}catch(K){G.value=""}if(G.name!="")C.userdata[G.name]=G.value}D.items[D.items.length]=C}if(H.childNodes[I].childNodes[E].tagName=="userdata"){C={};try{C.name=H.childNodes[I].childNodes[E].getAttribute("name")}catch(K){C.name=""}try{C.value=H.childNodes[I].childNodes[E].firstChild.nodeValue}catch(K){C.value=""}D.userdata[D.userdata.length]=C}}A._addItemToStorage(D)}if(A.skin=="dhx_terrace")A._improveTerraceSkin();A.callEvent("onXLE",[]);A._doOnLoad();this.destructor()};this._addItemToStorage=function(B,E){var A=(B.id||this._genStr(24)),D=(B.type||"");if(D!="")if(this["_"+D+"Object"]!=null){if((typeof(B.openAll)=="undefined"||B.openAll==null)&&this.skin=="dhx_terrace")B.openAll=true;this.objPull[this.idPrefix+A]=new this["_"+D+"Object"](this,A,B);this.objPull[this.idPrefix+A]["type"]=D;this.setPosition(A,E)}if(B.userdata)for(var C=0;C<B.userdata.length;C++)this.setUserData(A,B.userdata[C].name,B.userdata[C].value)};this._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B+=D.charAt(Math.round(Math.random()*(D.length-1)));return B};this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput");this.idPrefix=this._genStr(12);dhtmlxEventable(this);this._getObj=function(C,B){var D=null;for(var A=0;A<C.childNodes.length;A++)if(C.childNodes[A].tagName!=null)if(String(C.childNodes[A].tagName).toLowerCase()==String(B).toLowerCase())D=C.childNodes[A];return D};this._addImgObj=function(B){var A=document.createElement("IMG");if(B.childNodes.length>0)B.insertBefore(A,B.childNodes[0]);else B.appendChild(A);return A};this._setItemImage=function(C,D,B){if(B==true)C.imgEn=D;else C.imgDis=D;if((!C.state&&B==true)||(C.state&&B==false))return;var A=this._getObj(C.obj,"img");if(A==null)A=this._addImgObj(C.obj);A.src=this.imagePath+D};this._clearItemImage=function(C,B){if(B==true)C.imgEn="";else C.imgDis="";if((!C.state&&B==true)||(C.state&&B==false))return;var A=this._getObj(C.obj,"img");if(A!=null)A.parentNode.removeChild(A)};this._setItemText=function(B,A){var C=this._getObj(B.obj,"div");if(A==null||A.length==0){if(C!=null)C.parentNode.removeChild(C);return}if(C==null){C=document.createElement("DIV");B.obj.appendChild(C)}C.innerHTML=A};this._getItemText=function(A){var B=this._getObj(A.obj,"div");if(B!=null)return B.innerHTML;return""};this._enableItem=function(B){if(B.state)return;B.state=true;if(this.objPull[B.id]["type"]=="buttonTwoState"&&this.objPull[B.id]["obj"]["pressed"]==true){B.obj.className="dhx_toolbar_btn pres";B.obj.renderAs="dhx_toolbar_btn over"}else{B.obj.className="dhx_toolbar_btn def";B.obj.renderAs=B.obj.className}if(B.arw)B.arw.className=String(B.obj.className).replace("btn","arw");var A=this._getObj(B.obj,"img");if(B.imgEn!=""){if(A==null)A=this._addImgObj(B.obj);A.src=this.imagePath+B.imgEn}else if(A!=null)A.parentNode.removeChild(A)};this._disableItem=function(B){if(!B.state)return;B.state=false;B.obj.className="dhx_toolbar_btn "+(this.objPull[B.id]["type"]=="buttonTwoState"&&B.obj.pressed?"pres_":"")+"dis";B.obj.renderAs="dhx_toolbar_btn def";if(B.arw)B.arw.className=String(B.obj.className).replace("btn","arw");var A=this._getObj(B.obj,"img");if(B.imgDis!=""){if(A==null)A=this._addImgObj(B.obj);A.src=this.imagePath+B.imgDis}else if(A!=null)A.parentNode.removeChild(A);if(B.polygon!=null)if(B.polygon.style.display!="none"){B.polygon.style.display="none";if(B.polygon._ie6cover)B.polygon._ie6cover.style.display="none";if(this.skin=="dhx_terrace")this._improveTerraceButtonSelect(B.id,true)}this.anyUsed="none"};this.clearAll=function(){for(var A in this.objPull)this._removeItem(String(A).replace(this.idPrefix,""))};this._isWebToolbar=true;this._doOnClick=function(B){A.forEachItem(function(C){if(A.objPull[A.idPrefix+C]["type"]=="buttonSelect"){var B=A.objPull[A.idPrefix+C];if(B.polygon.style.display!="none"){B.obj.renderAs="dhx_toolbar_btn def";B.obj.className=B.obj.renderAs;B.arw.className=String(B.obj.renderAs).replace("btn","arw");A.anyUsed="none";B.polygon.style.display="none";if(B.polygon._ie6cover)B.polygon._ie6cover.style.display="none";if(A.skin=="dhx_terrace")A._improveTerraceButtonSelect(B.id,true)}}})};if(this._isIPad)document.addEventListener("touchstart",this._doOnClick,false);else if(_isIE)document.body.attachEvent("onclick",this._doOnClick);else window.addEventListener("click",this._doOnClick,false);return this}dhtmlXToolbarObject.prototype.addSpacer=function(B){var F=this.idPrefix+B;if(this._spacer!=null){if(this._spacer.idd==B)return;if(this._spacer==this.objPull[F].obj.parentNode){var E=true;while(E){var D=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(D==B||this._spacer.childNodes.length==0){if(this.objPull[F].arw!=null)this.base.appendChild(this.objPull[F].arw);E=false}}this._spacer.idd=B;this._fixSpacer();return}if(this.base==this.objPull[F].obj.parentNode){var E=true,G=(this.objPull[F].arw!=null);while(E){var C=this.base.childNodes.length-1;if(G==true)if(this.base.childNodes[C]==this.objPull[F].arw)E=false;if(this.base.childNodes[C].idd==B)E=false;if(E)if(this._spacer.childNodes.length>0)this._spacer.insertBefore(this.base.childNodes[C],this._spacer.childNodes[0]);else this._spacer.appendChild(this.base.childNodes[C])}this._spacer.idd=B;this._fixSpacer();return}}else{var A=null;for(C=0;C<this.base.childNodes.length;C++)if(this.base.childNodes[C]==this.objPull[this.idPrefix+B].obj){A=C;if(this.objPull[this.idPrefix+B].arw!=null)A=C+1}if(A!=null){this._spacer=document.createElement("DIV");this._spacer.className="dhxtoolbar_spacer "+(this.align=="right"?" float_left":" float_right");this._spacer.dir="rtl";this._spacer.idd=B;while(this.base.childNodes.length>A+1)this._spacer.appendChild(this.base.childNodes[A+1]);this.cont.appendChild(this._spacer);this._fixSpacer()}}if(this.skin=="dhx_terrace")this._improveTerraceSkin()};dhtmlXToolbarObject.prototype.removeSpacer=function(){if(!this._spacer)return;while(this._spacer.childNodes.length>0)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer);this._spacer=null;if(this.skin=="dhx_terrace")this._improveTerraceSkin()};dhtmlXToolbarObject.prototype._fixSpacer=function(){if(_isIE&&this._spacer!=null){this._spacer.style.borderLeft="1px solid #a4bed4";var A=this._spacer;window.setTimeout(function(){A.style.borderLeft="0px solid #a4bed4";A=null},1)}};dhtmlXToolbarObject.prototype.getType=function(D){var A=this.getParentId(D);if(A!=null){var C=null,B=this.objPull[this.idPrefix+A]._listOptions[D];if(B!=null)if(B.sep!=null)C="buttonSelectSeparator";else C="buttonSelectButton";return C}else{if(this.objPull[this.idPrefix+D]==null)return null;return this.objPull[this.idPrefix+D]["type"]}};dhtmlXToolbarObject.prototype.getTypeExt=function(B){var A=this.getType(B);if(A=="buttonSelectButton"||A=="buttonSelectSeparator"){if(A=="buttonSelectButton")A="button";else A="separator";return A}return null};dhtmlXToolbarObject.prototype.inArray=function(C,B){for(var A=0;A<C.length;A++)if(C[A]==B)return true;return false};dhtmlXToolbarObject.prototype.getParentId=function(C){var A=null;for(var D in this.objPull)if(this.objPull[D]._listOptions)for(var B in this.objPull[D]._listOptions)if(B==C)A=String(D).replace(this.idPrefix,"");return A};dhtmlXToolbarObject.prototype._addItem=function(A,B){this._addItemToStorage(A,B);if(this.skin=="dhx_terrace")this._improveTerraceSkin()};dhtmlXToolbarObject.prototype.addButton=function(A,E,B,D,C){this._addItem({id:A,type:"button",text:B,img:D,imgdis:C},E)};dhtmlXToolbarObject.prototype.addText=function(A,C,B){this._addItem({id:A,type:"text",text:B},C)};dhtmlXToolbarObject.prototype.addButtonSelect=function(H,G,B,A,F,L,D,E,C){var J=[];for(var K=0;K<A.length;K++){var I={};if(A[K].id&&A[K].type){I.id=A[K].id;I.type=(A[K].type=="obj"?"button":"separator");I.text=A[K].text;I.img=A[K].img}else{I.id=A[K][0];I.type=(A[K][1]=="obj"?"button":"separator");I.text=(A[K][2]||null);I.img=(A[K][3]||null)}J[J.length]=I}this._addItem({id:H,type:"buttonSelect",text:B,img:F,imgdis:L,renderSelect:D,openAll:E,items:J,maxOpen:C},G)};dhtmlXToolbarObject.prototype.addButtonTwoState=function(A,E,B,D,C){this._addItem({id:A,type:"buttonTwoState",img:D,imgdis:C,text:B},E)};dhtmlXToolbarObject.prototype.addSeparator=function(A,B){this._addItem({id:A,type:"separator"},B)};dhtmlXToolbarObject.prototype.addSlider=function(A,I,E,G,F,C,B,D,H){this._addItem({id:A,type:"slider",length:E,valueMin:G,valueMax:F,valueNow:C,textMin:B,textMax:D,toolTip:H},I)};dhtmlXToolbarObject.prototype.addInput=function(A,D,C,B){this._addItem({id:A,type:"buttonInput",value:C,width:B},D)};dhtmlXToolbarObject.prototype.forEachItem=function(B){for(var A in this.objPull)if(this.inArray(this.rootTypes,this.objPull[A]["type"]))B(this.objPull[A]["id"].replace(this.idPrefix,""))};(function(){var D="showItem,hideItem,isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),A=["","",false,"","",false,"","","","","","","","","",false,"","","",null,"",[null,null],"",[null,null],"",null],E=function(B,A){return function(E,D,C){E=this.idPrefix+E;if(this.objPull[E][B]!=null)return this.objPull[E][B].call(this.objPull[E],D,C);else return A}};for(var F=0;F<D.length;F++){var C=D[F],B=A[F];dhtmlXToolbarObject.prototype[C]=E(C,B)}})();dhtmlXToolbarObject.prototype.getPosition=function(A){return this._getPosition(A)};dhtmlXToolbarObject.prototype._getPosition=function(B,D){if(this.objPull[this.idPrefix+B]==null)return null;var E=null,A=0;for(var C=0;C<this.base.childNodes.length;C++)if(this.base.childNodes[C].idd!=null){if(this.base.childNodes[C].idd==B)E=A;A++}if(!E&&this._spacer!=null)for(C=0;C<this._spacer.childNodes.length;C++)if(this._spacer.childNodes[C].idd!=null){if(this._spacer.childNodes[C].idd==B)E=A;A++}return E};dhtmlXToolbarObject.prototype.setPosition=function(A,B){this._setPosition(A,B)};dhtmlXToolbarObject.prototype._setPosition=function(A,E){if(this.objPull[this.idPrefix+A]==null)return;if(isNaN(E))E=this.base.childNodes.length;if(E<0)E=0;var D=null;if(this._spacer){D=this._spacer.idd;this.removeSpacer()}var C=this.objPull[this.idPrefix+A];this.base.removeChild(C.obj);if(C.arw)this.base.removeChild(C.arw);var B=this._getIdByPosition(E,true);if(B[0]==null){this.base.appendChild(C.obj);if(C.arw)this.base.appendChild(C.arw)}else{this.base.insertBefore(C.obj,this.base.childNodes[B[1]]);if(C.arw)this.base.insertBefore(C.arw,this.base.childNodes[B[1]+1])}if(D!=null)this.addSpacer(D)};dhtmlXToolbarObject.prototype._getIdByPosition=function(F,E){var B=null,A=0,D=0;for(var C=0;C<this.base.childNodes.length;C++){if(this.base.childNodes[C]["idd"]!=null&&B==null)if((A++)==F)B=this.base.childNodes[C]["idd"];if(B==null)D++}D=(B==null?null:D);return(E==true?new Array(B,D):B)};dhtmlXToolbarObject.prototype.removeItem=function(A){this._removeItem(A);if(this.skin=="dhx_terrace")this._improveTerraceSkin()};dhtmlXToolbarObject.prototype._removeItem=function(D){var A=this.getType(D);D=this.idPrefix+D;var C=this.objPull[D];if(A=="button"){C.obj._doOnMouseOver=null;C.obj._doOnMouseOut=null;C.obj._doOnMouseUp=null;C.obj._doOnMouseUpOnceAnywhere=null;C.obj.onclick=null;C.obj.onmouseover=null;C.obj.onmouseout=null;C.obj.onmouseup=null;C.obj.onmousedown=null;C.obj.onselectstart=null;C.obj.renderAs=null;C.obj.idd=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.state=null;C.img=null;C.imgEn=null;C.imgDis=null;C.type=null;C.enableItem=null;C.disableItem=null;C.isEnabled=null;C.showItem=null;C.hideItem=null;C.isVisible=null;C.setItemText=null;C.getItemText=null;C.setItemImage=null;C.clearItemImage=null;C.setItemImageDis=null;C.clearItemImageDis=null;C.setItemToolTip=null;C.getItemToolTip=null}if(A=="buttonTwoState"){C.obj._doOnMouseOver=null;C.obj._doOnMouseOut=null;C.obj.onmouseover=null;C.obj.onmouseout=null;C.obj.onmousedown=null;C.obj.onselectstart=null;C.obj.renderAs=null;C.obj.idd=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.state=null;C.img=null;C.imgEn=null;C.imgDis=null;C.type=null;C.enableItem=null;C.disableItem=null;C.isEnabled=null;C.showItem=null;C.hideItem=null;C.isVisible=null;C.setItemText=null;C.getItemText=null;C.setItemImage=null;C.clearItemImage=null;C.setItemImageDis=null;C.clearItemImageDis=null;C.setItemToolTip=null;C.getItemToolTip=null;C.setItemState=null;C.getItemState=null}if(A=="buttonSelect"){for(var B in C._listOptions)this.removeListOption(D,B);C._listOptions=null;if(C.polygon._ie6cover){document.body.removeChild(C.polygon._ie6cover);C.polygon._ie6cover=null}C.p_tbl.removeChild(C.p_tbody);C.polygon.removeChild(C.p_tbl);C.polygon.onselectstart=null;document.body.removeChild(C.polygon);C.p_tbody=null;C.p_tbl=null;C.polygon=null;C.obj.onclick=null;C.obj.onmouseover=null;C.obj.onmouseout=null;C.obj.onmouseup=null;C.obj.onmousedown=null;C.obj.onselectstart=null;C.obj.idd=null;C.obj.iddPrefix=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.arw.onclick=null;C.arw.onmouseover=null;C.arw.onmouseout=null;C.arw.onmouseup=null;C.arw.onmousedown=null;C.arw.onselectstart=null;C.arw.parentNode.removeChild(C.arw);C.arw=null;C.renderSelect=null;C.state=null;C.type=null;C.id=null;C.img=null;C.imgEn=null;C.imgDis=null;C.openAll=null;C._isListButton=null;C._separatorButtonSelectObject=null;C._buttonButtonSelectObject=null;C.setWidth=null;C.enableItem=null;C.disableItem=null;C.isEnabled=null;C.showItem=null;C.hideItem=null;C.isVisible=null;C.setItemText=null;C.getItemText=null;C.setItemImage=null;C.clearItemImage=null;C.setItemImageDis=null;C.clearItemImageDis=null;C.setItemToolTip=null;C.getItemToolTip=null;C.addListOption=null;C.removeListOption=null;C.showListOption=null;C.hideListOption=null;C.isListOptionVisible=null;C.enableListOption=null;C.disableListOption=null;C.isListOptionEnabled=null;C.setListOptionPosition=null;C.getListOptionPosition=null;C.setListOptionImage=null;C.getListOptionImage=null;C.clearListOptionImage=null;C.setListOptionText=null;C.getListOptionText=null;C.setListOptionToolTip=null;C.getListOptionToolTip=null;C.forEachListOption=null;C.getAllListOptions=null;C.setListOptionSelected=null;C.getListOptionSelected=null}if(A=="buttonInput"){C.obj.childNodes[0].onkeydown=null;C.obj.removeChild(C.obj.childNodes[0]);C.obj.w=null;C.obj.idd=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.type=null;C.enableItem=null;C.disableItem=null;C.isEnabled=null;C.showItem=null;C.hideItem=null;C.isVisible=null;C.setItemToolTip=null;C.getItemToolTip=null;C.setWidth=null;C.getWidth=null;C.setValue=null;C.getValue=null;C.setItemText=null;C.getItemText=null}if(A=="slider"){if(this._isIPad){document.removeEventListener("touchmove",pen._doOnMouseMoveStart,false);document.removeEventListener("touchend",pen._doOnMouseMoveEnd,false)}else if(_isIE){document.body.detachEvent("onmousemove",C.pen._doOnMouseMoveStart);document.body.detachEvent("onmouseup",C.pen._doOnMouseMoveEnd)}else{window.removeEventListener("mousemove",C.pen._doOnMouseMoveStart,false);window.removeEventListener("mouseup",C.pen._doOnMouseMoveEnd,false)}C.pen.allowMove=null;C.pen.initXY=null;C.pen.maxX=null;C.pen.minX=null;C.pen.nowX=null;C.pen.newNowX=null;C.pen.valueMax=null;C.pen.valueMin=null;C.pen.valueNow=null;C.pen._definePos=null;C.pen._detectLimits=null;C.pen._doOnMouseMoveStart=null;C.pen._doOnMouseMoveEnd=null;C.pen.onmousedown=null;C.obj.removeChild(C.pen);C.pen=null;C.label.tip=null;document.body.removeChild(C.label);C.label=null;C.obj.onselectstart=null;C.obj.idd=null;while(C.obj.childNodes.length>0)C.obj.removeChild(C.obj.childNodes[0]);C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.type=null;C.state=null;C.enableItem=null;C.disableItem=null;C.isEnabled=null;C.setItemToolTipTemplate=null;C.getItemToolTipTemplate=null;C.setMaxValue=null;C.setMinValue=null;C.getMaxValue=null;C.getMinValue=null;C.setValue=null;C.getValue=null;C.showItem=null;C.hideItem=null;C.isVisible=null}if(A=="separator"){C.obj.onselectstart=null;C.obj.idd=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.type=null;C.showItem=null;C.hideItem=null;C.isVisible=null}if(A=="text"){C.obj.onselectstart=null;C.obj.idd=null;C.obj.parentNode.removeChild(C.obj);C.obj=null;C.id=null;C.type=null;C.showItem=null;C.hideItem=null;C.isVisible=null;C.setWidth=null;C.setItemText=null;C.getItemText=null}A=null;C=null;this.objPull[this.idPrefix+D]=null;delete this.objPull[this.idPrefix+D]};(function(){var B="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),C=function(A){return function(B,G,E,F,C,D){B=this.idPrefix+B;if(this.objPull[B]==null)return;if(this.objPull[B]["type"]!="buttonSelect")return;return this.objPull[B][A].call(this.objPull[B],G,E,F,C,D)}};for(var D=0;D<B.length;D++){var A=B[D];dhtmlXToolbarObject.prototype[A]=C(A)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(B,A){return B+A};dhtmlXToolbarObject.prototype._separatorObject=function(B,A,C){this.id=B.idPrefix+A;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=(C.hidden!=null?"none":"");this.obj.idd=String(A);this.obj.title=(C.title||"");this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};if(B._isIPad)this.obj.ontouchstart=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};B.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};return this};dhtmlXToolbarObject.prototype._textObject=function(B,A,C){this.id=B.idPrefix+A;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=(C.hidden!=null?"none":"");this.obj.idd=String(A);this.obj.title=(C.title||"");this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};if(B._isIPad)this.obj.ontouchstart=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};this.obj.innerHTML=(C.text||"");B.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(A){this.obj.innerHTML=A};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(A){this.obj.style.width=A+"px"};this.setItemToolTip=function(A){this.obj.title=A};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonObject=function(B,A,C){this.id=B.idPrefix+A;this.state=(C.enabled!=null?false:true);this.imgEn=(C.img||"");this.imgDis=(C.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=(C.hidden!=null?"none":"");this.obj.allowClick=false;this.obj.extAction=(C.action||null);this.obj.renderAs=this.obj.className;this.obj.idd=String(A);this.obj.title=(C.title||"");this.obj.pressed=false;this.obj.innerHTML=B._rtlParseBtn((this.img!=""?"<img src='"+B.imagePath+this.img+"'>":""),(C.text!=null?"<div>"+C.text+"</div>":""));var D=this;this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){this.allowClick=true;if(D.state==false)return;if(B.anyUsed!="none")return;this.className="dhx_toolbar_btn over";this.renderAs=this.className};this.obj._doOnMouseOut=function(){this.allowClick=false;if(D.state==false)return;if(B.anyUsed!="none")return;this.className="dhx_toolbar_btn def";this.renderAs=this.renderAs};this.obj.onclick=function(C){if(D.state==false)return;if(this.allowClick==false)return;C=C||event;var A=this.idd.replace(B.idPrefix,"");if(this.extAction){try{window[this.extAction](A)}catch(C){}}if(B&&B.callEvent)B.callEvent("onClick",[A])};this.obj[B._isIPad?"ontouchstart":"onmousedown"]=function(A){if(D.state==false){A=A||event;A.returnValue=false;A.cancelBubble=true;return false}if(B.anyUsed!="none")return;B.anyUsed=this.idd;this.className="dhx_toolbar_btn pres";this.pressed=true;this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){B.anyUsed="none";this._doOnMouseOut()};return false};this.obj[B._isIPad?"ontouchend":"onmouseup"]=function(C){if(D.state==false)return;if(B.anyUsed!="none")if(B.anyUsed!=this.idd)return;var A=B.anyUsed;this._doOnMouseUp();if(B._isIPad&&A!="none")B.callEvent("onClick",[this.idd.replace(B.idPrefix,"")])};if(B._isIPad)this.obj.ontouchmove=function(A){this._doOnMouseUp()};this.obj._doOnMouseUp=function(){B.anyUsed="none";this.className=this.renderAs;this.pressed=false};this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp();this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){this._doOnMouseOut()}};B.base.appendChild(this.obj);this.enableItem=function(){B._enableItem(this)};this.disableItem=function(){B._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(A){B._setItemText(this,A)};this.getItemText=function(){return B._getItemText(this)};this.setItemImage=function(A){B._setItemImage(this,A,true)};this.clearItemImage=function(){B._clearItemImage(this,true)};this.setItemImageDis=function(A){B._setItemImage(this,A,false)};this.clearItemImageDis=function(){B._clearItemImage(this,false)};this.setItemToolTip=function(A){this.obj.title=A};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonSelectObject=function(B,A,E){this.id=B.idPrefix+A;this.state=(E.enabled!=null?(E.enabled=="true"?true:false):true);this.imgEn=(E.img||"");this.imgDis=(E.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.mode=(E.mode||"button");if(this.mode=="select"){this.openAll=true;this.renderSelect=false;if(!E.text||E.text.length==0)E.text="&nbsp;"}else{this.openAll=(E.openAll=="true"||E.openAll==true||E.openAll==1||E.openAll=="1"||E.openAll=="yes"||E.openAll=="on");this.renderSelect=(E.renderSelect!=null?(E.renderSelect=="false"||E.renderSelect=="disabled"?false:true):true)}this.maxOpen=(!isNaN(E.maxOpen?E.maxOpen:"")?E.maxOpen:null);this._maxOpenTest=function(){if(!isNaN(this.maxOpen))if(!B._sbw){var A=document.createElement("DIV");A.className="dhxtoolbar_maxopen_test";document.body.appendChild(A);var C=document.createElement("DIV");C.className="dhxtoolbar_maxopen_test2";A.appendChild(C);B._sbw=A.offsetWidth-C.offsetWidth;A.removeChild(C);C=null;document.body.removeChild(A);A=null}};this._maxOpenTest();this.obj=document.createElement("DIV");this.obj.allowClick=false;this.obj.extAction=(E.action||null);this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=(E.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};this.obj.idd=String(A);this.obj.title=(E.title||"");this.obj.pressed=false;this.callEvent=false;this.obj.innerHTML=B._rtlParseBtn((this.img!=""?"<img src='"+B.imagePath+this.img+"'>":""),(E.text!=null?"<div>"+E.text+"</div>":""));B.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw "+(this.state?"def":"dis");this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";this.arw.title=this.obj.title;this.arw.onselectstart=function(A){A=A||event;A.returnValue=false};B.base.appendChild(this.arw);var F=this;this.obj.onmouseover=function(A){A=A||event;if(B.anyUsed!="none")return;if(!F.state)return;F.obj.renderAs="dhx_toolbar_btn over";F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw")};this.obj.onmouseout=function(){F.obj.allowClick=false;if(B.anyUsed!="none")return;if(!F.state)return;F.obj.renderAs="dhx_toolbar_btn def";F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");F.callEvent=false};this.arw.onmouseover=this.obj.onmouseover;this.arw.onmouseout=this.obj.onmouseout;if(this.openAll==true);else{this.obj.onclick=function(C){C=C||event;if(!F.obj.allowClick)return;if(!F.state)return;if(B.anyUsed!="none")return;var A=F.obj.idd.replace(B.idPrefix,"");if(F.obj.extAction){try{window[F.obj.extAction](A)}catch(C){}}B.callEvent("onClick",[A])};this.obj[B._isIPad?"ontouchstart":"onmousedown"]=function(A){A=A||event;if(B.anyUsed!="none")return;if(!F.state)return;F.obj.allowClick=true;F.obj.className="dhx_toolbar_btn pres";F.arw.className="dhx_toolbar_arw pres";F.callEvent=true};this.obj[B._isIPad?"ontouchend":"onmouseup"]=function(C){C=C||event;C.cancelBubble=true;if(B.anyUsed!="none")return;if(!F.state)return;F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");if(B._isIPad&&F.callEvent){var A=F.obj.idd.replace(B.idPrefix,"");B.callEvent("onClick",[A])}}}if(B._isIPad)this.obj.ontouchmove=this.obj.onmouseout;this.arw[B._isIPad?"ontouchstart":"onmousedown"]=function(A){A=A||event;if(!F.state)return;if(B.anyUsed==F.obj.idd){F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");B.anyUsed="none";F.polygon.style.display="none";if(F.polygon._ie6cover)F.polygon._ie6cover.style.display="none";if(B.skin=="dhx_terrace")B._improveTerraceButtonSelect(F.id,true)}else{if(B.anyUsed!="none")if(B.objPull[B.idPrefix+B.anyUsed]["type"]=="buttonSelect"){var C=B.objPull[B.idPrefix+B.anyUsed];if(C.polygon.style.display!="none"){C.obj.renderAs="dhx_toolbar_btn def";C.obj.className=C.obj.renderAs;C.arw.className=String(F.obj.renderAs).replace("btn","arw");C.polygon.style.display="none";if(C.polygon._ie6cover)C.polygon._ie6cover.style.display="none";if(B.skin=="dhx_terrace")B._improveTerraceButtonSelect(C.id,true)}}F.obj.className="dhx_toolbar_btn over";F.arw.className="dhx_toolbar_arw pres";B.anyUsed=F.obj.idd;F.polygon.style.top="0px";F.polygon.style.visibility="hidden";F.polygon.style.display="";if(B.skin=="dhx_terrace")B._improveTerraceButtonSelect(F.id,false);F._fixMaxOpenHeight(F.maxOpen||null);B._autoDetectVisibleArea();var E=getAbsoluteTop(F.obj)+F.obj.offsetHeight+B.selectPolygonOffsetTop,D=F.polygon.offsetHeight;if(E+D>B.tY2){var G=(F.maxOpen!=null?Math.floor((B.tY2-E)/22):0);if(G>=1)F._fixMaxOpenHeight(G);else{E=getAbsoluteTop(F.obj)-D-B.selectPolygonOffsetTop;if(E<0)E=0}}F.polygon.style.top=E+"px";if(B.rtl)F.polygon.style.left=getAbsoluteLeft(F.obj)+F.obj.offsetWidth-F.polygon.offsetWidth+B.selectPolygonOffsetLeft+"px";else F.polygon.style.left=getAbsoluteLeft(F.obj)+B.selectPolygonOffsetLeft+"px";F.polygon.style.visibility="visible";if(F.polygon._ie6cover){F.polygon._ie6cover.style.left=F.polygon.style.left;F.polygon._ie6cover.style.top=F.polygon.style.top;F.polygon._ie6cover.style.width=F.polygon.offsetWidth+"px";F.polygon._ie6cover.style.height=F.polygon.offsetHeight+"px";F.polygon._ie6cover.style.display=""}}return false};this.arw.onclick=function(A){A=A||event;A.cancelBubble=true};this.arw[B._isIPad?"ontouchend":"onmouseup"]=function(A){A=A||event;A.cancelBubble=true};if(this.openAll===true){this.obj.onclick=this.arw.onclick;this.obj.onmousedown=this.arw.onmousedown;this.obj.onmouseup=this.arw.onmouseup;if(B._isIPad){this.obj.ontouchstart=this.arw.ontouchstart;this.obj.ontouchend=this.arw.ontouchend}}this.obj.iddPrefix=B.idPrefix;this._listOptions={};this._fixMaxOpenHeight=function(C){var G="auto",E=false;if(C!==null){var A=0;for(var D in this._listOptions)A++;if(A>C){this._ph=22*C;G=this._ph+"px"}else E=true}this.polygon.style.width="auto";this.polygon.style.height="auto";if(!E&&F.maxOpen!=null){this.polygon.style.width=this.p_tbl.offsetWidth+B._sbw+"px";this.polygon.style.height=G}};this._separatorButtonSelectObject=function(A,B,C){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(A){A=A||event;A.returnValue=false;return false};if(isNaN(C))C=F.p_tbody.childNodes.length+1;else if(C<1)C=1;if(C>F.p_tbody.childNodes.length)F.p_tbody.appendChild(this.obj.tr);else F.p_tbody.insertBefore(this.obj.tr,F.p_tbody.childNodes[C-1]);this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className="btn_sep";this.obj.sep.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.obj.td.appendChild(this.obj.sep);F._listOptions[A]=this.obj;return this};this._buttonButtonSelectObject=function(A,C,E){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=(C.enabled=="false"?false:(C.disabled=="true"?false:true));this.obj.tr.extAction=(C.action||null);this.obj.tr._selected=(C.selected!=null);this.obj.tr.className="tr_btn"+(this.obj.tr.en?(this.obj.tr._selected&&F.renderSelect?" tr_btn_selected":""):" tr_btn_disabled");this.obj.tr.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.obj.tr.idd=String(A);if(C.userdata)this.obj.userData=C.userdata;if(isNaN(E))E=F.p_tbody.childNodes.length+1;else if(E<1)E=1;if(E>F.p_tbody.childNodes.length)F.p_tbody.appendChild(this.obj.tr);else F.p_tbody.insertBefore(this.obj.tr,F.p_tbody.childNodes[E-1]);this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(A){A=A||event;A.returnValue=false;return false};if(B.rtl){this.obj.tr.appendChild(this.obj.td_b);this.obj.tr.appendChild(this.obj.td_a)}else{this.obj.tr.appendChild(this.obj.td_a);this.obj.tr.appendChild(this.obj.td_b)}if(C.img!=null){this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+B.imagePath+C.img+"' border='0'>";this.obj.tr._img=C.img}var D=(C.text!=null?C.text:(C.itemText||""));this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+D+"</div>";this.obj.tr[B._isIPad?"ontouchstart":"onmouseover"]=function(){if(!this.en||(this._selected&&F.renderSelect))return;this.className="tr_btn tr_btn_over"};this.obj.tr.onmouseout=function(){if(!this.en)return;if(this._selected&&F.renderSelect){if(String(this.className).search("tr_btn_selected")==-1)this.className="tr_btn tr_btn_selected"}else this.className="tr_btn"};this.obj.tr[B._isIPad?"ontouchend":"onclick"]=function(C){C=C||event;C.cancelBubble=true;if(!this.en)return;F.setListOptionSelected(this.idd.replace(B.idPrefix,""));F.obj.renderAs="dhx_toolbar_btn def";F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");F.polygon.style.display="none";if(F.polygon._ie6cover)F.polygon._ie6cover.style.display="none";if(B.skin=="dhx_terrace")B._improveTerraceButtonSelect(F.id,true);B.anyUsed="none";var A=this.idd.replace(B.idPrefix,"");if(this.extAction){try{window[this.extAction](A)}catch(C){}}B.callEvent("onClick",[A])};F._listOptions[A]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display="none";this.polygon.style.zIndex=101;this.polygon.className="dhx_toolbar_poly_"+B.iconSize+"_"+B.skin+(B.rtl?" rtl":"");this.polygon.onselectstart=function(A){A=A||event;A.returnValue=false};this.polygon.style.overflowY="auto";if(B._isIPad)this.polygon.ontouchstart=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true;return false};this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);if(E.items)for(var D=0;D<E.items.length;D++){var C="_"+(E.items[D].type||"")+"ButtonSelectObject";if(typeof(this[C])=="function")new this[C](E.items[D].id||B._genStr(24),E.items[D])}document.body.appendChild(this.polygon);if(B._isIE6){this.polygon._ie6cover=document.createElement("IFRAME");this.polygon._ie6cover.frameBorder=0;this.polygon._ie6cover.style.position="absolute";this.polygon._ie6cover.style.border="none";this.polygon._ie6cover.style.backgroundColor="#000000";this.polygon._ie6cover.style.filter="alpha(opacity=100)";this.polygon._ie6cover.style.display="none";this.polygon._ie6cover.setAttribute("src","javascript:false;");document.body.appendChild(this.polygon._ie6cover)}this.setWidth=function(A){this.obj.style.width=A-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){B._enableItem(this)};this.disableItem=function(){B._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(A){B._setItemText(this,A)};this.getItemText=function(){return B._getItemText(this)};this.setItemImage=function(A){B._setItemImage(this,A,true)};this.clearItemImage=function(){B._clearItemImage(this,true)};this.setItemImageDis=function(A){B._setItemImage(this,A,false)};this.clearItemImageDis=function(){B._clearItemImage(this,false)};this.setItemToolTip=function(A){this.obj.title=A;this.arw.title=A};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(A,F,E,B,C){if(!(E=="button"||E=="separator"))return;var D={id:A,type:E,text:B,img:C};new this["_"+E+"ButtonSelectObject"](A,D,F)};this.removeListOption=function(A){if(!this._isListButton(A,true))return;var C=this._listOptions[A];if(C.td_a!=null&&C.td_b!=null){C.td_a.onselectstart=null;C.td_b.onselectstart=null;while(C.td_a.childNodes.length>0)C.td_a.removeChild(C.td_a.childNodes[0]);while(C.td_b.childNodes.length>0)C.td_b.removeChild(C.td_b.childNodes[0]);C.tr.onselectstart=null;C.tr.onmouseover=null;C.tr.onmouseout=null;C.tr.onclick=null;while(C.tr.childNodes.length>0)C.tr.removeChild(C.tr.childNodes[0]);C.tr.parentNode.removeChild(C.tr);C.td_a=null;C.td_b=null;C.tr=null}else{C.sep.onselectstart=null;C.td.onselectstart=null;C.tr.onselectstart=null;while(C.td.childNodes.length>0)C.td.removeChild(C.td.childNodes[0]);while(C.tr.childNodes.length>0)C.tr.removeChild(C.tr.childNodes[0]);C.tr.parentNode.removeChild(C.tr);C.sep=null;C.td=null;C.tr=null}C=null;this._listOptions[A]=null;try{delete this._listOptions[A]}catch(B){}};this.showListOption=function(A){if(!this._isListButton(A,true))return;this._listOptions[A].tr.style.display=""};this.hideListOption=function(A){if(!this._isListButton(A,true))return;this._listOptions[A].tr.style.display="none"};this.isListOptionVisible=function(A){if(!this._isListButton(A,true))return;return(this._listOptions[A].tr.style.display!="none")};this.enableListOption=function(A){if(!this._isListButton(A))return;this._listOptions[A].tr.en=true;this._listOptions[A].tr.className="tr_btn"+(this._listOptions[A].tr._selected&&B.renderSelect?" tr_btn_selected":"")};this.disableListOption=function(A){if(!this._isListButton(A))return;this._listOptions[A].tr.en=false;this._listOptions[A].tr.className="tr_btn tr_btn_disabled"};this.isListOptionEnabled=function(A){if(!this._isListButton(A))return;return this._listOptions[A].tr.en};this.setListOptionPosition=function(A,C){if(!this._listOptions[A]||this.getListOptionPosition(A)==C||isNaN(C))return;if(C<1)C=1;var B=this._listOptions[A].tr;this.p_tbody.removeChild(B);if(C>this.p_tbody.childNodes.length)this.p_tbody.appendChild(B);else this.p_tbody.insertBefore(B,this.p_tbody.childNodes[C-1]);B=null};this.getListOptionPosition=function(A){var C=-1;if(!this._listOptions[A])return C;for(var B=0;B<this.p_tbody.childNodes.length;B++)if(this.p_tbody.childNodes[B]==this._listOptions[A].tr)C=B+1;return C};this.setListOptionImage=function(A,D){if(!this._isListButton(A))return;var E=this._listOptions[A].tr.childNodes[(B.rtl?1:0)];if(E.childNodes.length>0)E.childNodes[0].src=B.imagePath+D;else{var C=document.createElement("IMG");C.className="btn_sel_img";C.src=B.imagePath+D;E.appendChild(C)}E=null};this.getListOptionImage=function(A){if(!this._isListButton(A))return;var D=this._listOptions[A].tr.childNodes[(B.rtl?1:0)],C=null;if(D.childNodes.length>0)C=D.childNodes[0].src;D=null;return C};this.clearListOptionImage=function(A){if(!this._isListButton(A))return;var C=this._listOptions[A].tr.childNodes[(B.rtl?1:0)];while(C.childNodes.length>0)C.removeChild(C.childNodes[0]);C=null};this.setListOptionText=function(A,C){if(!this._isListButton(A))return;this._listOptions[A].tr.childNodes[(B.rtl?0:1)].childNodes[0].innerHTML=C};this.getListOptionText=function(A){if(!this._isListButton(A))return;return this._listOptions[A].tr.childNodes[(B.rtl?0:1)].childNodes[0].innerHTML};this.setListOptionToolTip=function(A,B){if(!this._isListButton(A))return;this._listOptions[A].tr.title=B};this.getListOptionToolTip=function(A){if(!this._isListButton(A))return;return this._listOptions[A].tr.title};this.forEachListOption=function(B){for(var A in this._listOptions)B(A)};this.getAllListOptions=function(){var B=new Array();for(var A in this._listOptions)B[B.length]=A;return B};this.setListOptionSelected=function(A){for(var C in this._listOptions){var B=this._listOptions[C];if(B.td_a!=null&&B.td_b!=null&&B.tr.en)if(C==A){B.tr._selected=true;B.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":"");if(this.mode=="select"){if(B.tr._img)this.setItemImage(B.tr._img);else this.clearItemImage();this.setItemText(this.getListOptionText(A))}}else{B.tr._selected=false;B.tr.className="tr_btn"}B=null}};this.getListOptionSelected=function(){var A=null;for(var B in this._listOptions)if(this._listOptions[B].tr._selected==true)A=B;return A};this._isListButton=function(A,B){if(this._listOptions[A]==null)return false;if(!B&&this._listOptions[A].tr.className=="tr_sep")return false;return true};this.setMaxOpen=function(A){this._ph=null;if(typeof(A)=="number"){this.maxOpen=A;this._maxOpenTest();return}this.maxOpen=null};if(E.width)this.setWidth(E.width);if(this.mode=="select"&&typeof(E.selected)!="undefined")this.setListOptionSelected(E.selected);return this};dhtmlXToolbarObject.prototype._buttonInputObject=function(B,A,C){this.id=B.idPrefix+A;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn def";this.obj.style.display=(C.hidden!=null?"none":"");this.obj.idd=String(A);this.obj.w=(C.width!=null?C.width:100);this.obj.title=(C.title!=null?C.title:"");this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(C.value!=null?" value='"+C.value+"'":"")+">";var E=B,D=this;this.obj.childNodes[0].onkeydown=function(A){A=A||event;if(A.keyCode==13)E.callEvent("onEnter",[D.obj.idd,this.value])};B.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=false};this.disableItem=function(){this.obj.childNodes[0].disabled=true};this.isEnabled=function(){return(!this.obj.childNodes[0].disabled)};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display!="none")};this.setValue=function(A){this.obj.childNodes[0].value=A};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(A){this.obj.w=A;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(A){this.obj.title=A};this.getItemToolTip=function(){return this.obj.title};this.getInput=function(){return this.obj.firstChild};return this};dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(B,A,C){this.id=B.idPrefix+A;this.state=(C.enabled!=null?false:true);this.imgEn=(C.img!=null?C.img:"");this.imgDis=(C.imgdis!=null?C.imgdis:"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.pressed=(C.selected!=null);this.obj.extAction=(C.action||null);this.obj.className="dhx_toolbar_btn "+(this.obj.pressed?"pres"+(this.state?"":"_dis"):(this.state?"def":"dis"));this.obj.style.display=(C.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.idd=String(A);this.obj.title=(C.title||"");if(this.obj.pressed)this.obj.renderAs="dhx_toolbar_btn over";this.obj.innerHTML=B._rtlParseBtn((this.img!=""?"<img src='"+B.imagePath+this.img+"'>":""),(C.text!=null?"<div>"+C.text+"</div>":""));B.base.appendChild(this.obj);var D=this;this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){if(D.state==false)return;if(B.anyUsed!="none")return;if(this.pressed){this.renderAs="dhx_toolbar_btn over";return}this.className="dhx_toolbar_btn over";this.renderAs=this.className};this.obj._doOnMouseOut=function(){if(D.state==false)return;if(B.anyUsed!="none")return;if(this.pressed){this.renderAs="dhx_toolbar_btn def";return}this.className="dhx_toolbar_btn def";this.renderAs=this.className};this.obj[B._isIPad?"ontouchstart":"onmousedown"]=function(C){if(B.checkEvent("onBeforeStateChange"))if(!B.callEvent("onBeforeStateChange",[this.idd.replace(B.idPrefix,""),this.pressed]))return;if(D.state==false)return;if(B.anyUsed!="none")return;this.pressed=!this.pressed;this.className=(this.pressed?"dhx_toolbar_btn pres":this.renderAs);var A=this.idd.replace(B.idPrefix,"");if(this.extAction){try{window[this.extAction](A,this.pressed)}catch(C){}}B.callEvent("onStateChange",[A,this.pressed]);return false};this.setItemState=function(D,E){if(this.obj.pressed!=D){if(D==true){this.obj.pressed=true;this.obj.className="dhx_toolbar_btn pres"+(this.state?"":"_dis");this.obj.renderAs="dhx_toolbar_btn over"}else{this.obj.pressed=false;this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.renderAs=this.obj.className}if(E==true){var A=this.obj.idd.replace(B.idPrefix,"");if(this.obj.extAction){try{window[this.obj.extAction](A,this.obj.pressed)}catch(C){}}B.callEvent("onStateChange",[A,this.obj.pressed])}}};this.getItemState=function(){return this.obj.pressed};this.enableItem=function(){B._enableItem(this)};this.disableItem=function(){B._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(A){B._setItemText(this,A)};this.getItemText=function(){return B._getItemText(this)};this.setItemImage=function(A){B._setItemImage(this,A,true)};this.clearItemImage=function(){B._clearItemImage(this,true)};this.setItemImageDis=function(A){B._setItemImage(this,A,false)};this.clearItemImageDis=function(){B._clearItemImage(this,false)};this.setItemToolTip=function(A){this.obj.title=A};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._sliderObject=function(C,B,D){this.id=C.idPrefix+B;this.state=(D.enabled!=null?(D.enabled=="true"?true:false):true);this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=(D.hidden!=null?"none":"");this.obj.onselectstart=function(A){A=A||event;A.returnValue=false};this.obj.idd=String(B);this.obj.len=(D.length!=null?Number(D.length):50);this.obj.innerHTML="<div>"+(D.textMin||"")+"</div>"+"<div class='sl_bg_l'></div>"+"<div class='sl_bg_m' style='width:"+this.obj.len+"px;'></div>"+"<div class='sl_bg_r'></div>"+"<div>"+(D.textMax||"")+"</div>";C.base.appendChild(this.obj);var F=this;this.pen=document.createElement("DIV");this.pen.className="sl_pen";this.obj.appendChild(this.pen);var A=this.pen;this.label=document.createElement("DIV");this.label.dir="ltr";this.label.className="dhx_toolbar_slider_label_"+C.skin+(C.rtl?"_rtl":"");this.label.style.display="none";this.label.tip=(D.toolTip||"%v");document.body.appendChild(this.label);var E=this.label;this.pen.valueMin=(D.valueMin!=null?Number(D.valueMin):0);this.pen.valueMax=(D.valueMax!=null?Number(D.valueMax):100);if(this.pen.valueMin>this.pen.valueMax)this.pen.valueMin=this.pen.valueMax;this.pen.valueNow=(D.valueNow!=null?Number(D.valueNow):this.pen.valueMax);if(this.pen.valueNow>this.pen.valueMax)this.pen.valueNow=this.pen.valueMax;if(this.pen.valueNow<this.pen.valueMin)this.pen.valueNow=this.pen.valueMin;this.pen._detectLimits=function(){this.minX=F.obj.childNodes[1].offsetLeft-4;this.maxX=F.obj.childNodes[3].offsetLeft-this.offsetWidth+1};this.pen._detectLimits();this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX);this.style.left=this.nowX+"px";this.newNowX=this.nowX};this.pen._definePos();this.pen.initXY=0;this.pen.allowMove=false;this.pen[C._isIPad?"ontouchstart":"onmousedown"]=function(A){if(F.state==false)return;A=A||event;this.initXY=(C._isIPad?A.touches[0].clientX:A.clientX);this.newValueNow=this.valueNow;this.allowMove=true;this.className="sl_pen over";if(E.tip!=""){E.style.visibility="hidden";E.style.display="";E.innerHTML=E.tip.replace("%v",this.valueNow);E.style.left=Math.round(getAbsoluteLeft(this)+this.offsetWidth/2-E.offsetWidth/2)+"px";E.style.top=getAbsoluteTop(this)-E.offsetHeight-3+"px";E.style.visibility=""}};this.pen._doOnMouseMoveStart=function(B){B=B||event;if(!A.allowMove)return;var D=(C._isIPad?B.touches[0].clientX:B.clientX),F=D-A.initXY;if(D<getAbsoluteLeft(A)+Math.round(A.offsetWidth/2)&&A.nowX==A.minX)return;if(D>getAbsoluteLeft(A)+Math.round(A.offsetWidth/2)&&A.nowX==A.maxX)return;A.newNowX=A.nowX+F;if(A.newNowX<A.minX)A.newNowX=A.minX;if(A.newNowX>A.maxX)A.newNowX=A.maxX;A.nowX=A.newNowX;A.style.left=A.nowX+"px";A.initXY=D;A.newValueNow=Math.round((A.valueMax-A.valueMin)*(A.newNowX-A.minX)/(A.maxX-A.minX)+A.valueMin);if(E.tip!=""){E.innerHTML=E.tip.replace(/%v/gi,A.newValueNow);E.style.left=Math.round(getAbsoluteLeft(A)+A.offsetWidth/2-E.offsetWidth/2)+"px";E.style.top=getAbsoluteTop(A)-E.offsetHeight-3+"px"}B.cancelBubble=true;B.returnValue=false;return false};this.pen._doOnMouseMoveEnd=function(){if(!A.allowMove)return;A.className="sl_pen";A.allowMove=false;A.nowX=A.newNowX;A.valueNow=A.newValueNow;if(E.tip!="")E.style.display="none";C.callEvent("onValueChange",[F.obj.idd.replace(C.idPrefix,""),A.valueNow])};if(C._isIPad){document.addEventListener("touchmove",A._doOnMouseMoveStart,false);document.addEventListener("touchend",A._doOnMouseMoveEnd,false)}else if(_isIE){document.body.attachEvent("onmousemove",A._doOnMouseMoveStart);document.body.attachEvent("onmouseup",A._doOnMouseMoveEnd)}else{window.addEventListener("mousemove",A._doOnMouseMoveStart,false);window.addEventListener("mouseup",A._doOnMouseMoveEnd,false)}this.enableItem=function(){if(this.state)return;this.state=true;this.obj.className="dhx_toolbar_btn def"};this.disableItem=function(){if(!this.state)return;this.state=false;this.obj.className="dhx_toolbar_btn dis"};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setValue=function(A,B){A=Number(A);if(A<this.pen.valueMin)A=this.pen.valueMin;if(A>this.pen.valueMax)A=this.pen.valueMax;this.pen.valueNow=A;this.pen._definePos();if(B==true)C.callEvent("onValueChange",[this.obj.idd.replace(C.idPrefix,""),this.pen.valueNow])};this.getValue=function(){return this.pen.valueNow};this.setMinValue=function(A,B){A=Number(A);if(A>this.pen.valueMax)return;this.obj.childNodes[0].innerHTML=B;this.obj.childNodes[0].style.display=(B.length>0?"":"none");this.pen.valueMin=A;if(this.pen.valueNow<this.pen.valueMin)this.pen.valueNow=this.pen.valueMin;this.pen._detectLimits();this.pen._definePos()};this.setMaxValue=function(A,B){A=Number(A);if(A<this.pen.valueMin)return;this.obj.childNodes[4].innerHTML=B;this.obj.childNodes[4].style.display=(B.length>0?"":"none");this.pen.valueMax=A;if(this.pen.valueNow>this.pen.valueMax)this.pen.valueNow=this.pen.valueMax;this.pen._detectLimits();this.pen._definePos()};this.getMinValue=function(){var B=this.obj.childNodes[0].innerHTML,A=this.pen.valueMin;return new Array(A,B)};this.getMaxValue=function(){var B=this.obj.childNodes[4].innerHTML,A=this.pen.valueMax;return new Array(A,B)};this.setItemToolTipTemplate=function(A){this.label.tip=A};this.getItemToolTipTemplate=function(){return this.label.tip};return this};dhtmlXToolbarObject.prototype.unload=function(){if(this._isIPad)document.removeEventListener("touchstart",this._doOnClick,false);else if(_isIE)document.body.detachEvent("onclick",this._doOnClick);else window.removeEventListener("click",this._doOnClick,false);this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader){this._xmlLoader.destructor();this._xmlLoader=null}while(this.base.childNodes.length>0)this.base.removeChild(this.base.childNodes[0]);this.cont.removeChild(this.base);this.base=null;while(this.cont.childNodes.length>0)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="";this.cont=null;this.detachAllEvents();this.tX1=null;this.tX2=null;this.tY1=null;this.tY2=null;this._isIE6=null;this._isWebToolbar=null;this.align=null;this.anyUsed=null;this.idPrefix=null;this.imagePath=null;this.rootTypes=null;this.selectPolygonOffsetLeft=null;this.selectPolygonOffsetTop=null;this.skin=null;this._rtl=null;this._rtlParseBtn=null;this.setRTL=null;this._sbw=null;this._getObj=null;this._addImgObj=null;this._setItemImage=null;this._clearItemImage=null;this._setItemText=null;this._getItemText=null;this._enableItem=null;this._disableItem=null;this._xmlParser=null;this._doOnLoad=null;this._addItemToStorage=null;this._genStr=null;this._addItem=null;this._getPosition=null;this._setPosition=null;this._getIdByPosition=null;this._separatorObject=null;this._textObject=null;this._buttonObject=null;this._buttonSelectObject=null;this._buttonInputObject=null;this._buttonTwoStateObject=null;this._sliderObject=null;this._autoDetectVisibleArea=null;this._removeItem=null;this.setAlign=null;this.setSkin=null;this.setIconsPath=null;this.setIconPath=null;this.loadXML=null;this.loadXMLString=null;this.attachEvent=null;this.callEvent=null;this.checkEvent=null;this.eventCatcher=null;this.detachEvent=null;this.detachAllEvents=null;this.clearAll=null;this.addSpacer=null;this.removeSpacer=null;this.getType=null;this.getTypeExt=null;this.inArray=null;this.getParentId=null;this.addButton=null;this.addText=null;this.addButtonSelect=null;this.addButtonTwoState=null;this.addSeparator=null;this.addSlider=null;this.addInput=null;this.forEachItem=null;this.showItem=null;this.hideItem=null;this.isVisible=null;this.enableItem=null;this.disableItem=null;this.isEnabled=null;this.setItemText=null;this.getItemText=null;this.setItemToolTip=null;this.getItemToolTip=null;this.setItemImage=null;this.setItemImageDis=null;this.clearItemImage=null;this.clearItemImageDis=null;this.setItemState=null;this.getItemState=null;this.setItemToolTipTemplate=null;this.getItemToolTipTemplate=null;this.setValue=null;this.getValue=null;this.setMinValue=null;this.getMinValue=null;this.setMaxValue=null;this.getMaxValue=null;this.setWidth=null;this.getWidth=null;this.getPosition=null;this.setPosition=null;this.removeItem=null;this.addListOption=null;this.removeListOption=null;this.showListOption=null;this.hideListOption=null;this.isListOptionVisible=null;this.enableListOption=null;this.disableListOption=null;this.isListOptionEnabled=null;this.setListOptionPosition=null;this.getListOptionPosition=null;this.setListOptionText=null;this.getListOptionText=null;this.setListOptionToolTip=null;this.getListOptionToolTip=null;this.setListOptionImage=null;this.getListOptionImage=null;this.clearListOptionImage=null;this.forEachListOption=null;this.getAllListOptions=null;this.setListOptionSelected=null;this.getListOptionSelected=null;this.unload=null;this.setUserData=null;this.getUserData=null;this.setMaxOpen=null;this.items=null};dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft;this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth);this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};dhtmlXToolbarObject.prototype.setUserData=function(A,C,D){if(this.objPull[this.idPrefix+A]==null)return;var B=this.objPull[this.idPrefix+A];if(B.userData==null)B.userData={};B.userData[C]=D};dhtmlXToolbarObject.prototype.getUserData=function(A,B){if(this.objPull[this.idPrefix+A]==null)return null;if(this.objPull[this.idPrefix+A].userData==null)return null;if(this.objPull[this.idPrefix+A].userData[B]==null)return null;return this.objPull[this.idPrefix+A].userData[B]};dhtmlXToolbarObject.prototype._isListOptionExists=function(B,A){if(this.objPull[this.idPrefix+B]==null)return false;var C=this.objPull[this.idPrefix+B];if(C.type!="buttonSelect")return false;if(C._listOptions[A]==null)return false;return true};dhtmlXToolbarObject.prototype.setListOptionUserData=function(B,A,C,D){if(!this._isListOptionExists(B,A))return;var E=this.objPull[this.idPrefix+B]._listOptions[A];if(E.userData==null)E.userData={};E.userData[C]=D};dhtmlXToolbarObject.prototype.getListOptionUserData=function(B,A,C){if(!this._isListOptionExists(B,A))return null;var D=this.objPull[this.idPrefix+B]._listOptions[A];if(!D.userData)return null;return(D.userData[C]?D.userData[C]:null)};(function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(A){return[A.parent,A.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(A){for(var C=0;C<A.length;C++){var B=A[C];if(B.type=="button")this.addButton(B.id,null,B.text,B.img,B.img_disabled);if(B.type=="separator")this.addSeparator(B.id,null);if(B.type=="text")this.addText(B.id,null,B.text);if(B.type=="buttonSelect")this.addButtonSelect(B.id,null,B.text,B.options,B.img,B.img_disabled,B.renderSelect,B.openAll,B.maxOpen);if(B.type=="buttonTwoState")this.addButtonTwoState(B.id,null,B.text,B.img,B.img_disabled);if(B.type=="buttonInput")this.addInput(B.id,null,B.text);if(B.type=="slider")this.addSlider(B.id,null,B.length,B.value_min,B.value_max,B.value_now,B.text_min,B.text_max,B.tip_template);if(B.width)this.setWidth(B.id,B.width);if(B.disabled)this.disableItem(B.id);if(B.tooltip)this.setItemToolTip(B.id,B.tooltip);if(B.pressed===true)this.setItemState(B.id,true)}}})})();function dhtmlXWindowsSngl(){}function dhtmlXWindowsBtn(){}function dhtmlXWindows(){if(!window.dhtmlXContainer){alert(this.i18n.dhx);return}this.engine="dhx";var C="_"+this.engine+"_Engine";if(!this[C]){alert(this.i18n.noenginealert);return}else this[C]();this._isIPad=(navigator.userAgent.search(/iPad/gi)>=0);var A=this;this.pathPrefix="dhxwins_";this.imagePath=dhtmlx.image_path||"codebase/imgs/";this.setImagePath=function(A){this.imagePath=A};this.skin=(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:"dhx_skyblue");this.skinParams={"dhx_black":{"header_height":21,"border_left_width":2,"border_right_width":2,"border_bottom_height":2},"dhx_blue":{"header_height":21,"border_left_width":2,"border_right_width":2,"border_bottom_height":2},"dhx_skyblue":{"header_height":21,"border_left_width":2,"border_right_width":2,"border_bottom_height":2}};this.setSkin=function(A){this.skin=A;this._engineRedrawSkin()};this.isWindow=function(A){var B=(this.wins[A]!=null);return B};this.findByText=function(A){var C=new Array();for(var B in this.wins)if(this.wins[B].getText().search(A,"gi")>=0)C[C.length]=this.wins[B];return C};this.window=function(A){var B=null;if(this.wins[A]!=null)B=this.wins[A];return B};this.forEachWindow=function(B){for(var A in this.wins)B(this.wins[A])};this.getBottommostWindow=function(){var B=this.getTopmostWindow();for(var A in this.wins)if(this.wins[A].zi<B.zi)B=this.wins[A];return(B.zi!=0?B:null)};this.getTopmostWindow=function(A){var C={"zi":0};for(var B in this.wins)if(this.wins[B].zi>C.zi){if(A==true&&!this._isWindowHidden(this.wins[B]))C=this.wins[B];if(A!=true)C=this.wins[B]}return(C.zi!=0?C:null)};this.wins={};for(var B in this.wins)delete this.wins[B];this.autoViewport=true;this._createViewport=function(){this.vp=document.body;this._clearVPCss();this.vp._css=(String(this.vp.className).length>0?this.vp.className:"");this.vp.className+=" dhtmlx_skin_"+this.skin+(this._r?" dhx_wins_rtl":"");this.modalCoverI=document.createElement("IFRAME");this.modalCoverI.frameBorder="0";this.modalCoverI.className="dhx_modal_cover_ifr";this.modalCoverI.setAttribute("src","javascript:false;");this.modalCoverI.style.display="none";this.modalCoverI.style.zIndex=0;this.vp.appendChild(this.modalCoverI);this.modalCoverD=document.createElement("DIV");this.modalCoverD.className="dhx_modal_cover_dv";this.modalCoverD.style.display="none";this.modalCoverD.style.zIndex=0;this.vp.appendChild(this.modalCoverD);this._vpcover=document.createElement("DIV");this._vpcover.className="dhx_content_vp_cover";this._vpcover.style.display="none";this.vp.appendChild(this._vpcover);this._carcass=document.createElement("DIV");this._carcass.className="dhx_carcass_resmove";this._carcass.style.display="none";if(_isIE){this._carcass.innerHTML="<iframe border=0 frameborder=0 style='filter: alpha(opacity=0);width: 100%;height:100%;position: absolute;top: 0px;left: 0px;width: 100%;height: 100%;'></iframe><div style='position: absolute;top: 0px;left: 0px;width: 100%;height: 100%;'></div>";this._carcass.childNodes[0].setAttribute("src","javascript:false;")}this._carcass.onselectstart=function(A){A=A||event;A.returnValue=false};this.vp.appendChild(this._carcass)};this._clearVPCss=function(A){this.vp.className=String(this.vp.className).replace(/[a-z_]{1,}/gi,function(A){return({"dhtmlx_skin_dhx_skyblue":1,"dhtmlx_skin_dhx_blue":1,"dhtmlx_skin_dhx_black":1,"dhtmlx_skin_dhx_web":1,"dhtmlx_skin_dhx_terrace":1}[A]==1?"":A)})};this._autoResizeViewport=function(){for(var D in this.wins){if(this.wins[D]._isFullScreened){this.wins[D]._content.style.width=document.body.offsetWidth-(_isIE?4:0)+"px";if(document.body.offsetHeight==0){if(window.innerHeight)this.wins[D]._content.style.height=window.innerHeight+"px";else this.wins[D]._content.style.height=document.body.scrollHeight+"px"}else this.wins[D]._content.style.height=document.body.offsetHeight-(_isIE?4:0)+"px";if(this.wins[D].layout!=null&&_isOpera)this.wins[D].layout._fixCellsContentOpera950();this.wins[D].updateNestedObjects()}if(this.wins[D]._isMaximized&&this.wins[D].style.display!="none"){this._restoreWindow(D);this._maximizeWindow(D)}}if(this.vp==document.body)return;if(this.autoViewport==false)return;this.vp.style.width=(_isIE?document.body.offsetWidth-4:window.innerWidth)+"px";this.vp.style.height=(_isIE?document.body.offsetHeight-4:window.innerHeight)+"px";for(D in this.wins){var E=this.wins[D],C=false,B=false;if(E.x>this.vp.offsetWidth-10){E.x=this.vp.offsetWidth-10;C=true}var A=(E._skinParams!=null?E._skinParams:this.skinParams[this.skin]);if(E.y+A["header_height"]>this.vp.offsetHeight){E.y=this.vp.offsetHeight-A["header_height"];B=true}if(C||B)this._engineRedrawWindowPos(E)}};this.enableAutoViewport=function(A){if(this.vp!=document.body)return;this.autoViewport=A;if(A==false){if(this.vp==document.body)document.body.className=this.vp._css;this.vp.removeChild(this.modalCoverI);this.vp.removeChild(this.modalCoverD);this.vp.removeChild(this._vpcover);this.vp.removeChild(this._carcass);this.vp=null;this.vp=document.createElement("DIV");this.vp.autocreated=true;this.vp.className="dhtmlx_winviewport dhtmlx_skin_"+this.skin+(this._r?" dhx_wins_rtl":"");this.vp.style.left="0px";this.vp.style.top="0px";document.body.appendChild(this.vp);this.vp.ax=0;this.vp.ay=0;this._autoResizeViewport();this.vp.appendChild(this.modalCoverI);this.vp.appendChild(this.modalCoverD);this.vp.appendChild(this._vpcover);this.vp.appendChild(this._carcass)}};this.attachViewportTo=function(A){if(this.autoViewport==false){this.vp.removeChild(this.modalCoverI);this.vp.removeChild(this.modalCoverD);this.vp.removeChild(this._vpcover);this.vp.removeChild(this._carcass);if(this.vp!=document.body)this.vp.parentNode.removeChild(this.vp);this.vp=null;this.vp=(typeof(A)=="string"?document.getElementById(A):A);this.vp.autocreated=false;this._clearVPCss();this.vp.className+=" dhtmlx_skin_"+this.skin+(this._r?" dhx_wins_rtl":"");this.vp.style.position="relative";this.vp.style.overflow="hidden";this.vp.ax=0;this.vp.ay=0;this.vp.appendChild(this.modalCoverI);this.vp.appendChild(this.modalCoverD);this.vp.appendChild(this._vpcover);this.vp.appendChild(this._carcass)}};this.setViewport=function(E,D,B,A,C){if(this.autoViewport==false){this.vp.style.left=E+"px";this.vp.style.top=D+"px";this.vp.style.width=B+"px";this.vp.style.height=A+"px";if(C!=null)C.appendChild(this.vp);this.vp.ax=getAbsoluteLeft(this.vp);this.vp.ay=getAbsoluteTop(this.vp)}};this._effects={"move":false,"resize":false};this.setEffect=function(A,B){if((this._effects[A]!=null)&&(typeof(B)=="boolean"))this._effects[A]=B};this.getEffect=function(A){return this._effects[A]};this.createWindow=function(B,I,H,E,C){var F=document.createElement("DIV");F.className="dhtmlx_window_inactive";F.dir="ltr";for(var D in this.wins){this.wins[D].zi+=this.zIndexStep;this.wins[D].style.zIndex=this.wins[D].zi}F.zi=this.zIndexStep;F.style.zIndex=F.zi;F.active=false;F._isWindow=true;F.isWindow=true;F.w=Number(E);F.h=Number(C);F.x=I;F.y=H;this._engineFixWindowPosInViewport(F);F._isModal=false;F._allowResize=true;F.maxW="auto";F.maxH="auto";F.minW=200;F.minH=140;F.iconsPresent=true;F.icons=new Array(this.imagePath+this.pathPrefix+this.skin+"/active/icon_normal.gif",this.imagePath+this.pathPrefix+this.skin+"/inactive/icon_normal.gif");F._allowMove=true;F._allowMoveGlobal=true;F._allowResizeGlobal=true;F._keepInViewport=false;var G=this.skinParams[this.skin];F.idd=B;this.vp.appendChild(F);this._engineSetWindowBody(F);this._engineRedrawWindowPos(F);this._engineRedrawWindowSize(F);this._engineUpdateWindowIcon(F,F.icons[0]);this._engineDiableOnSelectInWindow(F,true);this.wins[B]=F;dhtmlxEventable(F);this._engineGetWindowHeader(F)[this._isIPad?"ontouchstart":"onmousedown"]=function(C){C=C||event;var B=A.wins[this.idd];if(!B.isOnTop())B.bringToTop();if(A._engineGetWindowHeaderState(B))return;if(!A._engineCheckHeaderMouseDown(B,C))return;if(!B._allowMove||!B._allowMoveGlobal)return;A._wasMoved=false;B.moveOffsetX=B.x-(A._isIPad?C.touches[0].clientX:C.clientX);B.moveOffsetY=B.y-(A._isIPad?C.touches[0].clientY:C.clientY);A.movingWin=B;if(A._effects["move"]==false){A._carcass.x=A.movingWin.x;A._carcass.y=A.movingWin.y;A._carcass.w=parseInt(A.movingWin.style.width)+(_isIE?0:-2);A._carcass.h=parseInt(A.movingWin.style.height)+(_isIE?0:-2);A._carcass.style.left=A._carcass.x+"px";A._carcass.style.top=A._carcass.y+"px";A._carcass.style.width=A._carcass.w+"px";A._carcass.style.height=A._carcass.h+"px";A._carcass.style.zIndex=A._getTopZIndex(true)+1;A._carcass._keepInViewport=F._keepInViewport}A._blockSwitcher(true);A._vpcover.style.zIndex=A.movingWin.style.zIndex-1;A._vpcover.style.display="";C.returnValue=false;C.cancelBubble=true;return false};this._engineGetWindowHeader(F).ondblclick=function(C){var B=A.wins[this.idd];if(!A._engineCheckHeaderMouseDown(B,C||event))return;if(B._allowResizeGlobal&&!B._isParked)if(B._isMaximized==true)A._restoreWindow(B.idd);else A._maximizeWindow(B.idd);B=null};F.setText=function(B){A._engineGetWindowLabel(this).innerHTML=B};F.getText=function(){return A._engineGetWindowLabel(this).innerHTML};F.getId=function(){return this.idd};F.show=function(){A._showWindow(this)};F.hide=function(){A._hideWindow(this)};F.minimize=function(){A._restoreWindow(this.idd)};F.maximize=function(){A._maximizeWindow(this.idd)};F.close=function(){A._closeWindow(this.idd)};F.park=function(){if(this._isParkedAllowed)A._parkWindow(this.winId)};F.stick=function(){A._stickWindow(this.idd)};F.unstick=function(){A._unstickWindow(this.idd)};F.isSticked=function(){return this._isSticked};F.setIcon=function(B,C){A._setWindowIcon(F,B,C)};F.getIcon=function(){return A._getWindowIcon(this)};F.clearIcon=function(){A._clearWindowIcons(this)};F.restoreIcon=function(){A._restoreWindowIcons(this)};F.keepInViewport=function(A){this._keepInViewport=A};F.setModal=function(B){if(B==true){if(A.modalWin!=null||A.modalWin==this)return;A._setWindowModal(this,true)}else{if(A.modalWin!=this)return;A._setWindowModal(this,false)}};F.isModal=function(){return this._isModal};F.isHidden=function(){return A._isWindowHidden(this)};F.isMaximized=function(){return this._isMaximized};F.isParked=function(){return this._isParked};F.allowPark=function(){A._allowParking(this)};F.denyPark=function(){A._denyParking(this)};F.isParkable=function(){return this._isParkedAllowed};F.allowResize=function(){A._allowReszieGlob(this)};F.denyResize=function(){A._denyResize(this)};F.isResizable=function(){return this._allowResizeGlobal};F.allowMove=function(){if(!this._isMaximized)this._allowMove=true;this._allowMoveGlobal=true};F.denyMove=function(){this._allowMoveGlobal=false};F.isMovable=function(){return this._allowMoveGlobal};F.bringToTop=function(){A._bringOnTop(this);A._makeActive(this)};F.bringToBottom=function(){A._bringOnBottom(this)};F.isOnTop=function(){return A._isWindowOnTop(this)};F.isOnBottom=function(){return A._isWindowOnBottom(this)};F.setPosition=function(C,B){this.x=C;this.y=B;A._engineFixWindowPosInViewport(this);A._engineRedrawWindowPos(this)};F.getPosition=function(){return new Array(this.x,this.y)};F.setDimension=function(C,B){if(C!=null){if(this.maxW!="auto")if(C>this.maxW)C=this.maxW;if(C<this.minW)C=this.minW;this.w=C}if(B!=null){if(this.maxH!="auto")if(B>this.maxH)B=this.maxH;if(B<this.minH)B=this.minH;this.h=B}A._fixWindowDimensionInViewport(this);A._engineFixWindowPosInViewport(this);A._engineRedrawWindowSize(this);this.updateNestedObjects()};F.getDimension=function(){return new Array(this.w,this.h)};F.setMaxDimension=function(C,B){this.maxW=(isNaN(C)?"auto":C);this.maxH=(isNaN(B)?"auto":B);A._engineRedrawWindowSize(this)};F.getMaxDimension=function(){return new Array(this.maxW,this.maxH)};F.setMinDimension=function(C,B){if(C!=null)this.minW=C;if(B!=null)this.minH=B;A._fixWindowDimensionInViewport(this);A._engineRedrawWindowPos(this)};F.getMinDimension=function(){return new Array(this.minW,this.minH)};F._adjustToContent=function(C,B){A._engineAdjustWindowToContent(this,C,B)};F._doOnAttachMenu=function(){A._engineRedrawWindowSize(this);this.updateNestedObjects()};F._doOnAttachToolbar=function(){A._engineRedrawWindowSize(this);this.updateNestedObjects()};F._doOnAttachStatusBar=function(){A._engineRedrawWindowSize(this);this.updateNestedObjects()};F._doOnFrameMouseDown=function(){this.bringToTop()};F._doOnFrameContentLoaded=function(){A.callEvent("onContentLoaded",[this])};F.addUserButton=function(B,F,D,E){var C=A._addUserButton(this,B,F,D,E);return C};F.removeUserButton=function(B){B=String(B).toLowerCase();if(!((B=="minmax1")||(B=="minmax2")||(B=="park")||(B=="close")||(B=="stick")||(B=="unstick")||(B=="help")))if(btn!=null)A._removeUserButton(this,B)};F.progressOn=function(){A._engineSwitchWindowProgress(this,true)};F.progressOff=function(){A._engineSwitchWindowProgress(this,false)};F.setToFullScreen=function(B){A._setWindowToFullScreen(this,B)};F.showHeader=function(){A._engineSwitchWindowHeader(this,true)};F.hideHeader=function(){A._engineSwitchWindowHeader(this,false)};F.progressOff();F.canStartResize=false;F.onmousemove=function(B){if(_isIE&&this._isMaximized)return true;B=B||event;var E=B.target||B.srcElement;if(String(E.className).search("dhtmlx_wins_resizer")<0)E=null;if(!this._allowResize||this._allowResizeGlobal==false||!E){if(E)if(E.style.cursor!="default")E.style.cursor="default";if(this.style.cursor!="default")this.style.cursor="default";this.canStartResize=false;return true}if(A.resizingWin!=null)return;if(A.movingWin!=null)return;if(this._isParked)return;if(A._isIPad)var C=B.touches[0].clientX,D=B.touches[0].clientY;else C=(_isIE||_isOpera?B.offsetX:B.layerX),D=(_isIE||_isOpera?B.offsetY:B.layerY);var H=A._engineAllowWindowResize(F,E,C,D);if(H==null){this.canStartResize=false;if(E.style.cursor!="default")E.style.cursor="default";if(this.style.cursor!="default")this.style.cursor="default";return}A.resizingDirs=H;var G={x:B.clientX,y:B.clientY};switch(A.resizingDirs){case"border_left":E.style.cursor="w-resize";this.resizeOffsetX=this.x-G.x;break;case"border_right":E.style.cursor="e-resize";this.resizeOffsetXW=this.x+this.w-G.x;break;case"border_top":E.style.cursor="n-resize";this.resizeOffsetY=this.y-G.y;break;case"border_bottom":E.style.cursor="n-resize";this.resizeOffsetYH=this.y+this.h-G.y;break;case"corner_left":E.style.cursor="sw-resize";this.resizeOffsetX=this.x-B.clientX;this.resizeOffsetYH=this.y+this.h-G.y;break;case"corner_up_left":E.style.cursor="nw-resize";this.resizeOffsetY=this.y-G.y;this.resizeOffsetX=this.x-G.x;break;case"corner_right":E.style.cursor="nw-resize";this.resizeOffsetXW=this.x+this.w-G.x;this.resizeOffsetYH=this.y+this.h-G.y;break;case"corner_up_right":E.style.cursor="sw-resize";this.resizeOffsetY=this.y-G.y;this.resizeOffsetXW=this.x+this.w-G.x;break}this.canStartResize=true;this.style.cursor=E.style.cursor;B.cancelBubble=true;B.returnValue=false;return false};F.onmousedown=function(B){if(A._getActive()!=this)A._makeActive(this);A._bringOnTop(this);if(this.canStartResize){A._blockSwitcher(true);A.resizingWin=this;if(!A._effects["resize"]){A._carcass.x=A.resizingWin.x;A._carcass.y=A.resizingWin.y;A._carcass.w=Number(A.resizingWin.w)+(_isIE?0:-2);A._carcass.h=Number(A.resizingWin.h)+(_isIE?0:-2);A._carcass.style.left=A._carcass.x+"px";A._carcass.style.top=A._carcass.y+"px";A._carcass.style.width=A._carcass.w+"px";A._carcass.style.height=A._carcass.h+"px";A._carcass.style.zIndex=A._getTopZIndex(true)+1;A._carcass.style.cursor=this.style.cursor;A._carcass._keepInViewport=this._keepInViewport;A._carcass.style.display=""}A._vpcover.style.zIndex=A.resizingWin.style.zIndex-1;A._vpcover.style.display="";if(this.vs[this.av].layout)this.callEvent("_onBeforeTryResize",[this]);B=B||event}};this._addDefaultButtons(F.idd);F.button=function(A){A=String(A).toLowerCase();var B=null;if(this.btns[A]!=null)B=this.btns[A];return B};F.center=function(){A._centerWindow(this,false)};F.centerOnScreen=function(){A._centerWindow(this,true)};F._attachContent("empty",null);F._redraw=function(){A._engineRedrawWindowSize(this)};F.bringToTop();this._engineRedrawWindowSize(F);return this.wins[B]};this.zIndexStep=50;this._getTopZIndex=function(A){var C=0;for(var B in this.wins)if(A==true){if(this.wins[B].zi>C)C=this.wins[B].zi}else if(this.wins[B].zi>C&&!this.wins[B]._isSticked)C=this.wins[B].zi;return C};this.movingWin=null;this._moveWindow=function(B){if(this.movingWin!=null){if(!this.movingWin._allowMove||!this.movingWin._allowMoveGlobal)return;if(this._effects["move"]==true){if(this._engineGetWindowHeader(this.movingWin).style.cursor!="move")this._engineGetWindowHeader(this.movingWin).style.cursor="move";this._wasMoved=true;this.movingWin.x=(this._isIPad?B.touches[0].clientX:B.clientX)+this.movingWin.moveOffsetX;this.movingWin.y=(this._isIPad?B.touches[0].clientY:B.clientY)+this.movingWin.moveOffsetY;this._engineFixWindowPosInViewport(this.movingWin);this._engineRedrawWindowPos(this.movingWin)}else{if(this._carcass.style.display!="")this._carcass.style.display="";if(this._carcass.style.cursor!="move")this._carcass.style.cursor="move";if(this._engineGetWindowHeader(this.movingWin).style.cursor!="move")this._engineGetWindowHeader(this.movingWin).style.cursor="move";this._carcass.x=(this._isIPad?B.touches[0].clientX:B.clientX)+this.movingWin.moveOffsetX;this._carcass.y=(this._isIPad?B.touches[0].clientY:B.clientY)+this.movingWin.moveOffsetY;this._wasMoved=true;this._engineFixWindowPosInViewport(this._carcass);this._carcass.style.left=this._carcass.x+"px";this._carcass.style.top=this._carcass.y+"px"}}if(this.resizingWin!=null){if(!this.resizingWin._allowResize)return;var D={x:B.clientX,y:B.clientY};if(this.resizingDirs=="border_left"||this.resizingDirs=="corner_left"||this.resizingDirs=="corner_up_left")if(this._effects["resize"]){var C=D.x+this.resizingWin.resizeOffsetX,A=(C>this.resizingWin.x?-1:1);newW=this.resizingWin.w+Math.abs(C-this.resizingWin.x)*A;if((newW<this.resizingWin.minW)&&(A<0)){this.resizingWin.x=this.resizingWin.x+this.resizingWin.w-this.resizingWin.minW;this.resizingWin.w=this.resizingWin.minW}else{this.resizingWin.w=newW;this.resizingWin.x=C}this._engineRedrawWindowPos(this.resizingWin);this._engineRedrawWindowSize(this.resizingWin)}else{C=D.x+this.resizingWin.resizeOffsetX,A=(C>this._carcass.x?-1:1);newW=this._carcass.w+Math.abs(C-this._carcass.x)*A;if(newW>this.resizingWin.maxW){newW=this.resizingWin.maxW;C=this._carcass.x+this._carcass.w-this.resizingWin.maxW}if((newW<this.resizingWin.minW)&&(A<0)){this._carcass.x=this._carcass.x+this._carcass.w-this.resizingWin.minW;this._carcass.w=this.resizingWin.minW}else{this._carcass.w=newW;this._carcass.x=C}this._carcass.style.left=this._carcass.x+"px";this._carcass.style.width=this._carcass.w+"px"}if(this.resizingDirs=="border_right"||this.resizingDirs=="corner_right"||this.resizingDirs=="corner_up_right")if(this._effects["resize"]){C=D.x-(this.resizingWin.x+this.resizingWin.w)+this.resizingWin.resizeOffsetXW;newW=this.resizingWin.w+C;if(newW<this.resizingWin.minW)newW=this.resizingWin.minW;this.resizingWin.w=newW;this._engineRedrawWindowPos(this.resizingWin);this._engineRedrawWindowSize(this.resizingWin)}else{C=D.x-(this._carcass.x+this._carcass.w)+this.resizingWin.resizeOffsetXW;newW=this._carcass.w+C;if(newW<this.resizingWin.minW)newW=this.resizingWin.minW;if(this.resizingWin.maxW!="auto")if(newW>this.resizingWin.maxW)newW=this.resizingWin.maxW;this._carcass.w=newW;this._carcass.style.width=this._carcass.w+"px"}if(this.resizingDirs=="border_bottom"||this.resizingDirs=="corner_left"||this.resizingDirs=="corner_right")if(this._effects["resize"]){C=D.y-(this.resizingWin.y+this.resizingWin.h)+this.resizingWin.resizeOffsetYH;newH=this.resizingWin.h+C;if(newH<this.resizingWin.minH)newH=this.resizingWin.minH;this.resizingWin.h=newH;this._engineRedrawWindowPos(this.resizingWin);this._engineRedrawWindowSize(this.resizingWin)}else{C=D.y-(this._carcass.y+this._carcass.h)+this.resizingWin.resizeOffsetYH;newH=this._carcass.h+C;if(newH<this.resizingWin.minH)newH=this.resizingWin.minH;if(newH>this.resizingWin.maxH)newH=this.resizingWin.maxH;this._carcass.h=newH;this._carcass.style.height=this._carcass.h+"px"}if(this.resizingDirs=="border_top"||this.resizingDirs=="corner_up_right"||this.resizingDirs=="corner_up_left")if(this._effects["resize"]);else{C=D.y+this.resizingWin.resizeOffsetY,A=(C>this.resizingWin.y?-1:1);newH=this.resizingWin.h+Math.abs(C-this.resizingWin.y)*A;if(newH>this.resizingWin.maxH){newH=this.resizingWin.maxH;C=this.resizingWin.y+this.resizingWin.h-this.resizingWin.maxH}if((newH<this.resizingWin.minH)&&(A<0)){this._carcass.y=this._carcass.y+this._carcass.h-this.resizingWin.minH;this._carcass.h=this.resizingWin.minH}else{this._carcass.h=newH+(_isIE?0:-2);this._carcass.y=C}this._carcass.style.top=this._carcass.y+"px";this._carcass.style.height=this._carcass.h+"px"}}};this._stopMove=function(){if(this.movingWin!=null){if(this._effects["move"]){var B=this.movingWin;this.movingWin=null;this._blockSwitcher(false);this._engineGetWindowHeader(B).style.cursor="";if(_isFF){B.h++;A._engineRedrawWindowPos(B);B.h--;A._engineRedrawWindowPos(B)}}else{this._carcass.style.cursor="";this._carcass.style.display="none";B=this.movingWin;this._engineGetWindowHeader(B).style.cursor="";this.movingWin=null;this._blockSwitcher(false);B.setPosition(parseInt(this._carcass.style.left),parseInt(this._carcass.style.top))}this._vpcover.style.display="none";if(this._wasMoved)if(B.checkEvent("onMoveFinish"))B.callEvent("onMoveFinish",[B]);else this.callEvent("onMoveFinish",[B]);this._wasMoved=false}if(this.resizingWin!=null){B=this.resizingWin;this.resizingWin=null;this._blockSwitcher(false);if(!this._effects["resize"]){this._carcass.style.display="none";B.setDimension(this._carcass.w+(_isIE?0:2),this._carcass.h+(_isIE?0:2));B.setPosition(this._carcass.x,this._carcass.y)}else B.updateNestedObjects();if(B.vs[B.av].layout)B.vs[B.av].layout.callEvent("onResize",[]);this._vpcover.style.display="none";if(B.checkEvent("onResizeFinish"))B.callEvent("onResizeFinish",[B]);else this.callEvent("onResizeFinish",[B])}};this._fixWindowDimensionInViewport=function(A){if(A.w<A.minW)A.w=A.minW;if(A._isParked)return;if(A.h<A.minH)A.h=A.minH};this._bringOnTop=function(C){var A=C.zi,D=this._getTopZIndex(C._isSticked);for(var B in this.wins)if(this.wins[B]!=C)if(C._isSticked||(!C._isSticked&&!this.wins[B]._isSticked))if(this.wins[B].zi>A){this.wins[B].zi=this.wins[B].zi-this.zIndexStep;this.wins[B].style.zIndex=this.wins[B].zi}C.zi=D;C.style.zIndex=C.zi};this._makeActive=function(D,B){for(var C in this.wins)if(this.wins[C]==D){var A=false;if(this.wins[C].className!="dhtmlx_window_active"&&!B)A=true;this.wins[C].className="dhtmlx_window_active";this._engineUpdateWindowIcon(this.wins[C],this.wins[C].icons[0]);if(A==true)if(D.checkEvent("onFocus"))D.callEvent("onFocus",[D]);else this.callEvent("onFocus",[D])}else{this.wins[C].className="dhtmlx_window_inactive";this._engineUpdateWindowIcon(this.wins[C],this.wins[C].icons[1])}};this._getActive=function(){var B=null;for(var A in this.wins)if(this.wins[A].className=="dhtmlx_window_active")B=this.wins[A];return B};this._centerWindow=function(D,A){if(D._isMaximized==true)return;if(A==true)var F=(_isIE?document.body.offsetWidth:window.innerWidth),E=(_isIE?document.body.offsetHeight:window.innerHeight);else F=(this.vp==document.body?document.body.offsetWidth:(Number(parseInt(this.vp.style.width))&&String(this.vp.style.width).search("%")==-1?parseInt(this.vp.style.width):this.vp.offsetWidth)),E=(this.vp==document.body?document.body.offsetHeight:(Number(parseInt(this.vp.style.height))&&String(this.vp.style.height).search("%")==-1?parseInt(this.vp.style.height):this.vp.offsetHeight));var B=Math.round((F/2)-(D.w/2)),C=Math.round((E/2)-(D.h/2));D.x=B;D.y=C;this._engineFixWindowPosInViewport(D);this._engineRedrawWindowPos(D)};this._addDefaultButtons=function(I){var K=this.wins[I],J=this._engineGetWindowButton(K,"stick");J.title=this.i18n.stick;J.isVisible=false;J.style.display="none";J._isEnabled=true;J.isPressed=false;J.label="stick";J._doOnClick=function(){this.isPressed=true;A._stickWindow(this.winId)};var H=this._engineGetWindowButton(K,"sticked");H.title=this.i18n.unstick;H.isVisible=false;H.style.display="none";H._isEnabled=true;H.isPressed=false;H.label="sticked";H._doOnClick=function(){this.isPressed=false;A._unstickWindow(this.winId)};var E=this._engineGetWindowButton(K,"help");E.title=this.i18n.help;E.isVisible=false;E.style.display="none";E._isEnabled=true;E.isPressed=false;E.label="help";E._doOnClick=function(){A._needHelp(this.winId)};var D=this._engineGetWindowButton(K,"park");D.titleIfParked=this.i18n.parkdown;D.titleIfNotParked=this.i18n.parkup;D.title=D.titleIfNotParked;D.isVisible=true;D._isEnabled=true;D.isPressed=false;D.label="park";D._doOnClick=function(){A._parkWindow(this.winId)};var G=this._engineGetWindowButton(K,"minmax1");G.title=this.i18n.maximize;G.isVisible=true;G._isEnabled=true;G.isPressed=false;G.label="minmax1";G._doOnClick=function(){A._maximizeWindow(this.winId)};var B=this._engineGetWindowButton(K,"minmax2");B.title=this.i18n.restore;B.isVisible=false;B.style.display="none";B._isEnabled=true;B.isPressed=false;B.label="minmax2";B._doOnClick=function(){A._restoreWindow(this.winId)};var L=this._engineGetWindowButton(K,"close");L.title=this.i18n.close;L.isVisible=true;L._isEnabled=true;L.isPressed=false;L.label="close";L._doOnClick=function(){A._closeWindow(this.winId)};var C=this._engineGetWindowButton(K,"dock");C.title=this.i18n.dock;C.style.display="none";C.isVisible=false;C._isEnabled=true;C.isPressed=false;C.label="dock";C._doOnClick=function(){};K._isSticked=false;K._isParked=false;K._isParkedAllowed=true;K._isMaximized=false;K._isDocked=false;K.btns={};K.btns["stick"]=J;K.btns["sticked"]=H;K.btns["help"]=E;K.btns["park"]=D;K.btns["minmax1"]=G;K.btns["minmax2"]=B;K.btns["close"]=L;K.btns["dock"]=C;for(var F in K.btns){K.btns[F].winId=K.idd;this._attachEventsOnButton(K.idd,F)}K=J=H=E=D=G=B=L=C=null};this._attachEventsOnButton=function(C,D){var B=this.wins[C].btns[D];if(!this._isIPad){B.onmouseover=function(){if(this._isEnabled)this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_over_"+(this.isPressed?"pressed":"default");else this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_disabled"};B.onmouseout=function(){if(this._isEnabled){this.isPressed=false;this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_default"}else this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_disabled"};B.onmousedown=function(){if(this._isEnabled){this.isPressed=true;this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_over_pressed"}else this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_disabled"};B.onmouseup=function(){if(this._isEnabled){var B=this.isPressed;this.isPressed=false;this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_over_default";if(B)if(this.checkEvent("onClick"))this.callEvent("onClick",[A.wins[this.winId],this]);else this._doOnClick()}else this.className="dhtmlx_wins_btns_button dhtmlx_button_"+this.label+"_disabled"}}else{B.ontouchstart=function(A){A.cancelBubble=true;A.returnValue=false;return false};B.ontouchend=function(B){B.cancelBubble=true;B.returnValue=false;if(!this._isEnabled)return false;if(this.checkEvent("onClick"))this.callEvent("onClick",[A.wins[this.winId],this]);else this._doOnClick();return false}}B.show=function(){A._showButton(A.wins[this.winId],this.label,true)};B.hide=function(){A._hideButton(A.wins[this.winId],this.label,true)};B.enable=function(){A._enableButton(A.wins[this.winId],this.label)};B.disable=function(){A._disableButton(A.wins[this.winId],this.label)};B.isEnabled=function(){return this._isEnabled};B.isHidden=function(){return(!this.isVisible)};dhtmlxEventable(B);B=null};this._parkWindow=function(C,B){var D=this.wins[C];if(!D._isParkedAllowed&&!B)return;if(this.enableParkEffect&&D.parkBusy)return;if(D._isParked){if(this.enableParkEffect&&!B){D.parkBusy=true;this._doParkDown(D)}else{D.h=D.lastParkH;this._engineRedrawWindowSize(D);this._engineDoOnWindowParkDown(D);D.updateNestedObjects();D.btns["park"].title=D.btns["park"].titleIfNotParked;if(D._allowResizeGlobal==true){this._enableButton(D,"minmax1");this._enableButton(D,"minmax2")}D._isParked=false;if(!B)if(D.checkEvent("onParkDown"))D.callEvent("onParkDown",[D]);else this.callEvent("onParkDown",[D])}}else if(this.enableParkEffect&&!B){D.lastParkH=(String(D.h).search(/\%$/)==-1?D.h:D.offsetHeight);if(D._allowResizeGlobal==true){this._disableButton(D,"minmax1");this._disableButton(D,"minmax2")}if(this.enableParkEffect){D.parkBusy=true;this._doParkUp(D)}else{var A=(D._skinParams!=null?D._skinParams:this.skinParams[this.skin]);D.h=A["header_height"]+A["border_bottom_height"];D.btns["park"].title=D.btns["park"].titleIfParked}}else{D.lastParkH=(String(D.h).search(/\%$/)==-1?D.h:D.offsetHeight);D.h=this._engineGetWindowParkedHeight(D);this._engineRedrawWindowSize(D);this._engineDoOnWindowParkUp(D);D.btns["park"].title=D.btns["park"].titleIfParked;D._isParked=true;if(!B)if(D.checkEvent("onParkUp"))D.callEvent("onParkUp",[D]);else this.callEvent("onParkUp",[D])}D=null};this._allowParking=function(A){A._isParkedAllowed=true;this._enableButton(A,"park")};this._denyParking=function(A){A._isParkedAllowed=false;this._disableButton(A,"park")};this.enableParkEffect=false;this.parkStartSpeed=80;this.parkSpeed=this.parkStartSpeed;this.parkTM=null;this.parkTMTime=5;this._doParkUp=function(C){if(String(C.h).search(/\%$/)!=-1)C.h=C.offsetHeight;C.h-=this.parkSpeed;var B=this._engineGetWindowParkedHeight(C);if(C.h<=B){C.h=B;this._engineGetWindowButton(C,"park").title=this._engineGetWindowButton(C,"park").titleIfParked;C._isParked=true;C.parkBusy=false;this._engineRedrawWindowSize(C);this._engineDoOnWindowParkUp(C);if(C.checkEvent("onParkUp"))C.callEvent("onParkUp",[C]);else this.callEvent("onParkUp",[C])}else{this._engineRedrawWindowSize(C);this.parkTM=window.setTimeout(function(){A._doParkUp(C)},this.parkTMTime)}};this._doParkDown=function(B){B.h+=this.parkSpeed;if(B.h>=B.lastParkH){B.h=B.lastParkH;this._engineGetWindowButton(B,"park").title=this._engineGetWindowButton(B,"park").titleIfNotParked;if(B._allowResizeGlobal==true){this._enableButton(B,"minmax1");this._enableButton(B,"minmax2")}B._isParked=false;B.parkBusy=false;this._engineRedrawWindowSize(B);B.updateNestedObjects();this._engineDoOnWindowParkDown(B);if(B.checkEvent("onParkDown"))B.callEvent("onParkDown",[B]);else this.callEvent("onParkDown",[B])}else{this._engineRedrawWindowSize(B);this.parkTM=window.setTimeout(function(){A._doParkDown(B)},this.parkTMTime)}};this._enableButton=function(C,A){var B=this._engineGetWindowButton(C,A);if(!B)return;B._isEnabled=true;B.className="dhtmlx_wins_btns_button dhtmlx_button_"+B.label+"_default";B=null};this._disableButton=function(C,A){var B=this._engineGetWindowButton(C,A);if(!B)return;B._isEnabled=false;B.className="dhtmlx_wins_btns_button dhtmlx_button_"+C.btns[A].label+"_disabled";B=null};this._allowReszieGlob=function(A){A._allowResizeGlobal=true;this._enableButton(A,"minmax1");this._enableButton(A,"minmax2")};this._denyResize=function(A){A._allowResizeGlobal=false;this._disableButton(A,"minmax1");this._disableButton(A,"minmax2")};this._maximizeWindow=function(B){var C=this.wins[B];if(C._allowResizeGlobal==false)return;var A=C._isParked;if(A)this._parkWindow(C.idd,true);C.lastMaximizeX=C.x;C.lastMaximizeY=C.y;C.lastMaximizeW=C.w;C.lastMaximizeH=C.h;if(C.maxW!="auto"&&C.maxW!="auto"){C.x=Math.round(C.x+(C.w-C.maxW)/2);C.y=Math.round(C.y+(C.h-C.maxH)/2);C._allowMove=true}else{C.x=0;C.y=0;C._allowMove=false}C._isMaximized=true;C._allowResize=false;C.w=(C.maxW=="auto"?(this.vp==document.body?"100%":(this.vp.style.width!=""&&String(this.vp.style.width).search("%")==-1?parseInt(this.vp.style.width):this.vp.offsetWidth)):C.maxW);C.h=(C.maxH=="auto"?(this.vp==document.body?"100%":(this.vp.style.height!=""&&String(this.vp.style.width).search("%")==-1?parseInt(this.vp.style.height):this.vp.offsetHeight)):C.maxH);this._hideButton(C,"minmax1");this._showButton(C,"minmax2");this._engineRedrawWindowPos(C);if(A)this._parkWindow(C.idd,true);else{this._engineRedrawWindowSize(C);C.updateNestedObjects()}if(C.checkEvent("onMaximize"))C.callEvent("onMaximize",[C]);else this.callEvent("onMaximize",[C]);C=null};this._restoreWindow=function(B){var C=this.wins[B];if(C._allowResizeGlobal==false)return;if(C.layout)C.layout._defineWindowMinDimension(C);var A=C._isParked;if(A)this._parkWindow(C.idd,true);if(C.maxW!="auto"&&C.maxW!="auto"){C.x=Math.round(C.x+(C.w-C.lastMaximizeW)/2);C.y=Math.round(C.y+(C.h-C.lastMaximizeH)/2)}else{C.x=C.lastMaximizeX;C.y=C.lastMaximizeY}C.w=C.lastMaximizeW;C.h=C.lastMaximizeH;C._isMaximized=false;C._allowMove=C._allowMoveGlobal;C._allowResize=true;this._fixWindowDimensionInViewport(C);this._hideButton(C,"minmax2");this._showButton(C,"minmax1");this._engineRedrawWindowPos(C);if(A)this._parkWindow(C.idd,true);else{this._engineRedrawWindowSize(C);C.updateNestedObjects()}if(C.checkEvent("onMinimize"))C.callEvent("onMinimize",[C]);else this.callEvent("onMinimize",[C]);C=null};this._showButton=function(D,B,A){var C=this._engineGetWindowButton(D,B);if(!C)return;if((!A&&C._userHide)||C.isVisible===true)return;C.isVisible=true;C.style.display="";C.style.visibility="visible";C._userHide=!(A==true);this._engineRedrawWindowTitle(D);C=null};this._hideButton=function(D,A,C){var B=this._engineGetWindowButton(D,A);if(!B||(!C&&B.isVisible===false))return;B.isVisible=false;B.style.display="none";B.style.visibility="hidden";B._userHide=(C==true);this._engineRedrawWindowTitle(D);B=null};this._showWindow=function(B){B.style.display="";if(B.checkEvent("onShow"))B.callEvent("onShow",[B]);else this.callEvent("onShow",[B]);var A=this._getActive();if(A==null){this._bringOnTop(B);this._makeActive(B)}else if(this._isWindowHidden(A)){this._bringOnTop(B);this._makeActive(B)}};this._hideWindow=function(B){B.style.display="none";if(B.checkEvent("onHide"))B.callEvent("onHide",[B]);else this.callEvent("onHide",[B]);var A=this.getTopmostWindow(true);if(A!=null){this._bringOnTop(A);this._makeActive(A)}};this._isWindowHidden=function(B){var A=(B.style.display=="none");return A};this._closeWindow=function(B){var C=this.wins[B];if(this._focusFixIE){this._focusFixIE.style.top=(this.vp==document.body?0:getAbsoluteTop(this.vp))+Number(C.y)+"px";this._focusFixIE.focus()}if(C.checkEvent("onClose")){if(!C.callEvent("onClose",[C]))return}else if(!this.callEvent("onClose",[C]))return;C=null;this._removeWindowGlobal(B);var D={"zi":0};for(var A in this.wins)if(this.wins[A].zi>D.zi)D=this.wins[A];if(D!=null)this._makeActive(D)};this._needHelp=function(A){var B=this.wins[A];if(B.checkEvent("onHelp"))B.callEvent("onHelp",[B]);else this.callEvent("onHelp",[B]);B=null};this._setWindowIcon=function(A,B,C){A.iconsPresent=true;A.icons[0]=this.imagePath+B;A.icons[1]=this.imagePath+C;this._engineUpdateWindowIcon(A,A.icons[A.isOnTop()?0:1])};this._getWindowIcon=function(A){if(A.iconsPresent)return new Array(A.icons[0],A.icons[1]);else return new Array(null,null)};this._clearWindowIcons=function(A){A.iconsPresent=false;A.icons[0]=this.imagePath+this.pathPrefix+this.skin+"/active/icon_blank.gif";A.icons[1]=this.imagePath+this.pathPrefix+this.skin+"/inactive/icon_blank.gif";this._engineUpdateWindowIcon(A,A.icons[A.isOnTop()?0:1])};this._restoreWindowIcons=function(A){A.iconsPresent=true;A.icons[0]=this.imagePath+this.pathPrefix+this.skin+"/active/icon_normal.gif";A.icons[1]=this.imagePath+this.pathPrefix+this.skin+"/inactive/icon_normal.gif";this._engineUpdateWindowIcon(A,A.icons[A.className=="dhtmlx_window_active"?0:1])};this._attachWindowContentTo=function(D,C,A,E){var B=this._engineGetWindowContent(D).parentNode;B.parentNode.removeChild(B);D.hide();B.style.left="0px";B.style.top="0px";B.style.width=(A!=null?A:C.offsetWidth)+"px";B.style.height=(E!=null?E:C.offsetHeight)+"px";B.style.position="relative";C.appendChild(B);this._engineGetWindowContent(D).style.width=B.style.width;this._engineGetWindowContent(D).style.height=B.style.height};this._setWindowToFullScreen=function(D,C){if(C==true){var B=D._content;B.parentNode.removeChild(B);D.hide();D._isFullScreened=true;B.style.left="0px";B.style.top="0px";B.style.width=document.body.offsetWidth-(_isIE?4:0)+"px";if(document.body.offsetHeight==0){if(window.innerHeight)B.style.height=window.innerHeight+"px";else B.style.height=document.body.scrollHeight+"px"}else B.style.height=document.body.offsetHeight-(_isIE?4:0)+"px";B.style.position="absolute";document.body.appendChild(B)}else if(C==false){var B=D.childNodes[0].childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1],A=D._content;document.body.removeChild(A);B.appendChild(A);D._isFullScreened=false;D.setDimension(D.w,D.h);D.show();D.bringToTop();D.center()}D.updateNestedObjects()};this._isWindowOnTop=function(B){var A=(this.getTopmostWindow()==B);return A};this._bringOnBottom=function(B){for(var A in this.wins)if(this.wins[A].zi<B.zi){this.wins[A].zi+=this.zIndexStep;this.wins[A].style.zIndex=this.wins[A].zi}B.zi=50;B.style.zIndex=B.zi;this._makeActive(this.getTopmostWindow())};this._isWindowOnBottom=function(C){var B=true;for(var A in this.wins)if(this.wins[A]!=C)B=B&&(this.wins[A].zi>C.zi);return B};this._stickWindow=function(A){var B=this.wins[A];B._isSticked=true;this._hideButton(B,"stick");this._showButton(B,"sticked");this._bringOnTop(B);B=null};this._unstickWindow=function(A){var B=this.wins[A];B._isSticked=false;this._hideButton(B,"sticked");this._showButton(B,"stick");this._bringOnTopAnyStickedWindows();B=null};this._addUserButton=function(D,A,E,B){A=String(A).toLowerCase();var C=this._engineAddUserButton(D,A,E);C.title=B;C.isVisible=true;C._isEnabled=true;C.isPressed=false;C.label=A;D.btns[A]=C;D.btns[A].winId=D.idd;D.btns[A]._doOnClick=function(){};this._attachEventsOnButton(D.idd,A);C=null};this._removeUserButton=function(B,A){this._removeButtonGlobal(B,A)};this._blockSwitcher=function(B){for(var A in this.wins)if(B==true)this.wins[A].showCoverBlocker();else this.wins[A].hideCoverBlocker()};this.resizingWin=null;this.modalWin=null;this.resizingDirs="none";if(_isIE){this._focusFixIE=document.createElement("INPUT");this._focusFixIE.className="dhx_windows_ieonclosefocusfix";this._focusFixIE.style.position="absolute";this._focusFixIE.style.width="1px";this._focusFixIE.style.height="1px";this._focusFixIE.style.border="none";this._focusFixIE.style.background="none";this._focusFixIE.style.left="-10px";this._focusFixIE.style.fontSize="1px";document.body.appendChild(this._focusFixIE)}this._createViewport();this._doOnMouseUp=function(){if(A!=null)A._stopMove()};this._doOnMoseMove=function(B){B=B||event;if(A!=null)A._moveWindow(B)};this._resizeTM=null;this._resizeTMTime=200;this._lw=null;this._doOnResize=function(){if(A._lw!=document.documentElement.clientHeight){window.clearTimeout(A._resizeTM);A._resizeTM=window.setTimeout(function(){A._autoResizeViewport()},A._resizeTMTime)}A._lw=document.documentElement.clientHeight};this._doOnUnload=function(){A.unload()};this._doOnSelectStart=function(B){B=B||event;if(A.movingWin!=null||A.resizingWin!=null)B.returnValue=false};if(_isIE)document.body.attachEvent("onselectstart",this._doOnSelectStart);dhtmlxEvent(window,"resize",this._doOnResize);dhtmlxEvent(document.body,"unload",this._doOnUnload);if(this._isIPad){document.addEventListener("touchmove",this._doOnMoseMove,false);document.addEventListener("touchend",this._doOnMouseUp,false)}else{dhtmlxEvent(document.body,"mouseup",this._doOnMouseUp);dhtmlxEvent(this.vp,"mousemove",this._doOnMoseMove);dhtmlxEvent(this.vp,"mouseup",this._doOnMouseUp)}this._setWindowModal=function(B,A){if(A==true){this._makeActive(B);this._bringOnTop(B);this.modalWin=B;B._isModal=true;this.modalCoverI.style.zIndex=B.zi-2;this.modalCoverI.style.display="";this.modalCoverD.style.zIndex=B.zi-2;this.modalCoverD.style.display=""}else{this.modalWin=null;B._isModal=false;this.modalCoverI.style.zIndex=0;this.modalCoverI.style.display="none";this.modalCoverD.style.zIndex=0;this.modalCoverD.style.display="none"}};this._bringOnTopAnyStickedWindows=function(){var C=new Array();for(var B in this.wins)if(this.wins[B]._isSticked)C[C.length]=this.wins[B];for(var A=0;A<C.length;A++)this._bringOnTop(C[A]);if(C.length==0)for(B in this.wins)if(this.wins[B].className=="dhtmlx_window_active")this._bringOnTop(this.wins[B])};this.unload=function(){this._clearAll()};this._removeButtonGlobal=function(C,B){if(!this.wins[C])return;if(!this.wins[C].btns[B])return;var A=this.wins[C].btns[B];A.title=null;A.isVisible=null;A._isEnabled=null;A.isPressed=null;A.label=null;A._doOnClick=null;A.detachAllEvents();A.attachEvent=null;A.callEvent=null;A.checkEvent=null;A.detachEvent=null;A.detachAllEvents=null;A.disable=null;A.enable=null;A.eventCatcher=null;A.hide=null;A.isEnabled=null;A.isHidden=null;A.show=null;A.onmousedown=null;A.onmouseout=null;A.onmouseover=null;A.onmouseup=null;A.ontouchstart=null;A.ontouchend=null;if(A.parentNode)A.parentNode.removeChild(A);A=null;this.wins[C].btns[B]=null;delete this.wins[C].btns[B]};this._removeWindowGlobal=function(C){var D=this.wins[C];if(this.modalWin==D)this._setWindowModal(D,false);var A=D.coverBlocker();A.onselectstart=null;A=null;this._engineDiableOnSelectInWindow(D,false);D._dhxContDestruct();this._engineGetWindowHeader(D).onmousedown=null;this._engineGetWindowHeader(D).ondblclick=null;this.movingWin=null;this.resizingWin=null;for(var B in D.btns)this._removeButtonGlobal(D,B);D.btns=null;D.detachAllEvents();D._adjustToContent=null;D._doOnAttachMenu=null;D._doOnAttachStatusBar=null;D._doOnAttachToolbar=null;D._doOnFrameMouseDown=null;D._doOnFrameContentLoaded=null;D._redraw=null;D.addUserButton=null;D.allowMove=null;D.allowPark=null;D.allowResize=null;D.attachEvent=null;D.bringToBottom=null;D.bringToTop=null;D.callEvent=null;D.center=null;D.centerOnScreen=null;D.checkEvent=null;D.clearIcon=null;D.close=null;D.denyMove=null;D.denyPark=null;D.denyResize=null;D.detachEvent=null;D.detachAllEvents=null;D.eventCatcher=null;D.getDimension=null;D.getIcon=null;D.getId=null;D.getMaxDimension=null;D.getMinDimension=null;D.getPosition=null;D.getText=null;D.hide=null;D.hideHeader=null;D.isHidden=null;D.isMaximized=null;D.isModal=null;D.isMovable=null;D.isOnBottom=null;D.isOnTop=null;D.isParkable=null;D.isParked=null;D.isResizable=null;D.isSticked=null;D.keepInViewport=null;D.maximize=null;D.minimize=null;D.park=null;D.progressOff=null;D.progressOn=null;D.removeUserButton=null;D.restoreIcon=null;D.setDimension=null;D.setIcon=null;D.setMaxDimension=null;D.setMinDimension=null;D.setModal=null;D.setPosition=null;D.setText=null;D.setToFullScreen=null;D.show=null;D.showHeader=null;D.stick=null;D.unstick=null;D.onmousemove=null;D.onmousedown=null;D.icons=null;D.button=null;D._dhxContDestruct=null;D.dhxContGlobal.obj=null;D.dhxContGlobal.setContent=null;D.dhxContGlobal.dhxcont=null;D.dhxContGlobal=null;if(D._frame){while(D._frame.childNodes.length>0)D._frame.removeChild(D._frame.childNodes[0]);D._frame=null}this._parseNestedForEvents(D);D._content=null;D.innerHTML="";D.parentNode.removeChild(D);D=null;this.wins[C]=null;delete this.wins[C]};this._removeEvents=function(A){A.onmouseover=null;A.onmouseout=null;A.onmousemove=null;A.onclick=null;A.ondblclick=null;A.onmouseenter=null;A.onmouseleave=null;A.onmouseup=null;A.onmousewheel=null;A.onmousedown=null;A.onselectstart=null;A.onfocus=null;A.style.display="";A=null};this._parseNestedForEvents=function(B){this._removeEvents(B);for(var A=0;A<B.childNodes.length;A++)if(B.childNodes[A].tagName!=null)this._parseNestedForEvents(B.childNodes[A]);B=null};this._clearAll=function(){this._clearDocumentEvents();for(var B in this.wins)this._removeWindowGlobal(B);this.wins=null;this._parseNestedForEvents(this._carcass);while(this._carcass.childNodes.length>0)this._carcass.removeChild(this._carcass.childNodes[0]);this._carcass.onselectstart=null;this._carcass.parentNode.removeChild(this._carcass);this._carcass=null;this._parseNestedForEvents(this._vpcover);this._vpcover.parentNode.removeChild(this._vpcover);this._vpcover=null;this._parseNestedForEvents(this.modalCoverD);this.modalCoverD.parentNode.removeChild(this.modalCoverD);this.modalCoverD=null;this._parseNestedForEvents(this.modalCoverI);this.modalCoverI.parentNode.removeChild(this.modalCoverI);this.modalCoverI=null;if(this.vp.autocreated==true)this.vp.parentNode.removeChild(this.vp);this.vp=null;for(B in this.skinParams)delete this.skinParams[B];this.skinParams=null;this._effects=null;this._engineSkinParams=null;this._addDefaultButtons=null;this._addUserButton=null;this._allowParking=null;this._allowReszieGlob=null;this._attachEventsOnButton=null;this._attachWindowContentTo=null;this._autoResizeViewport=null;this._blockSwitcher=null;this._bringOnBottom=null;this._bringOnTop=null;this._bringOnTopAnyStickedWindows=null;this._centerWindow=null;this._clearAll=null;this._clearDocumentEvents=null;this._clearWindowIcons=null;this._closeWindow=null;this._createViewport=null;this._denyParking=null;this._denyResize=null;this._dhx_Engine=null;this._disableButton=null;this._doOnMoseMove=null;this._doOnMouseUp=null;this._doOnResize=null;this._doOnSelectStart=null;this._doOnUnload=null;this._doParkDown=null;this._doParkUp=null;this._enableButton=null;this._engineAddUserButton=null;this._engineAdjustWindowToContent=null;this._engineAllowWindowResize=null;this._engineCheckHeaderMouseDown=null;this._engineDiableOnSelectInWindow=null;this._engineDoOnWindowParkDown=null;this._engineDoOnWindowParkUp=null;this._engineFixWindowPosInViewport=null;this._engineGetWindowButton=null;this._engineGetWindowContent=null;this._engineGetWindowHeader=null;this._engineGetWindowHeaderState=null;this._engineGetWindowLabel=null;this._engineGetWindowParkedHeight=null;this._engineRedrawSkin=null;this._engineRedrawWindowPos=null;this._engineRedrawWindowSize=null;this._engineRedrawWindowTitle=null;this._engineSetWindowBody=null;this._engineSwitchWindowHeader=null;this._engineSwitchWindowProgress=null;this._engineUpdateWindowIcon=null;this._fixWindowDimensionInViewport=null;this._genStr=null;this._getActive=null;this._getTopZIndex=null;this._getWindowIcon=null;this._hideButton=null;this._hideWindow=null;this._isWindowHidden=null;this._isWindowOnBottom=null;this._isWindowOnTop=null;this._makeActive=null;this._maximizeWindow=null;this._moveWindow=null;this._needHelp=null;this._parkWindow=null;this._parseNestedForEvents=null;this._removeButtonGlobal=null;this._removeEvents=null;this._removeUserButton=null;this._removeWindowGlobal=null;this._restoreWindow=null;this._restoreWindowIcons=null;this._setWindowIcon=null;this._setWindowModal=null;this._setWindowToFullScreen=null;this._showButton=null;this._showWindow=null;this._stickWindow=null;this._stopMove=null;this._unstickWindow=null;this.attachEvent=null;this.attachViewportTo=null;this.callEvent=null;this.checkEvent=null;this.createWindow=null;this.detachEvent=null;this.enableAutoViewport=null;this.eventCatcher=null;this.findByText=null;this.forEachWindow=null;this.getBottommostWindow=null;this.getEffect=null;this.getTopmostWindow=null;this.isWindow=null;this.setEffect=null;this.setImagePath=null;this.setSkin=null;this.setViewport=null;this.unload=null;this.window=null;A=null};this._clearDocumentEvents=function(){if(_isIE){window.detachEvent("onresize",this._doOnResize);document.body.detachEvent("onselectstart",this._doOnSelectStart);document.body.detachEvent("onmouseup",this._doOnMouseUp);document.body.detachEvent("onunload",this._doOnUnload);this.vp.detachEvent("onmousemove",this._doOnMoseMove);this.vp.detachEvent("onmouseup",this._doOnMouseUp)}else{window.removeEventListener("resize",this._doOnResize,false);document.body.removeEventListener("mouseup",this._doOnMouseUp,false);document.body.removeEventListener("unload",this._doOnUnload,false);this.vp.removeEventListener("mousemove",this._doOnMoseMove,false);this.vp.removeEventListener("mouseup",this._doOnMouseUp,false)}};this._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B+=D.charAt(Math.round(Math.random()*(D.length-1)));return B};dhtmlxEventable(this);return this}dhtmlXWindows.prototype._dhx_Engine=function(){this._engineEnabled=true;this._engineName="dhx";this._engineSkinParams={dhx_blue:{"hh":21,"lbw":2,"rbw":2,"lch":2,"lcw":14,"rch":14,"rcw":14,"bbh":2,"mnh":23,"tbh":25,"sbh":20,"noh_t":null,"noh_h":null},dhx_black:{"hh":21,"lbw":2,"rbw":2,"lch":2,"lcw":14,"rch":14,"rcw":14,"bbh":2,"mnh":23,"tbh":25,"sbh":20,"noh_t":null,"noh_h":null},dhx_skyblue:{"hh":29,"lbw":2,"rbw":2,"lch":2,"lcw":14,"rch":14,"rcw":14,"bbh":2,"mnh":23,"tbh":25,"sbh":20,"noh_t":5,"noh_h":-10},dhx_web:{"hh":27,"lbw":5,"rbw":5,"lch":5,"lcw":14,"rch":14,"rcw":14,"bbh":5,"mnh":23,"tbh":25,"sbh":20,"noh_t":5,"noh_h":-10},dhx_terrace:{"hh":37,"lbw":5,"rbw":5,"lch":5,"lcw":14,"rch":14,"rcw":14,"bbh":5,"mnh":23,"tbh":25,"sbh":20,"noh_t":5,"noh_h":-10}};this._isIE6=false;if(_isIE)this._isIE6=(window.XMLHttpRequest==null?true:false);this._engineSetWindowBody=function(B){B.innerHTML="<div iswin='1' class='dhtmlx_wins_body_outer' style='position: relative;'>"+(this._isIE6?"<iframe src='javascript:false;' frameborder='0' class='dhtmlx_wins_ie6_cover_fix' onload='this.contentWindow.document.body.style.overflow=\"hidden\";'></iframe>":"")+"<div class='dhtmlx_wins_icon'></div>"+"<div class='dhtmlx_wins_progress'></div>"+"<div class='dhtmlx_wins_title'>dhtmlxWindow</div>"+"<div class='dhtmlx_wins_btns'>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_sticked_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_stick_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_help_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_park_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_minmax2_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_minmax1_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_close_default'></div>"+"<div class='dhtmlx_wins_btns_button dhtmlx_button_dock_default'></div>"+"</div>"+"<div class='dhtmlx_wins_body_inner'></div>"+"<div winResT='yes' class='dhtmlx_wins_resizer_t' style='display:none;'></div>"+"<div winResL='yes' class='dhtmlx_wins_resizer_l'></div>"+"<div winResR='yes' class='dhtmlx_wins_resizer_r'></div>"+"<div winResB='yes' class='dhtmlx_wins_resizer_b'></div>"+"<div class='white_line'></div>"+"<div class='white_line2'></div>"+"</div>";B.dhxContGlobal=new dhtmlXContainer(B);if(this.skin=="dhx_skyblue"){B.dhxContGlobal.obj._offsetWidth=-10;B.dhxContGlobal.obj._offsetHeight=-5;B.dhxContGlobal.obj._offsetLeft=5;B.dhxContGlobal.obj._offsetHeightSaved=B.dhxContGlobal.obj._offsetHeight}if(this.skin=="dhx_web"){B.dhxContGlobal.obj._offsetWidth=-10;B.dhxContGlobal.obj._offsetHeight=-5;B.dhxContGlobal.obj._offsetLeft=5;B.dhxContGlobal.obj._offsetHeightSaved=B.dhxContGlobal.obj._offsetHeight}B.skin=this.skin;B.dhxContGlobal.setContent(B.childNodes[0].childNodes[(this._isIE6?5:4)]);var A=B.coverBlocker();A.onselectstart=function(A){A=A||event;A.returnValue=false;A.cancelBubble=true};A=null};this._engineDiableOnSelectInWindow=function(D,C){var B=new Array();B[0]=D.childNodes[0].childNodes[(this._isIE6?1:0)];B[1]=D.childNodes[0].childNodes[(this._isIE6?2:1)];B[2]=D.childNodes[0].childNodes[(this._isIE6?3:2)];B[3]=D.childNodes[0].childNodes[(this._isIE6?4:3)];B[4]=D.childNodes[0].childNodes[(this._isIE6?6:5)];B[5]=D.childNodes[0].childNodes[(this._isIE6?7:6)];B[6]=D.childNodes[0].childNodes[(this._isIE6?8:7)];B[7]=D.childNodes[0].childNodes[(this._isIE6?9:8)];for(var A=0;A<B.length;A++){B[A].onselectstart=(C?function(A){A=A||event;A.returnValue=false;return false}:null);B[A]=null}B=null};this._engineGetWindowHeader=function(A){A.childNodes[0].idd=A.idd;return A.childNodes[0]};this._engineRedrawWindowSize=function(D){D.style.width=(String(D.w).search("%")==-1?D.w+"px":D.w);D.style.height=(String(D.h).search("%")==-1?D.h+"px":D.h);var A=D.childNodes[0];A.style.width=D.clientWidth+"px";A.style.height=D.clientHeight+"px";if(A.offsetWidth>D.clientWidth)A.style.width=D.clientWidth*2-A.offsetWidth+"px";if(A.offsetHeight>D.clientHeight){var B=D.clientHeight*2-A.offsetHeight;if(B<0)B=0;A.style.height=B+"px"}var C=(D._noHeader==true?D._hdrSize:this._engineSkinParams[this.skin]["hh"]);this._engineRedrawWindowTitle(D);D.adjustContent(A,C)};this._engineRedrawWindowPos=function(A){if(A._isFullScreened)return;A.style.left=A.x+"px";A.style.top=A.y+"px"};this._engineFixWindowPosInViewport=function(B){var A=(B._noHeader==true?B._hdrSize:this._engineSkinParams[this.skin]["hh"]);if(B._keepInViewport){if(B.x<0)B.x=0;if(B.x+B.w>this.vp.offsetWidth)B.x=this.vp.offsetWidth-B.w;if(B.y+B.h>this.vp.offsetHeight)B.y=this.vp.offsetHeight-B.h;if(B.y<0)B.y=0}else{if(B.y+A>this.vp.offsetHeight)B.y=this.vp.offsetHeight-A;if(B.y<0)B.y=0;if(B.x+B.w-10<0)B.x=10-B.w;if(B.x>this.vp.offsetWidth-10)B.x=this.vp.offsetWidth-10}};this._engineCheckHeaderMouseDown=function(D,A){if(this._isIPad){var F=A.touches[0].clientX,E=A.touches[0].clientY,C=A.target||A.srcElement;if(C==D.childNodes[0]||C==D.childNodes[0].childNodes[0]||C==D.childNodes[0].childNodes[2]||C==D.childNodes[0].childNodes[3])return true;return false}else F=(_isIE||_isOpera?A.offsetX:A.layerX),E=(_isIE||_isOpera?A.offsetY:A.layerY),C=A.target||A.srcElement;var B=(D._noHeader==true?D._hdrSize:this._engineSkinParams[this.skin]["hh"]);if(E<=B&&(C==D.childNodes[0]||C==D.childNodes[0].childNodes[(this._isIE6?1:0)]||C==D.childNodes[0].childNodes[(this._isIE6?3:2)]||C==D.childNodes[0].childNodes[(this._isIE6?4:3)]))return true;return false};this._engineGetWindowContent=function(A){alert("_engineGetWindowContent")};this._engineGetWindowButton=function(E,F){F=String(F).toLowerCase();var D=null,B="dhtmlx_button_"+F+"_";for(var C=0;C<E.childNodes[0].childNodes[(this._isIE6?4:3)].childNodes.length;C++){var A=E.childNodes[0].childNodes[(this._isIE6?4:3)].childNodes[C];if(String(A.className).search(B)!=-1)D=A;A=null}return D};this._engineAddUserButton=function(C,E,D){if(isNaN(D))D=0;var A=document.createElement("DIV");A.className="dhtmlx_wins_btns_button dhtmlx_button_"+E+"_default";var B=C.childNodes[0].childNodes[(this._isIE6?4:3)];D=B.childNodes.length-D;if(D<0)D=0;if(D>=B.childNodes.length)B.appendChild(A);else B.insertBefore(A,B.childNodes[D]);this._engineRedrawWindowTitle(C);return A};this._engineGetWindowParkedHeight=function(A){return this._engineSkinParams[this.skin]["hh"]+1};this._engineDoOnWindowParkDown=function(A){A.childNodes[0].childNodes[(this._isIE6?6:5)].style.display=(A._noHeader==true?"":"none");A.childNodes[0].childNodes[(this._isIE6?7:6)].style.display="";A.childNodes[0].childNodes[(this._isIE6?8:7)].style.display="";A.childNodes[0].childNodes[(this._isIE6?9:8)].style.display=""};this._engineDoOnWindowParkUp=function(A){A.childNodes[0].childNodes[(this._isIE6?6:5)].style.display="none";A.childNodes[0].childNodes[(this._isIE6?7:6)].style.display="none";A.childNodes[0].childNodes[(this._isIE6?8:7)].style.display="none";A.childNodes[0].childNodes[(this._isIE6?9:8)].style.display="none"};this._engineUpdateWindowIcon=function(B,A){B.childNodes[0].childNodes[(this._isIE6?1:0)].style.backgroundImage="url('"+A+"')"};this._engineAllowWindowResize=function(F,D,C,A){if(!D.getAttribute)return;var B=this._engineSkinParams[this.skin],E=(F._noHeader==true?F._hdrSize:this._engineSkinParams[this.skin]["hh"]);if(D.getAttribute("winResL")!=null)if(D.getAttribute("winResL")=="yes")if(A>=E){if(A>=F.h-B["lch"])return"corner_left";if(A<=B["lch"]&&F._noHeader==true)return"corner_up_left";return"border_left"}if(D.getAttribute("winResR")!=null)if(D.getAttribute("winResR")=="yes")if(A>=E){if(A>=F.h-B["rch"])return"corner_right";if(A<=B["rch"]&&F._noHeader==true)return"corner_up_right";return"border_right"}if(D.getAttribute("winResT")!=null)if(D.getAttribute("winResT")=="yes"&&F._noHeader==true){if(C<=B["lcw"])return"corner_up_left";if(C>=F.w-B["rcw"])return"corner_up_right";return"border_top"}if(D.getAttribute("winResB")!=null)if(D.getAttribute("winResB")=="yes"){if(C<=B["lcw"])return"corner_left";if(C>=F.w-B["rcw"])return"corner_right";return"border_bottom"}return null};this._engineAdjustWindowToContent=function(D,A,E){var B=A+D.w-D.vs[D.av].dhxcont.clientWidth,C=E+D.h-D.vs[D.av].dhxcont.clientHeight;D.setDimension(B,C)};this._engineRedrawSkin=function(){this.vp.className=(this.vp==document.body&&this.vp._css?this.vp._css+" ":"")+"dhtmlx_winviewport dhtmlx_skin_"+this.skin+(this._r?" dhx_wins_rtl":"");var A=this._engineSkinParams[this.skin];for(var B in this.wins){if(this.skin=="dhx_skyblue"){this.wins[B].dhxContGlobal.obj._offsetTop=(this.wins[B]._noHeader?A["noh_t"]:null);this.wins[B].dhxContGlobal.obj._offsetWidth=-10;this.wins[B].dhxContGlobal.obj._offsetHeight=(this.wins[B]._noHeader?A["noh_h"]:-5);this.wins[B].dhxContGlobal.obj._offsetLeft=5;this.wins[B].dhxContGlobal.obj._offsetHeightSaved=-5}else{this.wins[B].dhxContGlobal.obj._offsetWidth=null;this.wins[B].dhxContGlobal.obj._offsetHeight=null;this.wins[B].dhxContGlobal.obj._offsetLeft=null;this.wins[B].dhxContGlobal.obj._offsetTop=null;this.wins[B].dhxContGlobal.obj._offsetHeightSaved=null}this.wins[B].skin=this.skin;this._restoreWindowIcons(this.wins[B]);this._engineRedrawWindowSize(this.wins[B])}};this._engineSwitchWindowProgress=function(B,A){if(A==true){B.childNodes[0].childNodes[(this._isIE6?1:0)].style.display="none";B.childNodes[0].childNodes[(this._isIE6?2:1)].style.display=""}else{B.childNodes[0].childNodes[(this._isIE6?2:1)].style.display="none";B.childNodes[0].childNodes[(this._isIE6?1:0)].style.display=""}};this._engineSwitchWindowHeader=function(C,B){if(!C._noHeader)C._noHeader=false;if(B!=C._noHeader)return;C._noHeader=(B==true?false:true);C._hdrSize=0;C.childNodes[0].childNodes[(this._isIE6?5:4)].className="dhtmlx_wins_body_inner"+(C._noHeader?" dhtmlx_wins_no_header":"");C.childNodes[0].childNodes[(this._isIE6?6:5)].style.display=(C._noHeader?"":"none");C.childNodes[0].childNodes[(this._isIE6?1:0)].style.display=(C._noHeader?"none":"");C.childNodes[0].childNodes[(this._isIE6?3:2)].style.display=(C._noHeader?"none":"");C.childNodes[0].childNodes[(this._isIE6?4:3)].style.display=(C._noHeader?"none":"");var A=this._engineSkinParams[this.skin];if(C._noHeader){C.dhxContGlobal.obj._offsetHeightSaved=C.dhxContGlobal.obj._offsetHeight;C.dhxContGlobal.obj._offsetHeight=A["noh_h"];C.dhxContGlobal.obj._offsetTop=A["noh_t"]}else{C.dhxContGlobal.obj._offsetHeight=C.dhxContGlobal.obj._offsetHeightSaved;C.dhxContGlobal.obj._offsetTop=null}this._engineRedrawWindowSize(C)};this._engineGetWindowHeaderState=function(A){return(A._noHeader?true:false)};this._engineGetWindowLabel=function(A){return A.childNodes[0].childNodes[(this._isIE6?3:2)]};this._engineRedrawWindowTitle=function(D){if(D._noHeader!==true){var B=D.childNodes[0].childNodes[(this._isIE6?1:0)].offsetWidth,A=D.childNodes[0].childNodes[(this._isIE6?4:3)].offsetWidth,C=D.offsetWidth-B-A-24;if(C<0)C="100%";else C+="px";D.childNodes[0].childNodes[(this._isIE6?3:2)].style.width=C}}};dhtmlXWindows.prototype.i18n={dhxcontaler:"dhtmlxcontainer.js is missed on the page",noenginealert:"No dhtmlxWindows engine was found.",stick:"Stick",unstick:"Unstick",help:"Help",parkdown:"Park Down",parkup:"Park Up",maximize:"Maximize",restore:"Restore",close:"Close",dock:"Dock"};(function(){dhtmlx.extend_api("dhtmlXWindows",{_init:function(A){return[]},_patch:function(B){B.old_createWindow=B.createWindow;B.createWindow=function(D){if(arguments.length>1)return this.old_createWindow.apply(this,arguments);var B=this.old_createWindow(D.id,(D.x||D.left),(D.y||D.top),D.width,D.height);B.allowMoveA=function(A){if(A)this.allowMove();else this.denyMove()};B.allowParkA=function(A){if(A)this.allowPark();else this.denyPark()};B.allowResizeA=function(A){if(A)this.allowResize();else this.denyResize()};for(var C in D)if(A[C])B[A[C]](D[C]);else if(C.indexOf("on")==0)B.attachEvent(C,D[C]);return B}},animation:"setEffect",image_path:"setImagePath",skin:"setSkin",viewport:"_viewport",wins:"_wins"},{_viewport:function(A){if(A.object){this.enableAutoViewport(false);this.attachViewportTo(A.object)}else{this.enableAutoViewport(false);this.setViewport(A.left,A.top,A.width,A.height,A.parent)}},_wins:function(A){for(var B=0;B<A.length;B++){var C=A[B];this.createWindow(C.id,C.left,C.top,C.width,C.height);if(C.text)this.window(C.id).setText(C.text);if(C.keep_in_viewport)this.window(C.id).keepInViewport(true);if(C.deny_resize)this.window(C.id).denyResize();if(C.deny_park)this.window(C.id).denyPark();if(C.deny_move)this.window(C.id).denyMove()}}});var A={move:"allowMoveA",park:"allowParkA",resize:"allowResizeA",center:"center",modal:"setModal",caption:"setText",header:"showHeader"}})();function dhtmlXContainer(C){var A=this;this.obj=C;C=null;this.obj._padding=true;this.dhxcont=null;this.st=document.createElement("DIV");this.st.style.position="absolute";this.st.style.left="-200px";this.st.style.top="0px";this.st.style.width="100px";this.st.style.height="1px";this.st.style.visibility="hidden";this.st.style.overflow="hidden";document.body.insertBefore(this.st,document.body.childNodes[0]);this.obj._getSt=function(){return A.st};this.obj.dv="def";this.obj.av=this.obj.dv;this.obj.cv=this.obj.av;this.obj.vs={};this.obj.vs[this.obj.av]={};this.obj.view=function(B){if(!this.vs[B]){this.vs[B]={};this.vs[B].dhxcont=this.vs[this.dv].dhxcont;var C=document.createElement("DIV");C.style.position="relative";C.style.left="0px";C.style.width="200px";C.style.height="200px";C.style.overflow="hidden";C.style.visibility="";A.st.appendChild(C);this.vs[B].dhxcont.mainCont[B]=C;C=null}this.avt=this.av;this.av=B;return this};this.obj.setActive=function(){if(!this.vs[this.av])return;this.cv=this.av;if(this.vs[this.avt].dhxcont==this.vs[this.avt].dhxcont.mainCont[this.avt].parentNode){A.st.appendChild(this.vs[this.avt].dhxcont.mainCont[this.avt]);if(this.vs[this.avt].menu)A.st.appendChild(document.getElementById(this.vs[this.avt].menuId));if(this.vs[this.avt].toolbar)A.st.appendChild(document.getElementById(this.vs[this.avt].toolbarId));if(this.vs[this.avt].sb)A.st.appendChild(document.getElementById(this.vs[this.avt].sbId))}if(this._isCell);if(this.vs[this.av].dhxcont!=this.vs[this.av].dhxcont.mainCont[this.av].parentNode){this.vs[this.av].dhxcont.insertBefore(this.vs[this.av].dhxcont.mainCont[this.av],this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]);if(this.vs[this.av].menu)this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].menuId),this.vs[this.av].dhxcont.childNodes[0]);if(this.vs[this.av].toolbar)this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].toolbarId),this.vs[this.av].dhxcont.childNodes[(this.vs[this.av].menu?1:0)]);if(this.vs[this.av].sb)this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].sbId),this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1])}if(this._doOnResize)this._doOnResize();if(this._isWindow)this.updateNestedObjects();this.avt=null};this.obj._viewRestore=function(){var A=this.av;if(this.avt){this.av=this.avt;this.avt=null}return A};this.setContent=function(A){this.obj.vs[this.obj.av].dhxcont=A;this.obj._init();A=null};this.obj._init=function(){this.vs[this.av].dhxcont.innerHTML="<div ida='dhxMainCont' style='position: relative;left: 0px;top: 0px;overflow: hidden;'></div>"+"<div class='dhxcont_content_blocker' style='display: none;'></div>";this.vs[this.av].dhxcont.mainCont={};this.vs[this.av].dhxcont.mainCont[this.av]=this.vs[this.av].dhxcont.childNodes[0]};this.obj._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B+=D.charAt(Math.round(Math.random()*(D.length-1)));return B};this.obj.setMinContentSize=function(A,B){this.vs[this.av]._minDataSizeW=A;this.vs[this.av]._minDataSizeH=B};this.obj._setPadding=function(B,A){if(typeof(B)=="object"){this._offsetTop=B[0];this._offsetLeft=B[1];this._offsetWidth=B[2];this._offsetHeight=B[3];B=null}else{this._offsetTop=B;this._offsetLeft=B;this._offsetWidth=-B*2;this._offsetHeight=-B*2}this.vs[this.av].dhxcont.className="dhxcont_global_content_area "+(A||"")};this.obj.moveContentTo=function(E){for(var C in this.vs){E.view(C).setActive();var F=null;if(this.vs[C].grid)F="grid";if(this.vs[C].tree)F="tree";if(this.vs[C].tabbar)F="tabbar";if(this.vs[C].folders)F="folders";if(this.vs[C].layout)F="layout";if(F!=null){E.view(C).attachObject(this.vs[C][F+"Id"],false,true,false);E.vs[C][F]=this.vs[C][F];E.vs[C][F+"Id"]=this.vs[C][F+"Id"];E.vs[C][F+"Obj"]=this.vs[C][F+"Obj"];this.vs[C][F]=null;this.vs[C][F+"Id"]=null;this.vs[C][F+"Obj"]=null}if(this.vs[C]._frame){E.vs[C]._frame=this.vs[C]._frame;this.vs[C]._frame=null}if(this.vs[C].menu!=null){if(E.cv==E.av)E.vs[E.av].dhxcont.insertBefore(document.getElementById(this.vs[C].menuId),E.vs[E.av].dhxcont.childNodes[0]);else{var D=E._getSt();D.appendChild(document.getElementById(this.vs[C].menuId));D=null}E.vs[C].menu=this.vs[C].menu;E.vs[C].menuId=this.vs[C].menuId;E.vs[C].menuHeight=this.vs[C].menuHeight;this.vs[C].menu=null;this.vs[C].menuId=null;this.vs[C].menuHeight=null;if(this.cv==this.av&&this._doOnAttachMenu)this._doOnAttachMenu("unload");if(E.cv==E.av&&E._doOnAttachMenu)E._doOnAttachMenu("move")}if(this.vs[C].toolbar!=null){if(E.cv==E.av)E.vs[E.av].dhxcont.insertBefore(document.getElementById(this.vs[C].toolbarId),E.vs[E.av].dhxcont.childNodes[(E.vs[E.av].menu!=null?1:0)]);else{D=E._getSt();D.appendChild(document.getElementById(this.vs[C].toolbarId));D=null}E.vs[C].toolbar=this.vs[C].toolbar;E.vs[C].toolbarId=this.vs[C].toolbarId;E.vs[C].toolbarHeight=this.vs[C].toolbarHeight;this.vs[C].toolbar=null;this.vs[C].toolbarId=null;this.vs[C].toolbarHeight=null;if(this.cv==this.av&&this._doOnAttachToolbar)this._doOnAttachToolbar("unload");if(E.cv==E.av&&E._doOnAttachToolbar)E._doOnAttachToolbar("move")}if(this.vs[C].sb!=null){if(E.cv==E.av)E.vs[E.av].dhxcont.insertBefore(document.getElementById(this.vs[C].sbId),E.vs[E.av].dhxcont.childNodes[E.vs[E.av].dhxcont.childNodes.length-1]);else{D=E._getSt();D.appendChild(document.getElementById(this.vs[C].sbId));return D}E.vs[C].sb=this.vs[C].sb;E.vs[C].sbId=this.vs[C].sbId;E.vs[C].sbHeight=this.vs[C].sbHeight;this.vs[C].sb=null;this.vs[C].sbId=null;this.vs[C].sbHeight=null;if(this.cv==this.av&&this._doOnAttachStatusBar)this._doOnAttachStatusBar("unload");if(E.cv==E.av&&E._doOnAttachStatusBar)E._doOnAttachStatusBar("move")}var B=this.vs[C].dhxcont.mainCont[C],A=E.vs[C].dhxcont.mainCont[C];while(B.childNodes.length>0)A.appendChild(B.childNodes[0])}E.view(this.av).setActive();E=null};this.obj.adjustContent=function(I,K,A,H,E){var G=this.vs[this.av].dhxcont,L=G.mainCont[this.av];G.style.left=(this._offsetLeft||0)+"px";G.style.top=(this._offsetTop||0)+K+"px";var D=I.clientWidth+(this._offsetWidth||0);if(H!==true)G.style.width=Math.max(0,D)+"px";if(H!==true)if(G.offsetWidth>D)G.style.width=Math.max(0,D*2-G.offsetWidth)+"px";var J=I.clientHeight+(this._offsetHeight||0);G.style.height=Math.max(0,J-K)+(A!=null?A:0)+"px";if(G.offsetHeight>J-K)G.style.height=Math.max(0,(J-K)*2-G.offsetHeight)+"px";if(E)if(!isNaN(E))G.style.height=Math.max(0,parseInt(G.style.height)-E)+"px";if(this.vs[this.av]._minDataSizeH!=null)if(parseInt(G.style.height)<this.vs[this.av]._minDataSizeH)G.style.height=this.vs[this.av]._minDataSizeH+"px";if(this.vs[this.av]._minDataSizeW!=null)if(parseInt(G.style.width)<this.vs[this.av]._minDataSizeW)G.style.width=this.vs[this.av]._minDataSizeW+"px";if(H!==true){L.style.width=G.clientWidth+"px";if(L.offsetWidth>G.clientWidth)L.style.width=Math.max(0,G.clientWidth*2-L.offsetWidth)+"px"}var C=(this.vs[this.av].menu!=null?(!this.vs[this.av].menuHidden?this.vs[this.av].menuHeight:0):0),F=(this.vs[this.av].toolbar!=null?(!this.vs[this.av].toolbarHidden?this.vs[this.av].toolbarHeight:0):0),B=(this.vs[this.av].sb!=null?(!this.vs[this.av].sbHidden?this.vs[this.av].sbHeight:0):0);L.style.height=G.clientHeight+"px";if(L.offsetHeight>G.clientHeight)L.style.height=Math.max(0,G.clientHeight*2-L.offsetHeight)+"px";L.style.height=Math.max(0,parseInt(L.style.height)-C-F-B)+"px";L=null;G=null;I=null};this.obj.coverBlocker=function(){return this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]};this.obj.showCoverBlocker=function(){var A=this.coverBlocker();A.style.display="";A=null};this.obj.hideCoverBlocker=function(){var A=this.coverBlocker();A.style.display="none";A=null};this.obj.updateNestedObjects=function(D){if(this.skin=="dhx_terrace"){var E=(this.vs[this.av].menu!=null||this.vs[this.av].toolbar!=null);if(this.vs[this.av].grid){var A=(E||this._isWindow?14:0),C=(this._isWindow?14:0),B=(this._isWindow?14:0);if(D){if(!this._isWindow){this.vs[this.av].grid.entBox.style.border="0px solid white";this.vs[this.av].grid.skin_h_correction=-2}this.vs[this.av].grid.dontSetSizes=true;this.vs[this.av].gridObj.style.position="absolute"}this.vs[this.av].gridObj.style.top=A+"px";this.vs[this.av].gridObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-A-C+"px";this.vs[this.av].gridObj.style.left=B+"px";this.vs[this.av].gridObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";this.vs[this.av].grid.setSizes()}if(this.vs[this.av].tree){A=(E||this._isWindow?14:0),C=(this._isWindow?14:0),B=(this._isWindow?14:0);if(D)this.vs[this.av].treeObj.style.position="absolute";this.vs[this.av].treeObj.style.top=A+"px";this.vs[this.av].treeObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-A-C+"px";this.vs[this.av].treeObj.style.left=B+"px";this.vs[this.av].treeObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px"}if(this.vs[this.av].form){A=(E||this._isWindow?14:0),C=(this._isWindow?14:0),B=(this._isWindow?14:0);if(D)this.vs[this.av].formObj.style.position="absolute";this.vs[this.av].formObj.style.top=A+"px";this.vs[this.av].formObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-A-C+"px";this.vs[this.av].formObj.style.left=B+"px";this.vs[this.av].formObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";this.vs[this.av].form.setSizes()}if(this.vs[this.av].layout){if(D)if(!this._isWindow&&!this._isCell)this.vs[this.av].layout._hideBorders();A=(this._isCell&&this._noHeader&&!E?0:14),C=(this._isCell&&this._noHeader?0:14),B=(this._isCell&&this._noHeader?0:14);this.vs[this.av].layoutObj.style.top=A+"px";this.vs[this.av].layoutObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-A-C+"px";this.vs[this.av].layoutObj.style.left=B+"px";this.vs[this.av].layoutObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";this.vs[this.av].layout.setSizes()}if(this.vs[this.av].accordion){if(D)this.vs[this.av].accordion._hideBorders=true;A=(this._isCell&&this._noHeader&&!E?0:14),C=(this._isCell&&this._noHeader?0:14),B=(this._isCell&&this._noHeader?0:14);this.vs[this.av].accordionObj.style.top=A+"px";this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-A-C+"px";this.vs[this.av].accordionObj.style.left=B+"px";this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";this.vs[this.av].accordion.setSizes()}if(this.vs[this.av].tabbar!=null){A=(!E&&this._isCell&&this._noHeader?0:14),C=(this._isCell&&this._noHeader?A:28),B=(this._isCell&&this._noHeader?0:14);this.vs[this.av].tabbarObj.style.top=A+"px";this.vs[this.av].tabbarObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-C+"px";this.vs[this.av].tabbarObj.style.left=B+"px";this.vs[this.av].tabbarObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";this.vs[this.av].tabbar.adjustOuterSize()}if(this.vs[this.av].editor){if(D)if(this.vs[this.av].editor.tb!=null&&this.vs[this.av].editor.tb instanceof dhtmlXToolbarObject);A=14,B=14;this.vs[this.av].editorObj.style.top=A+"px";this.vs[this.av].editorObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-(A*2)+"px";this.vs[this.av].editorObj.style.left=B+"px";this.vs[this.av].editorObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)-(B*2)+"px";if(!_isIE)this.vs[this.av].editor._prepareContent(true);this.vs[this.av].editor.setSizes()}if(this.vs[this.av].dockedCell)this.vs[this.av].dockedCell.updateNestedObjects();return}if(this.vs[this.av].grid)this.vs[this.av].grid.setSizes();if(this.vs[this.av].sched)this.vs[this.av].sched.setSizes();if(this.vs[this.av].tabbar)this.vs[this.av].tabbar.adjustOuterSize();if(this.vs[this.av].folders)this.vs[this.av].folders.setSizes();if(this.vs[this.av].editor){if(!_isIE)this.vs[this.av].editor._prepareContent(true);this.vs[this.av].editor.setSizes()}if(this.vs[this.av].layout){if((this._isAcc||this._isTabbarCell)&&this.skin=="dhx_skyblue"){this.vs[this.av].layoutObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px";this.vs[this.av].layoutObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"}else{this.vs[this.av].layoutObj.style.width=this.vs[this.av].dhxcont.mainCont[this.av].style.width;this.vs[this.av].layoutObj.style.height=this.vs[this.av].dhxcont.mainCont[this.av].style.height}this.vs[this.av].layout.setSizes()}if(this.vs[this.av].accordion!=null){if(this.skin=="dhx_web"){this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px";this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"}else{this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px";this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"}this.vs[this.av].accordion.setSizes()}if(this.vs[this.av].dockedCell)this.vs[this.av].dockedCell.updateNestedObjects();if(this.vs[this.av].form)this.vs[this.av].form.setSizes()};this.obj.attachStatusBar=function(){if(this.vs[this.av].sb)return;var B=document.createElement("DIV");if(this._isCell)B.className="dhxcont_sb_container_layoutcell";else B.className="dhxcont_sb_container";B.id="sbobj_"+this._genStr(12);B.innerHTML="<div class='dhxcont_statusbar'></div>";if(this.cv==this.av)this.vs[this.av].dhxcont.insertBefore(B,this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]);else A.st.appendChild(B);B.setText=function(A){this.childNodes[0].innerHTML=A};B.getText=function(){return this.childNodes[0].innerHTML};B.onselectstart=function(A){A=A||event;A.returnValue=false;return false};this.vs[this.av].sb=B;this.vs[this.av].sbHeight=(this.skin=="dhx_web"?41:(this.skin=="dhx_skyblue"?23:B.offsetHeight));this.vs[this.av].sbId=B.id;if(this._doOnAttachStatusBar)this._doOnAttachStatusBar("init");this.adjust();return this.vs[this._viewRestore()].sb};this.obj.detachStatusBar=function(){if(!this.vs[this.av].sb)return;this.vs[this.av].sb.setText=null;this.vs[this.av].sb.getText=null;this.vs[this.av].sb.onselectstart=null;this.vs[this.av].sb.parentNode.removeChild(this.vs[this.av].sb);this.vs[this.av].sb=null;this.vs[this.av].sbHeight=null;this.vs[this.av].sbId=null;this._viewRestore();if(this._doOnAttachStatusBar)this._doOnAttachStatusBar("unload")};this.obj.getFrame=function(){return this.getView()._frame};this.obj.getView=function(A){return this.vs[A||this.av]};this.obj.attachMenu=function(C){if(this.vs[this.av].menu)return;var B=document.createElement("DIV");B.style.position="relative";B.style.overflow="hidden";B.id="dhxmenu_"+this._genStr(12);if(this.cv==this.av)this.vs[this.av].dhxcont.insertBefore(B,this.vs[this.av].dhxcont.childNodes[0]);else A.st.appendChild(B);if(typeof(C)!="object")this.vs[this.av].menu=new dhtmlXMenuObject(B.id,(C||this.skin));else{C.parent=B.id;this.vs[this.av].menu=new dhtmlXMenuObject(C)}this.vs[this.av].menuHeight=(this.skin=="dhx_web"?29:B.offsetHeight);this.vs[this.av].menuId=B.id;if(this._doOnAttachMenu)this._doOnAttachMenu("init");this.adjust();return this.vs[this._viewRestore()].menu};this.obj.detachMenu=function(){if(!this.vs[this.av].menu)return;var A=document.getElementById(this.vs[this.av].menuId);this.vs[this.av].menu.unload();this.vs[this.av].menu=null;this.vs[this.av].menuId=null;this.vs[this.av].menuHeight=null;if(A)A.parentNode.removeChild(A);A=null;this._viewRestore();if(this._doOnAttachMenu)this._doOnAttachMenu("unload")};this.obj.attachToolbar=function(D){if(this.vs[this.av].toolbar)return;var B=document.createElement("DIV");B.style.position="relative";B.style.overflow="hidden";B.id="dhxtoolbar_"+this._genStr(12);if(this.cv==this.av)this.vs[this.av].dhxcont.insertBefore(B,this.vs[this.av].dhxcont.childNodes[(this.vs[this.av].menu!=null?1:0)]);else A.st.appendChild(B);if(typeof(D)!="object")this.vs[this.av].toolbar=new dhtmlXToolbarObject(B.id,(D||this.skin));else{D.parent=B.id;this.vs[this.av].toolbar=new dhtmlXToolbarObject(D)}this.vs[this.av].toolbarHeight=B.offsetHeight;this.vs[this.av].toolbarId=B.id;if(this._doOnAttachToolbar)this._doOnAttachToolbar("init");this.adjust();var C=this;this.vs[this.av].toolbar.attachEvent("_onIconSizeChange",function(A){C.vs[C.av].toolbarHeight=this.cont.offsetHeight;C.vs[C.av].toolbarId=this.cont.id;if(C._doOnAttachToolbar)C._doOnAttachToolbar("iconSizeChange")});if(this.skin!="dhx_terrace")this.vs[this.av].toolbar.callEvent("_onIconSizeChange",[]);return this.vs[this._viewRestore()].toolbar};this.obj.detachToolbar=function(){if(!this.vs[this.av].toolbar)return;var A=document.getElementById(this.vs[this.av].toolbarId);this.vs[this.av].toolbar.unload();this.vs[this.av].toolbar=null;this.vs[this.av].toolbarId=null;this.vs[this.av].toolbarHeight=null;if(A)A.parentNode.removeChild(A);A=null;this._viewRestore();if(this._doOnAttachToolbar)this._doOnAttachToolbar("unload")};this.obj.attachGrid=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var A=document.createElement("DIV");A.id="dhxGridObj_"+this._genStr(12);A.style.width="100%";A.style.height="100%";A.cmp="grid";document.body.appendChild(A);this.attachObject(A.id,false,true,false);this.vs[this.av].grid=new dhtmlXGridObject(A.id);this.vs[this.av].grid.setSkin(this.skin);if(this.skin=="dhx_skyblue"||this.skin=="dhx_black"||this.skin=="dhx_blue"){this.vs[this.av].grid.entBox.style.border="0px solid white";this.vs[this.av].grid._sizeFix=2}this.vs[this.av].gridId=A.id;this.vs[this.av].gridObj=A;if(this.skin=="dhx_terrace"){this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].grid};this.obj.attachScheduler=function(D,G,A,B){B=B||window.scheduler;var E=0;if(A){C=document.getElementById(A);if(C)E=1}if(!E){var F=A||"<div class=\"dhx_cal_tab\" name=\"day_tab\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" style=\"right:76px;\"></div>",C=document.createElement("DIV");C.id="dhxSchedObj_"+this._genStr(12);C.innerHTML="<div id=\""+C.id+"\" class=\"dhx_cal_container\" style=\"width:100%;height:100%;\"><div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\">&nbsp;</div><div class=\"dhx_cal_next_button\">&nbsp;</div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div>"+F+"</div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div></div>";document.body.appendChild(C.firstChild)}this.attachObject(C.id,false,true,false);this.vs[this.av].sched=B;this.vs[this.av].schedId=C.id;B.setSizes=B.update_view;B.destructor=function(){};B.init(C.id,D,G);return this.vs[this._viewRestore()].sched};this.obj.attachTree=function(A){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var B=document.createElement("DIV");B.id="dhxTreeObj_"+this._genStr(12);B.style.width="100%";B.style.height="100%";B.cmp="tree";document.body.appendChild(B);this.attachObject(B.id,false,true,false);this.vs[this.av].tree=new dhtmlXTreeObject(B.id,"100%","100%",(A||0));this.vs[this.av].tree.setSkin(this.skin);this.vs[this.av].tree.allTree.childNodes[0].style.marginTop="2px";this.vs[this.av].tree.allTree.childNodes[0].style.marginBottom="2px";this.vs[this.av].treeId=B.id;this.vs[this.av].treeObj=B;if(this.skin=="dhx_terrace"){this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].tree};this.obj.attachTabbar=function(B){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.style.border="none";this.setDimension(this.w,this.h)}var A=document.createElement("DIV");A.id="dhxTabbarObj_"+this._genStr(12);A.style.width="100%";A.style.height="100%";A.style.overflow="hidden";A.cmp="tabbar";if(!this._isWindow)A._hideBorders=true;document.body.appendChild(A);this.attachObject(A.id,false,true,false);if(this._isCell){this.hideHeader();A._hideBorders=false;this._padding=false}this.vs[this.av].tabbar=new dhtmlXTabBar(A.id,B||"top",(this.skin=="dhx_terrace"?null:20));if(!this._isWindow&&this.skin!="dhx_terrace")this.vs[this.av].tabbar._s.expand=true;this.vs[this.av].tabbar.setSkin(this.skin);this.vs[this.av].tabbar.adjustOuterSize();this.vs[this.av].tabbarId=A.id;this.vs[this.av].tabbarObj=A;if(this.skin=="dhx_terrace"){this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].tabbar};this.obj.attachFolders=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var A=document.createElement("DIV");A.id="dhxFoldersObj_"+this._genStr(12);A.style.width="100%";A.style.height="100%";A.style.overflow="hidden";A.cmp="folders";document.body.appendChild(A);this.attachObject(A.id,false,true,false);this.vs[this.av].folders=new dhtmlxFolders(A.id);this.vs[this.av].folders.setSizes();this.vs[this.av].foldersId=A.id;this.vs[this.av].foldersObj=A;return this.vs[this._viewRestore()].folders};this.obj.attachAccordion=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var A=document.createElement("DIV");A.id="dhxAccordionObj_"+this._genStr(12);this._padding=true;if(this.skin=="dhx_web"){A.style.left="0px";A.style.top="0px";A.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px";A.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"}else if(this.skin!="dhx_terrace"){A.style.left="-1px";A.style.top="-1px";A.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px";A.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"}A.style.position="relative";A.cmp="accordion";document.body.appendChild(A);this.attachObject(A.id,false,true,false);this.vs[this.av].accordion=new dhtmlXAccordion(A.id,this.skin);this.vs[this.av].accordion.setSizes();this.vs[this.av].accordionId=A.id;this.vs[this.av].accordionObj=A;if(this.skin=="dhx_terrace"){this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].accordion};this.obj.attachLayout=function(B,C){if(this._isCell&&this.skin=="dhx_skyblue"){this.hideHeader();this.vs[this.av].dhxcont.style.border="0px solid white";this.adjustContent(this.childNodes[0],0)}if(this._isCell&&this.skin=="dhx_web")this.hideHeader();this._padding=true;var A=document.createElement("DIV");A.id="dhxLayoutObj_"+this._genStr(12);A.style.overflow="hidden";A.style.position="absolute";A.style.left="0px";A.style.top="0px";A.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px";A.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px";if((this._isTabbarCell||this._isAcc)&&(this.skin=="dhx_skyblue")){A.style.left="-1px";A.style.top="-1px";A.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px";A.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"}A.dhxContExists=true;A.cmp="layout";document.body.appendChild(A);this.attachObject(A.id,false,true,false);this.vs[this.av].layout=new dhtmlXLayoutObject(A,B,(C||this.skin));if(this._isWindow)this.attachEvent("_onBeforeTryResize",this.vs[this.av].layout._defineWindowMinDimension);this.vs[this.av].layoutId=A.id;this.vs[this.av].layoutObj=A;if(this.skin=="dhx_terrace"){if(this._isCell){this.style.backgroundColor="transparent";this.vs[this.av].dhxcont.style.backgroundColor="transparent";this.hideHeader()}this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].layout};this.obj.attachEditor=function(B){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var A=document.createElement("DIV");A.id="dhxEditorObj_"+this._genStr(12);A.style.position="relative";A.style.display="none";A.style.overflow="hidden";A.style.width="100%";A.style.height="100%";A.cmp="editor";document.body.appendChild(A);if(this.skin=="dhx_terrace")A._attached=true;this.attachObject(A.id,false,true,false);this.vs[this.av].editor=new dhtmlXEditor(A.id,B||this.skin);this.vs[this.av].editorId=A.id;this.vs[this.av].editorObj=A;if(this.skin=="dhx_terrace"){this.adjust();this.updateNestedObjects(true)}return this.vs[this._viewRestore()].editor};this.obj.attachMap=function(A){var B=document.createElement("DIV");B.id="GMapsObj_"+this._genStr(12);B.style.position="relative";B.style.display="none";B.style.overflow="hidden";B.style.width="100%";B.style.height="100%";B.cmp="gmaps";document.body.appendChild(B);this.attachObject(B.id,false,true,true);if(!A)A={center:new google.maps.LatLng(40.719837,-73.992348),zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP};this.vs[this.av].gmaps=new google.maps.Map(B,A);return this.vs[this.av].gmaps};this.obj.attachObject=function(D,B,A,F){if(typeof(D)=="string")D=document.getElementById(D);if(B){D.style.visibility="hidden";D.style.display="";var C=D.offsetWidth,E=D.offsetHeight}this._attachContent("obj",D);if(B&&this._isWindow){D.style.visibility="";this._adjustToContent(C,E)}if(this.skin=="dhx_terrace")if(this.vs[this.av].menu!=null||this.vs[this.av].toolbar!=null){this.adjust(typeof(F)=="undefined"||F==true);this.updateNestedObjects(true)}if(!A)this._viewRestore()};this.obj.detachObject=function(B,H){var E=null,G=null,A=["tree","grid","layout","tabbar","accordion","folders"];for(var D=0;D<A.length;D++)if(this.vs[this.av][A[D]]){E=this.vs[this.av][A[D]];G=this.vs[this.av][A[D]+"Obj"];if(B){if(E.unload)E.unload();if(E.destructor)E.destructor();while(G.childNodes.length>0)G.removeChild(G.childNodes[0]);G.parentNode.removeChild(G);G=null;E=null}else{document.body.appendChild(G);G.style.display="none"}this.vs[this.av][A[D]]=null;this.vs[this.av][A[D]+"Id"]=null;this.vs[this.av][A[D]+"Obj"]=null}if(E!=null&&G!=null)return new Array(E,G);if(B&&this.vs[this.av]._frame){this._detachURLEvents();this.vs[this.av]._frame=null}var C=this.vs[this.av].dhxcont.mainCont[this.av];while(C.childNodes.length>0)if(B==true)C.removeChild(C.childNodes[0]);else{var F=C.childNodes[0];if(H!=null){if(typeof(H)!="object")H=document.getElementById(H);H.appendChild(F)}else document.body.appendChild(F);F.style.display="none"}C=H=null};this.obj.appendObject=function(A){if(typeof(A)=="string")A=document.getElementById(A);this._attachContent("obj",A,true)};this.obj.attachHTMLString=function(B){this._attachContent("str",B);var C=B.match(/<script[^>]*>[^\f]*?<\/script>/g)||[];for(var D=0;D<C.length;D++){var A=C[D].replace(/<([\/]{0,1})script[^>]*>/g,"");if(A)if(window.execScript)window.execScript(A);else window.eval(A)}};this.obj.attachURL=function(B,A){this._attachContent((A==true?"urlajax":"url"),B,false);if(this.skin=="dhx_terrace")if(this.vs[this.av].menu!=null||this.vs[this.av].toolbar!=null){this.adjust(true);this.updateNestedObjects(true)}this._viewRestore()};this.obj.adjust=function(F){if(this.skin=="dhx_skyblue"){if(this.vs[this.av].menu){if(this._isWindow||this._isLayout){this.vs[this.av].menu._topLevelOffsetLeft=0;document.getElementById(this.vs[this.av].menuId).style.height="26px";this.vs[this.av].menuHeight=document.getElementById(this.vs[this.av].menuId).offsetHeight;if(this._doOnAttachMenu)this._doOnAttachMenu("show")}if(this._isCell){document.getElementById(this.vs[this.av].menuId).className+=" in_layoutcell";this.vs[this.av].menuHeight=25}if(this._isAcc){document.getElementById(this.vs[this.av].menuId).className+=" in_acccell";this.vs[this.av].menuHeight=25}if(this._doOnAttachMenu)this._doOnAttachMenu("adjust")}if(this.vs[this.av].toolbar){if(this._isWindow)document.getElementById(this.vs[this.av].toolbarId).className+=" in_window";if(this._isLayout)document.getElementById(this.vs[this.av].toolbarId).className+=" in_layout";if(this._isCell)document.getElementById(this.vs[this.av].toolbarId).className+=" in_layoutcell";if(this._isAcc)document.getElementById(this.vs[this.av].toolbarId).className+=" in_acccell";if(this._isTabbarCell)document.getElementById(this.vs[this.av].toolbarId).className+=" in_tabbarcell"}}if(this.skin=="dhx_web")if(this.vs[this.av].toolbar){if(this._isWindow)document.getElementById(this.vs[this.av].toolbarId).className+=" in_window";if(this._isLayout)document.getElementById(this.vs[this.av].toolbarId).className+=" in_layout";if(this._isCell)document.getElementById(this.vs[this.av].toolbarId).className+=" in_layoutcell";if(this._isAcc)document.getElementById(this.vs[this.av].toolbarId).className+=" in_acccell";if(this._isTabbarCell)document.getElementById(this.vs[this.av].toolbarId).className+=" in_tabbarcell"}if(this.skin=="dhx_terrace"){var B=0;if(this._isWindow||this._isCell||this._isAcc||this._isTabbarCell)B=14;if(this._isCell&&this._noHeader)B=0;var A=0;if(this._isWindow||this._isCell||this._isAcc||this._isTabbarCell)A=14;if(this._isCell&&this._noHeader)A=0;var D=((F==true&&!this.vs[this.av].toolbar)||this._isLayout?14:0),E=(F==true||this._isLayout?14:0),C=false;if(this.vs[this.av].menu){document.getElementById(this.vs[this.av].menuId).style.marginLeft=B+"px";document.getElementById(this.vs[this.av].menuId).style.marginRight=B+"px";document.getElementById(this.vs[this.av].menuId).style.marginTop=A+"px";document.getElementById(this.vs[this.av].menuId).style.marginBottom=D+"px";this.vs[this.av].menuHeight=32+A+D;if(this._doOnAttachMenu)this._doOnAttachMenu("show");C=true}if(this.vs[this.av].toolbar){if(A==0&&this.vs[this.av].menu!=null&this._isCell)A=14;document.getElementById(this.vs[this.av].toolbarId).style.marginLeft=B+"px";document.getElementById(this.vs[this.av].toolbarId).style.marginRight=B+"px";document.getElementById(this.vs[this.av].toolbarId).style.marginTop=A+"px";document.getElementById(this.vs[this.av].toolbarId).style.marginBottom=E+"px";this.vs[this.av].toolbarHeight=32+A+E;if(this._doOnAttachToolbar)this._doOnAttachToolbar("show");C=true}}};this.obj._attachContent=function(F,E,A){if(A!==true){if(this.vs[this.av]._frame){this._detachURLEvents();this.vs[this.av]._frame=null}while(this.vs[this.av].dhxcont.mainCont[this.av].childNodes.length>0)this.vs[this.av].dhxcont.mainCont[this.av].removeChild(this.vs[this.av].dhxcont.mainCont[this.av].childNodes[0])}if(F=="url"){if(this._isWindow&&E.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this._redraw()}var D=document.createElement("IFRAME");D.frameBorder=0;D.border=0;D.style.width="100%";D.style.height="100%";D.setAttribute("src","javascript:false;");this.vs[this.av].dhxcont.mainCont[this.av].appendChild(D);D.src=E;this.vs[this.av]._frame=D;this._attachURLEvents()}else if(F=="urlajax"){if(this._isWindow&&E.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF";this._redraw()}var B=this,C=String(this.av).valueOf(),H=function(){var A=B.av;B.av=C;B.attachHTMLString(this.xmlDoc.responseText,this);B.av=A;if(B._doOnFrameContentLoaded)B._doOnFrameContentLoaded();this.destructor()},G=new dtmlXMLLoaderObject(H,window);G.dhxWindowObject=this;G.loadXML(E)}else if(F=="obj"){if(this._isWindow&&E.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF";this._redraw()}this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].appendChild(E);this.vs[this.av].dhxcont.mainCont[this.av].style.overflow=(A===true?"auto":"hidden");E.style.display=""}else if(F=="str"){if(this._isWindow&&E.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid";this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF";this._redraw()}this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].innerHTML=E}};this.obj._attachURLEvents=function(){var A=this,B=this.vs[this.av]._frame;if(_isIE)B.onreadystatechange=function(D){if(B.readyState=="complete"){try{B.contentWindow.document.body.onmousedown=function(){if(A._doOnFrameMouseDown)A._doOnFrameMouseDown()}}catch(C){}try{if(A._doOnFrameContentLoaded)A._doOnFrameContentLoaded()}catch(C){}}};else B.onload=function(){try{B.contentWindow.onmousedown=function(){if(A._doOnFrameMouseDown)A._doOnFrameMouseDown()}}catch(C){}try{if(A._doOnFrameContentLoaded)A._doOnFrameContentLoaded()}catch(C){}}};this.obj._detachURLEvents=function(){if(_isIE){try{this.vs[this.av]._frame.onreadystatechange=null;this.vs[this.av]._frame.contentWindow.document.body.onmousedown=null;this.vs[this.av]._frame.onload=null}catch(A){}}else{try{this.vs[this.av]._frame.contentWindow.onmousedown=null;this.vs[this.av]._frame.onload=null}catch(A){}}};this.obj.showMenu=function(){if(!(this.vs[this.av].menu&&this.vs[this.av].menuId))return;if(document.getElementById(this.vs[this.av].menuId).style.display!="none")return;this.vs[this.av].menuHidden=false;if(this._doOnAttachMenu)this._doOnAttachMenu("show");document.getElementById(this.vs[this.av].menuId).style.display="";this._viewRestore()};this.obj.hideMenu=function(){if(!(this.vs[this.av].menu&&this.vs[this.av].menuId))return;if(document.getElementById(this.vs[this.av].menuId).style.display=="none")return;document.getElementById(this.vs[this.av].menuId).style.display="none";this.vs[this.av].menuHidden=true;if(this._doOnAttachMenu)this._doOnAttachMenu("hide");this._viewRestore()};this.obj.showToolbar=function(){if(!(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId))return;if(document.getElementById(this.vs[this.av].toolbarId).style.display!="none")return;this.vs[this.av].toolbarHidden=false;if(this._doOnAttachToolbar)this._doOnAttachToolbar("show");document.getElementById(this.vs[this.av].toolbarId).style.display="";this._viewRestore()};this.obj.hideToolbar=function(){if(!(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId))return;if(document.getElementById(this.vs[this.av].toolbarId).style.display=="none")return;this.vs[this.av].toolbarHidden=true;document.getElementById(this.vs[this.av].toolbarId).style.display="none";if(this._doOnAttachToolbar)this._doOnAttachToolbar("hide");this._viewRestore()};this.obj.showStatusBar=function(){if(!(this.vs[this.av].sb&&this.vs[this.av].sbId))return;if(document.getElementById(this.vs[this.av].sbId).style.display!="none")return;this.vs[this.av].sbHidden=false;if(this._doOnAttachStatusBar)this._doOnAttachStatusBar("show");document.getElementById(this.vs[this.av].sbId).style.display="";this._viewRestore()};this.obj.hideStatusBar=function(){if(!(this.vs[this.av].sb&&this.vs[this.av].sbId))return;if(document.getElementById(this.vs[this.av].sbId).style.display=="none")return;this.vs[this.av].sbHidden=true;document.getElementById(this.vs[this.av].sbId).style.display="none";if(this._doOnAttachStatusBar)this._doOnAttachStatusBar("hide");this._viewRestore()};this.obj._dhxContDestruct=function(){var C=this.av;for(var B in this.vs){this.av=B;this.detachMenu();this.detachToolbar();this.detachStatusBar();this.detachObject(true);this.vs[B].dhxcont.mainCont[B]=null}for(B in this.vs){this.vs[B].dhxcont.mainCont=null;this.vs[B].dhxcont.innerHTML="";this.vs[B].dhxcont=null;this.vs[B]=null}this.vs=null;this.attachMenu=null;this.attachToolbar=null;this.attachStatusBar=null;this.detachMenu=null;this.detachToolbar=null;this.detachStatusBar=null;this.showMenu=null;this.showToolbar=null;this.showStatusBar=null;this.hideMenu=null;this.hideToolbar=null;this.hideStatusBar=null;this.attachGrid=null;this.attachScheduler=null;this.attachTree=null;this.attachTabbar=null;this.attachFolders=null;this.attachAccordion=null;this.attachLayout=null;this.attachEditor=null;this.attachObject=null;this.detachObject=null;this.appendObject=null;this.attachHTMLString=null;this.attachURL=null;this.attachMap=null;this.view=null;this.show=null;this.adjust=null;this.setMinContentSize=null;this.moveContentTo=null;this.adjustContent=null;this.coverBlocker=null;this.showCoverBlocker=null;this.hideCoverBlocker=null;this.updateNestedObjects=null;this._attachContent=null;this._attachURLEvents=null;this._detachURLEvents=null;this._viewRestore=null;this._setPadding=null;this._init=null;this._genStr=null;this._dhxContDestruct=null;this._getSt=null;this.getFrame=null;this.getView=null;this.setActive=null;A.st.innerHTML="";A.st.parentNode.removeChild(A.st);A.st=null;A.setContent=null;A.dhxcont=null;A.obj=null;A=null;if(dhtmlx.detaches)for(B in dhtmlx.detaches)dhtmlx.detaches[B](this)};if(dhtmlx.attaches)for(var B in dhtmlx.attaches)this.obj[B]=dhtmlx.attaches[B];return this}function dhtmlXCalendarObject(J,I){this.i={};this.uid=function(){if(!this.uidd)this.uidd=new Date().getTime();return this.uidd++};var H=null;if(typeof(J)=="string")var E=document.getElementById(J);else E=J;if(E&&typeof(E)=="object"&&E.tagName&&String(E.tagName).toLowerCase()!="input")H=E;E=null;if(typeof(J)!="object"||!J.length)J=[J];for(var F=0;F<J.length;F++){if(typeof(J[F])=="string")J[F]=(document.getElementById(J[F])||null);if(J[F]!=null&&J[F].tagName&&String(J[F].tagName).toLowerCase()=="input")this.i[this.uid()]=J[F];J[F]=null}this.skin=(I!=null?I:(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:"dhx_skyblue"));this.setSkin=function(A){this.skin=A;this.base.className="dhtmlxcalendar_container dhtmlxcalendar_skin_"+this.skin;this._ifrSize()};this.base=document.createElement("DIV");this.base.className="dhtmlxcalendar_container";this.base.style.display="none";if(H!=null){this._hasParent=true;H.appendChild(this.base);H=null}else document.body.appendChild(this.base);this.setParent=function(A){if(this._hasParent)if(typeof(A)=="object")A.appendChild(this.base);else if(typeof(A)=="string")document.getElementById(A).appendChild(this.base)};this.setSkin(this.skin);this.base.onclick=function(A){A=A||event;A.cancelBubble=true};this.loadUserLanguage=function(D){if(!this.langData[D])return;this.lang=D;this.setWeekStartDay(this.langData[this.lang].weekstart);if(this.msCont){var B=0;for(var C=0;C<this.msCont.childNodes.length;C++)for(var A=0;A<this.msCont.childNodes[C].childNodes.length;A++)this.msCont.childNodes[C].childNodes[A].innerHTML=this.langData[this.lang].monthesSNames[B++]}};this.contMonth=document.createElement("DIV");this.contMonth.className="dhtmlxcalendar_month_cont";this.contMonth.onselectstart=function(A){A=A||event;A.cancelBubble=true;A.returnValue=false;return false};this.base.appendChild(this.contMonth);var D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contMonth.appendChild(D);var B=document.createElement("LI");B.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";B.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div>"+"<span class='dhtmlxcalendar_month_label_month'>Month</span><span class='dhtmlxcalendar_month_label_year'>Year</span>"+"<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";D.appendChild(B);var C=this;B.onclick=function(B){B=B||event;var A=(B.target||B.srcElement);if(A.className&&A.className.indexOf("dhtmlxcalendar_month_arrow")===0){C._hideSelector();var D=(A.parentNode.firstChild==A?-1:1),E=new Date(C._activeMonth);C._drawMonth(new Date(C._activeMonth.getFullYear(),C._activeMonth.getMonth()+D,1,0,0,0,0));C.callEvent("onArrowClick",[E,new Date(C._activeMonth)]);return}if(A.className&&A.className=="dhtmlxcalendar_month_label_month"){B.cancelBubble=true;C._showSelector("month",31,21,"selector_month",true);return}if(A.className&&A.className=="dhtmlxcalendar_month_label_year"){B.cancelBubble=true;C._showSelector("year",42,21,"selector_year",true);return}C._hideSelector()};this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.appendChild(this.contDays);this.setWeekStartDay=function(A){if(A==0)A=7;this._wStart=Math.min(Math.max((isNaN(A)?1:A),1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==0){var C=document.createElement("UL");C.className="dhtmlxcalendar_line";this.contDays.appendChild(C)}else C=this.contDays.firstChild;var B=this._wStart,E=this.langData[this.lang].daysSNames;E.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var D=0;D<7;D++){if(C.childNodes[D]==null){var A=document.createElement("LI");C.appendChild(A)}else A=C.childNodes[D];A.className="dhtmlxcalendar_cell"+(B>=6?" dhtmlxcalendar_day_weekday_cell":"")+(D==0?"_first":"");A.innerHTML=E[B];if(++B>7)B=1}if(this._activeMonth!=null)this._drawMonth(this._activeMonth)};this._wStart=this.langData[this.lang].weekstart;this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.appendChild(this.contDates);this.contDates.onclick=function(F){F=F||event;var E=(F.target||F.srcElement);if(E._date!=null&&!E._css_dis){var D=C._activeDate.getHours(),B=C._activeDate.getMinutes(),A=E._date;if(C.checkEvent("onBeforeChange"))if(!C.callEvent("onBeforeChange",[new Date(E._date.getFullYear(),E._date.getMonth(),E._date.getDate(),D,B)]))return;if(C._activeDateCell!=null){C._activeDateCell._css_date=false;C._updateCellStyle(C._activeDateCell._q,C._activeDateCell._w)}var G=(C._hasParent&&C._activeDate.getFullYear()+"_"+C._activeDate.getMonth()!=A.getFullYear()+"_"+A.getMonth());C._nullDate=false;C._activeDate=new Date(A.getFullYear(),A.getMonth(),A.getDate(),D,B);C._activeDateCell=E;C._activeDateCell._css_date=true;C._activeDateCell._css_hover=false;C._lastHover=null;C._updateCellStyle(C._activeDateCell._q,C._activeDateCell._w);if(G)C._drawMonth(C._activeDate);if(C._activeInp&&C.i[C._activeInp])C.i[C._activeInp].value=C._dateToStr(new Date(C._activeDate.getTime()));if(!C._hasParent)C._hide();C.callEvent("onClick",[new Date(C._activeDate.getTime())])}};this.contDates.onmouseover=function(B){B=B||event;var A=(B.target||B.srcElement);if(A._date!=null){A._css_hover=true;C._updateCellStyle(A._q,A._w);C._lastHover=A}};this.contDates.onmouseout=function(){C._clearDayHover()};this._lastHover=null;this._clearDayHover=function(){if(!this._lastHover)return;this._lastHover._css_hover=false;this._updateCellStyle(this._lastHover._q,this._lastHover._w);this._lastHover=null};for(F=0;F<6;F++){D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contDates.appendChild(D);for(var A=0;A<7;A++){B=document.createElement("LI");B.className="dhtmlxcalendar_cell";D.appendChild(B)}}this.contTime=document.createElement("DIV");this.contTime.className="dhtmlxcalendar_time_cont";this.base.appendChild(this.contTime);this.showTime=function(){if(String(this.base.className).search("dhtmlxcalendar_time_hidden")>0)this.base.className=String(this.base.className).replace(/dhtmlxcalendar_time_hidden/gi,"");this._ifrSize()};this.hideTime=function(){if(String(this.base.className).search("dhtmlxcalendar_time_hidden")<0)this.base.className+=" dhtmlxcalendar_time_hidden";this._ifrSize()};D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contTime.appendChild(D);B=document.createElement("LI");B.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";B.innerHTML="<div class='dhtmlxcalendar_time_label'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'>:</span><span class='dhtmlxcalendar_label_minutes'></span>";D.appendChild(B);B.onclick=function(B){B=B||event;var A=(B.target||B.srcElement);if(A.className&&A.className=="dhtmlxcalendar_label_hours"){B.cancelBubble=true;C._showSelector("hours",3,115,"selector_hours",true);return}if(A.className&&A.className=="dhtmlxcalendar_label_minutes"){B.cancelBubble=true;C._showSelector("minutes",59,115,"selector_minutes",true);return}C._hideSelector()};this._activeMonth=null;this._activeDate=new Date();this._activeDateCell=null;this.setDate=function(B){this._nullDate=(typeof(B)=="undefined"||B===""||!B);if(!(B instanceof Date)){B=this._strToDate(String(B||""));if(B=="Invalid Date")B=new Date()}var A=B.getTime();if(this._isOutOfRange(A))return;this._activeDate=new Date(A);this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleHours();this._updateVisibleMinutes()};this.getDate=function(A){if(this._nullDate)return null;var B=new Date(this._activeDate.getTime());if(A)return this._dateToStr(B);return B};this._drawMonth=function(A){if(!(A instanceof Date))return;if(isNaN(A.getFullYear()))A=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0);this._activeMonth=new Date(A.getFullYear(),A.getMonth(),1,0,0,0,0);this._activeDateCell=null;var M=new Date(this._activeMonth.getTime()),F=M.getDay(),J=F-this._wStart;if(J<0)J=J+7;M.setDate(M.getDate()-J);var C=A.getMonth(),B=new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime(),E=0;for(var K=0;K<6;K++){var D=this._wStart;for(var G=0;G<7;G++){var I=new Date(M.getFullYear(),M.getMonth(),M.getDate()+E++,0,0,0,0);this.contDates.childNodes[K].childNodes[G].innerHTML=I.getDate();var L=I.getDay(),H=I.getTime();this.contDates.childNodes[K].childNodes[G]._date=new Date(H);this.contDates.childNodes[K].childNodes[G]._q=K;this.contDates.childNodes[K].childNodes[G]._w=G;this.contDates.childNodes[K].childNodes[G]._css_month=(I.getMonth()==C);this.contDates.childNodes[K].childNodes[G]._css_date=(!this._nullDate&&H==B);this.contDates.childNodes[K].childNodes[G]._css_weekend=(D>=6);this.contDates.childNodes[K].childNodes[G]._css_dis=this._isOutOfRange(H);this.contDates.childNodes[K].childNodes[G]._css_holiday=(this._holidays[H]==true);this._updateCellStyle(K,G);if(H==B)this._activeDateCell=this.contDates.childNodes[K].childNodes[G];if(++D>7)D=1}}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this.langData[this.lang].monthesFNames[A.getMonth()];this.contMonth.firstChild.firstChild.childNodes[2].innerHTML=A.getFullYear()};this._updateCellStyle=function(D,A){var C=this.contDates.childNodes[D].childNodes[A],B="dhtmlxcalendar_cell dhtmlxcalendar_cell";B+=(C._css_month?"_month":"");B+=(C._css_date?"_date":"");B+=(C._css_weekend?"_weekend":"");B+=(C._css_holiday?"_holiday":"");B+=(C._css_dis?"_dis":"");B+=(C._css_hover&&!C._css_dis?"_hover":"");C.className=B;C=null};this._initSelector=function(F,G){if(!this._selCover){this._selCover=document.createElement("DIV");this._selCover.className="dhtmlxcalendar_selector_cover";this.base.appendChild(this._selCover)}if(!this._sel){this._sel=document.createElement("DIV");this._sel.className="dhtmlxcalendar_selector_obj";this.base.appendChild(this._sel);this._sel.appendChild(document.createElement("TABLE"));this._sel.firstChild.className="dhtmlxcalendar_selector_table";this._sel.firstChild.cellSpacing=0;this._sel.firstChild.cellPadding=0;this._sel.firstChild.border=0;this._sel.firstChild.appendChild(document.createElement("TBODY"));this._sel.firstChild.firstChild.appendChild(document.createElement("TR"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left";this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle";this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right";this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;";this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;";this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"};this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(A){A=A||event;A.cancelBubble=true;C._scrollYears(-1)};this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(A){A=A||event;A.cancelBubble=true;C._scrollYears(1)};this._sel._ta={};this._selHover=null;this._sel.onmouseover=function(B){B=B||event;var A=(B.target||B.srcElement);if(A._cell===true){if(C._selHover!=A)C._clearSelHover();if(String(A.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=null){A.className+=" dhtmlxcalendar_selector_cell_hover";C._selHover=A}}};this._sel.onmouseout=function(){C._clearSelHover()};this._sel.appendChild(document.createElement("DIV"));this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"}if(this._sel._ta[F]==true)return;if(F=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+G;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);var H=0;for(var E=0;E<4;E++){var D=document.createElement("UL");D.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(D);for(var B=0;B<3;B++){var A=document.createElement("LI");A.innerHTML=this.langData[this.lang].monthesSNames[H];A.className="dhtmlxcalendar_selector_cell";D.appendChild(A);A._month=H;A._cell=true;this._msCells[H++]=A}}this.msCont.onclick=function(B){B=B||event;B.cancelBubble=true;var A=(B.target||B.srcElement);if(A._month!=null){C._hideSelector();C._updateActiveMonth();C._drawMonth(new Date(C._activeMonth.getFullYear(),A._month,1,0,0,0,0));C._doOnSelectorChange()}}}if(F=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+G;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(E=0;E<4;E++){D=document.createElement("UL");D.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(D);for(B=0;B<3;B++){A=document.createElement("LI");A.className="dhtmlxcalendar_selector_cell";A._cell=true;D.appendChild(A)}}this.ysCont.onclick=function(B){B=B||event;B.cancelBubble=true;var A=(B.target||B.srcElement);if(A._year!=null){C._hideSelector();C._drawMonth(new Date(A._year,C._activeMonth.getMonth(),1,0,0,0,0));C._doOnSelectorChange()}}}if(F=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");this.hsCont.className="dhtmlxcalendar_area_"+G;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);H=0;for(E=0;E<4;E++){D=document.createElement("UL");D.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(D);for(B=0;B<6;B++){A=document.createElement("LI");A.innerHTML=this._fixLength(H,2);A.className="dhtmlxcalendar_selector_cell";D.appendChild(A);A._hours=H;A._cell=true;this._hsCells[H++]=A}}this.hsCont.onclick=function(B){B=B||event;B.cancelBubble=true;var A=(B.target||B.srcElement);if(A._hours!=null){C._hideSelector();C._activeDate.setHours(A._hours);C._updateActiveHours();C._updateVisibleHours();C._doOnSelectorChange()}}}if(F=="minutes"){this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className="dhtmlxcalendar_area_"+G;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);H=0;for(E=0;E<4;E++){D=document.createElement("UL");D.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(D);for(B=0;B<3;B++){A=document.createElement("LI");A.innerHTML=this._fixLength(H,2);A.className="dhtmlxcalendar_selector_cell";D.appendChild(A);A._minutes=H;A._cell=true;this._rsCells[H]=A;H+=5}}this.rsCont.onclick=function(B){B=B||event;B.cancelBubble=true;var A=(B.target||B.srcElement);if(A._minutes!=null){C._hideSelector();C._activeDate.setMinutes(A._minutes);C._updateActiveMinutes();C._updateVisibleMinutes();C._doOnSelectorChange()}}}this._sel._ta[F]=true};this._showSelector=function(B,E,D,C,A){if(A===true&&this._sel!=null&&this._isSelectorVisible()&&B==this._sel._t){this._hideSelector();return}if(this.skin=="dhx_terrace"){E+={month:14,year:27,hours:19,minutes:24}[B];D+={month:8,year:8,hours:14,minutes:14}[B]}if(!this._sel||!this._sel._ta[B])this._initSelector(B,C);this._selCover.style.display="";this._sel._t=B;this._sel.style.left=E+"px";this._sel.style.top=D+"px";this._sel.style.display="";this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+C;this._doOnSelectorShow(B)};this._doOnSelectorShow=function(A){if(A=="month")this._updateActiveMonth();if(A=="year")this._updateYearsList(this._activeMonth);if(A=="hours")this._updateActiveHours();if(A=="minutes")this._updateActiveMinutes()};this._hideSelector=function(){if(!this._sel)return;this._sel.style.display="none";this._selCover.style.display="none"};this._isSelectorVisible=function(){if(!this._sel)return false;return(this._sel.style.display!="none")};this._doOnSelectorChange=function(A){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),A])};this._clearSelHover=function(){if(!this._selHover)return;this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,""));this._selHover=null};this._updateActiveMonth=function(){if(typeof(this._msActive)!="undefined"&&typeof(this._msCells[this._msActive])!="undefined")this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell";this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var A=this._activeMonth.getFullYear();if(this._ysCells[A])this._ysCells[A].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateYearsList=function(B){for(var D in this._ysCells){this._ysCells[D]=null;delete this._ysCells[D]}var E=12*Math.floor(B.getFullYear()/12);for(var C=0;C<4;C++)for(var A=0;A<3;A++){this.ysCont.childNodes[C].childNodes[A].innerHTML=E;this.ysCont.childNodes[C].childNodes[A]._year=E;this.ysCont.childNodes[C].childNodes[A].className="dhtmlxcalendar_selector_cell";this._ysCells[E++]=this.ysCont.childNodes[C].childNodes[A]}this._updateActiveYear()};this._scrollYears=function(C){var B=(C<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+C,A=new Date(B,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(A)};this._updateActiveHours=function(){if(typeof(this._hsActive)!="undefined"&&typeof(this._hsCells[this._hsActive])!="undefined")this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell";this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(typeof(this._rsActive)!="undefined"&&typeof(this._rsCells[this._rsActive])!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell";this._rsActive=this._activeDate.getMinutes();if(typeof(this._rsCells[this._rsActive])!="undefined")this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleMinutes=function(){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this._fixLength(this._activeDate.getMinutes(),2)};this._fixLength=function(A,B){while(String(A).length<B)A="0"+String(A);return A};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(A){this._dateFormat=A;this._dateFormatRE=new RegExp(String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(B){var A=B.replace(/%/,"");switch(A){case"n":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+C.langData[C.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+C.langData[C.lang].monthesFNames.join("|").toLowerCase()+"){1,}"}return B}),"i")};this.setDateFormat("%Y-%m-%d");this._getInd=function(A,C){for(var B=0;B<C.length;B++)if(C[B].toLowerCase()==A)return B;return-1};this._strToDate=function(A,F){F=(F||this._dateFormat);var I=A.match(/[a-z0-9]{1,}/gi),B=F.match(/%[a-zA-Z]/g);if(!I||I.length!=B.length)return"Invalid Date";var M={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%H":4,"%G":4,"%h":4,"%g":4,"%i":5,"%s":6},E={},N={};for(var L=0;L<B.length;L++)if(typeof(M[B[L]])!="undefined"){var J=M[B[L]];if(!E[J]){E[J]=[];N[J]=[]}E[J].push(I[L]);N[J].push(B[L])}I=[];B=[];for(L=1;L<=6;L++)if(E[L]!=null)for(var H=0;H<E[L].length;H++){I.push(E[L][H]);B.push(N[L][H])}var K=new Date();K.setDate(1);for(L=0;L<I.length;L++)switch(B[L]){case"%d":case"%j":case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":if(!isNaN(I[L]))K[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds"}[B[L]]](Number(I[L])+(B[L]=="%m"||B[L]=="%n"?-1:0));break;case"%M":case"%F":var G=this._getInd(I[L].toLowerCase(),C.langData[C.lang][{"%M":"monthesSNames","%F":"monthesFNames"}[B[L]]]);if(G>=0)K.setMonth(G);break;case"%y":if(!isNaN(I[L])){var D=Number(I[L]);K.setFullYear(D+(D>50?1900:2000))}break;case"%g":case"%h":if(!isNaN(I[L])){D=Number(I[L]);if(D<=12&&D>=0)K.setHours(D+(this._getInd("pm",I)>=0?12:0))}break}return K};this._dateToStr=function(A,D){if(A instanceof Date)var F=function(A){return(String(A).length==1?"0"+String(A):A)},E=function(B){switch(B){case"%d":return F(A.getDate());case"%j":return A.getDate();case"%D":return C.langData[C.lang].daysSNames[A.getDay()];case"%l":return C.langData[C.lang].daysFNames[A.getDay()];case"%m":return F(A.getMonth()+1);case"%n":return A.getMonth()+1;case"%M":return C.langData[C.lang].monthesSNames[A.getMonth()];case"%F":return C.langData[C.lang].monthesFNames[A.getMonth()];case"%y":return F(A.getYear()%100);case"%Y":return A.getFullYear();case"%g":return(A.getHours()+11)%12+1;case"%h":return F((A.getHours()+11)%12+1);case"%G":return A.getHours();case"%H":return F(A.getHours());case"%i":return F(A.getMinutes());case"%s":return F(A.getSeconds());case"%a":return(A.getHours()>11?"pm":"am");case"%A":return(A.getHours()>11?"PM":"AM");case"%%":"%";default:return B}},B=String(D||this._dateFormat).replace(/%[a-zA-Z]/g,E);return(B||String(A))};this._updateDateStr=function(A){if(A==""){this.setDate(new Date());this.callEvent("onChange",[null,true]);return}else if(!this._dateFormatRE||!A.match(this._dateFormatRE))return;var B=this._strToDate(A);if(!(B instanceof Date))return;this._nullDate=false;this._activeDate=B;this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleMinutes();this._updateVisibleHours();if(this._sel&&this._isSelectorVisible())this._doOnSelectorShow(this._sel._t);this._doOnSelectorChange(true)};this.setFormatedDate=function(D,A,C,B){var E=this._strToDate(A,D);if(B)return E;this.setDate(E)};this.getFormatedDate=function(A,B){if(this._nullDate)return"";if(!(B&&B instanceof Date))B=new Date(this._activeDate);return this._dateToStr(B,A)};this.show=function(A){if(!A&&this._hasParent){this._show();return}if(typeof(A)=="object"&&typeof(A._dhtmlxcalendar_uid)!="undefined"&&this.i[A._dhtmlxcalendar_uid]==A){this._show(A._dhtmlxcalendar_uid);return}if(typeof(A)=="undefined")for(var B in this.i)if(!A)A=B;if(!A)return;this._show(A)};this.hide=function(){if(this._isVisible())this._hide()};this.isVisible=function(){return this._isVisible()};this.draw=function(){this.show()};this.close=function(){this.hide()};this._activeInp=null;this.pos="bottom";this.setPosition=function(B,A){this._px=null;this._py=null;if(B=="right"||B=="bottom")this.pos=B;else{this.pos="int";if(typeof(B)!="undefined"&&!isNaN(B)){this.base.style.left=B+"px";this._px=B}if(typeof(A)!="undefined"&&!isNaN(A)){this.base.style.top=A+"px";this._py=A}this._ifrSize()}};this._show=function(B,A){if(A===true&&this._activeInp==B&&this._isVisible()){this._hide();return}if(!B){if(this._px&&this._py){this.base.style.left=this._px+"px";this.base.style.top=this._py+"px"}else{this.base.style.left="0px";this.base.style.top="0px"}}else{if(this.pos=="right"){this.base.style.left=this._getLeft(this.i[B])+this.i[B].offsetWidth-1+"px";this.base.style.top=this._getTop(this.i[B])+"px"}else if(this.pos=="bottom"){this.base.style.left=this._getLeft(this.i[B])+"px";this.base.style.top=this._getTop(this.i[B])+this.i[B].offsetHeight-1+"px"}else{this.base.style.left=(this._px||0)+"px";this.base.style.top=(this._py||0)+"px"}this._activeInp=B}this._hideSelector();this.base.style.display="";this._ifrSize();if(this._ifr)this._ifr.style.display=""};this._hide=function(){this._hideSelector();this.base.style.display="none";this._activeInp=null;if(this._ifr)this._ifr.style.display="none"};this._isVisible=function(){return(this.base.style.display!="none")};this._getLeft=function(A){return this._posGetOffset(A).left};this._getTop=function(A){return this._posGetOffset(A).top};this._posGetOffsetSum=function(A){var C=0,B=0;while(A){C=C+parseInt(A.offsetTop);B=B+parseInt(A.offsetLeft);A=A.offsetParent}return{top:C,left:B}};this._posGetOffsetRect=function(A){var I=A.getBoundingClientRect(),B=document.body,E=document.documentElement,G=window.pageYOffset||E.scrollTop||B.scrollTop,F=window.pageXOffset||E.scrollLeft||B.scrollLeft,C=E.clientTop||B.clientTop||0,D=E.clientLeft||B.clientLeft||0,J=I.top+G-C,H=I.left+F-D;return{top:Math.round(J),left:Math.round(H)}};this._posGetOffset=function(A){return this[A.getBoundingClientRect?"_posGetOffsetRect":"_posGetOffsetSum"](A)};this._rangeActive=false;this._rangeFrom=null;this._rangeTo=null;this._rangeSet={};this.setInsensitiveDays=function(A){var B=this._extractDates(A);for(var C=0;C<B.length;C++)this._rangeSet[new Date(B[C].getFullYear(),B[C].getMonth(),B[C].getDate(),0,0,0,0).getTime()]=true;this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(B){if(B==null)this._clearHolidays();else if(B!=null){var A=this._extractDates(B);for(var C=0;C<A.length;C++)this._holidays[new Date(A[C].getFullYear(),A[C].getMonth(),A[C].getDate(),0,0,0,0).getTime()]=true}this._drawMonth(this._activeMonth)};this._extractDates=function(D){if(typeof(D)=="string"||D instanceof Date)D=[D];var C=[];for(var E=0;E<D.length;E++)if(typeof(D[E])=="string"){var B=D[E].split(",");for(var A=0;A<B.length;A++)C.push(this._strToDate(B[A]))}else if(D[E]instanceof Date)C.push(D[E]);return C};this._clearRange=function(){this._rangeActive=false;this._rangeType=null;this._rangeFrom=null;this._rangeTo=null};this._clearRangeSet=function(){for(var A in this._rangeSet){this._rangeSet[A]=null;delete this._rangeSet[A]}};this._clearHolidays=function(){for(var A in this._holidays){this._holidays[A]=null;delete this._holidays[A]}};this._isOutOfRange=function(A){if(this._rangeSet[A]==true)return true;if(this._rangeActive){if(this._rangeType=="in"&&(A<this._rangeFrom||A>this._rangeTo))return true;if(this._rangeType=="out"&&(A>=this._rangeFrom&&A<=this._rangeTo))return true;if(this._rangeType=="from"&&A<this._rangeFrom)return true;if(this._rangeType=="to"&&A>this._rangeTo)return true}var B=new Date(A);if(this._rangeWeek)if(this._rangeWeekData[B.getDay()]===true)return true;if(this._rangeMonth)if(this._rangeMonthData[B.getDate()]===true)return true;if(this._rangeYear)if(this._rangeYearData[B.getMonth()+"_"+B.getDate()]===true)return true;return false};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(D,B,C){var A=false;if(D!=null&&B!=null){if(!(D instanceof Date))D=this._strToDate(D);if(!(B instanceof Date))B=this._strToDate(B);if(D.getTime()>B.getTime())return;this._rangeFrom=new Date(D.getFullYear(),D.getMonth(),D.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(B.getFullYear(),B.getMonth(),B.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="in";A=true}if(!A&&D!=null&&B==null){if(!(D instanceof Date))D=this._strToDate(D);this._rangeFrom=new Date(D.getFullYear(),D.getMonth(),D.getDate(),0,0,0,0).getTime();this._rangeTo=null;if(C===true)this._rangeFrom++;this._rangeActive=true;this._rangeType="from";A=true}if(!A&&D==null&&B!=null){if(!(B instanceof Date))B=this._strToDate(B);this._rangeFrom=null;this._rangeTo=new Date(B.getFullYear(),B.getMonth(),B.getDate(),0,0,0,0).getTime();if(C===true)this._rangeTo--;this._rangeActive=true;this._rangeType="to";A=true}if(A)this._drawMonth(this._activeMonth)};this.setInsensitiveRange=function(B,A){if(B!=null&&A!=null){if(!(B instanceof Date))B=this._strToDate(B);if(!(A instanceof Date))A=this._strToDate(A);if(B.getTime()>A.getTime())return;this._rangeFrom=new Date(B.getFullYear(),B.getMonth(),B.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(A.getFullYear(),A.getMonth(),A.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="out";this._drawMonth(this._activeMonth);return}if(B!=null&&A==null){this.setSensitiveRange(null,B,true);return}if(B==null&&A!=null){this.setSensitiveRange(A,null,true);return}};this.disableDays=function(E,A){if(E=="week"){if(typeof(A)!="object"&&typeof(A.length)=="undefined")A=[A];if(!this._rangeWeekData)this._rangeWeekData={};for(var D in this._rangeWeekData){this._rangeWeekData[D]=false;delete this._rangeWeekData[D]}for(var C=0;C<A.length;C++){this._rangeWeekData[A[C]]=true;if(A[C]==7)this._rangeWeekData[0]=true}this._rangeWeek=true}if(E=="month"){if(typeof(A)!="object"&&typeof(A.length)=="undefined")A=[A];if(!this._rangeMonthData)this._rangeMonthData={};for(D in this._rangeMonthData){this._rangeMonthData[D]=false;delete this._rangeMonthData[D]}for(C=0;C<A.length;C++)this._rangeMonthData[A[C]]=true;this._rangeMonth=true}if(E=="year"){var B=this._extractDates(A);if(!this._rangeYearData)this._rangeYearData={};for(D in this._rangeYearData){this._rangeYearData[D]=false;delete this._rangeYearData[D]}for(C=0;C<B.length;C++)this._rangeYearData[B[C].getMonth()+"_"+B[C].getDate()]=true;this._rangeYear=true}this._drawMonth(this._activeMonth)};this.enableDays=function(A){if(A=="week")this._rangeWeek=false;if(A=="month")this._rangeMonth=false;if(A=="year")this._rangeYear=false;this._drawMonth(this._activeMonth)};this._updateFromInput=function(A){if(this._nullInInput&&((A.value).replace(/\s/g,"")).length==0)this.setDate(null);else this._updateDateStr(A.value);A=null};this._doOnClick=function(B){B=B||event;var A=(B.target||B.srcElement);if(A._dhtmlxcalendar_uid&&A._dhtmlxcalendar_uid!=C._activeInp&&C._isVisible()&&C._activeInp){C._hide();return}if(!A._dhtmlxcalendar_uid||!C.i[A._dhtmlxcalendar_uid])if(C._isSelectorVisible())C._hideSelector();else if(!C._hasParent&&C._isVisible())C._hide()};this._doOnKeyDown=function(A){A=A||event;if(A.keyCode==27||A.keyCode==13)if(C._isSelectorVisible())C._hideSelector();else if(C._isVisible()&&!C._hasParent)C._hide()};this._doOnInpClick=function(B){B=B||event;var A=(B.target||B.srcElement);if(!A._dhtmlxcalendar_uid)return;if(!C._listenerEnabled)C._updateFromInput(A);C._show(A._dhtmlxcalendar_uid,true)};this._doOnInpKeyUp=function(B){B=B||event;var A=(B.target||B.srcElement);if(B.keyCode==13||!A._dhtmlxcalendar_uid)return;if(!C._listenerEnabled)C._updateFromInput(A)};this._doOnUnload=function(){if(C&&C.unload)C.unload()};if(window.addEventListener){document.body.addEventListener("click",C._doOnClick,false);window.addEventListener("keydown",C._doOnKeyDown,false);window.addEventListener("unload",C._doOnUnload,false)}else{document.body.attachEvent("onclick",C._doOnClick);document.body.attachEvent("onkeydown",C._doOnKeyDown);window.attachEvent("onunload",C._doOnUnload)}this.attachObj=function(B){if(typeof(B)=="string")B=document.getElementById(B);var A=this.uid();this.i[A]=B;this._attachEventsToObject(A)};this.detachObj=function(B){if(typeof(B)=="string")B=document.getElementById(B);var A=B._dhtmlxcalendar_uid;if(this.i[A]!=null){this._detachEventsFromObject(A);this.i[A]._dhtmlxcalendar_uid=null;this.i[A]=null;delete this.i[A]}};this._attachEventsToObject=function(A){this.i[A]._dhtmlxcalendar_uid=A;if(window.addEventListener){this.i[A].addEventListener("click",C._doOnInpClick,false);this.i[A].addEventListener("keyup",C._doOnInpKeyUp,false)}else{this.i[A].attachEvent("onclick",C._doOnInpClick);this.i[A].attachEvent("onkeyup",C._doOnInpKeyUp)}};this.enableListener=function(A){if(window.addEventListener){A.addEventListener("focus",C._listenerEvFocus,false);A.addEventListener("blur",C._listenerEvBlur,false)}else{A.attachEvent("onfocus",C._listenerEvFocus);A.attachEvent("onblur",C._listenerEvBlur)}A=null};this.disableListener=function(A){A._f0=false;if(this._tmListener)window.clearTimeout(this._tmListener);if(window.addEventListener){A.removeEventListener("focus",C._listenerEvFocus,false);A.removeEventListener("blur",C._listenerEvBlur,false)}else{A.detachEvent("onfocus",C._listenerEvFocus);A.detachEvent("onblur",C._listenerEvBlur)}A=null};this._startListener=function(A){if(this._tmListener)window.clearTimeout(this._tmListener);if(typeof(A._v1)=="undefined")A._v1=A.value;if(A._v1!=A.value){this._updateFromInput(A);A._v1=A.value}if(A._f0)this._tmListener=window.setTimeout(function(){C._startListener(A)},100)};this._listenerEvFocus=function(B){B=B||event;var A=B.target||B.srcElement;A._f0=true;C._startListener(A);A=null};this._listenerEvBlur=function(B){B=B||event;var A=B.target||B.srcElement;A._f0=false;A=null};this._detachEventsFromObject=function(A){if(window.addEventListener){this.i[A].removeEventListener("click",C._doOnInpClick,false);this.i[A].removeEventListener("keyup",C._doOnInpKeyUp,false)}else{this.i[A].detachEvent("onclick",C._doOnInpClick);this.i[A].detachEvent("onkeyup",C._doOnInpKeyUp)}};for(var G in this.i)this._attachEventsToObject(G);this.evs={};this.attachEvent=function(B,C){var A=this.uid();this.evs[A]={name:String(B).toLowerCase(),func:C};return A};this.detachEvent=function(A){if(this.evs[A]){this.evs[A].name=null;this.evs[A].func=null;this.evs[A]=null;delete this.evs[A]}};this.callEvent=function(D,F){var A=true,E=String(D).toLowerCase();F=(F||[]);for(var C in this.evs)if(this.evs[C].name==E){var B=this.evs[C].func.apply(this,F);A=(A&&B)}return A};this.checkEvent=function(C){var A=false,D=String(C).toLowerCase();for(var B in this.evs)A=(A||this.evs[B].name==D);return A};this.unload=function(){this._activeDate=null;this._activeDateCell=null;this._activeInp=null;this._activeMonth=null;this._dateFormat=null;this._dateFormatRE=null;this._lastHover=null;this.uid=null;this.uidd=null;if(this._tmListener)window.clearTimeout(this._tmListener);this._tmListener=null;if(window.addEventListener){document.body.removeEventListener("click",C._doOnClick,false);window.removeEventListener("keydown",C._doOnKeyDown,false);window.removeEventListener("unload",C._doOnUnload,false)}else{document.body.detachEvent("onclick",C._doOnClick);document.body.detachEvent("onkeydown",C._doOnKeyDown);window.detachEvent("onunload",C._doOnKeyDown)}this._doOnClick=null;this._doOnKeyDown=null;this._doOnUnload=null;for(var A in this.i){this.i[A]._dhtmlxcalendar_uid=null;if(window.addEventListener){this.i[A].removeEventListener("click",C._doOnInpClick,false);this.i[A].removeEventListener("keyup",C._doOnInpKeyUp,false)}else{this.i[A].detachEvent("onclick",C._doOnInpClick);this.i[A].detachEvent("onkeyup",C._doOnInpKeyUp)}this.disableListener(this.i[A]);this.i[A]=null;delete this.i[A]}this.i=null;this._doOnInpClick=null;this._doOnInpKeyUp=null;for(A in this.evs)this.detachEvent(A);this.evs=null;this.attachEvent=null;this.detachEvent=null;this.checkEvent=null;this.callEvent=null;this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;while(this.contMonth.firstChild.firstChild.childNodes.length>0)this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild);this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);this.contMonth=null;while(this.contDays.firstChild.childNodes.length>0)this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild);this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.onmouseover=null;this.contDates.onmouseout=null;while(this.contDates.childNodes.length>0){while(this.contDates.lastChild.childNodes.length>0){this.contDates.lastChild.lastChild._css_date=null;this.contDates.lastChild.lastChild._css_month=null;this.contDates.lastChild.lastChild._css_weekend=null;this.contDates.lastChild.lastChild._css_hover=null;this.contDates.lastChild.lastChild._date=null;this.contDates.lastChild.lastChild._q=null;this.contDates.lastChild.lastChild._w=null;this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)}this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;this.contTime.firstChild.firstChild.onclick=null;while(this.contTime.firstChild.firstChild.childNodes.length>0)this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild);this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);this.contTime=null;this._lastHover=null;if(this.msCont){this.msCont.onclick=null;this._msActive=null;for(A in this._msCells){this._msCells[A]._cell=null;this._msCells[A]._month=null;this._msCells[A].parentNode.removeChild(this._msCells[A]);this._msCells[A]=null}this._msCells=null;while(this.msCont.childNodes.length>0)this.msCont.removeChild(this.msCont.lastChild);this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(this.ysCont){this.ysCont.onclick=null;for(A in this._ysCells){this._ysCells[A]._cell=null;this._ysCells[A]._year=null;this._ysCells[A].parentNode.removeChild(this._ysCells[A]);this._ysCells[A]=null}this._ysCells=null;while(this.ysCont.childNodes.length>0)this.ysCont.removeChild(this.ysCont.lastChild);this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(this.hsCont){this.hsCont.onclick=null;this._hsActive=null;for(A in this._hsCells){this._hsCells[A]._cell=null;this._hsCells[A]._hours=null;this._hsCells[A].parentNode.removeChild(this._hsCells[A]);this._hsCells[A]=null}this._hsCells=null;while(this.hsCont.childNodes.length>0)this.hsCont.removeChild(this.hsCont.lastChild);this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(this.rsCont){this.rsCont.onclick=null;this._rsActive=null;for(A in this._rsCells){this._rsCells[A]._cell=null;this._rsCells[A]._minutes=null;this._rsCells[A].parentNode.removeChild(this._rsCells[A]);this._rsCells[A]=null}this._rsCells=null;while(this.rsCont.childNodes.length>0)this.rsCont.removeChild(this.rsCont.lastChild);this.rsCont.parentNode.removeChild(this.rsCont);this.rsCont=null}if(this._selCover){this._selCover.parentNode.removeChild(this._selCover);this._selCover=null}if(this._sel){for(A in this._sel._ta)this._sel._ta[A]=null;this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;this._sel.onmouseout=null;while(this._sel.firstChild.firstChild.firstChild.childNodes.length>0){this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null;this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)}this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);while(this._sel.childNodes.length>0)this._sel.removeChild(this._sel.lastChild);this._sel.parentNode.removeChild(this._sel);this._sel=null}this.base.onclick=null;this.base.parentNode.removeChild(this.base);this.base=null;this._clearDayHover=null;this._clearSelHover=null;this._doOnSelectorChange=null;this._doOnSelectorShow=null;this._drawMonth=null;this._fixLength=null;this._getLeft=null;this._getTop=null;this._ifrSize=null;this._hide=null;this._hideSelector=null;this._initSelector=null;this._isSelectorVisible=null;this._isVisible=null;this._posGetOffset=null;this._posGetOffsetRect=null;this._posGetOffsetSum=null;this._scrollYears=null;this._show=null;this._showSelector=null;this._strToDate=null;this._updateActiveHours=null;this._updateActiveMinutes=null;this._updateActiveMonth=null;this._updateActiveYear=null;this._updateCellStyle=null;this._updateDateStr=null;this._updateVisibleHours=null;this._updateVisibleMinutes=null;this._updateYearsList=null;this.enableIframe=null;this.hide=null;this.hideTime=null;this.setDate=null;this.setDateFormat=null;this.setYearsRange=null;this.show=null;this.showTime=null;this.unload=null;for(A in this)delete this[A];A=C=null};this.setDate(this._activeDate);return this}dhtmlXCalendarObject.prototype.setYearsRange=function(){};dhtmlXCalendarObject.prototype.lang="en";dhtmlXCalendarObject.prototype.langData={"en":{dateformat:"%Y-%m-%d",monthesFNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthesSNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysSNames:["Su","Mo","Tu","We","Th","Fr","Sa"],weekstart:1}};dhtmlXCalendarObject.prototype.enableIframe=function(A){if(A==true){if(!this._ifr){this._ifr=document.createElement("IFRAME");this._ifr.frameBorder=0;this._ifr.border=0;this._ifr.setAttribute("src","javascript:false;");this._ifr.className="dhtmlxcalendar_ifr";this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")};this.base.parentNode.insertBefore(this._ifr,this.base);this._ifrSize()}}else if(this._ifr){this._ifr.parentNode.removeChild(this._ifr);this._ifr=null}};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr){this._ifr.style.left=this.base.style.left;this._ifr.style.top=this.base.style.top;this._ifr.style.width=this.base.offsetWidth+"px";this._ifr.style.height=this.base.offsetHeight+"px"}};dhtmlxCalendarObject=dhtmlXCalendarObject;function dhtmlXComboFromSelect(D,J){if(typeof(D)=="string")D=document.getElementById(D);J=J||D.getAttribute("width")||(window.getComputedStyle?window.getComputedStyle(D,null)["width"]:(D.currentStyle?D.currentStyle["width"]:0));if((!J)||(J=="auto"))J=D.offsetWidth||100;var G=document.createElement("SPAN");D.parentNode.insertBefore(G,D);D.style.display="none";var C=D.getAttribute("opt_type"),B=new dhtmlXCombo(G,D.name,J,C,D.tabIndex),I=new Array(),F=-1;for(var H=0;H<D.options.length;H++){if(D.options[H].selected)F=H;var E=D.options[H].innerHTML,A=D.options[H].getAttribute("value");if((typeof(A)=="undefined")||(A===null))A=E;I[H]={value:A,text:E,img_src:D.options[H].getAttribute("img_src")}}if(I.length)B.addOption(I);D.parentNode.removeChild(D);if(F>=0)B.selectOption(F,null,true);if(D.onchange)B.attachEvent("onChange",D.onchange);if(D.style.direction=="rtl"&&B.setRTL)B.setRTL(true);return B}var dhtmlXCombo_optionTypes=[];function dhtmlXCombo(D,C,B,E,A){if(typeof(D)=="string")D=document.getElementById(D);this.dhx_Event();this.optionType=(E!=window.undefined&&dhtmlXCombo_optionTypes[E])?E:"default";this._optionObject=dhtmlXCombo_optionTypes[this.optionType];this._disabled=false;this.readonlyDelay=750;this.filterEntities=["[","]","{","}","(",")","+","*","\\","?",".","$","^"];if(!window.dhx_glbSelectAr){window.dhx_glbSelectAr=new Array();window.dhx_openedSelect=null;window.dhx_SelectId=1;dhtmlxEvent(document.body,"click",this.closeAll);dhtmlxEvent(document.body,"keydown",function(A){try{if((A||event).keyCode==9)window.dhx_glbSelectAr[0].closeAll()}catch(A){}return true})}if(D.tagName=="SELECT")return dhtmlXComboFromSelect(D);else this._createSelf(D,C,B,A);dhx_glbSelectAr.push(this)}dhtmlXCombo.prototype.setSize=function(A){this.DOMlist.style.width=A+"px";if(this.DOMlistF)this.DOMlistF.style.width=A+"px";this.DOMelem.style.width=A+"px";this.DOMelem_input.style.width=Math.max(0,(A-19))+"px"};dhtmlXCombo.prototype.enableFilteringMode=function(D,C,B,A){if(D=="between"){this._filter=true;this._anyPosition=true;this._autoDisabled=true}else this._filter=convertStringToBoolean(D);if(C){this._xml=C;this._autoxml=convertStringToBoolean(A)}if(convertStringToBoolean(B))this._xmlCache=[]};dhtmlXCombo.prototype.setFilteringParam=function(A,B){if(!this._prs)this._prs=[];this._prs.push([A,B])};dhtmlXCombo.prototype.disable=function(B){var A=convertStringToBoolean(B);if(this._disabled==A)return;this.DOMelem_input.disabled=A;this._disabled=A};dhtmlXCombo.prototype.readonly=function(C,B){this.DOMelem_input.readOnly=C?true:false;if(B===false||C===false)this.DOMelem.onkeyup=function(A){};else{var A=this;this.DOMelem.onkeyup=function(C){C=C||window.event;if(A._searchTimeout)window.clearTimeout(A._searchTimeout);if(C.keyCode!=9)C.cancelBubble=true;if((C.keyCode>=48&&C.keyCode<=57)||(C.keyCode>=65&&C.keyCode<=90)){if(!A._searchText)A._searchText="";A._searchText+=String.fromCharCode(C.keyCode);for(var D=0;D<A.optionsArr.length;D++){var B=A.optionsArr[D].text;if(B.toString().toUpperCase().indexOf(A._searchText)==0){A.selectOption(D);break}}A._searchTimeout=window.setTimeout(function(){A._searchText=""},A.readonlyDelay);C.cancelBubble=true}}}};dhtmlXCombo.prototype.getOption=function(A){for(var B=0;B<this.optionsArr.length;B++)if(this.optionsArr[B].value==A)return this.optionsArr[B];return null};dhtmlXCombo.prototype.getOptionByLabel=function(A){for(var B=0;B<this.optionsArr.length;B++)if(this.optionsArr[B].text==A||this.optionsArr[B]._ctext==A)return this.optionsArr[B];return null};dhtmlXCombo.prototype.getOptionByIndex=function(A){return this.optionsArr[A]};dhtmlXCombo.prototype.clearAll=function(A){if(A)this.setComboText("");this.optionsArr=new Array();this.redrawOptions();if(A){if(this._selOption)this._selOption.RedrawHeader(this,true);this._confirmSelection()}};dhtmlXCombo.prototype.deleteOption=function(B){var A=this.getIndexByValue(B);if(A<0)return;if(this.optionsArr[A]==this._selOption)this._selOption=null;this.optionsArr.splice(A,1);this.redrawOptions()};dhtmlXCombo.prototype.render=function(A){this._skiprender=(!convertStringToBoolean(A));this.redrawOptions()};dhtmlXCombo.prototype.updateOption=function(D,B,E,C){var A=this.getOption(D);if(typeof(B)!="object")B={text:E,value:B,css:C};A.setValue(B);this.redrawOptions()};dhtmlXCombo.prototype.addOption=function(C){if(!arguments[0].length||typeof(arguments[0])!="object")args=[arguments];else args=C;this.render(false);for(var B=0;B<args.length;B++){var A=args[B];if(A.length){A.value=A[0]||"";A.text=A[1]||"";A.css=A[2]||""}this._addOption(A)}this.render(true)};dhtmlXCombo.prototype._addOption=function(A){dOpt=new this._optionObject();this.optionsArr.push(dOpt);dOpt.setValue.apply(dOpt,[A]);this.redrawOptions()};dhtmlXCombo.prototype.getIndexByValue=function(A){for(var B=0;B<this.optionsArr.length;B++)if(this.optionsArr[B].value==A)return B;return-1};dhtmlXCombo.prototype.getSelectedValue=function(){return(this._selOption?this._selOption.value:null)};dhtmlXCombo.prototype.getComboText=function(){return this.DOMelem_input.value};dhtmlXCombo.prototype.setComboText=function(A){this.DOMelem_input.value=A};dhtmlXCombo.prototype.setComboValue=function(A){this.setComboText(A);for(var B=0;B<this.optionsArr.length;B++)if(this.optionsArr[B].data()[0]==A)return this.selectOption(B,null,true);this.DOMelem_hidden_input.value=A};dhtmlXCombo.prototype.getActualValue=function(){return this.DOMelem_hidden_input.value};dhtmlXCombo.prototype.getSelectedText=function(){return(this._selOption?this._selOption.text:"")};dhtmlXCombo.prototype.getSelectedIndex=function(){for(var A=0;A<this.optionsArr.length;A++)if(this.optionsArr[A]==this._selOption)return A;return-1};dhtmlXCombo.prototype.setName=function(A){this.DOMelem_hidden_input.name=A;this.DOMelem_hidden_input2=A.replace(/(\]?)$/,"_new_value$1");this.name=A};dhtmlXCombo.prototype.show=function(A){if(convertStringToBoolean(A))this.DOMelem.style.display="";else this.DOMelem.style.display="none"};dhtmlXCombo.prototype.destructor=function(){this.DOMParent.removeChild(this.DOMelem);this.DOMlist.parentNode.removeChild(this.DOMlist);if(this.DOMlistF)this.DOMlistF.parentNode.removeChild(this.DOMlistF);var A=dhx_glbSelectAr;this.DOMParent=this.DOMlist=this.DOMlistF=this.DOMelem=0;this.DOMlist.combo=this.DOMelem.combo=0;for(var B=0;B<A.length;B++)if(A[B]==this){A[B]=null;A.splice(B,1);return}};dhtmlXCombo.prototype._createSelf=function(C,B,A,D){if(A.toString().indexOf("%")!=-1){var E=this,F=parseInt(A)/100;window.setInterval(function(){if(!C.parentNode)return;var A=C.parentNode.offsetWidth*F-2;if(A<0)return;if(A==E._lastTs)return;E.setSize(E._lastTs=A)},500);var A=parseInt(C.offsetWidth)}A=parseInt(A||100);this.ListPosition="Bottom";this.DOMParent=C;this._inID=null;this.name=B;this._selOption=null;this.optionsArr=Array();var G=new this._optionObject();G.DrawHeader(this,B,A,D);this.DOMlist=document.createElement("DIV");this.DOMlist.className="dhx_combo_list "+(dhtmlx.skin?dhtmlx.skin+"_list":"");this.DOMlist.style.width=A-(_isIE?0:0)+"px";if(_isOpera||_isKHTML)this.DOMlist.style.overflow="auto";this.DOMlist.style.display="none";document.body.insertBefore(this.DOMlist,document.body.firstChild);if(_isIE){this.DOMlistF=document.createElement("IFRAME");this.DOMlistF.style.border="0px";this.DOMlistF.className="dhx_combo_list";this.DOMlistF.style.width=A-(_isIE?0:0)+"px";this.DOMlistF.style.display="none";this.DOMlistF.src="javascript:false;";document.body.insertBefore(this.DOMlistF,document.body.firstChild)}this.DOMlist.combo=this.DOMelem.combo=this;this.DOMelem_input.onkeydown=this._onKey;this.DOMelem_input.onkeypress=this._onKeyF;this.DOMelem_input.onblur=this._onBlur;this.DOMelem.onclick=this._toggleSelect;this.DOMlist.onclick=this._selectOption;this.DOMlist.onmousedown=function(){this._skipBlur=true};this.DOMlist.onkeydown=function(A){(A||event).cancelBubble=true;this.combo.DOMelem_input.onkeydown(A)};this.DOMlist.onmouseover=this._listOver};dhtmlXCombo.prototype._listOver=function(C){C=C||event;C.cancelBubble=true;var B=(_isIE?event.srcElement:C.target),A=this.combo;if(B.parentNode==A.DOMlist){if(A._selOption)A._selOption.deselect();if(A._tempSel)A._tempSel.deselect();var E=0;for(E;E<A.DOMlist.childNodes.length;E++)if(A.DOMlist.childNodes[E]==B)break;var D=A.optionsArr[E];A._tempSel=D;A._tempSel.select();if((A._autoxml)&&((E+1)==A._lastLength))A._fetchOptions(E+1,A._lasttext||"")}};dhtmlXCombo.prototype._positList=function(){var A=this.getPosition(this.DOMelem);if(this.ListPosition=="Bottom"){this.DOMlist.style.top=A[1]+this.DOMelem.offsetHeight-1+"px";this.DOMlist.style.left=A[0]+"px"}else if(this.ListPosition=="Top"){this.DOMlist.style.top=A[1]-this.DOMlist.offsetHeight+"px";this.DOMlist.style.left=A[0]+"px"}else{this.DOMlist.style.top=A[1]+"px";this.DOMlist.style.left=A[0]+this.DOMelem.offsetWidth+"px"}};dhtmlXCombo.prototype.getPosition=function(D,E){if(_isIE&&_isIE<8){if(!E)E=document.body;var B=D,C=0,A=0;while((B)&&(B!=E)){C+=B.offsetLeft-B.scrollLeft+B.clientLeft;A+=B.offsetTop-B.scrollTop+B.clientTop;B=B.offsetParent}if(document.documentElement.scrollTop)A+=document.documentElement.scrollTop;if(document.documentElement.scrollLeft)C+=document.documentElement.scrollLeft;return new Array(C,A)}var F=getOffset(D);return[F.left,F.top]};dhtmlXCombo.prototype._correctSelection=function(){if(this.getComboText()!="")for(var A=0;A<this.optionsArr.length;A++)if(!this.optionsArr[A].isHidden())return this.selectOption(A,true,false);this.unSelectOption()};dhtmlXCombo.prototype.selectNext=function(B){var A=this.getSelectedIndex()+B;while(this.optionsArr[A]){if(!this.optionsArr[A].isHidden())return this.selectOption(A,false,false);A+=B}};dhtmlXCombo.prototype._onKeyF=function(C){var A=this.parentNode.combo,B=C||event;B.cancelBubble=true;if(B.keyCode=="13"||B.keyCode=="9"){A._confirmSelection();A.closeAll()}else if(B.keyCode=="27"){A._resetSelection();A.closeAll()}else A._activeMode=true;if(B.keyCode=="13"||B.keyCode=="27"){A.callEvent("onKeyPressed",[B.keyCode]);return false}return true};dhtmlXCombo.prototype._onKey=function(C){var A=this.parentNode.combo;(C||event).cancelBubble=true;var B=(C||event).keyCode;if(B>15&&B<19)return true;if(B==27)return true;if((A.DOMlist.style.display!="block")&&(B!="13")&&(B!="9")&&((!A._filter)||(A._filterAny)))A.DOMelem.onclick(C||event);if((B!="13")&&(B!="9")){window.setTimeout(function(){A._onKeyB(B)},1);if(B=="40"||B=="38")return false}else if(B==9){A._confirmSelection();A.closeAll();(C||event).cancelBubble=false}};dhtmlXCombo.prototype._onKeyB=function(A){if(A=="40")var B=this.selectNext(1);else if(A=="38")this.selectNext(-1);else{this.callEvent("onKeyPressed",[A]);if(this._filter)return this.filterSelf((A==8)||(A==46));for(var C=0;C<this.optionsArr.length;C++)if(this.optionsArr[C].data()[1]==this.DOMelem_input.value){this.selectOption(C,false,false);return false}this.unSelectOption()}return true};dhtmlXCombo.prototype._onBlur=function(){var A=this.parentNode._self;window.setTimeout(function(){if(A.DOMlist._skipBlur)return!(A.DOMlist._skipBlur=false);A._skipFocus=true;A._confirmSelection();A.callEvent("onBlur",[])},100)};dhtmlXCombo.prototype.redrawOptions=function(){if(this._skiprender)return;for(var A=this.DOMlist.childNodes.length-1;A>=0;A--)this.DOMlist.removeChild(this.DOMlist.childNodes[A]);for(A=0;A<this.optionsArr.length;A++)this.DOMlist.appendChild(this.optionsArr[A].render())};dhtmlXCombo.prototype.loadXML=function(C,A){this._load=true;this.callEvent("onXLS",[]);if(this._prs)for(var D=0;D<this._prs.length;D++)C+=[getUrlSymbol(C),escape(this._prs[D][0]),"=",escape(this._prs[D][1])].join("");if((this._xmlCache)&&(this._xmlCache[C])){this._fillFromXML(this,null,null,null,this._xmlCache[C]);if(A)A()}else{var B=(new dtmlXMLLoaderObject(this._fillFromXML,this,true,true));if(A)B.waitCall=A;B._cPath=C;B.loadXML(C)}};dhtmlXCombo.prototype.loadXMLString=function(B){var A=(new dtmlXMLLoaderObject(this._fillFromXML,this,true,true));A.loadXMLString(B)};dhtmlXCombo.prototype._fillFromXML=function(L,B,C,A,F){if(L._xmlCache)L._xmlCache[F._cPath]=F;var E=F.getXMLTopNode("complete");if(E.tagName!="complete"){L._load=false;return}var M=F.doXPath("//complete"),N=F.doXPath("//option"),H=false;L.render(false);if((!M[0])||(!M[0].getAttribute("add"))){L.clearAll();L._lastLength=N.length;if(L._xml)if((!N)||(!N.length))L.closeAll();else if(L._activeMode){L._positList();L.DOMlist.style.display="block";if(_isIE)L._IEFix(true)}}else{L._lastLength+=N.length||Infinity;H=true}for(var J=0;J<N.length;J++){var G=new Object();G.text=N[J].firstChild?N[J].firstChild.nodeValue:"";for(var I=0;I<N[J].attributes.length;I++){var D=N[J].attributes[I];if(D)G[D.nodeName]=D.nodeValue}L._addOption(G)}L.render(H!=true||(!!N.length));if((L._load)&&(L._load!==true))L.loadXML(L._load);else{L._load=false;if((!L._lkmode)&&(L._filter)&&!L._autoDisabled)L._correctSelection()}var K=F.doXPath("//option[@selected]");if(K.length)L.selectOption(L.getIndexByValue(K[0].getAttribute("value")),false,true);L.callEvent("onXLE",[])};dhtmlXCombo.prototype.unSelectOption=function(){if(this._selOption)this._selOption.deselect();if(this._tempSel)this._tempSel.deselect();this._tempSel=this._selOption=null};dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelection()};dhtmlXCombo.prototype._confirmSelection=function(D,B){var A=this.getComboText();this.setComboText("");this.setComboText(A);if(arguments.length==0){var E=this.getOptionByLabel(this.DOMelem_input.value);D=E?E.value:this.DOMelem_input.value;B=(E==null);if(D==this.getActualValue())return this._skipFocus=false}if(!this._skipFocus&&!this._disabled){try{this.DOMelem_input.focus()}catch(C){}}this._skipFocus=false;this.DOMelem_hidden_input.value=D;this.DOMelem_hidden_input2.value=(B?"true":"false");this.callEvent("onChange",[]);this._activeMode=false};dhtmlXCombo.prototype._resetSelection=function(B,A){var C=this.getOption(this.DOMelem_hidden_input.value);this.setComboValue(C?C.data()[0]:this.DOMelem_hidden_input.value);this.setComboText(C?C.data()[1]:this.DOMelem_hidden_input.value)};dhtmlXCombo.prototype.selectOption=function(B,G,E){if(arguments.length<3)E=true;this.unSelectOption();var F=this.optionsArr[B];if(!F)return;this._selOption=F;this._selOption.select();var D=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;if(D>0)this.DOMlist.scrollTop+=D;D=this.DOMlist.scrollTop-this._selOption.content.offsetTop;if(D>0)this.DOMlist.scrollTop-=D;var C=this._selOption.data();if(E){this.setComboText(C[1]);this._confirmSelection(C[0],false);if((this._autoxml)&&((B+1)==this._lastLength))this._fetchOptions(B+1,this._lasttext||"")}if(G){var A=this.getComboText();if(A!=C[1]){this.setComboText(C[1]);dhtmlXRange(this.DOMelem_input,A.length+1,C[1].length)}}else this.setComboText(C[1]);this._selOption.RedrawHeader(this);this.callEvent("onSelectionChange",[])};dhtmlXCombo.prototype._selectOption=function(C){(C||event).cancelBubble=true;var B=(_isIE?event.srcElement:C.target),A=this.combo;while(!B._self){B=B.parentNode;if(!B)return}var D=0;for(D;D<A.DOMlist.childNodes.length;D++)if(A.DOMlist.childNodes[D]==B)break;A.selectOption(D,false,true);A.closeAll();A.callEvent("onBlur",[]);A._activeMode=false};dhtmlXCombo.prototype.openSelect=function(){if(this._disabled)return;this.closeAll();this.DOMlist.style.display="block";this._positList();this.callEvent("onOpen",[]);if(this._tempSel)this._tempSel.deselect();if(this._selOption)this._selOption.select();if(this._selOption){var A=this._selOption.content.offsetTop+this._selOption.content.offsetHeight-this.DOMlist.scrollTop-this.DOMlist.offsetHeight;if(A>0)this.DOMlist.scrollTop+=A;A=this.DOMlist.scrollTop-this._selOption.content.offsetTop;if(A>0)this.DOMlist.scrollTop-=A}if(_isIE)this._IEFix(true);this.DOMelem_input.focus();if(this._filter)this.filterSelf()};dhtmlXCombo.prototype._toggleSelect=function(B){var A=this.combo;if(A.DOMlist.style.display=="block")A.closeAll();else A.openSelect();(B||event).cancelBubble=true};dhtmlXCombo.prototype._fetchOptions=function(B,A){if(A==""){this.closeAll();return this.clearAll()}var C=this._xml+((this._xml.indexOf("?")!=-1)?"&":"?")+"pos="+B+"&mask="+encodeURIComponent(A);this._lasttext=A;if(this._load)this._load=C;else{if(!this.callEvent("onDynXLS",[A,B]))return;this.loadXML(C)}};dhtmlXCombo.prototype.disableAutocomplete=function(){this._autoDisabled=true};dhtmlXCombo.prototype.filterSelf=function(G){var A=this.getComboText();if(this._xml){this._lkmode=G;this._fetchOptions(0,A)}var B=new RegExp("(["+this.filterEntities.join("\\")+"])","g");A=A.replace(B,"\\$1");var C=(this._anyPosition?"":"^")+A,E=new RegExp(C,"i");this.filterAny=false;for(var F=0;F<this.optionsArr.length;F++){var D=E.test(this.optionsArr[F].content?this.optionsArr[F].data()[1]:this.optionsArr[F].text);this.filterAny|=D;this.optionsArr[F].hide(!D)}if(!this.filterAny){this.closeAll();this._activeMode=true}else{if(this.DOMlist.style.display!="block")this.openSelect();if(_isIE)this._IEFix(true)}if(!G&&!this._autoDisabled)this._correctSelection();else this.unSelectOption()};dhtmlXCombo.prototype._IEFix=function(A){this.DOMlistF.style.display=(A?"block":"none");this.DOMlistF.style.top=this.DOMlist.style.top;this.DOMlistF.style.left=this.DOMlist.style.left;this.DOMlistF.style.width=this.DOMlist.offsetWidth+"px";this.DOMlistF.style.height=this.DOMlist.offsetHeight+"px"};dhtmlXCombo.prototype.closeAll=function(){if(window.dhx_glbSelectAr)for(var A=0;A<dhx_glbSelectAr.length;A++){if(dhx_glbSelectAr[A].DOMlist.style.display=="block"){dhx_glbSelectAr[A].DOMlist.style.display="none";if(_isIE)dhx_glbSelectAr[A]._IEFix(false)}dhx_glbSelectAr[A]._activeMode=false}};dhtmlXCombo.prototype.changeOptionId=function(B,A){(this.getOption(B)||{}).value=A};function dhtmlXRange(C,F,B){var A=typeof(C)=="object"?C:document.getElementById(C);try{A.focus()}catch(D){}var G=A.value.length;F--;if(F<0||F>B||F>G)F=0;if(B>G)B=G;if(F==B)return;if(A.setSelectionRange)A.setSelectionRange(F,B);else if(A.createTextRange){var E=A.createTextRange();E.moveStart("character",F);E.moveEnd("character",B-G);try{E.select()}catch(D){}}}dhtmlXCombo_defaultOption=function(){this.init()};dhtmlXCombo_defaultOption.prototype.init=function(){this.value=null;this.text="";this.selected=false;this.css=""};dhtmlXCombo_defaultOption.prototype.select=function(){if(this.content)this.content.className="dhx_selected_option"+(dhtmlx.skin?" combo_"+dhtmlx.skin+"_sel":"")};dhtmlXCombo_defaultOption.prototype.hide=function(A){this.render().style.display=A?"none":""};dhtmlXCombo_defaultOption.prototype.isHidden=function(){return(this.render().style.display=="none")};dhtmlXCombo_defaultOption.prototype.deselect=function(){if(this.content)this.render();this.content.className=""};dhtmlXCombo_defaultOption.prototype.setValue=function(A){this.value=A.value||"";this.text=A.text||"";this.css=A.css||"";this.content=null};dhtmlXCombo_defaultOption.prototype.render=function(){if(!this.content){this.content=document.createElement("DIV");this.content._self=this;this.content.style.cssText="width:100%;overflow:hidden;"+this.css;if(_isOpera||_isKHTML)this.content.style.padding="2px 0px 2px 0px";this.content.innerHTML=this.text;this._ctext=(typeof this.content.textContent!="undefined")?this.content.textContent:this.content.innerText}return this.content};dhtmlXCombo_defaultOption.prototype.data=function(){if(this.content)return[this.value,this._ctext?this._ctext:this.text]};dhtmlXCombo_defaultOption.prototype.DrawHeader=function(D,B,A,C){var E=document.createElement("DIV");E.style.width=A+"px";E.className="dhx_combo_box "+(dhtmlx.skin||"");E._self=D;D.DOMelem=E;this._DrawHeaderInput(D,B,A,C);this._DrawHeaderButton(D,B,A);D.DOMParent.appendChild(D.DOMelem)};dhtmlXCombo_defaultOption.prototype._DrawHeaderInput=function(D,B,A,C){var E=document.createElement("input");E.setAttribute("autocomplete","off");E.type="text";E.className="dhx_combo_input";if(C)E.tabIndex=C;E.style.width=A-19-(document.compatMode=="BackCompat"?0:3)+"px";D.DOMelem.appendChild(E);D.DOMelem_input=E;E=document.createElement("input");E.type="hidden";E.name=B;D.DOMelem.appendChild(E);D.DOMelem_hidden_input=E;E=document.createElement("input");E.type="hidden";E.name=(B||"").replace(/(\]?)$/,"_new_value$1");E.value="true";D.DOMelem.appendChild(E);D.DOMelem_hidden_input2=E};dhtmlXCombo_defaultOption.prototype._DrawHeaderButton=function(C,B,A){var D=document.createElement("img");D.className="dhx_combo_img";if(dhtmlx.image_path)dhx_globalImgPath=dhtmlx.image_path;D.src=(window.dhx_globalImgPath?dhx_globalImgPath:"")+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif";C.DOMelem.appendChild(D);C.DOMelem_button=D};dhtmlXCombo_defaultOption.prototype.RedrawHeader=function(A){};dhtmlXCombo_optionTypes["default"]=dhtmlXCombo_defaultOption;dhtmlXCombo.prototype.dhx_Event=function(){this.dhx_SeverCatcherPath="";this.attachEvent=function(B,A,C){C=C||this;B="ev_"+B;if((!this[B])||(!this[B].addEvent)){var D=new this.eventCatcher(C);D.addEvent(this[B]);this[B]=D}return(B+":"+this[B].addEvent(A))};this.callEvent=function(B,A){if(this["ev_"+B])return this["ev_"+B].apply(this,A);return true};this.checkEvent=function(A){if(this["ev_"+A])return true;return false};this.eventCatcher=function(obj){var dhx_catch=new Array(),m_obj=obj,func_server=function(B,A){B=B.split(":");var C="",E="",D=B[1];if(B[1]=="rpc"){C="<?xml version=\"1.0\"?><methodCall><methodName>"+B[2]+"</methodName><params>";E="</params></methodCall>";D=A}var F=function(){};return F},z=function(){if(dhx_catch)var A=true;for(var C=0;C<dhx_catch.length;C++)if(dhx_catch[C]!=null){var B=dhx_catch[C].apply(m_obj,arguments);A=A&&B}return A};z.addEvent=function(ev){if(typeof(ev)!="function")if(ev&&ev.indexOf&&ev.indexOf("server:")==0)ev=new func_server(ev,m_obj.rpcServer);else ev=eval(ev);if(ev)return dhx_catch.push(ev)-1;return false};z.removeEvent=function(A){dhx_catch[A]=null};return z};this.detachEvent=function(A){if(A!=false){var B=A.split(":");this[B[0]].removeEvent(B[1])}}};(function(){dhtmlx.extend_api("dhtmlXCombo",{_init:function(A){if(A.image_path)dhx_globalImgPath=A.image_path;return[A.parent,A.name,(A.width||"100%"),A.type,A.index]},filter:"filter_command",auto_height:"enableOptionAutoHeight",auto_position:"enableOptionAutoPositioning",auto_width:"enableOptionAutoWidth",xml:"loadXML",readonly:"readonly",items:"addOption"},{filter_command:function(A){if(typeof A=="string")this.enableFilteringMode(true,A);else this.enableFilteringMode(A)}})})();dhtmlXCombo_imageOption=function(){this.init()};dhtmlXCombo_imageOption.prototype=new dhtmlXCombo_defaultOption;dhtmlXCombo_imageOption.prototype.setValue=function(A){this.value=A.value||"";this.text=A.text||"";this.css=A.css||"";this.img_src=A.img_src||this.getDefImage()};dhtmlXCombo_imageOption.prototype.render=function(){if(!this.content){this.content=document.createElement("DIV");this.content._self=this;this.content.style.cssText="width:100%;overflow:hidden;"+this.css;var A="";if(this.img_src!="")A+="<img style=\"float:left;\" src=\""+this.img_src+"\" />";A+="<div style=\"float:left\">"+this.text+"</div>";this.content.innerHTML=A}return this.content};dhtmlXCombo_imageOption.prototype.data=function(){return[this.value,this.text,this.img_src]};dhtmlXCombo_imageOption.prototype.DrawHeader=function(C,B,A){var D=document.createElement("DIV");D.style.width=A+"px";D.className="dhx_combo_box";D._self=C;C.DOMelem=D;this._DrawHeaderImage(C,B,A);this._DrawHeaderInput(C,B,A-19);this._DrawHeaderButton(C,B,A);C.DOMParent.appendChild(C.DOMelem)};dhtmlXCombo_imageOption.prototype._DrawHeaderImage=function(C,B,A){var D=document.createElement("img");D.className="dhx_combo_option_img";D.style.visibility="hidden";C.DOMelem.appendChild(D);C.DOMelem_image=D};dhtmlXCombo_imageOption.prototype.RedrawHeader=function(B,A){B.DOMelem_image.style.visibility=A?"hidden":"visible";B.DOMelem_image.src=A?"":this.img_src};dhtmlXCombo_imageOption.prototype.getDefImage=function(A){return""};dhtmlXCombo.prototype.setDefaultImage=function(A){dhtmlXCombo_imageOption.prototype.getDefImage=function(){return A}};dhtmlXCombo_optionTypes["image"]=dhtmlXCombo_imageOption;dhtmlXCombo_checkboxOption=function(){this.init()};dhtmlXCombo_checkboxOption.prototype=new dhtmlXCombo_defaultOption;dhtmlXCombo_checkboxOption.prototype.setValue=function(A){this.value=A.value||"";this.text=A.text||"";this.css=A.css||"";this.checked=A.checked||0};dhtmlXCombo_checkboxOption.prototype.render=function(){if(!this.content){this.content=document.createElement("DIV");this.content._self=this;this.content.style.cssText="width:100%;overflow:hidden;"+this.css;var A="";if(this.checked)A+="<input style=\"float:left;\" type=\"checkbox\" checked />";else A+="<input style=\"float:left;\" type=\"checkbox\" />";A+="<div style=\"float:left\">"+this.text+"</div>";this.content.innerHTML=A;this.content.firstChild.onclick=function(A){this.parentNode.parentNode.combo.DOMelem_input.focus();(A||event).cancelBubble=true;if(!this.parentNode.parentNode.combo.callEvent("onCheck",[this.parentNode._self.value,this.checked])){this.checked=!this.checked;return false}}}return this.content};dhtmlXCombo_checkboxOption.prototype.data=function(){return[this.value,this.text,this.render().firstChild.checked]};dhtmlXCombo_checkboxOption.prototype.DrawHeader=function(C,B,A){C.DOMelem=document.createElement("DIV");C.DOMelem.style.width=A+"px";C.DOMelem.className="dhx_combo_box";C.DOMelem._self=C;this._DrawHeaderCheckbox(C,B,A);this._DrawHeaderInput(C,B,A-19);this._DrawHeaderButton(C,B,A);C.DOMParent.appendChild(C.DOMelem)};dhtmlXCombo_checkboxOption.prototype._DrawHeaderCheckbox=function(C,B,A){var D=document.createElement("input");D.type="checkbox";D.className="dhx_combo_option_img";D.style.visibility="hidden";D.onclick=function(B){var A=C.getIndexByValue(C.getActualValue());if(A!=-1){C.setChecked(A,D.checked);C.callEvent("onCheck",[C.getActualValue(),C.optionsArr[A].content.firstChild.checked])}(B||event).cancelBubble=true};C.DOMelem.appendChild(D);C.DOMelem_checkbox=D};dhtmlXCombo_checkboxOption.prototype.RedrawHeader=function(B,A){B.DOMelem_checkbox.style.visibility=A?"hidden":"";B.DOMelem_checkbox.checked=A?false:this.content.firstChild.checked};dhtmlXCombo_optionTypes["checkbox"]=dhtmlXCombo_checkboxOption;dhtmlXCombo.prototype.getChecked=function(){var A=[];for(var B=0;B<this.optionsArr.length;B++)if(this.optionsArr[B].data()[2])A.push(this.optionsArr[B].value);return A};dhtmlXCombo.prototype.setChecked=function(A,B){this.optionsArr[A].content.firstChild.checked=(!(B===false));if(this._selOption==this.optionsArr[A])this._selOption.RedrawHeader(this)};dhtmlXCombo.prototype.setCheckedByValue=function(A,B){return this.setChecked(this.getIndexByValue(A),B)};dhtmlXCombo.prototype.enableOptionAutoPositioning=function(A){if(!this.ListAutoPosit)this.ListAutoPosit=1;this.attachEvent("onOpen",function(){this._setOptionAutoPositioning(A)});this.attachEvent("onXLE",function(){this._setOptionAutoPositioning(A)})};dhtmlXCombo.prototype._setOptionAutoPositioning=function(B){if((typeof(B)!="undefined")&&(!convertStringToBoolean(B))){this.ListPosition="Bottom";this.ListAutoPosit=0;return true}var D=this.getPosition(this.DOMelem),C=this._getClientHeight()-D[1]-this.DOMelem.offsetHeight,A=(this.autoHeight)?(this.DOMlist.scrollHeight):parseInt(this.DOMlist.offsetHeight);if((C<A)&&(D[1]>A))this.ListPosition="Top";else this.ListPosition="Bottom";this._positList();if(_isIE)this._IEFix(true)};dhtmlXCombo.prototype._getClientHeight=function(){return((document.compatMode=="CSS1Compat")&&(!window.opera))?document.documentElement.clientHeight:document.body.clientHeight};dhtmlXCombo.prototype.setOptionWidth=function(A){if(arguments.length>0){this.DOMlist.style.width=A+"px";if(this.DOMlistF)this.DOMlistF.style.width=A+"px"}};dhtmlXCombo.prototype.setOptionHeight=function(A){if(arguments.length>0){if(_isIE)this.DOMlist.style.height=this.DOMlistF.style.height=A+"px";else this.DOMlist.style.height=A+"px";if(this.DOMlistF)this.DOMlistF.style.height=this.DOMlist.style.height;this._positList()}};dhtmlXCombo.prototype.enableOptionAutoWidth=function(A){if(!this._listWidthConf)this._listWidthConf=this.DOMlist.offsetWidth;if(arguments.length==0)var A=1;if(convertStringToBoolean(A)){this.autoOptionWidth=1;this.awOnOpen=this.attachEvent("onOpen",function(){this._setOptionAutoWidth()});this.awOnXLE=this.attachEvent("onXLE",function(){this._setOptionAutoWidth()})}else if(typeof(this.awOnOpen)!="undefined"){this.autoOptionWidth=0;this.detachEvent(this.awOnOpen);this.detachEvent(this.awOnXLE);this.setOptionWidth(this._listWidthConf)}};dhtmlXCombo.prototype._setOptionAutoWidth=function(){var D=!this.ahOnOpen&&this.DOMlist.scrollHeight>this.DOMlist.offsetHeight;this.setOptionWidth(1);var C=this.DOMlist.offsetWidth;for(var B=0;B<this.optionsArr.length;B++){var A=(_isFF)?(this.DOMlist.childNodes[B].scrollWidth-2):this.DOMlist.childNodes[B].scrollWidth;if(A>C)C=this.DOMlist.childNodes[B].scrollWidth}C+=D?18:0;this.setOptionWidth((this.DOMelem.offsetWidth>C)?this.DOMelem.offsetWidth:C+2)};dhtmlXCombo.prototype.enableOptionAutoHeight=function(C,D){if(!this._listHeightConf)this._listHeightConf=(this.DOMlist.style.height=="")?100:parseInt(this.DOMlist.style.height);if(arguments.length==0)var C=1;this.autoHeight=convertStringToBoolean(C);var E=this;if(this.autoHeight){var A=function(){window.setTimeout(function(){E._setOptionAutoHeight(C,D)},1)};this.ahOnOpen=this.attachEvent("onOpen",A);if(!this.awOnOpen)this.ahOnXLE=this.attachEvent("onXLE",A);var B;this.ahOnKey=this.attachEvent("onKeyPressed",function(){if(!this._filter)return;if(B)window.clearTimeout(B);window.setTimeout(function(){if(E.DOMlist.style.display=="block")E._setOptionAutoHeight(C,D)},50)})}else if(typeof(this.ahOnOpen)!="undefined"){this.detachEvent(this.ahOnOpen);if(this.ahOnXLE)this.detachEvent(this.ahOnXLE);if(this.ahOnKey)this.detachEvent(this.ahOnKey);this.setOptionHeight(this._listHeightConf)}};dhtmlXCombo.prototype._setOptionAutoHeight=function(B,C){if(convertStringToBoolean(B)){this.setOptionHeight(1);var A=0;if(this.optionsArr.length>0){if(this.DOMlist.scrollHeight>this.DOMlist.offsetHeight)A=this.DOMlist.scrollHeight+2;else A=this.DOMlist.offsetHeight;if((arguments.length>1)&&(C)){var C=parseInt(C);A=(A>C)?C:A}this.setOptionHeight(A)}else this.DOMlist.style.display="none"}};dhtmlXCombo.prototype.attachChildCombo=function(B,D){if(!this._child_combos)this._child_combos=[];this._has_childen=1;this._child_combos[this._child_combos.length]=B;B.show(0);var A=this,C=arguments.length;this.attachEvent("onChange",function(){for(var E=0;E<A._child_combos.length;E++)if(A._child_combos[E]==B){B.show(1);B.callEvent("onMasterChange",[A.getActualValue(),A])}if(A.getActualValue()==""){A.showSubCombo(A,0);return}if(B._xml){if(C==1)D=B._xml;B._xml=A.deleteParentVariable(D);B._xml+=((B._xml.indexOf("?")!=-1)?"&":"?")+"parent="+encodeURIComponent(A.getActualValue())}else if(D){B.clearAll(true);B.loadXML(D+((D.indexOf("?")!=-1)?"&":"?")+"parent="+encodeURIComponent(A.getActualValue()))}})};dhtmlXCombo.prototype.setAutoSubCombo=function(B,A){if(arguments.length==1)A="subcombo";if(!this._parentCombo){var C=new dhtmlXCombo(this.DOMParent,A,this.DOMelem.style.width);C._parentCombo=this}else{C=new dhtmlXCombo(this._parentCombo.DOMParent,A,this._parentCombo.DOMelem.style.width);C._parentCombo=this._parentCombo}if(this._filter)C._filter=1;if(this._xml){if(arguments.length>0)C._xml=B;else C._xml=this._xml;B=C._xml;C._autoxml=this._autoxml;if(this._xmlCache)C._xmlCache=[]}this.attachChildCombo(C,B);return C};dhtmlXCombo.prototype.detachChildCombo=function(A){for(var B=0;B<this._child_combos.length;B++){this._child_combos[B]==A;this._child_combos.splice(B,1)}A.show(1)};dhtmlXCombo.prototype.showSubCombo=function(B,A){if(B._child_combos)for(var C=0;C<B._child_combos.length;C++){B._child_combos[C].show(A);B.showSubCombo(B._child_combos[C],0)}};dhtmlXCombo.prototype.deleteParentVariable=function(A){A=A.replace(/parent\=[^&]*/g,"").replace(/\?\&/,"?");return A};function dhtmlXTabBar(B,C,A){C=C||"top";dhtmlxEventable(this);this._hrefs={};this._s={};this._c={};this._s.mode=C;this._s.scrolls=true;this._custom_height=A;this._s.line_height=(parseInt(A)||20)+3;this._s.skin_line=1;this._s.tab_margin=0;this._s.expand=0;this._s.ext_border=2;this._s._bMode=(C=="right"||C=="bottom")?1:0;this._s._vMode=(C=="right"||C=="left")?1:0;this._dx=this._s._vMode?"height":"width";this._dy=this._s._vMode?"width":"height";switch(C){case"top":this._py="top";this._px="left";this._pxc="right";break;case"bottom":this._py="bottom";this._px="left";this._pxc="right";break;case"right":this._py="right";this._px="top";this._pxc="bottom";break;case"left":this._py="left";this._px="top";this._pxc="bottom";break}this._active=null;this._tabs={};this._content={};this._href={};this._rows=[];this._s._tabSize=150;this._styles={"default":{left:3,right:3,select_shift:3,select_top:2,margin:1,offset:5,tab_color:"#F4F3EE",data_color:"#F0F8FF"},"winbiscarf":{left:18,right:18,select_shift:3,select_top:2,margin:1,offset:5},"winscarf":{left:18,right:4,select_shift:3,select_top:2,margin:5,offset:5},"modern":{left:5,right:5,select_shift:3,select_top:2,margin:1,offset:5,tab_color:"#F4F3EE",data_color:"#F0F8FF"},"silver":{left:7,right:7,select_shift:3,select_top:2,margin:1,offset:5,tab_color:"#F4F3EE",data_color:"#F0F8FF"},"dark_blue":{left:2,right:2,select_shift:3,select_top:2,margin:1,offset:5},"glassy_blue":{left:2,right:3,select_shift:3,select_top:2,margin:1,offset:5},"dhx_terrace":{left:7,right:7,select_shift:0,select_top:0,margin:-1,offset:0,tab_color:"",data_color:"#ffffff"},"dhx_black":{left:2,right:2,select_shift:3,select_top:0,margin:1,offset:5},"dhx_blue":{left:2,right:2,select_shift:3,select_top:0,margin:1,offset:5,tab_color:"#F4F3EE",data_color:"#F0F8FF"},"dhx_skyblue":{left:3,right:3,select_shift:0,select_top:0,margin:-1,offset:5,data_color:"white",hover:true},"dhx_web":{left:3,right:3,select_shift:1,select_top:0,margin:5,offset:15,data_color:"white"}};if(typeof(B)!="object")B=document.getElementById(B);this.entBox=B;this.entBox.className+=" dhx_tabbar_zone_"+this._s.mode;if(dhtmlx.image_path)this.setImagePath(dhtmlx.image_path);this.setStyle("default");this.__skin=false;this._createSelf();if(_isIE)this.preventIECashing(true);return this}dhtmlXTabBar.prototype={_get_size:function(A,B){var C=this.entBox.getAttribute(A)||this.entBox.style[A]||(window.getComputedStyle?window.getComputedStyle(this.entBox,null)[A]:(this.entBox.currentStyle?this.entBox.currentStyle[A]:0));if((C||"").indexOf("%")!=-1)this.enableAutoReSize(true,true);if(!C||C.indexOf("%")!=-1||C=="auto")C=B+"px";return C},setStyle:function(A){this.setSkin(A)},_getSkin:function(A){return this._a},setSkin:function(L){L=L.toLowerCase();if(!this._styles[L])L="default";this._a=this._styles[L];this.skin=L;if(this._tabAll)this._tabAll.className="dhx_tabbar_zone dhx_tabbar_zone_"+this.skin;var D=L.indexOf("dhx_sky")==0,E=L.indexOf("dhx_web")==0,K=L.indexOf("dhx_terrace")==0;if(K&&!this._custom_height){this._s.line_height=37;this._setRowSizes()}if(D)this._s.skin_line=0;if(E){this._s.line_height=29;this._s.ext_border=-1;this._s.expand=true}if(D){this._s.line_height=26;this._setRowSizes();if(this._s.expand)this._s.tab_margin=-1;this._s.skin_line_x=true;this._s.skin_line=-3;var J=this._s._rendered;if(J)for(var F=0;F<J.length;F++)J[F].parentNode.removeChild(J[F]);var G=document.createElement("DIV");G.className="dhx_tabbar_lineA";this._tabAll.appendChild(G);var H=document.createElement("DIV");H.className="dhx_tabbar_lineB";this._tabAll.appendChild(H);var I=document.createElement("DIV");I.className="dhx_tabbar_lineC";this._tabAll.appendChild(I);var C=document.createElement("DIV");C.className="dhx_tabbar_lineD";this._tabAll.appendChild(C);this._getCoverLine();this._s._rendered=[G,H,I,C];if(this._s.expand){this._conZone.style.borderWidth="0px 0px 0px 0px";this._tabZone.firstChild.style.borderWidth="0px 0px 0px 0px";I.style.borderWidth="0px 0px 0px 0px";C.style.left="0px";I.style.right="0px";G.style.borderWidth="0px 0px 0px 0px";if(this._s.mode=="top")this._lineA.style.borderWidth="1px 0px 0px 0px";H.style.left="1px";this._s.ext_border=0}var A=function(){this._lineA.style[this._dx]="1px";var B=(_isIE&&document.compatMode=="BackCompat"),A=this._tabAll[this._s._vMode?"offsetHeight":"offsetWidth"]+(B?2:0);if(this._lastActive)A=Math.max(A,this._lastActive.parentNode[this._s._vMode?"scrollHeight":"scrollWidth"]);if(A<6)return;G.style[this._py]=parseInt(this._conZone.style[this._py])-3+"px";G.style[this._dx]=A-2+"px";H.style[this._py]=parseInt(this._conZone.style[this._py])-3+"px";H.style[this._dx]=A-(B?6:4)+(this._s.expand?2:0)+"px";I.style[this._dy]=parseInt(this._tabZone.style[this._dy])-3+"px";this._lineA.style[this._dx]=A-2+"px"};A.call(this);var M=this._checkScroll;this._checkScroll=function(){A.apply(this,arguments);M.apply(this,arguments)};var B=this._scrollTo;this._scrollTo=function(){B.apply(this,arguments);A.apply(this,arguments)}}if(this._a.data_color&&this._conZone)this._conZone.style.backgroundColor=this._a.data_color;this.__skin=true},enableAutoReSize:function(){var A=this;dhtmlxEvent(window,"resize",function(){window.setTimeout(function(){if(A&&A._setSizes)A._setSizes()},1)})},_createSelf:function(){this._tabAll=document.createElement("DIV");this._tabZone=document.createElement("DIV");this._conZone=document.createElement("DIV");this.entBox.appendChild(this._tabAll);this._tabAll.appendChild(this._tabZone);this._tabAll.appendChild(this._conZone);this._tabAll.className="dhx_tabbar_zone dhx_tabbar_zone_"+this.skin;if(this._s._vMode)this._tabAll.className+="V";if(this._s._bMode)this._tabAll.className+="B";this._tabZone.className="dhx_tablist_zone";this._conZone.className="dhx_tabcontent_zone";if(this.entBox._hideBorders)this._conZone.style.borderLeft=this._conZone.style.borderRight=this._conZone.style.borderBottom="0px solid white";if(this._a.data_color)this._conZone.style.backgroundColor=this._a.data_color;this._tabZone.onselectstart=function(){return false};this._tabZone.onclick=this._onClickHandler;this._tabZone.onmouseover=this._onMouseOverHandler;this._tabZone[_isFF?"onmouseout":"onmouseleave"]=this._onMouseOutHandler;this._tabZone.tabbar=this;this._createRow()},_createRow:function(){var A=document.createElement("DIV");A.className="dhx_tabbar_row";A.tabCount=0;this._tabZone.appendChild(A);this._rows[this._rows.length]=A;this._setRowSizes()},_removeRow:function(B){B.parentNode.removeChild(B);var A=[];for(var C=0;C<this._rows.length;C++)if(this._rows[C]!=B)A[A.length]=this._rows[C];this._rows=A},_setSizes:function(I,H){var D=["clientHeight","clientWidth"];if(this._dx!="width")D.reverse();var F=(_isIE&&document.compatMode=="BackCompat"),E=(this._conZone.offsetWidth-this._conZone.clientWidth),C=H||(this.entBox[D[0]]+(F?E:0)),B=I||(this.entBox[D[1]]+(F?E:0)),G=this._rows.length*(this._s.line_height-(this._s.skin_line_x?4:2))+(this._s.skin_line_x?2:0);this._tabZone.style[this._dy]=G+"px";this._conZone.style[this._dy]=Math.max(0,C-this._s.ext_border-G-(this._s.skin_line_x?3:0)-this._s.tab_margin)+"px";this._conZone.style[this._dx]=Math.max(0,B-(this._s.expand?0:2))+"px";this._tabZone.style[this._py]=this._s.tab_margin+"px";this._conZone.style[this._py]=G+this._s.tab_margin-this._s.skin_line+"px";this._checkScroll();var A=this.getActiveTab();if(A)this.cells(A).activate()},_checkScroll:function(){if(this._lineA){this._lineA.style[this._dx]="1px";var B=(_isIE&&document.compatMode=="BackCompat"),A=this._tabAll[this._s._vMode?"offsetHeight":"offsetWidth"]+(B?2:0);if(this._lastActive)A=Math.max(A,this._lastActive.parentNode[this._s._vMode?"scrollHeight":"scrollWidth"]);if(A>2)this._lineA.style[this._dx]=A-2+"px"}if(this._s._vMode||!this._s.scrolls)return;for(var C=0;C<this._rows.length;C++)if((this._rows[C].scrollWidth-this._rows[C].offsetWidth)>2)this._showScroll(C);else this._hideScroll(C)},_showScroll:function(C){if(this._rows[C]._scroll)return;this.callEvent("onBeforeShowScroll",[C]);var A=this._rows[C]._scroll=[],B=Math.max(0,this._s.line_height-23);A[0]=document.createElement("DIV");A[0].style.cssText="background-image:url("+this.imgUrl+this.skin+"/"+this.skin+"_scroll_left.gif);width:20px;height:21px;position:absolute;left:0px;z-index:990;top:"+B+"px;";A[0].className="dhx_tab_scroll_left";this._rows[C].appendChild(A[0]);A[1]=document.createElement("DIV");A[1].style.cssText="background-image:url("+this.imgUrl+this.skin+"/"+this.skin+"_scroll_right.gif);width:20px;height:21px;position:absolute;right:0px;z-index:990;top:"+B+"px;";A[1].className="dhx_tab_scroll_right";this._rows[C].appendChild(A[1])},_hideScroll:function(A){if(this._rows[A]._scroll)this.callEvent("onBeforeHideScroll",[A]);if(!this._rows[A]._scroll)return;this._rows[A].removeChild(this._rows[A]._scroll[0]);this._rows[A].removeChild(this._rows[A]._scroll[1]);this._rows[A]._scroll=null},_setRowSizes:function(){for(var A=0;A<this._rows.length;A++){this._rows[A].style[this._dy]=this._s.line_height+"px";this._rows[A].style[this._py]=A*(this._s.line_height-(this._s.skin_line_x?4:2))-((_isIE&&!window.postMessage&&this._s._bMode)?0:0)+"px";this._rows[A].style.zIndex=10+A}this._setSizes()},_setTabSizes:function(C){var E=this._a.offset,A=this._s.align?this._pxc:this._px;for(var D=0;D<C.tabCount;D++){var B=C.childNodes[D];if(B.style.display=="none")continue;B.style[A]=E-(this._lastActive==B?this._a.select_shift:0)+"px";E+=B._size+this._a.margin}},addTab:function(B,C,H,A,F){if(!this.__skin&&dhtmlx.skin)this.setSkin(dhtmlx.skin);F=F||0;for(var G=this._rows.length;G<=F;G++)this._createRow();var E=this._rows[F].tabCount;if((!A)&&(A!==0))A=E;var D=this._createTab(B,C,(H=="*"?10:H||this._s._tabSize));this._addTab(this._rows[F],D,H,A);this._tabs[B]=D;this.cells(B).hide();this._checkScroll()},removeTab:function(A,D){var B=this._tabs[A];if(!B)return;this.cells(A)._dhxContDestruct();if(this._content[A]&&this._content[A].parentNode)this._content[A].parentNode.removeChild(this._content[A]);this._content[A]=null;this._goToAny(B,D);var C=B.parentNode;B.innerHTML="";C.removeChild(B);C.tabCount--;if((C.tabCount==0)&&(this._rows.length>1))this._removeRow(C);else this._setTabSizes(C);delete this._tabs[A];if(this._lastActive==B)this._lastActive=null;this._setRowSizes()},_goToAny:function(A,B){if(this._lastActive==A){if(B&&this.goToNextTab()==A)this.goToPrevTab();if(this._lastActive==A)this._lastActive=null}},_createTab:function(A,B,F){var C=document.createElement("DIV");C.className="dhx_tab_element dhx_tab_element_inactive";var E="<span>"+B+"</span><div></div><div></div><div></div>";if(this._close)E+="<IMG style='"+this._pxc+":4px;"+this._py+(this.skin=="dhx_web"?":7":":4")+"px;position:absolute;z-index:11;' src='"+this.imgUrl+this.skin+"/close.png' >";C.innerHTML=E;C.setAttribute("tab_id",A);C._size=parseInt(F);C.style[this._dx]=parseInt(F)+"px";C.style[this._dy]=this._s.line_height+"px";C.style[this._py]=this._a.select_top+"px";C.skin=this.skin;if(this._a.tab_color)C.style.backgroundColor=this._a.tab_color;if(this._c[A])C.childNodes[0].style.cssText=this._c[A].color;this._img_all(C);if(this._close){var D=this;C.childNodes[4].onclick=function(B){var A=this.parentNode.getAttribute("tab_id");if(D.callEvent("onTabClose",[A]))D.removeTab(A,true);(B||event).cancelBubble=true}}return C},_img_all:function(C){var B=this._getSkin(C),A=C._active?1:4;this._img(C.childNodes[1],A,this._px,B.left);this._img(C.childNodes[2],A+2,this._pxc,B.right);this._img(C.childNodes[3],A+1,this._px,parseInt(C.style[this._dx])-(B.left+B.right),B.left)},_get_img_pos:function(A){if(this._s._bMode&&A<7)A=Math.abs(A-6);A=-5-A*(this._s._vMode==1&&this.skin=="dhx_terrace"?245:45);if(this._s._vMode)return A+"px 0px";else return"0px "+A+"px"},_img:function(B,D,E,C,A){if(typeof(B)=="undefined")return;B.style.backgroundImage="url("+this.imgUrl+this.skin+"/"+this.skin+"_"+this._s.mode+".gif)";B.style.backgroundPosition=this._get_img_pos(D);if(this._s._vMode==1&&this.skin=="dhx_terrace")B.style.width="240px";B.style[this._py]="0px";if(E){B.style[this._dx]=Math.max(C,0)+"px";B.style[E]=(A||0)+"px"}},_addTab:function(E,D,G,A){var F=this._a.offset;if(E.tabCount)var B=E.childNodes[E.tabCount-1],F=parseInt(B.style[this._s.align?this._pxc:this._px])+parseInt(B._size)+this._a.margin;var C=E.childNodes[A];if(C)E.insertBefore(D,C);else E.appendChild(D);E.tabCount++;if(G=="*"){D.style.whiteSpace="nowrap";this.adjustTabSize(D)}D.style[this._s.align?this._pxc:this._px]=F+"px";if(A!=E.tabCount-1)this._setTabSizes(E)},adjustTabSize:function(B,C){var A=this._getSkin(A);if(!C){B.style.fontWeight="bold";B.childNodes[3].style[this._dx]=B.style[this._dx]="10px";C=B[this._s._vMode?"scrollHeight":"scrollWidth"]+10+(this._close?20:0);B.style.fontWeight=""}B.style[this._dx]=C+"px";B._size=C;this._img_all(B)},_onMouseOverHandler:function(A){var B=this.tabbar._getTabTarget(A?A.target:event.srcElement);this.tabbar._showHover(B)},_onMouseOutHandler:function(A){this.tabbar._showHover()},_showHover:function(B){if(B==this._lastHower)return;if(this._lastHower&&this._lastHower!=this._lastActive){var A=this._getSkin(this._lastHower);this._lastHower.className=this._lastHower.className.replace(/[ ]*dhx_tab_hover/gi,"");if(A.hover)this._img_all(this._lastHower);else this._img(this._lastHower.childNodes[3],5,this._px,parseInt(this._lastHower.style[this._dx])-(A.left+A.right),A.left);this._lastHower=null}if(B&&(B==this._lastActive||B._disabled))return;this._lastHower=B;if(B){A=this._getSkin(B);B.className+=" dhx_tab_hover";if(A.hover){this._img(B.childNodes[1],7,this._px,A.left);this._img(B.childNodes[2],8,this._pxc,A.right)}this._img(B.childNodes[3],0,this._px,parseInt(B.style[this._dx])-(A.left+A.right),A.left)}},_getTabTarget:function(A){if(!A)return null;while((!A.className)||(A.className.indexOf("dhx_tab_element")==-1)){if((A.className)&&(A.className.indexOf("dhx_tabbar_zone")!=-1))return null;A=A.parentNode;if(!A)return null}return A},_onClickHandler:function(A){var D=A?A.target:event.srcElement,C=this.tabbar._getTabTarget(D);if(C&&!C._disabled)this.tabbar._setTabActive(C);else{var B=null;if(D.className=="dhx_tab_scroll_left"){D.parentNode.scrollLeft=Math.max(0,D.parentNode.scrollLeft-D.parentNode.offsetWidth/2);B=D;this.tabbar._setTabTop(this.tabbar._lastActive)}else if(D.className=="dhx_tab_scroll_right"){D.parentNode.scrollLeft+=D.parentNode.offsetWidth/2;B=D.previousSibling;this.tabbar._setTabTop(this.tabbar._lastActive)}if(B&&B.parentNode&&B.parentNode.tagName){B.style.left=B.parentNode.scrollLeft+"px";if(!_isIE||window.XMLHttpRequest)B.nextSibling.style.right=B.parentNode.scrollLeft*(-1)+"px";return false}}},_deactivateTab:function(){this._setTabInActive(this._lastActive);this._lastActive=null},_setTabInActive:function(D,E){if(!D||D!=this._lastActive)return true;var C=this._getSkin(D),A=D.getAttribute("tab_id"),B=this._s.align?this._pxc:this._px;D.className=D.className.replace("_active","_inactive");D.style[this._py]=C.select_top+"px";D.style[B]=parseInt(D.style[B])+C.select_shift+"px";D.style[this._dx]=D._size+"px";D._active=false;if(C.tab_color)D.style.backgroundColor=C.tab_color;if(this._c[A])D.childNodes[0].style.cssText=this._c[A].color;this._img_all(D);this.cells(A).hide()},_setTabActive:function(E,F){if(!E)return true;var A=E.getAttribute("tab_id"),C=this._lastActive?this._lastActive.getAttribute("tab_id"):null,D=this._getSkin(E);if(!F)this.callEvent("onTabClick",[A,C]);if(E==this._lastActive)return true;if(!F)if(!this.callEvent("onSelect",[A,C]))return;var B=this._s.align?this._pxc:this._px;this._setTabInActive(this._lastActive);E.className=E.className.replace("_inactive","_active");E.style[this._py]="0px";E.style[B]=parseInt(E.style[B])-D.select_shift+"px";E.style[this._dx]=E._size+D.select_shift*2+"px";E._active=true;if(D.data_color)E.style.backgroundColor=D.data_color;if(this._c[A])E.childNodes[0].style.cssText=this._c[A].scolor;this._img_all(E);this._setTabTop(E);this._lastActive=E;this.cells(A).show();this._scrollTo(E);return true},_scrollTo:function(B){if(!this._s.scrolls)return;if(B.offsetLeft<B.parentNode.scrollLeft||(B.offsetLeft+B.offsetWidth)>(B.parentNode.scrollLeft+B.parentNode.offsetWidth)){B.parentNode.scrollLeft=B.offsetLeft;var A=B.parentNode._scroll;if(A&&A[0]){A[0].style.left=A[0].parentNode.scrollLeft+"px";if(!_isIE||window.XMLHttpRequest)A[1].style.right=A[1].parentNode.scrollLeft*(-1)+"px"}}},_setTabTop:function(D){if(!D)return false;var B=this._rows.length-1;for(var F=0;F<this._rows.length;F++)if(this._rows[F]==D.parentNode){var E=this._rows[F];if(F!=B){this._rows[F]=this._rows[B];this._rows[B]=E}var C=this._getCoverLine();E.appendChild(C);C.style[this._dx]="1px";var A=(this._s._vMode?Math.max(this._tabZone.offsetHeight,E.scrollHeight):Math.max(this._tabZone.offsetWidth,E.scrollWidth));if(A>0)C.style[this._dx]=A+"px";D.style.zIndex=(C._index++);break}this._setRowSizes()},_getCoverLine:function(){if(!this._lineA){this._lineA=document.createElement("div");this._lineA.className="dhx_tablist_line";this._lineA.style[this._py]=this._s.line_height-3-(this._s.skin_line_x?1:0)+"px";this._lineA.style[this._dx]="100%";this._lineA._index=1}this._lineA.style.zIndex=(this._lineA._index++);return this._lineA},cells:function(A){if(!this._tabs[A])return null;if(!this._content[A]){var B=document.createElement("DIV");B.style.cssText="width:100%;height:100%;visibility:hidden;overflow:hidden;position:absolute;top:0px;left:0px;";B.setAttribute("tab_id",A);B.skin=this.skin;this._conZone.appendChild(B);(new dhtmlXContainer(B)).setContent(B);if(this.skin=="dhx_web"&&B._setPadding)B._setPadding(1,"dhxcont_tabbar_dhx_web");B._isTabbarCell=true;this._content[A]=B;var C=this;B.show=function(){if(C._s.hide)this.style.display="";this.style.visibility="";this.style.zIndex="1";this.autoSize();this._activate()};B.hide=function(){if(C._s.hide){this.style.visibility="";this.style.display="none"}else this.style.visibility="hidden";this.style.zIndex=-1;if(C._hrfmode=="iframe")this.attachURL("javascript:false")};B.autoSize=function(){if(C._awdj||C._ahdj){var B=(this.vs?this.vs[this.av].dhxcont.mainCont[this.av]:this.mainCont);if(!B.offsetWidth)B.style.width=Math.max(0,C.entBox.offsetWidth-2)+"px";if(C._ahdj)B.style.height="1px";var A=this._getContentDim();if(C._awdj){C.entBox.style.width=A[0]+2+"px";B.style.width=A[0]+"px"}if(C._ahdj){C._tabAll.style.height=C.entBox.style.height=A[1]+C._rows.length*(C._s.line_height-2)+(C._s.expand?0:2)+2+"px";B.style.height=A[1]+"px"}C._setSizes();C._setTabTop(C._lastActive)}};B._activate=function(){if(this._delay)this._attachContent.apply(this,this._delay);this.activate();if(C._hrfmode!="iframe")this._delay=null};B._doOnResize=function(){this.activate()};B.activate=function(){this.adjustContent(this.parentNode,0,0,false,0);B.updateNestedObjects()};B._doOnAttachStatusBar=B.activate;B._doOnAttachMenu=B.activate;B._doOnAttachToolbar=B.activate;B._getContentDim=function(){var A=(this.vs?this.vs[this.av].dhxcont.mainCont[this.av]:this.mainCont);return[A.scrollWidth,A.scrollHeight]};B._doOnFrameContentLoaded=function(){if(C._awdj||C._ahdj)C.cells(A).autoSize();C.callEvent("onXLE",[]);C.callEvent("onTabContentLoaded",[this.getAttribute("tab_id")])};B._doOnBeforeAttachURL=function(){C.callEvent("onXLS",[])};B.adjustContent(B.parentNode,0,0,false,0)}return this._content[A]},forceLoad:function(A,B){this.setContentHref(A,B||this._hrefs[A]);this.cells(A)._activate()},enableAutoSize:function(A,B){this._ahdj=convertStringToBoolean(B);this._awdj=convertStringToBoolean(A)},clearAll:function(){for(var A in this._tabs)this.removeTab(A,false);if(this._lineA){var B=this._getCoverLine();if(B.parentNode)B.parentNode.removeChild(B)}},enableTabCloseButton:function(A){this._close=convertStringToBoolean(A)},preventIECashing:function(A){this.no_cashe=convertStringToBoolean(A);if(this.XMLLoader)this.XMLLoader.rSeed=this.no_cashe},setTabActive:function(A,B){this._setTabActive(this._tabs[A],B===false)},setTabInActive:function(){var A=this._lastActive;if(A){this._deactivateTab();this._setTabTop(A);this._getCoverLine()}},loadXMLString:function(B,A){this.XMLLoader=new dtmlXMLLoaderObject(this._parseXML,this,true,this.no_cashe);this.XMLLoader.waitCall=A||0;this.XMLLoader.loadXMLString(B)},loadXML:function(B,A){this.callEvent("onXLS",[]);this.XMLLoader=new dtmlXMLLoaderObject(this._parseXML,this,true,this.no_cashe);this.XMLLoader.waitCall=A||0;this.XMLLoader.loadXML(B)},_parseXML:function(K,E,A,C,O){K.clearAll();var L="";if(!O)O=K.XMLLoader;var B=O.getXMLTopNode("tabbar"),M=O.doXPath("//row",B),Q=B.getAttribute("tabstyle");if(Q)K.setStyle(Q);K._hrfmode=B.getAttribute("hrefmode")||K._hrfmode;K._a.margin=parseInt((B.getAttribute("margin")||K._a.margin),10);Q=B.getAttribute("align");if(Q)K._s.align=(Q=="right"||Q=="bottom");K._a.offset=parseInt((B.getAttribute("offset")||K._a.offset),10);Q=B.getAttribute("skinColors");if(Q)K.setSkinColors(Q.split(",")[0],Q.split(",")[1]);for(var I=0;I<M.length;I++){var F=O.doXPath("./tab",M[I]);for(var G=0;G<F.length;G++){var D=F[G].getAttribute("width"),N=K._getXMLContent(F[G]),J=F[G].getAttribute("id");K.addTab(J,N,D,"",I);if(F[G].getAttribute("selected"))L=J;if(K._hrfmode)K.setContentHref(J,F[G].getAttribute("href"));else for(var H=0;H<F[G].childNodes.length;H++){var P=F[G].childNodes[H];if(P.tagName=="content")if(P.getAttribute("id"))K.setContent(J,P.getAttribute("id"));else K.setContentHTML(J,K._getXMLContent(P))}}}if(L)K.setTabActive(L);K.callEvent("onXLE",[])},adjustOuterSize:function(){this._setSizes()},_getXMLContent:function(B){var A="";for(var D=0;D<B.childNodes.length;D++){var C=B.childNodes[D];A+=(C.nodeValue===null?"":C.nodeValue)}return A},enableContentZone:function(A){this._conZone.style.display=((convertStringToBoolean(A))?"":"none");this._setSizes()},enableForceHiding:function(A){this._s.hide=convertStringToBoolean(A)},setSize:function(B,A){this.entBox.style.width=B+"px";this.entBox.style.height=A+"px";this._setSizes()},setSkinColors:function(C,A,B){if(C)this._a.data_color=C;if(A)this._a.tab_color=A;this._conZone.style.backgroundColor=(B||C)},setCustomStyle:function(A,E,B,D){var C="";this._c[A]={color:(";"+(E?("color:"+E+";"):"")+(D||"")),scolor:(";"+(B?("color:"+B+";"):"")+(D||""))};if(this._tabs[A])this._tabs[A].childNodes[0].style.cssText=((this._tabs[A]==this._lastActive)?this._c[A].scolor:this._c[A].color)},setImagePath:function(A){this.imgUrl=A},getNext:function(C,A){A=A||"nextSibling";var B=C[A];if(B&&B.className.indexOf("dhx_tab_element")==-1)B=null;if(!B&&C.parentNode[A])B=C.parentNode[A].childNodes[0];return B||C},getAllTabs:function(){var B=[];for(var A in this._tabs)B.push(A);return B},goToNextTab:function(A){do A=this.getNext(A||this._lastActive);while(!this._setTabActive(A));return A},goToPrevTab:function(A){do A=this.getNext((A||this._lastActive),"previousSibling");while(!this._setTabActive(A));return A},disableTab:function(A){this._tabs[A]._disabled=true;this._tabs[A].style.color="silver"},enableTab:function(A){this._tabs[A]._disabled=false;this._tabs[A].style.color=""},showTab:function(A){var B=this._tabs[A];B.style.display="";this._setTabSizes(B.parentNode)},hideTab:function(A,C){var B=this._tabs[A];B.style.display="none";if(B==this._lastActive&&C!==false)this.goToNextTab();this._setTabSizes(B.parentNode)},getActiveTab:function(){if(!this._lastActive)return null;return this._lastActive.getAttribute("tab_id")},setLabel:function(A,B,D){var C=this.getActiveTab();this._tabs[A].firstChild.innerHTML=B;this.adjustTabSize(this._tabs[A],D);this._setTabSizes(this._tabs[A].parentNode);this._checkScroll()},getLabel:function(A){return this._tabs[A].firstChild.innerHTML},setOffset:function(A){this._a.offset=A*1},enableScroll:function(A){this._s.scrolls=convertStringToBoolean(A)},setMargin:function(A){this._a.margin=A*1},setAlign:function(A){this._s.align=(A=="bottom"||A=="right")},tabWindow:function(A){return(this._content[A]?this._content[A]._frame.contentWindow:null)},setContentHTML:function(A,B){this.cells(A).attachHTMLString(B)},setContent:function(A,B){this.cells(A).attachObject(B);this.cells(A).activate()},setHrefMode:function(A){this._hrfmode=A},setContentHref:function(A,D){this._hrefs[A]=D;switch(this._hrfmode){case"iframes":this.cells(A).attachURL(D);break;case"iframe":case"iframes-on-demand":this.cells(A)._delay=["url",D,false];break;case"ajax":var C=this.cells(A),B=this;C._delay=["urlajax",D,true];if(!C.attachHTMLStringA){C.attachHTMLStringA=C.attachHTMLString;C.attachHTMLString=function(A,C){if(C)A=B._getXMLContent(C.doXPath("//content")[0]);return this.attachHTMLStringA(A)}}break;case"ajax-html":this.cells(A)._delay=["urlajax",D,true];break}if(this._tabs[A]==this._lastActive)this.cells(A).show(true)},normalize:function(A,D){A=A||this._tabZone.offsetWidth;function C(A,B){K[B]._size=K[B]._size+(F!=Infinity?(F-I):0);A.adjustTabSize(K[B],K[B]._size)}var K=[];for(var G=0;G<this._rows.length;G++)for(var J=0;J<this._rows[G].tabCount;J++)K.push(this._rows[G].removeChild(this._rows[G].childNodes[0]));this._tabZone.innerHTML="";this._rows=[];var B=this._lastActive;this._lastActive=null;this._createRow();var H=0,I=this._a.offset,F=Infinity,E=null,J=0;for(J;J<K.length;J++)if((I+K[J]._size+this._a.margin)<A){this._rows[H].appendChild(K[J]);this._rows[H].tabCount++;I+=K[J]._size+this._a.margin}else{if(D&&I<F)C(this,J-1);this._createRow();J--;H++;F=I;I=this._a.offset;continue}if(D&&I<F&&F!=Infinity)C(this,J-1);for(G=0;G<this._rows.length;G++)this._setTabSizes(this._rows[G]);this._setSizes();if(this._lastActive=B)this._setTabTop(this._lastActive)},showInnerScroll:function(){for(var B in this._tabs)if(this.cells(B).vs){var A=this.cells(B).av;this.cells(B).vs[A].dhxcont.mainCont[A].style.overflow="auto"}else this.cells(B).dhxcont.mainCont.style.overflow="auto"},getNumberOfTabs:function(){var A=0;for(var B=0;B<this._rows.length;B++)A+=this._rows[B].tabCount;return A},destructor:function(){}};if(!window.dhtmlXContainer)window.dhtmlXContainer=function(B){var A=this;this.obj=B;this.dhxcont=null;this.setContent=function(A){this.dhxcont=A;this.dhxcont.innerHTML="<div id='dhxMainCont' class='dhxcont_main_content'></div>"+"<div id='dhxContBlocker' class='dhxcont_content_blocker' style='display: none;'></div>";this.dhxcont.mainCont=this.dhxcont.childNodes[0];this.obj.dhxcont=this.dhxcont};this.obj._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B=B+D.charAt(Math.round(Math.random()*D.length));return B};this.obj.setMinContentSize=function(A,B){this._minDataSizeW=A;this._minDataSizeH=B};this.obj.moveContentTo=function(A){A.updateNestedObjects()};this.obj.adjustContent=function(H,I,C,G,A){this.dhxcont.style.top=I+"px";this.dhxcont.style.left="0px";if(G==true);else this.dhxcont.style.width=H.clientWidth+"px";var B=H.clientHeight-I;if(B<0)B=0;this.dhxcont.style.height=B+(C!=null?C:0)+"px";if(G==true);else if(this.dhxcont.offsetWidth>H.clientWidth)this.dhxcont.style.width=Math.max(0,H.clientWidth*2-this.dhxcont.offsetWidth)+"px";if(this.dhxcont.offsetHeight>H.clientHeight-I){B=(H.clientHeight-I)*2-this.dhxcont.offsetHeight;if(B<0)B=0;this.dhxcont.style.height=B+"px"}if(A)if(!isNaN(A))this.dhxcont.style.height=parseInt(this.dhxcont.style.height)-A+"px";if(this._minDataSizeH!=null)if(parseInt(this.dhxcont.style.height)<this._minDataSizeH)this.dhxcont.style.height=this._minDataSizeH+"px";if(this._minDataSizeW!=null)if(parseInt(this.dhxcont.style.width)<this._minDataSizeW)this.dhxcont.style.width=this._minDataSizeW+"px";if(G==true);else this.dhxcont.mainCont.style.width=this.dhxcont.clientWidth+"px";var F=(this.menu!=null?(!this.menuHidden?this.menuHeight:0):0),E=(this.toolbar!=null?(!this.toolbarHidden?this.toolbarHeight:0):0),D=(this.sb!=null?(!this.sbHidden?this.sbHeight:0):0);this.dhxcont.mainCont.style.height=this.dhxcont.clientHeight-F-E-D+"px"};this.obj.updateNestedObjects=function(){};this.obj.attachObject=function(C,A){if(typeof(C)=="string")C=document.getElementById(C);if(A){C.style.visibility="hidden";C.style.display="";var B=C.offsetWidth,D=C.offsetHeight}this._attachContent("obj",C);if(A&&this._isWindow){C.style.visibility="";this._adjustToContent(B,D)}};this.obj.appendObject=function(A){if(typeof(A)=="string")A=document.getElementById(A);this._attachContent("obj",A,true)};this.obj.attachHTMLString=function(B){this._attachContent("str",B);var C=B.match(/<script[^>]*>[^\f]*?<\/script>/g)||[];for(var E=0;E<C.length;E++){var A=C[E].replace(/<([\/]{0,1})script[^>]*>/g,"");if(window.execScript){var D=C[E].match(/<script[^>]*src\s*=\s*("|')([^"']+)("|')/);if(D)A=dhtmlxAjax.getSync(D[2]).xmlDoc.responseText;if(A)window.execScript(A)}else window.eval(A)}};this.obj.attachURL=function(B,A){this._attachContent((A==true?"urlajax":"url"),B,false)};this.obj._attachContent=function(F,E,B){if(B!==true)while(A.dhxcont.mainCont.childNodes.length>0)A.dhxcont.mainCont.removeChild(A.dhxcont.mainCont.childNodes[0]);if(F=="url"){var D=document.createElement("IFRAME");D.frameBorder=0;D.border=0;D.style.width="100%";D.style.height="100%";A.dhxcont.mainCont.appendChild(D);D.src=E;this._frame=D;if(this._doOnFrameContentLoaded)this._doOnFrameContentLoaded(true)}else if(F=="urlajax"){var C=this,H=function(){C.attachHTMLString(this.xmlDoc.responseText,this);if(C._doOnFrameContentLoaded)C._doOnFrameContentLoaded(false);this.destructor()},G=new dtmlXMLLoaderObject(H,window);G.loadXML(E);if(C._doOnBeforeAttachURL)C._doOnBeforeAttachURL(false)}else if(F=="obj"){A.dhxcont._frame=null;A.dhxcont.mainCont.appendChild(E);A.dhxcont.mainCont.style.overflow=(B===true?"auto":"hidden");E.style.display=""}else if(F=="str"){A.dhxcont._frame=null;A.dhxcont.mainCont.innerHTML=E}};this.obj._dhxContDestruct=function(){}};(function(){dhtmlx.extend_api("dhtmlXTabBar",{_init:function(A){return[A.parent,A.mode,A.height]},tabs:"tabs",skin:"setSkin",offset:"setOffset",margin:"setMargin",image_path:"setImagePath",href_mode:"setHrefMode",align:"setAlign",xml:"loadXML",close_button:"enableTabCloseButton",scroll:"enableScroll",forced:"enableForceHiding",content_zone:"enableContentZone",size_by_content:"enableAutoSize",auto_size:"enableAutoReSize"},{tabs:function(B){for(var C=0;C<B.length;C++){var A=B[C];this.addTab(A.id,A.label,A.width,A.index,A.row);if(A.active)this.setTabActive(A.id)}}})})();function dhx_init_tabbars(){var z=document.getElementsByTagName("div");for(var i=0;i<z.length;i++)if(z[i].className.indexOf("dhtmlxTabBar")!=-1){var n=z[i],id=n.id;n.className="";var k=new Array();for(var j=0;j<n.childNodes.length;j++)if(n.childNodes[j].tagName&&n.childNodes[j].tagName!="!")k[k.length]=n.childNodes[j];var w=new dhtmlXTabBar(id,n.getAttribute("mode")||"top",n.getAttribute("tabheight")||20);window[id]=w;acs=n.getAttribute("onbeforeinit");if(acs)eval(acs);if(n.getAttribute("enableForceHiding"))w.enableForceHiding(true);w.setImagePath(n.getAttribute("imgpath"));var acs=n.getAttribute("margin");if(acs!=null)w._margin=acs;acs=n.getAttribute("align");if(acs)w._align=acs;acs=n.getAttribute("hrefmode");if(acs)w.setHrefMode(acs);acs=n.getAttribute("offset");if(acs!=null)w._offset=acs;acs=n.getAttribute("tabstyle");if(acs!=null)w.setStyle(acs);acs=n.getAttribute("select");var clrs=n.getAttribute("skinColors");if(clrs)w.setSkinColors(clrs.split(",")[0],clrs.split(",")[1]);for(j=0;j<k.length;j++){var m=k[j];m.parentNode.removeChild(m);w.addTab(m.id,m.getAttribute("name"),m.getAttribute("width"),null,m.getAttribute("row"));var href=m.getAttribute("href");if(href)w.setContentHref(m.id,href);else w.setContent(m.id,m);if((!w._dspN)&&(m.style.display=="none"))m.style.display=""}if(k.length)w.setTabActive(acs||k[0].id);acs=n.getAttribute("oninit");if(acs)eval(acs)}}dhtmlxEvent(window,"load",dhx_init_tabbars);function dhtmlXAccordionItem(){}function dhtmlXAccordion(C,D){if(!window.dhtmlXContainer){alert(this.i18n.dhxcontalert);return}var A=this;this.skin=(D!=null?D:(typeof(dhtmlx)!="undefined"&&typeof(dhtmlx.skin)=="string"?dhtmlx.skin:"dhx_skyblue"));if(C==document.body){this._isAccFS=true;document.body.className+=" dhxacc_fullscreened";var B=document.createElement("DIV");B.className="dhxcont_global_layout_area";C.appendChild(B);this.cont=new dhtmlXContainer(C);this.cont.setContent(B);C.adjustContent(C,0);this.base=document.createElement("DIV");this.base.className="dhx_acc_base_"+this.skin;this.base.style.overflow="hidden";this.base.style.position="absolute";this._adjustToFullScreen=function(){this.base.style.left="2px";this.base.style.top="2px";this.base.style.width=parseInt(B.childNodes[0].style.width)-4+"px";this.base.style.height=parseInt(B.childNodes[0].style.height)-4+"px"};this._adjustToFullScreen();B.childNodes[0].appendChild(this.base);this._resizeTM=null;this._resizeTMTime=400;this._doOnResize=function(){window.clearTimeout(A._resizeTM);A._resizeTM=window.setTimeout(function(){A._adjustAccordion()},A._resizeTMTime)};this._adjustAccordion=function(){document.body.adjustContent(document.body,0);this._adjustToFullScreen();this.setSizes()};dhtmlxEvent(window,"resize",this._doOnResize)}else{this.base=(typeof(C)=="string"?document.getElementById(C):C);this.base.className="dhx_acc_base_"+this.skin;this.base.innerHTML=""}this.w=this.base.offsetWidth;this.h=this.base.offsetHeight;this.skinParams={"dhx_blue":{"cell_height":24,"cell_space":1,"content_offset":1},"dhx_skyblue":{"cell_height":27,"cell_space":-1,"content_offset":-1},"dhx_black":{"cell_height":24,"cell_space":1,"content_offset":1},"dhx_web":{"cell_height":26,"cell_space":9,"content_offset":0,"cell_pading_max":1,"cell_pading_min":0},"dhx_terrace":{"cell_height":37,"cell_space":-1,"content_offset":-1}};this.sk=this.skinParams[this.skin];this.setSkinParameters=function(A,B){if(!isNaN(A))this.sk["cell_space"]=A;if(!isNaN(B))this.sk["content_offset"]=B;this._reopenItem()};this.setSkin=function(B){if(!this.skinParams[B])return;this.skin=B;this.sk=this.skinParams[this.skin];this.base.className="dhx_acc_base_"+this.skin+(this._r?" dhx_acc_rtl":"");for(var A in this.idPull)this.idPull[A].skin=this.skin;this._reopenItem()};this.idPull={};this.opened=null;this.cells=function(A){if(this.idPull[A]==null)return null;return this.idPull[A]};this.itemH=90;this.multiMode=false;this.enableMultiMode=function(){var B=0;for(var A in this.idPull)B++;if(B==0){if(!this.userOffset)this.skinParams["dhx_skyblue"]["cell_space"]=3;this.multiMode=true}if(this.skin=="dhx_terrace")this.skinParams["dhx_terrace"]["cell_space"]=12};this.userOffset=false;this.setOffset=function(A,B){this.userOffset=true;if(!isNaN(A))this.skinParams[this.skin]["cell_space"]=A;if(!isNaN(B))this.skinParams[this.skin]["content_offset"]=B;this.setSizes()};this.imagePath="";this.setIconsPath=function(A){this.imagePath=A};this.addItem=function(I,G){if(this.multiMode)var D=this._lastVisible();var C=document.createElement("DIV");C.className="dhx_acc_item";C.dir="ltr";C._isAcc=true;C.skin=this.skin;this.base.appendChild(C);if(this.multiMode)C.h=this.itemH;var F=document.createElement("DIV");F._idd=I;F.className="dhx_acc_item_label";F.innerHTML="<span>"+G+"</span><div class='dhx_acc_item_label_btmbrd'>&nbsp;</div>"+"<div class='dhx_acc_item_arrow'></div>"+"<div class='dhx_acc_hdr_line_l'></div>"+"<div class='dhx_acc_hdr_line_r'></div>";F.onselectstart=function(A){A=A||event;A.returnValue=false};F.onclick=function(){if(!A.multiMode&&A.idPull[this._idd]._isActive)return;if(A.multiMode){if(A.idPull[this._idd]._isActive){if(A.checkEvent("onBeforeActive")){if(A.callEvent("onBeforeActive",[this._idd,"close"]))A.closeItem(this._idd,"dhx_accord_outer_event")}else A.closeItem(this._idd,"dhx_accord_outer_event")}else if(A.checkEvent("onBeforeActive")){if(A.callEvent("onBeforeActive",[this._idd,"open"]))A.openItem(this._idd,"dhx_accord_outer_event")}else A.openItem(this._idd,"dhx_accord_outer_event");if(A._autoHeightEnabled)A.setSizes();return}if(A.checkEvent("onBeforeActive")){if(A.callEvent("onBeforeActive",[this._idd,"open"]))A.openItem(this._idd,"dhx_accord_outer_event")}else A.openItem(this._idd,"dhx_accord_outer_event")};F.onmouseover=function(){this.className="dhx_acc_item_label dhx_acc_item_lavel_hover"};F.onmouseout=function(){this.className="dhx_acc_item_label"};C.appendChild(F);var E=document.createElement("DIV");E.className="dhxcont_global_content_area";C.appendChild(E);var H=new dhtmlXContainer(C);H.setContent(E);if(this.skin=="dhx_terrace"&&this._hideBorders===true)C._setPadding([0,-1,2,0]);C.adjustContent(C,this.sk["cell_height"]+this.sk["content_offset"]);C._id=I;this.idPull[I]=C;C.getId=function(){return this._id};C.setText=function(B){A.setText(this._id,B)};C.getText=function(){return A.getText(this._id)};C.open=function(){A.openItem(this._id)};C.isOpened=function(){return A.isActive(this._id)};C.close=function(){A.closeItem(this._id)};C.setIcon=function(B){A.setIcon(this._id,B)};C.clearIcon=function(){A.clearIcon(this._id)};C.dock=function(){A.dockItem(this._id)};C.undock=function(){A.undockItem(this._id)};C.show=function(){A.showItem(this._id)};C.hide=function(){A.hideItem(this._id)};C.setHeight=function(B){A.setItemHeight(this._id,B)};C.moveOnTop=function(){A.moveOnTop(this._id)};C._doOnAttachMenu=function(){A._reopenItem()};C._doOnAttachToolbar=function(){A._reopenItem()};C._doOnAttachStatusBar=function(){A._reopenItem()};C._doOnFrameContentLoaded=function(){A.callEvent("onContentLoaded",[this])};if(this.multiMode&&D!=null){if(D._isActive==true){this.idPull[D._id].adjustContent(this.idPull[D._id],this.sk["cell_height"]+this.sk["content_offset"],null,null,this.sk["cell_space"]);this.idPull[D._id].updateNestedObjects()}else this.idPull[D._id].style.height=this.sk["cell_height"]+this.sk["cell_space"]+"px";D=null}var B=this._enableOpenEffect;this._enableOpenEffect=false;this.openItem(I);this._enableOpenEffect=B;if(!this.multiMode)this._defineLastItem();else this.setSizes();return C};this.openItem=function(C,D,A){if(this.multiMode)this._checkAutoHeight();if(this._openBuzy)return;if(this._enableOpenEffect&&!A){if(this.multiMode&&this.idPull[C]._isActive)return;this._openWithEffect(C,null,null,null,null,D);return}if(this.multiMode){for(var B in this.idPull)if(this.idPull[B]._isActive||B==C){this.idPull[B].style.height=this.idPull[B].h+"px";this.idPull[B].childNodes[1].style.display="";if(this.skin=="dhx_web")this.idPull[B]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_acc_dhx_web");this.idPull[B].adjustContent(this.idPull[B],this.sk["cell_height"]+this.sk["content_offset"],null,null,(this.idPull[B]==this._lastVisible()&&this.skin!="dhx_web"?0:this.sk["cell_space"]));this.idPull[B].updateNestedObjects();this.idPull[B]._isActive=true;this._updateArrows();if(D=="dhx_accord_outer_event"&&B==C)this.callEvent("onActive",[C,true])}return}if(C)if(this.idPull[C]._isActive&&!A)return;var E=0;for(B in this.idPull){this.idPull[B].style.height=this.sk["cell_height"]+(this.idPull[B]!=this._lastVisible()&&B!=C?this.sk["cell_space"]:0)+"px";if(B!=C){this.idPull[B].childNodes[1].style.display="none";if(this.skin=="dhx_web")this.idPull[B]._setPadding(this.skinParams[this.skin]["cell_pading_min"],"");this.idPull[B]._isActive=false;E+=this.idPull[B].offsetHeight}}E=this.base.offsetHeight-E;if(C){this.idPull[C].style.height=E+"px";this.idPull[C].childNodes[1].style.display="";if(this.skin=="dhx_web")this.idPull[C]._setPadding(this.skinParams[this.skin]["cell_pading_max"],"dhxcont_acc_dhx_web");this.idPull[C].adjustContent(this.idPull[C],this.sk["cell_height"]+this.sk["content_offset"],null,null,(this.idPull[C]==this._lastVisible()?0:this.sk["cell_space"]));this.idPull[C].updateNestedObjects();this.idPull[C]._isActive=true;if(D=="dhx_accord_outer_event")this.callEvent("onActive",[C,true])}this._updateArrows();return};this._lastVisible=function(){var B=null;for(var A=this.base.childNodes.length-1;A>=0;A--)if(!this.base.childNodes[A]._isHidden&&!B)B=this.base.childNodes[A];return B};this.closeItem=function(A,B){if(this.idPull[A]==null)return;if(!this.idPull[A]._isActive)return;if(this._openBuzy)return;if(this._enableOpenEffect){this._openWithEffect(this.multiMode?A:null,null,null,null,null,B);return}this.idPull[A].style.height=this.sk["cell_height"]+(this.idPull[A]!=this._lastVisible()?this.sk["cell_space"]:0)+"px";this.idPull[A].childNodes[1].style.display="none";if(this.skin=="dhx_web")this.idPull[A]._setPadding(this.skinParams[this.skin]["cell_pading_min"],"");this.idPull[A]._isActive=false;if(B=="dhx_accord_outer_event")this.callEvent("onActive",[A,false]);this._updateArrows()};this._updateArrows=function(){for(var C in this.idPull){var D=this.idPull[C].childNodes[0],B=null;for(var A=0;A<D.childNodes.length;A++)if(String(D.childNodes[A].className).search("dhx_acc_item_arrow")!=-1)B=D.childNodes[A];if(B!=null){B.className="dhx_acc_item_arrow "+(this.idPull[C]._isActive?"item_opened":"item_closed");B=null}}};this.setText=function(G,E,D){if(A.idPull[G]==null)return;var C=A.idPull[G].childNodes[0],F=null;for(var B=0;B<C.childNodes.length;B++)if(C.childNodes[B].tagName!=null)if(String(C.childNodes[B].tagName).toLowerCase()=="span")F=C.childNodes[B];if(!isNaN(D)){F.style.paddingLeft=D+"px";F.style.paddingRight=D+"px"}else F.innerHTML=E};this.getText=function(E){if(A.idPull[E]==null)return;var C=A.idPull[E].childNodes[0],D=null;for(var B=0;B<C.childNodes.length;B++)if(C.childNodes[B].tagName!=null)if(String(C.childNodes[B].tagName).toLowerCase()=="span")D=C.childNodes[B];return D.innerHTML};this._initWindows=function(A){if(!window.dhtmlXWindows)return;if(!this.dhxWins){this.dhxWins=new dhtmlXWindows();this.dhxWins.setSkin(this.skin);this.dhxWins.setImagePath(this.imagePath);this.dhxWinsIdPrefix="";if(!A)return}var B=this.dhxWinsIdPrefix+A;if(!this.dhxWins.window(B)){var C=this,D=this.dhxWins.createWindow(B,20,20,320,200);D.setText(this.getText(A));D.button("close").hide();D.attachEvent("onClose",function(A){A.hide()});D.addUserButton("dock",99,this.dhxWins.i18n.dock,"dock");D.button("dock").attachEvent("onClick",function(B){C.cells(A).dock()})}else this.dhxWins.window(B).show()};this.dockWindow=function(A){if(!this.idPull[A]._isUnDocked)return;if(!this.dhxWins)return;if(!this.dhxWins.window(this.dhxWinsIdPrefix+A))return;this.dhxWins.window(this.dhxWinsIdPrefix+A).moveContentTo(this.idPull[A]);this.dhxWins.window(this.dhxWinsIdPrefix+A).close();this.idPull[A]._isUnDocked=false;this.showItem(A);this.callEvent("onDock",[A])};this.undockWindow=function(A){if(this.idPull[A]._isUnDocked)return;this._initWindows(A);this.idPull[A].moveContentTo(this.dhxWins.window(this.dhxWinsIdPrefix+A));this.idPull[A]._isUnDocked=true;this.hideItem(A);this.callEvent("onUnDock",[A])};this.setSizes=function(){this._reopenItem()};this.showItem=function(A){if(this.idPull[A]==null)return;if(!this.idPull[A]._isHidden)return;if(this.idPull[A]._isUnDocked){this.dockItem(A);return}this.idPull[A].className="dhx_acc_item";this.idPull[A]._isHidden=false;this._defineLastItem();this._reopenItem()};this.hideItem=function(A){if(this.idPull[A]==null)return;if(this.idPull[A]._isHidden)return;this.closeItem(A);this.idPull[A].className="dhx_acc_item_hidden";this.idPull[A]._isHidden=true;this._defineLastItem();this._reopenItem()};this.isItemHidden=function(A){if(this.idPull[A]==null)return;return(this.idPull[A]._isHidden==true)};this._reopenItem=function(){var B=null;for(var A in this.idPull)if(this.idPull[A]._isActive&&!this.idPull[A]._isHidden)B=A;this.openItem(B,null,true)};this.forEachItem=function(B){for(var A in this.idPull)B(this.idPull[A])};this._enableOpenEffect=false;this._openStep=10;this._openStepIncrement=5;this._openStepTimeout=10;this._openBuzy=false;this.setEffect=function(A){this._enableOpenEffect=(A==true?true:false)};this._openWithEffect=function(B,G,H,K,M,L){if(this.multiMode){if(!M){this._openBuzy=true;M=this._openStep;if(this.idPull[B]._isActive){G=B;B=null;H=this.sk["cell_height"]+(this.idPull[G]!=this._lastVisible()?this.sk["cell_space"]:0);this.idPull[G].childNodes[1].style.display=""}else{K=this.idPull[B].h;this.idPull[B].childNodes[1].style.display=""}}var I=false;if(B){var J=parseInt(this.idPull[B].style.height||0)+M;if(J>K){J=K;I=true}this.idPull[B].style.height=J+"px"}if(G){J=parseInt(this.idPull[G].style.height)-M;if(J<H){J=H;I=true}this.idPull[G].style.height=J+"px"}M+=this._openStepIncrement;if(I){if(B){this.idPull[B].adjustContent(this.idPull[B],this.sk["cell_height"]+this.sk["content_offset"],null,null,(this.idPull[B]==this._lastVisible()?0:this.sk["cell_space"]));this.idPull[B].updateNestedObjects();this.idPull[B]._isActive=true}if(G){this.idPull[G].childNodes[1].style.display="none";this.idPull[G]._isActive=false}this._updateArrows();this._openBuzy=false;if(B&&L=="dhx_accord_outer_event")this.callEvent("onActive",[B,true]);if(G&&L=="dhx_accord_outer_event")this.callEvent("onActive",[G,false])}else{var F=this;window.setTimeout(function(){F._openWithEffect(B,G,H,K,M,L)},this._openStepTimeout)}return}if(!M){this._openBuzy=true;M=this._openStep;if(B)this.idPull[B].childNodes[1].style.display=""}if(!G||!H||!K){H=0;K=0;for(var A in this.idPull){var D=this.sk["cell_height"]+(this.idPull[A]!=this._lastVisible()&&A!=B?this.sk["cell_space"]:0);if(this.idPull[A]._isActive&&B!=A){G=A;H=D}if(A!=B)K+=D}K=this.base.offsetHeight-K}I=false;if(B){var E=parseInt(this.idPull[B].style.height)+M;if(E>K)I=true}if(G){var C=parseInt(this.idPull[G].style.height)-M;if(C<H)I=true}M+=this._openStepIncrement;if(I){E=K;C=H}if(G)this.idPull[G].style.height=C+"px";if(B)this.idPull[B].style.height=E+"px";if(I){if(G){this.idPull[G].childNodes[1].style.display="none";this.idPull[G]._isActive=false}if(B){this.idPull[B].adjustContent(this.idPull[B],this.sk["cell_height"]+this.sk["content_offset"],null,null,(this.idPull[B]==this._lastVisible()?0:this.sk["cell_space"]));this.idPull[B].updateNestedObjects();this.idPull[B]._isActive=true}this._updateArrows();this._openBuzy=false;if(L=="dhx_accord_outer_event"&&B)this.callEvent("onActive",[B,true])}else{F=this;window.setTimeout(function(){F._openWithEffect(B,G,H,K,M,L)},this._openStepTimeout)}};this.setActive=function(A){this.openItem(A)};this.isActive=function(A){return(this.idPull[A]._isActive===true?true:false)};this.dockItem=function(A){this.dockWindow(A)};this.undockItem=function(A){this.undockWindow(A)};this.setItemHeight=function(B,A){if(!this.multiMode)return;if(A=="*")this.idPull[B].h_auto=true;else{if(isNaN(A))return;this.idPull[B].h_auto=false;this.idPull[B].h=A}this._reopenItem()};this._checkAutoHeight=function(){var E=this.base.offsetHeight;this._autoHeightEnabled=false;var D=[];for(var B in this.idPull){if(!this._autoHeightEnabled&&this.idPull[B].h_auto)this._autoHeightEnabled=true;if(this.idPull[B].h_auto&&this.idPull[B]._isActive)D.push(B);else if(this.idPull[B]._isActive)E=Math.max(0,E-this.idPull[B].h);else E=Math.max(0,E-this.idPull[B].offsetHeight)}if(D.length>0){var C=Math.floor(E/D.length);for(var A=0;A<D.length;A++){if(A==D.length-1)C=E;else E-=C;this.idPull[D[A]].h=C}}};this.setIcon=function(D,A){if(this.idPull[D]==null)return;var C=this.idPull[D].childNodes[0],E=null;for(var B=0;B<C.childNodes.length;B++)if(C.childNodes[B].className=="dhx_acc_item_icon")E=C.childNodes[B];if(E==null){E=document.createElement("IMG");E.className="dhx_acc_item_icon";C.insertBefore(E,C.childNodes[0]);this.setText(D,null,20)}E.src=this.imagePath+A};this.clearIcon=function(C){if(this.idPull[C]==null)return;var B=this.idPull[C].childNodes[0],D=null;for(var A=0;A<B.childNodes.length;A++)if(B.childNodes[A].className=="dhx_acc_item_icon")D=B.childNodes[A];if(D!=null){B.removeChild(D);D=null;this.setText(C,null,0)}};this.moveOnTop=function(A){if(!this.idPull[A])return;if(this.base.childNodes.length<=1)return;this.base.insertBefore(this.idPull[A],this.base.childNodes[0]);this.setSizes()};this._defineLastItem=function(){if(this.multiMode)return;var B=false;for(var A=this.base.childNodes.length-1;A>=0;A--)if((this.base.childNodes[A].className).search("last_item")>=0){if(this.base.childNodes[A]._isHidden||B)this.base.childNodes[A].className=String(this.base.childNodes[A].className).replace(/last_item/gi,"");else B=true}else if(!this.base.childNodes[A]._isHidden&&!B){this.base.childNodes[A].className+=" last_item";B=true}};this.removeItem=function(D){var B=this.idPull[D],C=B.childNodes[0];C.onclick=null;C.onmouseover=null;C.onmouseout=null;C.onselectstart=null;C._idd=null;C.className="";B._dhxContDestruct();while(C.childNodes.length>0)C.removeChild(C.childNodes[0]);if(C.parentNode)C.parentNode.removeChild(C);C=null;while(B.childNodes.length>0)B.removeChild(B.childNodes[0]);B._dhxContDestruct=null;B._doOnAttachMenu=null;B._doOnAttachToolbar=null;B._doOnAttachStatusBar=null;B.clearIcon=null;B.close=null;B.dock=null;B.getId=null;B.getText=null;B.hide=null;B.isOpened=null;B.open=null;B.setHeight=null;B.setIcon=null;B.setText=null;B.show=null;B.undock=null;if(B.parentNode)B.parentNode.removeChild(B);B=null;this.idPull[D]=null;try{delete this.idPull[D]}catch(A){}};this.unload=function(){for(var B in this.skinParams){this.skinParams[B]=null;try{delete this.skinParams[B]}catch(A){}}this.skinParams=null;for(B in this.idPull)this.removeItem(B);this.idPull=null;this.sk=null;this._initWindows=null;this._lastVisible=null;this._reopenItem=null;this._updateArrows=null;this.addItem=null;this.attachEvent=null;this.callEvent=null;this.cells=null;this.checkEvent=null;this.clearIcon=null;this.closeItem=null;this.detachEvent=null;this.dockItem=null;this.dockWindow=null;this.enableMultiMode=null;this.eventCatcher=null;this.forEachItem=null;this.getText=null;this.h=null;this.hideItem=null;this.imagePath=null;this.isActive=null;this.itemH=null;this.multiMode=null;this.openItem=null;this.removeItem=null;this.setActive=null;this.setEffect=null;this.setIcon=null;this.setIconsPath=null;this.setItemHeight=null;this.setOffset=null;this.setSizes=null;this.setSkin=null;this.setSkinParameters=null;this.setText=null;this.showItem=null;this.skin=null;this.w=null;this.undockItem=null;this.undockWindow=null;this.undockWindowunload=null;this.unload=null;this.userOffset=null;if(this._isAccFS==true){if(_isIE)window.detachEvent("onresize",this._doOnResize);else window.removeEventListener("resize",this._doOnResize,false);this._isAccFS=null;this._doOnResize=null;this._adjustAccordion=null;this._adjustToFullScreen=null;this._resizeTM=null;this._resizeTMTime=null;document.body.className=String(document.body.className).replace("dhxacc_fullscreened","");this.cont.obj._dhxContDestruct();if(this.cont.dhxcont.parentNode)this.cont.dhxcont.parentNode.removeChild(this.cont.dhxcont);this.cont.dhxcont=null;this.cont.setContent=null;this.cont=null}if(this.dhxWins){this.dhxWins.unload();this.dhxWins=null}this.base.className="";this.base=null;for(B in this){try{delete this[B]}catch(A){}}};this._initWindows();dhtmlxEventable(this);return this}dhtmlXAccordion.prototype.i18n={dhxcontalert:"dhtmlxcontainer.js is missed on the page"};(function(){dhtmlx.extend_api("dhtmlXAccordion",{_init:function(A){return[A.parent,A.skin]},icon_path:"setIconsPath",items:"_items",effect:"setEffect",multi_mode:"enableMultiMode"},{_items:function(A){var E=[],C=[];for(var F=0;F<A.length;F++){var D=A[F];this.addItem(D.id,D.text);if(D.img)this.cells(D.id).setIcon(D.img);if(D.height)this.cells(D.id).setHeight(D.height);if(D.open===true)E[E.length]=D.id;if(D.open===false)C[C.length]=D.id}for(var B=0;B<E.length;B++)this.cells(E[B]).open();for(B=0;B<C.length;B++)this.cells(C[B]).close()}})})();dhtmlXAccordion.prototype.loadJSON=function(A){var E={skin:"setSkin",icons_path:"setIconsPath",multi_mode:"enableMultiMode",effect:"setEffect"};for(var C in E)if(typeof(A[C])!="undefined")this[E[C]](A[C]);var D=null;for(var B=0;B<A.cells.length;B++){this.addItem(A.cells[B].id,A.cells[B].text);if(typeof(A.cells[B].icon)!="undefined")this.setIcon(A.cells[B].id,A.cells[B].icon);if(typeof(A.cells[B].height)!="undefined")this.setItemHeight(A.cells[B].id,A.cells[B].height);if(typeof(A.cells[B].open)!="undefined")D=A.cells[B].id}if(D!=null)this.openItem(D)};dhtmlXAccordion.prototype.loadXML=function(C,B){var A=this;this.callEvent("onXLS",[]);dhtmlxAjax.get(C,function(G){var F=G.xmlDoc.responseXML.getElementsByTagName("accordion")[0],J={0:false,"true":true,"1":true,"y":true,"yes":true},E={cells:[]};if(F.getAttribute("skin")!=null)E.skin=F.getAttribute("skin");if(F.getAttribute("iconsPath")!=null)E.icons_path=F.getAttribute("iconsPath");if(F.getAttribute("mode")=="multi")E.multi_mode=true;if(J[F.getAttribute("openEffect")||0])E.effect=true;var I=null;for(var H=0;H<F.childNodes.length;H++)if(typeof(F.childNodes[H].tagName)!="indefined"&&String(F.childNodes[H].tagName).toLowerCase()=="cell"){var C=(F.childNodes[H].getAttribute("id")||A._genStr(12)),D=(F.childNodes[H].firstChild.nodeValue||"");E.cells.push({id:C,text:D});if(F.childNodes[H].getAttribute("icon")!=null)E.cells[E.cells.length-1].icon=F.childNodes[H].getAttribute("icon");if(F.childNodes[H].getAttribute("height")!=null)E.cells[E.cells.length-1].height=F.childNodes[H].getAttribute("height");if(J[F.childNodes[H].getAttribute("open")||0])E.cells[E.cells.length-1].open=true}A.loadJSON(E);A.callEvent("onXLE",[]);if(typeof(B)=="function")B();A=B=null})};function dhtmlXEditor(D,G){var A=this;this.skin=(G||dhtmlx.skin||"dhx_skyblue");this.iconsPath=dhtmlx.image_path||"../../codebase/imgs/";if(typeof(D)=="string")D=document.getElementById(D);this.base=D;while(this.base.childNodes.length>0)this.base.removeChild(this.base.childNodes[0]);this._isToolbar=(this.initDhtmlxToolbar!=null&&window.dhtmlXToolbarObject!=null?true:false);if(!this._isToolbar)this.tbData="<div class='dhxeditor_"+this.skin+"_btns'>"+"<a href='javascript:void(0);' onclick='return false;' tabindex='-1'><div actv='b' cmd='applyBold' class='dhxeditor_"+this.skin+"_tbbtn btn_bold'></div></a>"+"<a href='javascript:void(0);' onclick='return false;' tabindex='-1'><div actv='i' cmd='applyItalic' class='dhxeditor_"+this.skin+"_tbbtn btn_italic'></div></a>"+"<a href='javascript:void(0);' onclick='return false;' tabindex='-1'><div actv='u' cmd='applyUnderscore' class='dhxeditor_"+this.skin+"_tbbtn btn_underline'></div></a>"+"<a href='javascript:void(0);' onclick='return false;' tabindex='-1'><div actv='c' cmd='clearFormatting' class='dhxeditor_"+this.skin+"_tbbtn btn_clearformat'></div></a>"+"<div class='verline_l'></div><div class='verline_r'></div>"+"</div>";else this.tbData="";var I=(_isIE?this.base.currentStyle["position"]:window.getComputedStyle(this.base,null).getPropertyValue("position"));if(!(I=="relative"||I=="absolute"))this.base.style.position="relative";this.base.innerHTML=this.tbData+"<div style='position:absolute;width: 100%;overflow: hidden;'></div>";var H=new dhtmlXContainerLite(this.base);H.skin=this.skin;H.setContent(this.base.childNodes[(this._isToolbar?0:1)]);var F=(this._isToolbar?0:this.base.childNodes[0].offsetHeight);this.base.adjustContent(this.base,F);this.cBlock=document.createElement("DIV");this.cBlock.className="dhxcont_content_blocker";this.cBlock.style.display="none";this.base.appendChild(this.cBlock);this.editor=document.createElement("IFRAME");this.editor.className="dhxeditor_mainiframe_"+this.skin;this.editor.frameBorder=0;if(_isOpera)this.editor.scrolling="yes";var E=this.editor;if(_isIE){E.onreadystatechange=function(C){if(E.readyState=="complete"){try{this.contentWindow.document.body.attachEvent("onfocus",function(B){A._ev("focus",B)});this.contentWindow.document.body.attachEvent("onblur",function(B){A._ev("blur",B)});this.contentWindow.document.body.attachEvent("onkeydown",function(B){A._ev("keydown",B)});this.contentWindow.document.body.attachEvent("onkeyup",function(B){A._ev("keyup",B)});this.contentWindow.document.body.attachEvent("onkeypress",function(B){A._ev("keypress",B)});this.contentWindow.document.body.attachEvent("onmouseup",function(B){A._ev("mouseup",B)});this.contentWindow.document.body.attachEvent("onmousedown",function(B){A._ev("mousedown",B)});this.contentWindow.document.body.attachEvent("onclick",function(B){A._ev("click",B)})}catch(B){}}};E.onunload=function(){this.contentWindow.document.body.detachEvent("onfocus",function(){A._ev("focus",event)});this.contentWindow.document.body.detachEvent("onblur",function(){A._ev("blur",event)});this.contentWindow.document.body.detachEvent("onkeydown",function(){A._ev("keydown",event)});this.contentWindow.document.body.detachEvent("onkeyup",function(){A._ev("keyup",event)});this.contentWindow.document.body.detachEvent("onkeypress",function(){A._ev("keypress",event)});this.contentWindow.document.body.detachEvent("onmouseup",function(){A._ev("mouseup",event)});this.contentWindow.document.body.detachEvent("onmousedown",function(){A._ev("mousedown",event)});this.contentWindow.document.body.detachEvent("onclick",function(){A._ev("click",event)})}}else{var B=this.editor;E.onload=function(){this.contentWindow.addEventListener("focus",function(B){A._ev("focus",B)},false);this.contentWindow.addEventListener("blur",function(B){A._ev("blur",B)},false);this.contentWindow.addEventListener("keydown",function(B){A._ev("keydown",B)},false);this.contentWindow.addEventListener("keyup",function(B){A._ev("keyup",B)},false);this.contentWindow.addEventListener("keypress",function(B){A._ev("keypress",B)},false);this.contentWindow.addEventListener("mouseup",function(B){A._ev("mouseup",B)},false);this.contentWindow.addEventListener("mousedown",function(B){A._ev("mousedown",B)},false);this.contentWindow.addEventListener("click",function(B){A._ev("click",B)},false)};E.onunload=function(){this.contentWindow.removeEventListener("focus",function(B){A._ev("focus",B)},false);this.contentWindow.removeEventListener("blur",function(B){A._ev("blur",B)},false);this.contentWindow.removeEventListener("keydown",function(B){A._ev("keydown",B)},false);this.contentWindow.removeEventListener("keyup",function(B){A._ev("keyup",B)},false);this.contentWindow.removeEventListener("keypress",function(B){A._ev("keypress",B)},false);this.contentWindow.removeEventListener("mouseup",function(B){A._ev("mouseup",B)},false);this.contentWindow.removeEventListener("mousedown",function(B){A._ev("mousedown",B)},false);this.contentWindow.removeEventListener("click",function(B){A._ev("click",B)},false)}}this._ev=function(B,A){this.callEvent("onAccess",[B,A])};this._focus=function(){if(_isIE)this.editor.contentWindow.document.body.focus();else this.editor.contentWindow.focus()};this.base.attachObject(this.editor);this.edWin=this.editor.contentWindow;this.edDoc=this.edWin.document;this._prepareContent=function(C,E){var D="";if(C===true&&this.getContent!=null)D=this.getContent();var A=this.editor.contentWindow.document;A.open("text/html","replace");if(_isOpera)A.write("<html><head><style> html, body {overflow:auto;-webkit-overflow-scrolling: touch;padding:0px;padding-left:1px !important;height:100%;margin:0px;font-family:Tahoma;font-size:10pt;background-color:#ffffff;}</style></head><body "+(E!==true?"contenteditable='true'":"")+" tabindex='0'></body></html>");else if(window._KHTMLrv)A.write("<html><head><style> html {overflow-x: auto;-webkit-overflow-scrolling: touch;overflow-y: auto;}body {overflow: auto;overflow-y: scroll;}html,body {padding:0px;padding-left:1px !important;height:100%;margin:0px;font-family:Tahoma;font-size:10pt;background-color:#ffffff;}</style></head><body "+(E!==true?"contenteditable='true'":"")+" tabindex='0'></body></html>");else if(_isIE)A.write("<html><head><style> html {overflow-y: auto;}body {overflow-y: scroll;-webkit-overflow-scrolling: touch;}html,body {overflow-x: auto;padding:0px;padding-left:1px !important;height:100%;margin:0px;font-family:Tahoma;font-size:10pt;background-color:#ffffff;}</style></head><body "+(E!==true?"contenteditable='true'":"")+" tabindex='0'></body></html>");else A.write("<html><head><style> html,body {overflow-x: auto;overflow-y:-webkit-overflow-scrolling: touch;scroll;padding:0px;padding-left:1px !important;height:100%;margin:0px;font-family:Tahoma;font-size:10pt;background-color:#ffffff;}</style></head><body "+(E!==true?"contenteditable='true'":"")+" tabindex='0'></body></html>");A.close();if(_isIE)A.contentEditable=(E!==true);else A.designMode=(E!==true?"On":"Off");if(_isFF){try{A.execCommand("useCSS",false,true)}catch(B){}}if(C===true&&this.setContent!=null)this.setContent(D)};this._prepareContent();this.setIconsPath=function(){};this.init=function(){};this.setSizes=function(){var A=(this._isToolbar?0:this.base.childNodes[0].offsetHeight);this.base.adjustContent(this.base,A)};this._resizeTM=null;this._resizeTMTime=100;this._doOnResize=function(){window.clearTimeout(A._resizeTM);A._resizeTM=window.setTimeout(function(){if(A.setSizes)A.setSizes()},A._resizeTMTime)};this._doOnUnload=function(){window.detachEvent("onresize",this._doOnResize);window.removeEventListener("resize",this._doOnResize,false)};dhtmlxEvent(window,"resize",this._doOnResize);this.base.childNodes[0].onselectstart=function(A){A=A||event;A.cancelBubble=true;A.returnValue=false;if(A.preventDefault)A.preventDefault();return false};for(var C=0;C<this.base.childNodes[0].childNodes.length-2;C++){this.base.childNodes[0].childNodes[C].childNodes[0].onmousedown=function(C){var B=this.getAttribute("cmd");if(typeof A[B]=="function"){A[B]();A.callEvent("onToolbarClick",[this.getAttribute("actv")])}return false};this.base.childNodes[0].childNodes[C].childNodes[0].onclick=function(A){return false}}this.runCommand=function(D,C){if(this._roMode===true)return;if(arguments.length<2)C=null;if(_isIE)this.edWin.focus();try{var A=this.editor.contentWindow.document;A.execCommand(D,false,C)}catch(B){}if(_isIE){this.edWin.focus();var E=this;window.setTimeout(function(){E.edWin.focus()},1)}};this.applyBold=function(){this.runCommand("Bold")};this.applyItalic=function(){this.runCommand("Italic")};this.applyUnderscore=function(){this.runCommand("Underline")};this.clearFormatting=function(){this.runCommand("RemoveFormat")};if(this._isToolbar)this.initDhtmlxToolbar();dhtmlxEventable(this);dhtmlxEvent(this.edDoc,"click",function(C){var B=C||window.event,D=B.target||B.srcElement;A.showInfo(D)});if(_isOpera)dhtmlxEvent(this.edDoc,"mousedown",function(C){var B=C||window.event,D=B.target||B.srcElement;A.showInfo(D)});dhtmlxEvent(this.edDoc,"keyup",function(C){var B=C||window.event,E=B.keyCode,D=B.target||B.srcElement;if((E==37)||(E==38)||(E==39)||(E==40)||(E==13))A.showInfo(D)});this.attachEvent("onFocusChanged",function(B){if(A._doOnFocusChanged)A._doOnFocusChanged(B)});this.showInfo=function(B){var B=(this.getSelectionBounds().end)?this.getSelectionBounds().end:B;if(!B)return;try{if(this.edWin.getComputedStyle){var D=this.edWin.getComputedStyle(B,null),C=((D.getPropertyValue("font-weight")==401)?700:D.getPropertyValue("font-weight"));this.style={fontStyle:D.getPropertyValue("font-style"),fontSize:D.getPropertyValue("font-size"),textDecoration:D.getPropertyValue("text-decoration"),fontWeight:C,fontFamily:D.getPropertyValue("font-family"),textAlign:D.getPropertyValue("text-align")};if(window._KHTMLrv){this.style.fontStyle=D.getPropertyValue("font-style");this.style.vAlign=D.getPropertyValue("vertical-align");this.style.del=this.isStyleProperty(B,"span","textDecoration","line-through");this.style.u=this.isStyleProperty(B,"span","textDecoration","underline")}}else{D=B.currentStyle;this.style={fontStyle:D.fontStyle,fontSize:D.fontSize,textDecoration:D.textDecoration,fontWeight:D.fontWeight,fontFamily:D.fontFamily,textAlign:D.textAlign}}this.setStyleProperty(B,"h1");this.setStyleProperty(B,"h2");this.setStyleProperty(B,"h3");this.setStyleProperty(B,"h4");if(!window._KHTMLrv){this.setStyleProperty(B,"del");this.setStyleProperty(B,"sub");this.setStyleProperty(B,"sup");this.setStyleProperty(B,"u")}this.callEvent("onFocusChanged",[this.style,D])}catch(A){return null}};this.getSelectionBounds=function(){var A,C,B,G;if(this.edWin.getSelection){var F=this.edWin.getSelection();A=F.getRangeAt(F.rangeCount-1);B=A.startContainer;G=A.endContainer;C=A.commonAncestorContainer;if(B.nodeName=="#text")C=C.parentNode;if(B.nodeName=="#text")B=B.parentNode;if(B.nodeName.toLowerCase()=="body")B=B.firstChild;if(G.nodeName=="#text")G=G.parentNode;if(G.nodeName.toLowerCase()=="body")G=G.lastChild;if(B==G)C=B;return{root:C,start:B,end:G}}else if(this.edWin.document.selection){A=this.edDoc.selection.createRange();if(!A.duplicate)return null;C=A.parentElement();var D=A.duplicate(),E=A.duplicate();D.collapse(true);E.moveToElementText(D.parentElement());E.setEndPoint("EndToStart",D);B=D.parentElement();D=A.duplicate();E=A.duplicate();E.collapse(false);D.moveToElementText(E.parentElement());D.setEndPoint("StartToEnd",E);G=E.parentElement();if(B.nodeName.toLowerCase()=="body")B=B.firstChild;if(G.nodeName.toLowerCase()=="body")G=G.lastChild;if(B==G)C=B;return{root:C,start:B,end:G}}return null};this.getContent=function(){if(!this.edDoc.body)return"";else{if(_isFF)return this.editor.contentWindow.document.body.innerHTML.replace(/<\/{0,}br\/{0,}>\s{0,}$/gi,"");if(_isIE&&this.edDoc.body.innerText.length==0)return"";return this.edDoc.body.innerHTML}};this.setContent=function(B){B=B||"";if(this.edDoc.body){if(navigator.userAgent.indexOf("Firefox")!=-1){if(typeof(this._ffTest)=="undefined"){this.editor.contentWindow.document.body.innerHTML="";this.runCommand("InsertHTML","test");this._ffTest=(this.editor.contentWindow.document.body.innerHTML.length>0)}if(this._ffTest)this.editor.contentWindow.document.body.innerHTML=B;else{this.editor.contentWindow.document.body.innerHTML="";if(B.length==0)B=" ";this.runCommand("InsertHTML",B)}}else this.editor.contentWindow.document.body.innerHTML=B;this.callEvent("onContentSet",[])}else dhtmlxEvent(this.edWin,"load",function(C){A.setContent(B)})};this.setContentHTML=function(A){(new dtmlXMLLoaderObject(this._ajaxOnLoad,this,false,true)).loadXML(A)};this._ajaxOnLoad=function(E,D,A,B,C){if(C.xmlDoc.responseText)E.setContent(C.xmlDoc.responseText)}}function dhtmlXContainerLite(B){var A=this;this.obj=B;this.dhxcont=null;this.setContent=function(A){this.dhxcont=A;this.dhxcont.innerHTML="<div style='position: relative;left: 0px;top: 0px;overflow: hidden;'></div>";this.dhxcont.mainCont=this.dhxcont.childNodes[0];this.obj.dhxcont=this.dhxcont};this.obj._genStr=function(A){var B="",D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var C=0;C<A;C++)B+=D.charAt(Math.round(Math.random()*(D.length-1)));return B};this.obj.adjustContent=function(I,J,B,F,A){this.dhxcont.style.left=(this._offsetLeft||0)+"px";this.dhxcont.style.top=(this._offsetTop||0)+J+"px";var H=I.clientWidth+(this._offsetWidth||0);if(F!==true)this.dhxcont.style.width=Math.max(0,H)+"px";if(F!==true)if(this.dhxcont.offsetWidth>H)this.dhxcont.style.width=Math.max(0,H*2-this.dhxcont.offsetWidth)+"px";var G=I.clientHeight+(this._offsetHeight||0);this.dhxcont.style.height=Math.max(0,G-J)+(B!=null?B:0)+"px";if(this.dhxcont.offsetHeight>G-J)this.dhxcont.style.height=Math.max(0,(G-J)*2-this.dhxcont.offsetHeight)+"px";if(A)if(!isNaN(A))this.dhxcont.style.height=Math.max(0,parseInt(this.dhxcont.style.height)-A)+"px";if(this._minDataSizeH!=null)if(parseInt(this.dhxcont.style.height)<this._minDataSizeH)this.dhxcont.style.height=this._minDataSizeH+"px";if(this._minDataSizeW!=null)if(parseInt(this.dhxcont.style.width)<this._minDataSizeW)this.dhxcont.style.width=this._minDataSizeW+"px";if(F!==true){this.dhxcont.mainCont.style.width=this.dhxcont.clientWidth+"px";if(this.dhxcont.mainCont.offsetWidth>this.dhxcont.clientWidth)this.dhxcont.mainCont.style.width=Math.max(0,this.dhxcont.clientWidth*2-this.dhxcont.mainCont.offsetWidth)+"px"}var E=(this.menu!=null?(!this.menuHidden?this.menuHeight:0):0),D=(this.toolbar!=null?(!this.toolbarHidden?this.toolbarHeight:0):0),C=(this.sb!=null?(!this.sbHidden?this.sbHeight:0):0);this.dhxcont.mainCont.style.height=this.dhxcont.clientHeight+"px";if(this.dhxcont.mainCont.offsetHeight>this.dhxcont.clientHeight)this.dhxcont.mainCont.style.height=Math.max(0,this.dhxcont.clientHeight*2-this.dhxcont.mainCont.offsetHeight)+"px";this.dhxcont.mainCont.style.height=Math.max(0,parseInt(this.dhxcont.mainCont.style.height)-E-D-C)+"px"};this.obj.attachToolbar=function(){var B=document.createElement("DIV");B.style.position="relative";B.style.overflow="hidden";B.id="dhxtoolbar_"+this._genStr(12);this.dhxcont.insertBefore(B,this.dhxcont.childNodes[(this.menu!=null?1:0)]);this.toolbar=new dhtmlXToolbarObject(B.id,this.skin);if(A.skin=="dhx_web"){this.toolbarHeight=32;this.dhxcont.className="dhtmlx_editor_extended_"+A.skin}else if(A.skin=="dhx_terrace"){if(this._attached){this.toolbarHeight=46;B.style.marginBottom="14px"}else{this.toolbarHeight=34;B.style.marginTop="2px";B.style.marginLeft="2px";B.style.marginBottom="2px"}this.dhxcont.className="dhtmlx_editor_extended_"+A.skin}else this.toolbarHeight=B.offsetHeight+(this._isLayout&&this.skin=="dhx_skyblue"?2:0);this.toolbarId=B.id;if(this._doOnAttachToolbar)this._doOnAttachToolbar("init");this.adjust();return this.toolbar};this.obj.attachObject=function(C,A){if(typeof(C)=="string")C=document.getElementById(C);if(A){C.style.visibility="hidden";C.style.display="";var B=C.offsetWidth,D=C.offsetHeight}this._attachContent("obj",C);if(A&&this._isWindow){C.style.visibility="visible";this._adjustToContent(B,D)}};this.obj.adjust=function(){if(this.skin=="dhx_skyblue")if(this.toolbar){if(this._isWindow||this._isLayout){document.getElementById(this.toolbarId).style.height="29px";this.toolbarHeight=document.getElementById(this.toolbarId).offsetHeight;if(this._doOnAttachToolbar)this._doOnAttachToolbar("show")}if(this._isCell)document.getElementById(this.toolbarId).className+=" in_layoutcell";if(this._isAcc)document.getElementById(this.toolbarId).className+=" in_acccell"}};this.obj._attachContent=function(D,C,B){while(A.dhxcont.mainCont.childNodes.length>0)A.dhxcont.mainCont.removeChild(A.dhxcont.mainCont.childNodes[0]);if(D=="obj"){if(this._isWindow&&C.cmp==null&&this.skin=="dhx_skyblue"){this.dhxcont.mainCont.style.border="#a4bed4 1px solid";this.dhxcont.mainCont.style.backgroundColor="#FFFFFF";this._redraw()}A.dhxcont._frame=null;A.dhxcont.mainCont.appendChild(C);A.dhxcont.mainCont.style.overflow=(B===true?"auto":"hidden");C.style.display=""}};this.obj._dhxContDestruct=function(){while(this.dhxcont.mainCont.childNodes.length>0)this.dhxcont.mainCont.removeChild(this.dhxcont.mainCont.childNodes[0]);this.dhxcont.mainCont.innerHTML="";this.dhxcont.mainCont=null;try{delete this.dhxcont["mainCont"]}catch(A){}while(this.dhxcont.childNodes.length>0)this.dhxcont.removeChild(this.dhxcont.childNodes[0]);this.dhxcont.innerHTML="";this.dhxcont=null;try{delete this["dhxcont"]}catch(A){}this._genStr=null;this._attachContent=null;this._dhxContDestruct=null;this.adjust=null;this.attachObject=null;this.moveContentTo=null;this.adjustContent=null;this.attachToolbar=null}}(function(){dhtmlx.extend_api("dhtmlXEditor",{_init:function(A){return[A.parent,A.skin]},content:"setContent"},{})})();dhtmlXEditor.prototype.unload=function(){if(!this._isToolbar){while(this.base.childNodes[0].childNodes.length>0){if(this.base.childNodes[0].childNodes[0].tagName&&String(this.base.childNodes[0].childNodes[0].tagName).toLowerCase()=="a"){this.base.childNodes[0].childNodes[0].childNodes[0].onclick=null;this.base.childNodes[0].childNodes[0].childNodes[0].onmousedown=null;this.base.childNodes[0].childNodes[0].removeChild(this.base.childNodes[0].childNodes[0].childNodes[0])}this.base.childNodes[0].removeChild(this.base.childNodes[0].childNodes[0])}}else this._unloadExtModule();this.base.childNodes[0].onselectstart=null;this.tbData=null;this.detachAllEvents();if(_isIE)this.editor.onreadystatechange=null;else this.editor.onload=null;this.editor.parentNode.removeChild(this.editor);this.editor.onunload=null;this.editor=null;this.edDoc=null;this.edWin=null;this.base._dhxContDestruct();this.base._idd=null;this.base.name=null;while(this.base.childNodes.length>0)this.base.removeChild(this.base.childNodes[0]);this.base=null;this.cBlock=null;this._isToolbar=null;this._resizeTM=null;this._resizeTMTime=null;this.skin=null;this.iconsPath=null;this._ajaxOnLoad=null;this._ev=null;this._focus=null;this._prepareContent=null;this._doOnResize=null;this._doOnUnload=null;this.setIconsPath=null;this.init=null;this.setSizes=null;this.runCommand=null;this.applyBold=null;this.applyItalic=null;this.applyUnderscore=null;this.clearFormatting=null;this.attachEvent=null;this.callEvent=null;this.checkEvent=null;this.eventCatcher=null;this.detachEvent=null;this.detachAllEvents=null;this.showInfo=null;this.getSelectionBounds=null;this.getContent=null;this.setContent=null;this.setContentHTML=null;this.setReadonly=null;this.isReadonly=null;this.unload=null};dhtmlXEditor.prototype.setReadonly=function(A){this._roMode=(A===true);this._prepareContent(true,this._roMode);this.cBlock.style.display=(this._roMode?"":"none")};dhtmlXEditor.prototype.isReadonly=function(A){return(this._roMode||false)};dhtmlXEditor.prototype.initDhtmlxToolbar=function(){this.tb=this.base.attachToolbar();this.tb.setSkin(this.skin);if(this.skin=="dhx_skyblue"){this.tb.base.style.borderLeft="none";this.tb.base.style.borderRight="none";this.tb.base.style.top="-1px"}this.setSizes();this.tb.setIconsPath(this.iconsPath+"dhxeditor_"+this.skin+"/");this._availFonts=new Array("Arial","Arial Narrow","Comic Sans MS","Courier","Georgia","Impact","Tahoma","Times New Roman","Verdana");this._initFont=this._availFonts[0];this._xmlFonts="";for(var C=0;C<this._availFonts.length;C++){var B=String(this._availFonts[C]).replace(/\s/g,"_");this._xmlFonts+="<item type=\"button\" id=\"applyFontFamily:"+B+"\"><itemText><![CDATA[<img src=\""+this.tb.imagePath+"font_"+String(B).toLowerCase()+".gif\" border=\"0\" style=\"width:110px;height:16px;\">]]></itemText></item>"}this._availSizes={"1":"8pt","2":"10pt","3":"12pt","4":"14pt","5":"18pt","6":"24pt","7":"36pt"};this._xmlSizes="";for(var D in this._availSizes)this._xmlSizes+="<item type=\"button\" id=\"applyFontSize:"+D+":"+this._availSizes[D]+"\" text=\""+this._availSizes[D]+"\"/>";this.tbXML="<toolbar>"+"<item id=\"applyH1\" type=\"buttonTwoState\" img=\"h1.gif\" imgdis=\"h4_dis.gif\" title=\"H1\"/>"+"<item id=\"applyH2\" type=\"buttonTwoState\" img=\"h2.gif\" imgdis=\"h4_dis.gif\" title=\"H2\"/>"+"<item id=\"applyH3\" type=\"buttonTwoState\" img=\"h3.gif\" imgdis=\"h4_dis.gif\" title=\"H3\"/>"+"<item id=\"applyH4\" type=\"buttonTwoState\" img=\"h4.gif\" imgdis=\"h4_dis.gif\" title=\"H4\"/>"+"<item id=\"separ01\" type=\"separator\"/>"+"<item id=\"applyBold\" type=\"buttonTwoState\" img=\"bold.gif\" imgdis=\"bold_dis.gif\" title=\"Bold Text\"/>"+"<item id=\"applyItalic\" type=\"buttonTwoState\" img=\"italic.gif\" imgdis=\"italic_dis.gif\" title=\"Italic Text\"/>"+"<item id=\"applyUnderscore\" type=\"buttonTwoState\" img=\"underline.gif\" imgdis=\"underline_dis.gif\" title=\"Underscore Text\"/>"+"<item id=\"applyStrikethrough\" type=\"buttonTwoState\" img=\"strike.gif\" imgdis=\"strike_dis.gif\" title=\"Strikethrough Text\"/>"+"<item id=\"separ02\" type=\"separator\"/>"+"<item id=\"alignLeft\" type=\"buttonTwoState\" img=\"align_left.gif\" imgdis=\"align_left_dis.gif\" title=\"Left Alignment\"/>"+"<item id=\"alignCenter\" type=\"buttonTwoState\" img=\"align_center.gif\" imgdis=\"align_center_dis.gif\" title=\"Center Alignment\"/>"+"<item id=\"alignRight\" type=\"buttonTwoState\" img=\"align_right.gif\" imgdis=\"align_right_dis.gif\" title=\"Right Alignment\"/>"+"<item id=\"alignJustify\" type=\"buttonTwoState\" img=\"align_justify.gif\" title=\"Justified Alignment\"/>"+"<item id=\"separ03\" type=\"separator\"/>"+"<item id=\"applySub\" type=\"buttonTwoState\" img=\"script_sub.gif\" imgdis=\"script_sub.gif\" title=\"Subscript\"/>"+"<item id=\"applySuper\" type=\"buttonTwoState\" img=\"script_super.gif\" imgdis=\"script_super_dis.gif\" title=\"Superscript\"/>"+"<item id=\"separ04\" type=\"separator\"/>"+"<item id=\"createNumList\" type=\"button\" img=\"list_number.gif\" imgdis=\"list_number_dis.gif\" title=\"Number List\"/>"+"<item id=\"createBulList\" type=\"button\" img=\"list_bullet.gif\" imgdis=\"list_bullet_dis.gif\" title=\"Bullet List\"/>"+"<item id=\"separ05\" type=\"separator\"/>"+"<item id=\"increaseIndent\" type=\"button\" img=\"indent_inc.gif\" imgdis=\"indent_inc_dis.gif\" title=\"Increase Indent\"/>"+"<item id=\"decreaseIndent\" type=\"button\" img=\"indent_dec.gif\" imgdis=\"indent_dec_dis.gif\" title=\"Decrease Indent\"/>"+"<item id=\"separ06\" type=\"separator\"/>"+"<item id=\"clearFormatting\" type=\"button\" img=\"clear.gif\" title=\"Clear Formatting\"/>"+"</toolbar>";this.tb.loadXMLString(this.tbXML);this._checkAlign=function(A){this.tb.setItemState("alignCenter",false);this.tb.setItemState("alignRight",false);this.tb.setItemState("alignJustify",false);this.tb.setItemState("alignLeft",false);if(A)this.tb.setItemState(A,true)};this._checkH=function(A){this.tb.setItemState("applyH1",false);this.tb.setItemState("applyH2",false);this.tb.setItemState("applyH3",false);this.tb.setItemState("applyH4",false);if(A)this.tb.setItemState(A,true)};this._doOnFocusChanged=function(B){if(!B.h1&&!B.h2&&!B.h3&&!B.h4){var A=(String(B.fontWeight).search(/bold/i)!=-1)||(Number(B.fontWeight)>=700);this.tb.setItemState("applyBold",A)}else this.tb.setItemState("applyBold",false);var C="alignLeft";if(String(B.textAlign).search(/center/)!=-1)C="alignCenter";if(String(B.textAlign).search(/right/)!=-1)C="alignRight";if(String(B.textAlign).search(/justify/)!=-1)C="alignJustify";this.tb.setItemState(C,true);this._checkAlign(C);this.tb.setItemState("applyH1",B.h1);this.tb.setItemState("applyH2",B.h2);this.tb.setItemState("applyH3",B.h3);this.tb.setItemState("applyH4",B.h4);if(window._KHTMLrv){B.sub=(B.vAlign=="sub");B.sup=(B.vAlign=="super")}this.tb.setItemState("applyItalic",(B.fontStyle=="italic"));this.tb.setItemState("applyStrikethrough",B.del);this.tb.setItemState("applySub",B.sub);this.tb.setItemState("applySuper",B.sup);this.tb.setItemState("applyUnderscore",B.u)};this._doOnToolbarClick=function(A){var B=String(A).split(":");if(this[B[0]]!=null)if(typeof(this[B[0]])=="function"){this[B[0]](B[1]);this.callEvent("onToolbarClick",[A])}};this._doOnStateChange=function(B,A){this[B]();switch(B){case"alignLeft":case"alignCenter":case"alignRight":case"alignJustify":this._checkAlign(B);break;case"applyH1":case"applyH2":case"applyH3":case"applyH4":this._checkH(B);break}this.callEvent("onToolbarClick",[B])};this._doOnBeforeStateChange=function(B,A){if((B=="alignLeft"||B=="alignCenter"||B=="alignRight"||B=="alignJustify")&&A==true)return false;return true};var A=this;this.tb.attachEvent("onClick",function(B){A._doOnToolbarClick(B)});this.tb.attachEvent("onStateChange",function(B,C){A._doOnStateChange(B,C)});this.tb.attachEvent("onBeforeStateChange",function(B,C){return A._doOnBeforeStateChange(B,C)});this.applyBold=function(){this.runCommand("Bold")};this.applyItalic=function(){this.runCommand("Italic")};this.applyUnderscore=function(){this.runCommand("Underline")};this.applyStrikethrough=function(){this.runCommand("StrikeThrough")};this.alignLeft=function(){this.runCommand("JustifyLeft")};this.alignRight=function(){this.runCommand("JustifyRight")};this.alignCenter=function(){this.runCommand("JustifyCenter")};this.alignJustify=function(){this.runCommand("JustifyFull")};this.applySub=function(){this.runCommand("Subscript")};this.applySuper=function(){this.runCommand("Superscript")};this.applyH1=function(){this.runCommand("FormatBlock","<H1>")};this.applyH2=function(){this.runCommand("FormatBlock","<H2>")};this.applyH3=function(){this.runCommand("FormatBlock","<H3>")};this.applyH4=function(){this.runCommand("FormatBlock","<H4>")};this.createNumList=function(){this.runCommand("InsertOrderedList")};this.createBulList=function(){this.runCommand("InsertUnorderedList")};this.increaseIndent=function(){this.runCommand("Indent")};this.decreaseIndent=function(){this.runCommand("Outdent")};this.clearFormatting=function(){this.runCommand("RemoveFormat");this.tb.setItemState("applyBold",false);this.tb.setItemState("applyItalic",false);this.tb.setItemState("applyStrikethrough",false);this.tb.setItemState("applySub",false);this.tb.setItemState("applySuper",false);this.tb.setItemState("applyUnderscore",false)};this.getParentByTag=function(A,C){C=C.toLowerCase();var B=A;do if(C==""||B.nodeName.toLowerCase()==C)return B;while(B=B.parentNode);return A};this.isStyleProperty=function(A,E,B,D){E=E.toLowerCase();var C=A;do if((C.nodeName.toLowerCase()==E)&&(C.style[B]==D))return true;while(C=C.parentNode);return false};this.setStyleProperty=function(A,C){this.style[C]=false;var B=this.getParentByTag(A,C);if(B&&(B.tagName.toLowerCase()==C))this.style[C]=true;if(C=="del")if(this.getParentByTag(A,"strike")&&(this.getParentByTag(A,"strike").tagName.toLowerCase()=="strike"))this.style.del=true};this._unloadExtModule=function(){this.tb.unload();this.tb=null;this._availFonts=null;this._initFont=null;this._xmlFonts=null;this._availSizes=null;this._xmlSizes=null;this.tbXML=null;this._checkAlign=null;this._checkH=null;this._doOnFocusChanged=null;this._doOnToolbarClick=null;this._doOnStateChange=null;this._doOnBeforeStateChange=null;this.applyBold=null;this.applyItalic=null;this.applyUnderscore=null;this.applyStrikethrough=null;this.alignLeft=null;this.alignRight=null;this.alignCenter=null;this.alignJustify=null;this.applySub=null;this.applySuper=null;this.applyH1=null;this.applyH2=null;this.applyH3=null;this.applyH4=null;this.createNumList=null;this.createBulList=null;this.increaseIndent=null;this.decreaseIndent=null;this.clearFormatting=null;this.getParentByTag=null;this.isStyleProperty=null;this.setStyleProperty=null}};if(!window.dhtmlx)dhtmlx={};dhtmlx.assert=function(B,A){if(!B)dhtmlx.error(A)};dhtmlx.assert_enabled=function(){return false};dhtmlx.assert_event=function(E,C){if(!E._event_check){E._event_check={};E._event_check_size={}}for(var D in C){E._event_check[D.toLowerCase()]=C[D];var B=-1;for(var A in C[D])B++;E._event_check_size[D.toLowerCase()]=B}};dhtmlx.assert_method_info=function(C,B,D,E){var A=[];for(var F=0;F<E.length;F++)A.push(E[F][0]+" : "+E[F][1]+"\n "+E[F][2].describe()+(E[F][3]?";optional":""));return C.name+"."+B+"\n"+D+"\n Arguments:\n - "+A.join("\n - ")};dhtmlx.assert_method=function(B,A){for(var C in A)dhtmlx.assert_method_process(B,C,A[C].descr,A[C].args,(A[C].min||99),A[C].skip)};dhtmlx.assert_method_process=function(D,C,F,G,A,E){var B=D[C];if(!E)D[C]=function(){if(arguments.length!=G.length&&arguments.length<A)dhtmlx.log("warn","Incorrect count of parameters\n"+D[C].describe()+"\n\nExpecting "+G.length+" but have only "+arguments.length);else for(var E=0;E<G.length;E++)if(!G[E][3]&&!G[E][2](arguments[E]))dhtmlx.log("warn","Incorrect method call\n"+D[C].describe()+"\n\nActual value of "+(E+1)+" parameter: {"+(typeof arguments[E])+"}"+arguments[E]);return B.apply(this,arguments)};D[C].describe=function(){return dhtmlx.assert_method_info(D,C,F,G)}};dhtmlx.assert_event_call=function(C,B,A){if(C._event_check)if(!C._event_check[B])dhtmlx.log("warn","Not expected event call :"+B);else if(dhtmlx.isNotDefined(A))dhtmlx.log("warn","Event without parameters :"+B);else if(C._event_check_size[B]!=A.length)dhtmlx.log("warn","Incorrect event call, expected "+C._event_check_size[B]+" parameter(s), but have "+A.length+" parameter(s), for "+B+" event")};dhtmlx.assert_event_attach=function(B,A){if(B._event_check&&!B._event_check[A])dhtmlx.log("warn","Unknown event name: "+A)};dhtmlx.assert_property=function(B,A){if(!B._settings_check)B._settings_check={};dhtmlx.extend(B._settings_check,A)};dhtmlx.assert_check=function(A,B){if(typeof A=="object")for(var C in A)dhtmlx.assert_settings(C,A[C],B)};dhtmlx.assert_settings=function(H,D,F){F=F||this._settings_check;if(F){if(!F[H])return dhtmlx.log("warn","Unknown propery: "+H);var E="",B="",A=false;for(var G=0;G<F[H].length;G++){var C=F[H][G];if(typeof C=="string")continue;if(typeof C=="function")A=A||C(D);else if(typeof C=="object"&&typeof C[1]=="function"){A=A||C[1](D);if(A&&C[2])dhtmlx["assert_check"](D,C[2])}if(A)break}if(!A)dhtmlx.log("warn","Invalid configuration\n"+dhtmlx.assert_info(H,F)+"\nActual value: {"+(typeof D)+"}"+D)}};dhtmlx.assert_info=function(D,C){var B=C[D],E="",A=[];for(var F=0;F<B.length;F++)if(typeof rule=="string")E=B[F];else if(B[F].describe)A.push(B[F].describe());else if(B[F][1]&&B[F][1].describe)A.push(B[F][1].describe());return"Property: "+D+", "+E+" \nExpected value: \n - "+A.join("\n - ")};if(dhtmlx.assert_enabled()){dhtmlx.assert_rule_color=function(A){if(typeof A!="string")return false;if(A.indexOf("#")!==0)return false;if(A.substr(1).replace(/[0-9A-F]/gi,"")!=="")return false;return true};dhtmlx.assert_rule_color.describe=function(){return"{String}Value must start from # and contain hexadecimal code of color"};dhtmlx.assert_rule_template=function(A){if(typeof A=="function")return true;if(typeof A=="string")return true;return false};dhtmlx.assert_rule_template.describe=function(){return"{Function},{String}Value must be a function which accepts data object and return text string, or a sting with optional template markers"};dhtmlx.assert_rule_boolean=function(A){if(typeof A=="boolean")return true;return false};dhtmlx.assert_rule_boolean.describe=function(){return"{Boolean}true or false"};dhtmlx.assert_rule_object=function(B,A){if(typeof B=="object")return true;return false};dhtmlx.assert_rule_object.describe=function(){return"{Object}Configuration object"};dhtmlx.assert_rule_string=function(A){if(typeof A=="string")return true;return false};dhtmlx.assert_rule_string.describe=function(){return"{String}Plain string"};dhtmlx.assert_rule_htmlpt=function(A){return!!dhtmlx.toNode(A)};dhtmlx.assert_rule_htmlpt.describe=function(){return"{Object},{String}HTML node or ID of HTML Node"};dhtmlx.assert_rule_notdocumented=function(A){return false};dhtmlx.assert_rule_notdocumented.describe=function(){return"This options wasn't documented"};dhtmlx.assert_rule_key=function(B){var A=function(A){return B[A]};A.describe=function(){var A=[];for(var C in B)A.push(C);return"{String}can take one of next values: "+A.join(", ")};return A};dhtmlx.assert_rule_dimension=function(A){if(A*1==A&&!isNaN(A)&&A>=0)return true;return false};dhtmlx.assert_rule_dimension.describe=function(){return"{Integer}value must be a positive number"};dhtmlx.assert_rule_number=function(A){if(typeof A=="number")return true;return false};dhtmlx.assert_rule_number.describe=function(){return"{Integer}value must be a number"};dhtmlx.assert_rule_function=function(A){if(typeof A=="function")return true;return false};dhtmlx.assert_rule_function.describe=function(){return"{Function}value must be a custom function"};dhtmlx.assert_rule_any=function(A){return true};dhtmlx.assert_rule_any.describe=function(){return"Any value"};dhtmlx.assert_rule_mix=function(C,B){var A=function(A){if(C(A)||B(A))return true;return false};A.describe=function(){return C.describe()};return A}}dhtmlx.version="3.0";dhtmlx.codebase="./";dhtmlx.copy=function(B){var A=dhtmlx.copy._function;A.prototype=B;return new A()};dhtmlx.copy._function=function(){};dhtmlx.extend=function(B,A){for(var C in A)B[C]=A[C];if(dhtmlx.assert_enabled()&&A._assert){B._assert();B._assert=null}dhtmlx.assert(B,"Invalid nesting target");dhtmlx.assert(A,"Invalid nesting source");if(A._init)B._init();return B};dhtmlx.proto_extend=function(){var B=arguments,D=B[0],C=[];for(var F=B.length-1;F>0;F--){if(typeof B[F]=="function")B[F]=B[F].prototype;for(var E in B[F])if(E=="_init")C.push(B[F][E]);else if(!D[E])D[E]=B[F][E]}if(B[0]._init)C.push(B[0]._init);D._init=function(){for(var A=0;A<C.length;A++)C[A].apply(this,arguments)};D.base=B[1];var A=function(A){this._init(A);if(this._parseSettings)this._parseSettings(A,this.defaults)};A.prototype=D;D=B=null;return A};dhtmlx.bind=function(B,A){return function(){return B.apply(A,arguments)}};dhtmlx.require=function(A){if(!dhtmlx._modules[A]){dhtmlx.assert(dhtmlx.ajax,"load module is required");dhtmlx.exec(dhtmlx.ajax().sync().get(dhtmlx.codebase+A).responseText);dhtmlx._modules[A]=true}};dhtmlx._modules={};dhtmlx.exec=function(A){if(window.execScript)window.execScript(A);else window.eval(A)};dhtmlx.methodPush=function(C,B,A){return function(){var A=false;A=C[B].apply(C,arguments);return A}};dhtmlx.isNotDefined=function(A){return typeof A=="undefined"};dhtmlx.delay=function(B,A,D,C){setTimeout(function(){var C=B.apply(A,D);B=A=D=null;return C},C||1)};dhtmlx.uid=function(){if(!this._seed)this._seed=(new Date).valueOf();this._seed++;return this._seed};dhtmlx.toNode=function(A){if(typeof A=="string")return document.getElementById(A);return A};dhtmlx.toArray=function(A){return dhtmlx.extend((A||[]),dhtmlx.PowerArray)};dhtmlx.toFunctor=function(str){return(typeof(str)=="string")?eval(str):str};dhtmlx._events={};dhtmlx.event=function(B,C,E,D){B=dhtmlx.toNode(B);var A=dhtmlx.uid();dhtmlx._events[A]=[B,C,E];if(D)E=dhtmlx.bind(E,D);if(B.addEventListener)B.addEventListener(C,E,false);else if(B.attachEvent)B.attachEvent("on"+C,E);return A};dhtmlx.eventRemove=function(A){if(!A)return;dhtmlx.assert(this._events[A],"Removing non-existing event");var B=dhtmlx._events[A];if(B[0].removeEventListener)B[0].removeEventListener(B[1],B[2],false);else if(B[0].detachEvent)B[0].detachEvent("on"+B[1],B[2]);delete this._events[A]};dhtmlx.log=function(C,A,B){if(window.console&&console.log){C=C.toLowerCase();if(window.console[C])window.console[C](A||"unknown error");else window.console.log(C+": "+A);if(B)window.console.log(B)}};dhtmlx.log_full_time=function(A){dhtmlx._start_time_log=new Date();dhtmlx.log("Info","Timing start ["+A+"]");window.setTimeout(function(){var B=new Date();dhtmlx.log("Info","Timing end ["+A+"]:"+(B.valueOf()-dhtmlx._start_time_log.valueOf())/1000+"s")},1)};dhtmlx.log_time=function(B){var C="_start_time_log"+B;if(!dhtmlx[C]){dhtmlx[C]=new Date();dhtmlx.log("Info","Timing start ["+B+"]")}else{var A=new Date();dhtmlx.log("Info","Timing end ["+B+"]:"+(A.valueOf()-dhtmlx[C].valueOf())/1000+"s");dhtmlx[C]=null}};dhtmlx.error=function(A,B){dhtmlx.log("error",A,B)};dhtmlx.EventSystem={_init:function(){this._events={};this._handlers={};this._map={}},block:function(){this._events._block=true},unblock:function(){this._events._block=false},mapEvent:function(A){dhtmlx.extend(this._map,A)},callEvent:function(D,C){if(this._events._block)return true;D=D.toLowerCase();dhtmlx.assert_event_call(this,D,C);var B=this._events[D.toLowerCase()],A=true;if(dhtmlx.debug)dhtmlx.log("info","["+this.name+"] event:"+D,C);if(B)for(var E=0;E<B.length;E++)if(B[E].apply(this,(C||[]))===false)A=false;if(this._map[D]&&!this._map[D].callEvent(D,C))A=false;return A},attachEvent:function(C,D,A){C=C.toLowerCase();dhtmlx.assert_event_attach(this,C);A=A||dhtmlx.uid();D=dhtmlx.toFunctor(D);var B=this._events[C]||dhtmlx.toArray();B.push(D);this._events[C]=B;this._handlers[A]={f:D,t:C};return A},detachEvent:function(A){if(this._handlers[A]){var C=this._handlers[A].t,D=this._handlers[A].f,B=this._events[C];B.remove(D);delete this._handlers[A]}}};dhtmlx.PowerArray={removeAt:function(B,A){if(B>=0)this.splice(B,(A||1))},remove:function(A){this.removeAt(this.find(A))},insertAt:function(B,C){if(!C&&C!==0)this.push(B);else{var A=this.splice(C,(this.length-C));this[C]=B;this.push.apply(this,A)}},find:function(A){for(i=0;i<this.length;i++)if(A==this[i])return i;return-1},each:function(A,B){for(var C=0;C<this.length;C++)A.call((B||this),this[C])},map:function(A,B){for(var C=0;C<this.length;C++)this[C]=A.call((B||this),this[C]);return this}};dhtmlx.env={};if(navigator.userAgent.indexOf("Opera")!=-1)dhtmlx._isOpera=true;else{dhtmlx._isIE=!!document.all;dhtmlx._isFF=!document.all;dhtmlx._isWebKit=(navigator.userAgent.indexOf("KHTML")!=-1);if(navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat")dhtmlx._isIE=8;if(navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat")dhtmlx._isIE=9}dhtmlx.env={};(function(){dhtmlx.env.transform=false;dhtmlx.env.transition=false;var D={};D.names=["transform","transition"];D.transform=["transform","WebkitTransform","MozTransform","oTransform","msTransform"];D.transition=["transition","WebkitTransition","MozTransition","oTransition"];var A=document.createElement("DIV"),B;for(var C=0;C<D.names.length;C++)while(p=D[D.names[C]].pop())if(typeof A.style[p]!="undefined")dhtmlx.env[D.names[C]]=true})();dhtmlx.env.transform_prefix=(function(){var A;if(dhtmlx._isOpera)A="-o-";else{A="";if(dhtmlx._isFF)A="-moz-";if(dhtmlx._isWebKit)A="-webkit-"}return A})();dhtmlx.env.svg=(function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")})();dhtmlx.zIndex={drag:10000};dhtmlx.html={create:function(C,B,D){B=B||{};var A=document.createElement(C);for(var E in B)A.setAttribute(E,B[E]);if(B.style)A.style.cssText=B.style;if(B["class"])A.className=B["class"];if(D)A.innerHTML=D;return A},getValue:function(A){A=dhtmlx.toNode(A);if(!A)return"";return dhtmlx.isNotDefined(A.value)?A.innerHTML:A.value},remove:function(A){if(A instanceof Array){for(var B=0;B<A.length;B++)this.remove(A[B])}else if(A&&A.parentNode)A.parentNode.removeChild(A)},insertBefore:function(A,B,C){if(!A)return;if(B)B.parentNode.insertBefore(A,B);else C.appendChild(A)},locate:function(B,A){B=B||event;var D=B.target||B.srcElement;while(D){if(D.getAttribute){var C=D.getAttribute(A);if(C)return C}D=D.parentNode}return null},offset:function(A){if(A.getBoundingClientRect){var I=A.getBoundingClientRect(),B=document.body,E=document.documentElement,G=window.pageYOffset||E.scrollTop||B.scrollTop,F=window.pageXOffset||E.scrollLeft||B.scrollLeft,C=E.clientTop||B.clientTop||0,D=E.clientLeft||B.clientLeft||0,J=I.top+G-C,H=I.left+F-D;return{y:Math.round(J),x:Math.round(H)}}else{J=0,H=0;while(A){J=J+parseInt(A.offsetTop,10);H=H+parseInt(A.offsetLeft,10);A=A.offsetParent}return{y:J,x:H}}},pos:function(B){B=B||event;if(B.pageX||B.pageY)return{x:B.pageX,y:B.pageY};var A=((dhtmlx._isIE)&&(document.compatMode!="BackCompat"))?document.documentElement:document.body;return{x:B.clientX+A.scrollLeft-A.clientLeft,y:B.clientY+A.scrollTop-A.clientTop}},preventEvent:function(A){if(A&&A.preventDefault)A.preventDefault();dhtmlx.html.stopEvent(A)},stopEvent:function(A){(A||event).cancelBubble=true;return false},addCss:function(A,B){A.className+=" "+B},removeCss:function(A,B){A.className=A.className.replace(RegExp(B,"g"),"")}};(function(){var A=document.getElementsByTagName("SCRIPT");dhtmlx.assert(A.length,"Can't locate codebase");if(A.length){A=(A[A.length-1].getAttribute("src")||"").split("/");A.splice(A.length-1,1);dhtmlx.codebase=A.slice(0,A.length).join("/")+"/"}})();if(!dhtmlx.ui)dhtmlx.ui={};dhtmlx.Destruction={_init:function(){dhtmlx.destructors.push(this)},destructor:function(){this.destructor=function(){};this._htmlmap=null;this._htmlrows=null;if(this._html)document.body.appendChild(this._html);this._html=null;if(this._obj){this._obj.innerHTML="";this._obj._htmlmap=null}this._obj=this._dataobj=null;this.data=null;this._events=this._handlers={}}};dhtmlx.destructors=[];dhtmlx.event(window,"unload",function(){for(var C=0;C<dhtmlx.destructors.length;C++)dhtmlx.destructors[C].destructor();dhtmlx.destructors=[];for(var B in dhtmlx._events){var A=dhtmlx._events[B];if(A[0].removeEventListener)A[0].removeEventListener(A[1],A[2],false);else if(A[0].detachEvent)A[0].detachEvent("on"+A[1],A[2]);delete dhtmlx._events[B]}});dhtmlx.math={};dhtmlx.math._toHex=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];dhtmlx.math.toHex=function(B,A){B=parseInt(B,10);str="";while(B>0){str=this._toHex[B%16]+str;B=Math.floor(B/16)}while(str.length<A)str="0"+str;return str};dhtmlx.math.hexToDec=function(A){return parseInt(A,16)};dhtmlx.math.toRgb=function(E){var C,A,B,D;if(typeof(E)!="string"){C=E[0];A=E[1];B=E[2]}else if(E.indexOf("rgb")!=-1){D=E.substr(E.indexOf("(")+1,E.lastIndexOf(")")-E.indexOf("(")-1).split(",");C=D[0];A=D[1];B=D[2]}else{if(E.substr(0,1)=="#")E=E.substr(1);C=this.hexToDec(E.substr(0,2));A=this.hexToDec(E.substr(2,2));B=this.hexToDec(E.substr(4,2))}C=(parseInt(C,10)||0);A=(parseInt(A,10)||0);B=(parseInt(B,10)||0);if(C<0||C>255)C=0;if(A<0||A>255)A=0;if(B<0||B>255)B=0;return[C,A,B]};dhtmlx.math.hsvToRgb=function(K,F,C){var J,A,I,H,D,G,B,E;J=Math.floor((K/60))%6;A=K/60-J;I=C*(1-F);H=C*(1-A*F);D=C*(1-(1-A)*F);G=0;B=0;E=0;switch(J){case 0:G=C;B=D;E=I;break;case 1:G=H;B=C;E=I;break;case 2:G=I;B=C;E=D;break;case 3:G=I;B=H;E=C;break;case 4:G=D;B=I;E=C;break;case 5:G=C;B=I;E=H;break}G=Math.floor(G*255);B=Math.floor(B*255);E=Math.floor(E*255);return[G,B,E]};dhtmlx.math.rgbToHsv=function(G,C,F){var J,I,H,D,A,E,K,B;J=G/255;I=C/255;H=F/255;D=Math.min(J,I,H),A=Math.max(J,I,H);K=0;E=A==0?0:(1-D/A);B=A;if(A==D)K=0;else if(A==J&&I>=H)K=60*(I-H)/(A-D)+0;else if(A==J&&I<H)K=60*(I-H)/(A-D)+360;else if(A==I)K=60*(H-J)/(A-D)+120;else if(A==H)K=60*(J-I)/(A-D)+240;return[K,E,B]};if(!dhtmlx.presets)dhtmlx.presets={};dhtmlx.presets.chart={"simple":{item:{borderColor:"#ffffff",color:"#2b7100",shadow:false,borderWidth:2},line:{color:"#8ecf03",width:2}},"plot":{color:"#1293f8",item:{borderColor:"#636363",borderWidth:1,color:"#ffffff",type:"r",shadow:false},line:{color:"#1293f8",width:2}},"diamond":{color:"#b64040",item:{borderColor:"#b64040",color:"#b64040",type:"d",radius:3,shadow:true},line:{color:"#ff9000",width:2}},"point":{color:"#fe5916",disableLines:true,fill:false,disableItems:false,item:{color:"#feb916",borderColor:"#fe5916",radius:2,borderWidth:1,type:"r"},alpha:1},"line":{line:{color:"#3399ff",width:2},item:{color:"#ffffff",borderColor:"#3399ff",radius:2,borderWidth:2,type:"d"},fill:false,disableItems:false,disableLines:false,alpha:1},"area":{fill:"#3399ff",line:{color:"#3399ff",width:1},disableItems:true,alpha:0.2,disableLines:false},"round":{item:{radius:3,borderColor:"#3f83ff",borderWidth:1,color:"#3f83ff",type:"r",shadow:false,alpha:0.6}},"square":{item:{radius:3,borderColor:"#447900",borderWidth:2,color:"#69ba00",type:"s",shadow:false,alpha:1}},"column":{color:"RAINBOW",gradient:false,width:45,radius:0,alpha:1,border:true},"stick":{width:5,gradient:false,color:"#67b5c9",radius:2,alpha:1,border:false},"alpha":{color:"#b9a8f9",width:70,gradient:"falling",radius:0,alpha:0.5,border:true}};dhtmlx.ui.Map=function(A){this.name="Map";this._id="map_"+dhtmlx.uid();this._key=A;this._map=[]};dhtmlx.ui.Map.prototype={addRect:function(A,C,B){this._createMapArea(A,"RECT",C,B)},addPoly:function(A,B){this._createMapArea(A,"POLY",B)},_createMapArea:function(A,D,C,B){var E="";if(arguments.length==4)E="userdata='"+B+"'";this._map.push("<area "+this._key+"='"+A+"' shape='"+D+"' coords='"+C.join()+"' "+E+"></area>")},addSector:function(A,C,D,I,G,E,B){var F=[];F.push(I);F.push(Math.floor(G*B));for(var H=C;H<D;H+=Math.PI/18){F.push(Math.floor(I+E*Math.cos(H)));F.push(Math.floor((G+E*Math.sin(H))*B))}F.push(Math.floor(I+E*Math.cos(D)));F.push(Math.floor((G+E*Math.sin(D))*B));F.push(I);F.push(Math.floor(G*B));return this.addPoly(A,F)},render:function(B){var A=dhtmlx.html.create("DIV");A.style.cssText="position:absolute;width:100%;height:100%;top:0px;left:0px;";B.appendChild(A);var C=dhtmlx._isIE?"":"src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='";A.innerHTML="<map id='"+this._id+"' name='"+this._id+"'>"+this._map.join("\n")+"</map><img "+C+" class='dhx_map_img' usemap='#"+this._id+"'>";B._htmlmap=A;this._map=[]}};dhtmlx.chart={};dhtmlx.chart.scatter={pvt_render_scatter:function(E,D,H,I,G,C){if(!this._settings.xValue)return dhtmlx.log("warning","Undefined propery: xValue");var A=this._getLimits(),B=this._getLimits("h","xValue");if(!G){this._drawYAxis(E,D,H,I,A.min,A.max);this._drawHXAxis(E,D,H,I,B.min,B.max)}A={min:this._settings.yAxis.start,max:this._settings.yAxis.end};B={min:this._settings.xAxis.start,max:this._settings.xAxis.end};var F=this._getScatterParams(E,D,H,I,B,A);for(var J=0;J<D.length;J++)this._drawScatterItem(E,C,H,I,F,B,A,D[J],G)},_getScatterParams:function(D,C,F,G,B,A){var E={};E.totalHeight=G.y-F.y;E.totalWidth=G.x-F.x;this._calcScatterUnit(E,B.min,B.max,E.totalWidth,"X");this._calcScatterUnit(E,A.min,A.max,E.totalHeight,"Y");return E},_drawScatterItem:function(F,G,K,L,B,E,D,I,J){var C=this._calculateScatterItemPosition(B,L,K,E,I,"X"),A=this._calculateScatterItemPosition(B,K,L,D,I,"Y");this._drawItemOfLineChart(F,C,A,I,1);var H=this._settings,M=(H.eventRadius||Math.floor(H.item.radius+1));G.addRect(I.id,[C-M,A-M,C+M,A+M],J)},_calculateScatterItemPosition:function(H,I,J,B,G,A){var F=this._settings[A=="X"?"xValue":"value"].call(this,G),E=H["valueFactor"+A],D=(parseFloat(F||0)-B.min)*E,C=H["unit"+A],K=J[A.toLowerCase()]-(A=="X"?(-1):1)*Math.floor(C*D);if(D<0)K=J[A.toLowerCase()];if(F>B.max)K=I[A.toLowerCase()];if(F<B.min)K=J[A.toLowerCase()];return K},_calcScatterUnit:function(E,B,D,F,A){var C=this._getRelativeValue(B,D);A=(A||"");E["relValue"+A]=C[0];E["valueFactor"+A]=C[1];E["unit"+A]=(E["relValue"+A]?F/E["relValue"+A]:10)}};dhtmlx.chart.radar={pvt_render_radar:function(C,B,F,E,D,A){this._renderRadarChart(C,B,F,E,D,A)},_renderRadarChart:function(H,C,L,M,K,I){if(!C.length)return;var G=this._getPieParameters(L,M),J=(this._settings.radius?this._settings.radius:G.radius),E=(this._settings.x?this._settings.x:G.x),B=(this._settings.y?this._settings.y:G.y),A=[];for(var F=0;F<C.length;F++)A.push(1);var D=this._getRatios(A,C.length);if(!K)this._drawRadarAxises(H,D,E,B,J,C);this._drawRadarData(H,D,E,B,J,C,K,I)},_drawRadarData:function(I,Q,b,a,V,B,X,H){var F,G,Z,L,R,M,P,E,D,T,W,Y,O,A,J,U,C,N,S,K;L=this._settings;M=L.yAxis.start;P=L.yAxis.end;K=this._getRelativeValue(M,P);O=K[0];S=(O?V/O:V/2);N=K[1];A=-Math.PI/2;F=G=A;T=[];for(R=0;R<B.length;R++){if(!C){J=L.value(B[R]);U=(C||(parseFloat(J||0)-M)*N)}else U=C;W=Math.floor(S*U);J=L.value((R!=(B.length-1))?B[R+1]:B[0]);C=(parseFloat(J||0)-M)*N;Y=Math.floor(S*C);F=G;G=((R!=(B.length-1))?(A+Q[R]-0.0001):A);E=(D||this._getPositionByAngle(F,b,a,W));D=this._getPositionByAngle(G,b,a,Y);Z=(L.eventRadius||(parseInt(L.item.radius.call(this,B[R]),10)+L.item.borderWidth));H.addRect(B[R].id,[E.x-Z,E.y-Z,E.x+Z,E.y+Z],X);T.push(E)}if(L.fill)this._fillRadarChart(I,T,B);if(!L.disableLines)this._strokeRadarChart(I,T,B);if(!L.disableItems)this._drawRadarItemMarkers(I,T,B);T=null},_drawRadarItemMarkers:function(B,C,A){for(var D=0;D<C.length;D++)this._drawItemOfLineChart(B,C[D].x,C[D].y,A[D])},_fillRadarChart:function(D,E,C){var B,A;D.globalAlpha=this._settings.alpha.call(this,{});D.beginPath();for(var F=0;F<E.length;F++){D.fillStyle=this._settings.fill.call(this,C[F]);B=E[F];A=(E[F+1]||E[0]);if(!F)D.moveTo(B.x,B.y);D.lineTo(A.x,A.y)}D.fill();D.globalAlpha=1},_strokeRadarChart:function(D,E,C){var B,A;for(var F=0;F<E.length;F++){B=E[F];A=(E[F+1]||E[0]);this._drawLine(D,B.x,B.y,A.x,A.y,this._settings.line.color.call(this,C[F]),this._settings.line.width)}},_drawRadarAxises:function(J,Q,a,Z,X,B){var F=this._settings.yAxis,H=this._settings.xAxis,V=F.start,M=F.end,Y=F.step,O={},K=this._settings.configYAxis;if(typeof K.step=="undefined"||typeof K.start=="undefined"||typeof K.end=="undefined"){var N=this._getLimits();O=this._calculateScale(N.min,N.max);V=O.start;M=O.end;Y=O.step;F.end=M;F.start=V}var S=[],T,R,W,P=0,U=X*Y/(M-V),L,C;if(Y<1){L=Math.min(this._log10(Y),(V<=0?0:this._log10(V)));C=Math.pow(10,-L)}var D=[];for(T=M;T>=V;T-=Y){if(O.fixNum)T=parseFloat((new Number(T)).toFixed(O.fixNum));S.push(Math.floor(P*U)+0.5);if(C)T=Math.round(T*C)/C;var I=Z-X+S[S.length-1];this.renderTextAt("middle","left",a,I,F.template(T.toString()),"dhx_axis_item_y dhx_radar");if(Q.length<2){this._drawScaleSector(J,"arc",a,Z,X-S[S.length-1],-Math.PI/2,3*Math.PI/2,T);return}var A=-Math.PI/2,E=A,G;for(R=0;R<Q.length;R++){if(T==M)D.push(E);G=A+Q[R]-0.0001;this._drawScaleSector(J,(K.lineShape||"line"),a,Z,X-S[S.length-1],E,G,T,R,B[T]);E=G}P++}for(T=0;T<D.length;T++){W=this._getPositionByAngle(D[T],a,Z,X);this._drawLine(J,a,Z,W.x,W.y,(H?H.lineColor.call(this,B[T]):"#cfcfcf"),((H&&H.lineWidth)?H.lineWidth.call(this,B[T]):1));this._drawRadarScaleLabel(J,a,Z,X,D[T],(H?H.template.call(this,B[T]):"&nbsp;"))}},_drawScaleSector:function(G,A,L,K,J,H,I,C,B){var D,E;if(J<0)return false;D=this._getPositionByAngle(H,L,K,J);E=this._getPositionByAngle(I,L,K,J);var F=this._settings.yAxis;if(F.bg){G.beginPath();G.moveTo(L,K);if(A=="arc")G.arc(L,K,J,H,I,false);else{G.lineTo(D.x,D.y);G.lineTo(E.x,E.y)}G.fillStyle=F.bg(C,B);G.moveTo(L,K);G.fill();G.closePath()}if(F.lines(C,B)){G.lineWidth=1;G.beginPath();if(A=="arc")G.arc(L,K,J,H,I,false);else{G.moveTo(D.x,D.y);G.lineTo(E.x,E.y)}G.strokeStyle=F.lineColor(C,B);G.stroke()}},_drawRadarScaleLabel:function(K,M,L,J,B,A){var H=this.renderText(0,0,A,"dhx_axis_radar_title",1),C=H.scrollWidth,I=H.offsetHeight,D=0.001,E=this._getPositionByAngle(B,M,L,J+5),F=0,G=0;if(B<0||B>Math.PI)G=-I;if(B>Math.PI/2)F=-C;if(Math.abs(B+Math.PI/2)<D||Math.abs(B-Math.PI/2)<D)F=-C/2;else if(Math.abs(B)<D||Math.abs(B-Math.PI)<D)G=-I/2;H.style.top=E.y+G+"px";H.style.left=E.x+F+"px";H.style.width=C+"px";H.style.whiteSpace="nowrap"}};dhtmlx.chart.area={pvt_render_area:function(H,C,K,L,J,I){var D=this._calculateParametersOfLineChart(H,C,K,L,J),G=(this._settings.eventRadius||Math.floor(D.cellWidth/2));if(C.length){H.globalAlpha=this._settings.alpha.call(this,C[0]);H.fillStyle=this._settings.color.call(this,C[0]);var B=this._getYPointOfLineChart(C[0],K,L,D),E=(this._settings.offset?K.x+D.cellWidth*0.5:K.x);H.beginPath();H.moveTo(E,L.y);H.lineTo(E,B);I.addRect(C[0].id,[E-G,B-G,E+G,B+G],J);if(!this._settings.yAxis)this.renderTextAt(false,(!this._settings.offset?false:true),E,B-this._settings.labelOffset,this._settings.label(C[0]));for(var F=1;F<C.length;F++){var A=E+Math.floor(D.cellWidth*F)-0.5,M=this._getYPointOfLineChart(C[F],K,L,D);H.lineTo(A,M);I.addRect(C[F].id,[A-G,M-G,A+G,M+G],J);if(!this._settings.yAxis)this.renderTextAt(false,(!this._settings.offset&&F==(C.length-1)?"left":"center"),A,M-this._settings.labelOffset,this._settings.label(C[F]))}H.lineTo(E+Math.floor(D.cellWidth*[C.length-1]),L.y);H.lineTo(E,L.y);H.fill()}}};dhtmlx.chart.stackedArea={pvt_render_stackedArea:function(J,B,M,O,L,K){var F=this._calculateParametersOfLineChart(J,B,M,O,L),I=(this._settings.eventRadius||Math.floor(F.cellWidth/2)),C=[];if(B.length){J.globalAlpha=this._settings.alpha.call(this,B[0]);J.fillStyle=this._settings.color.call(this,B[0]);var N=(L?B[0].$startY:O.y),G=(this._settings.offset?M.x+F.cellWidth*0.5:M.x),P=this._getYPointOfLineChart(B[0],M,O,F)-(L?(O.y-N):0);C[0]=P;J.beginPath();J.moveTo(G,N);J.lineTo(G,P);K.addRect(B[0].id,[G-I,P-I,G+I,P+I],L);if(!this._settings.yAxis)this.renderTextAt(false,true,G,P-this._settings.labelOffset,this._settings.label(B[0]));for(var H=1;H<B.length;H++){var A=G+Math.floor(F.cellWidth*H)-0.5,E=this._getYPointOfLineChart(B[H],M,O,F)-(L?(O.y-B[H].$startY):0);C[H]=E;J.lineTo(A,E);K.addRect(B[H].id,[A-I,E-I,A+I,E+I],L);if(!this._settings.yAxis)this.renderTextAt(false,true,A,E-this._settings.labelOffset,this._settings.label(B[H]))}J.lineTo(G+Math.floor(F.cellWidth*[B.length-1]),N);if(L){for(H=B.length-1;H>=0;H--){var A=G+Math.floor(F.cellWidth*H)-0.5,D=B[H].$startY;J.lineTo(A,D)}}else J.lineTo(G+Math.floor(F.cellWidth*(length-1))-0.5,N);J.lineTo(G,N);J.fill();for(H=0;H<B.length;H++)B[H].$startY=C[H]}}};dhtmlx.chart.spline={pvt_render_spline:function(M,C,R,S,Q,N){var K,O,J,L,G,E,P,A,U,H,I,F,T,B,D;E=this._calculateParametersOfLineChart(M,C,R,S,Q);O=this._settings;L=[];if(C.length){H=(O.offset?R.x+E.cellWidth*0.5:R.x);for(J=0;J<C.length;J++){U=((!J)?H:Math.floor(E.cellWidth*J)-0.5+H);T=this._getYPointOfLineChart(C[J],R,S,E);L.push({x:U,y:T})}A=this._getSplineParameters(L);for(J=0;J<L.length;J++){I=L[J].x;B=L[J].y;if(J<L.length-1){F=L[J+1].x;D=L[J+1].y;for(G=I;G<F;G++)this._drawLine(M,G,this._getSplineYPoint(G,I,J,A.a,A.b,A.c,A.d),G+1,this._getSplineYPoint(G+1,I,J,A.a,A.b,A.c,A.d),O.line.color(C[J]),O.line.width);this._drawLine(M,F-1,this._getSplineYPoint(G,I,J,A.a,A.b,A.c,A.d),F,D,O.line.color(C[J]),O.line.width)}this._drawItemOfLineChart(M,I,B,C[J],O.label(C[J]));P=(parseInt(O.item.radius.call(this,C[J-1]),10)||2);K=(O.eventRadius||P+1);N.addRect(C[J].id,[I-K,B-K,I+K,B+K],Q)}}},_getSplineParameters:function(I){var J,K,C,A,E,G,D,F,B,H;J=[];m=[];H=I.length;for(K=0;K<H-1;K++){J[K]=I[K+1].x-I[K].x;m[K]=(I[K+1].y-I[K].y)/J[K]}C=[];A=[];C[0]=0;C[1]=2*(J[0]+J[1]);A[0]=0;A[1]=6*(m[1]-m[0]);for(K=2;K<H-1;K++){C[K]=2*(J[K-1]+J[K])-J[K-1]*J[K-1]/C[K-1];A[K]=6*(m[K]-m[K-1])-J[K-1]*A[K-1]/C[K-1]}E=[];E[H-1]=E[0]=0;for(K=H-2;K>=1;K--)E[K]=(A[K]-J[K]*E[K+1])/C[K];G=[];D=[];F=[];B=[];for(K=0;K<H-1;K++){G[K]=I[K].y;D[K]=-J[K]*E[K+1]/6-J[K]*E[K]/3+(I[K+1].y-I[K].y)/J[K];F[K]=E[K]/2;B[K]=(E[K+1]-E[K])/(6*J[K])}return{a:G,b:D,c:F,d:B}},_getSplineYPoint:function(G,B,F,E,C,D,A){return E[F]+(G-B)*(C[F]+(G-B)*(D[F]+(G-B)*A[F]))}};dhtmlx.chart.barH={pvt_render_barH:function(J,D,L,M,b,I){var N,C,Q,P,V=M.x-L.x,U=!!this._settings.yAxis,B=!!this._settings.xAxis,O=this._getLimits("h");N=O.max;C=O.min;var F=Math.floor((M.y-L.y)/D.length);if(!b)this._drawHScales(J,D,L,M,C,N,F);if(U){N=parseFloat(this._settings.xAxis.end);C=parseFloat(this._settings.xAxis.start)}var R=this._getRelativeValue(C,N);P=R[0];Q=R[1];var W=(P?V/P:10);if(!U){var X=10;W=(P?(V-X)/P:10)}var c=parseInt(this._settings.width,10);if((c*this._series.length+4)>F)c=F/this._series.length-4;var G=Math.floor((F-c*this._series.length)/2),a=(typeof this._settings.radius!="undefined"?parseInt(this._settings.radius,10):Math.round(c/5)),Y=false,d=this._settings.gradient;if(d&&typeof(d)!="function"){Y=d;d=false}else if(d){d=J.createLinearGradient(L.x,L.y,M.x,L.y);this._settings.gradient(d)}var A=0;if(!U)this._drawLine(J,L.x-0.5,L.y,L.x-0.5,M.y,"#000000",1);for(var T=0;T<D.length;T++){var H=parseFloat(this._settings.value(D[T]||0));if(H>N)H=N;H-=C;H*=Q;var E=L.x,S=L.y+G+T*F+(c+1)*b;if((H<0&&this._settings.origin=="auto")||(this._settings.xAxis&&H===0&&!(this._settings.origin!="auto"&&this._settings.origin>C))){this.renderTextAt("middle","right",E+10,S+c/2+G,this._settings.label(D[T]));continue}if(H<0&&this._settings.origin!="auto"&&this._settings.origin>C)H=0;if(!U)H+=X/W;var Z=d||this._settings.color.call(this,D[T]);if(this._settings.border)this._drawBarHBorder(J,E,S,c,C,a,W,H,Z);J.globalAlpha=this._settings.alpha.call(this,D[T]);var K=this._drawBarH(J,L,E,S,c,C,a,W,H,Z,d,Y);if(Y!=false)this._drawBarHGradient(J,E,S,c,C,a,W,H,Z,Y);J.globalAlpha=1;if(K[3]==S){this.renderTextAt("middle","left",K[0]-5,K[3]+Math.floor(c/2),this._settings.label(D[T]));I.addRect(D[T].id,[K[0],K[3],K[2],K[3]+c],b)}else{this.renderTextAt("middle",false,K[2]+5,K[1]+Math.floor(c/2),this._settings.label(D[T]));I.addRect(D[T].id,[K[0],S,K[2],K[3]],b)}}},_setBarHPoints:function(K,G,A,P,N,I,L,O,M){var J=0;if(N>I*L){var Q=(N-I*L)/N;J=-Math.asin(Q)+Math.PI/2}K.moveTo(G,A+O);var H=G+I*L-N-(N?0:O);if(N<I*L)K.lineTo(H,A+O);var B=A+N;if(N&&N>0)K.arc(H,B,N-O,-Math.PI/2+J,0,false);var D=A+P-N-(N?0:O),F=H+N-(N?O:0);K.lineTo(F,D);var C=H;if(N&&N>0)K.arc(C,D,N-O,0,Math.PI/2-J,false);var E=A+P-O;K.lineTo(G,E);if(!M)K.lineTo(G,A+O);return[F,E]},_drawHScales:function(C,B,D,E,A,F,H){var G=this._drawHXAxis(C,B,D,E,A,F);this._drawHYAxis(C,B,D,E,H,G)},_drawHYAxis:function(H,C,J,K,F,I){if(!this._settings.yAxis)return;var A,E=parseInt((I?I:J.x),10)-0.5,B=K.y+0.5,D=J.y;this._drawLine(H,E,B,E,D,this._settings.yAxis.color,1);for(var G=0;G<C.length;G++){var L=((this._settings.origin!="auto")&&(this._settings.view=="barH")&&(parseFloat(this._settings.value(C[G]))<this._settings.origin));A=D+F/2+G*F;this.renderTextAt("middle",(L?false:"left"),(L?E+5:E-5),A,this._settings.yAxis.template(C[G]),"dhx_axis_item_y",(L?0:E-10));if(this._settings.yAxis.lines.call(this,C[G]))this._drawLine(H,J.x,A,K.x,A,this._settings.yAxis.lineColor.call(this,C[G]),1)}this._drawLine(H,J.x+0.5,D+0.5,K.x,D+0.5,this._settings.yAxis.lineColor.call(this,{}),1);this._setYAxisTitle(J,K)},_drawHXAxis:function(M,F,N,O,L,P){var Q,C={},A=this._settings.xAxis;if(!A)return;var E=O.y+0.5,G=N.x-0.5,I=O.x-0.5,K=N.x;this._drawLine(M,G,E,I,E,A.color,1);if(A.step)Q=parseFloat(A.step);if(typeof this._settings.configXAxis.step=="undefined"||typeof this._settings.configXAxis.start=="undefined"||typeof this._settings.configXAxis.end=="undefined"){C=this._calculateScale(L,P);L=C.start;P=C.end;Q=C.step;this._settings.xAxis.end=P;this._settings.xAxis.start=L;this._settings.xAxis.step=Q}if(Q===0)return;var J=(I-G)*Q/(P-L),D=0;for(var H=L;H<=P;H+=Q){if(C.fixNum)H=parseFloat((new Number(H)).toFixed(C.fixNum));var B=Math.floor(G+D*J)+0.5;if(!(H==L&&this._settings.origin=="auto")&&A.lines.call(this,H))this._drawLine(M,B,E,B,N.y,this._settings.xAxis.lineColor.call(this,H),1);if(H==this._settings.origin)K=B+1;this.renderTextAt(false,true,B,E+2,A.template(H.toString()),"dhx_axis_item_x");D++}this.renderTextAt(true,false,G,O.y+this._settings.padding.bottom-3,this._settings.xAxis.title,"dhx_axis_title_x",O.x-N.x);if(!A.lines)this._drawLine(M,G,N.y-0.5,I,N.y-0.5,this._settings.xAxis.color,0.2);return K},_correctBarHParams:function(E,I,G,D,A,F,C){var H=this._settings.yAxis,B=I;if(!!H&&this._settings.origin!="auto"&&(this._settings.origin>C)){I+=(this._settings.origin-C)*A;B=I;D=D-(this._settings.origin-C);if(D<0){D*=(-1);E.translate(I,G+F);E.rotate(Math.PI);I=0.5;G=0}I+=0.5}return{value:D,x0:I,y0:G,start:B}},_drawBarH:function(L,P,F,A,Q,B,N,H,M,J,R,I){L.save();var K=this._correctBarHParams(L,F,A,M,H,Q,B);L.fillStyle=J;L.beginPath();var O=this._setBarHPoints(L,K.x0,K.y0,Q,N,H,K.value,(this._settings.border?1:0));if(R&&!I)L.lineTo(P.x+total_width,K.y0+(this._settings.border?1:0));L.fill();L.restore();var C=K.y0,D=(K.y0!=A?A:O[1]),G=(K.y0!=A?(K.start-O[0]):K.start),E=(K.y0!=A?K.start:O[0]);return[G,C,E,D]},_drawBarHBorder:function(G,J,E,I,D,H,A,F,B){G.save();var C=this._correctBarHParams(G,J,E,F,A,I,D);G.beginPath();this._setBorderStyles(G,B);G.globalAlpha=0.9;this._setBarHPoints(G,C.x0,C.y0,I,H,A,C.value,G.lineWidth/2,1);G.stroke();G.restore()},_drawBarHGradient:function(H,C,A,M,B,J,D,I,F,E){H.save();var G=this._correctBarHParams(H,C,A,I,D,M,B),K=this._setBarGradient(H,G.x0,G.y0+M,G.x0+D*G.value,G.y0,E,F,"x");H.fillStyle=K.gradient;H.beginPath();var L=this._setBarHPoints(H,G.x0,G.y0+K.offset,M-K.offset*2,J,D,G.value,K.offset);H.fill();H.globalAlpha=1;H.restore()}};dhtmlx.assert(dhtmlx.chart.barH);dhtmlx.chart.stackedBarH={pvt_render_stackedBarH:function(G,B,J,K,a,F){var L,A,O,N,S=K.x-J.x,R=!!this._settings.yAxis,M=this._getStackedLimits(B);L=M.max;A=M.min;var D=Math.floor((K.y-J.y)/B.length);if(!a)this._drawHScales(G,B,J,K,A,L,D);if(R){L=parseFloat(this._settings.xAxis.end);A=parseFloat(this._settings.xAxis.start)}var P=this._getRelativeValue(A,L);N=P[0];O=P[1];var U=(N?S/N:10);if(!R){var V=10;U=(N?(S-V)/N:10)}var b=parseInt(this._settings.width,10);if((b+4)>D)b=D-4;var E=Math.floor((D-b)/2),Z=0,W=false,c=this._settings.gradient;if(c)W=true;if(!R)this._drawLine(G,J.x-0.5,J.y,J.x-0.5,K.y,"#000000",1);for(var T=0;T<B.length;T++){if(!a)B[T].$startX=J.x;var H=parseFloat(this._settings.value(B[T]||0));if(H>L)H=L;H-=A;H*=O;var C=J.x,Q=J.y+E+T*D;if(!a)B[T].$startX=C;else C=B[T].$startX;if(H<0||(this._settings.yAxis&&H===0)){this.renderTextAt("middle",true,C+10,Q+b/2,this._settings.label(B[T]));continue}if(!R)H+=V/U;var X=this._settings.color.call(this,B[T]);G.globalAlpha=this._settings.alpha.call(this,B[T]);G.fillStyle=this._settings.color.call(this,B[T]);G.beginPath();var I=this._setBarHPoints(G,C,Q,b,Z,U,H,(this._settings.border?1:0));if(c&&!W)G.lineTo(J.x+S,Q+(this._settings.border?1:0));G.fill();if(W!=false){var Y=this._setBarGradient(G,C,Q+b,C,Q,W,X,"x");G.fillStyle=Y.gradient;G.beginPath();I=this._setBarHPoints(G,C,Q,b,Z,U,H,0);G.fill()}if(this._settings.border)this._drawBarHBorder(G,C,Q,b,A,Z,U,H,X);G.globalAlpha=1;this.renderTextAt("middle",true,B[T].$startX+(I[0]-B[T].$startX)/2-1,Q+(I[1]-Q)/2,this._settings.label(B[T]));F.addRect(B[T].id,[B[T].$startX,Q,I[0],I[1]],a);B[T].$startX=I[0]}}};dhtmlx.chart.stackedBar={pvt_render_stackedBar:function(H,C,K,L,Z,G){var M,B,P,O,S=L.y-K.y,T=!!this._settings.yAxis,A=!!this._settings.xAxis,N=this._getStackedLimits(C);M=N.max;B=N.min;var E=Math.floor((L.x-K.x)/C.length);if(!Z)this._drawScales(H,C,K,L,B,M,E);if(T){M=parseFloat(this._settings.yAxis.end);B=parseFloat(this._settings.yAxis.start)}var Q=this._getRelativeValue(B,M);O=Q[0];P=Q[1];var V=(O?S/O:10),a=parseInt(this._settings.width,10);if(a+4>E)a=E-4;var F=Math.floor((E-a)/2),W=(this._settings.gradient?this._settings.gradient:false);if(!A)this._drawLine(H,K.x,L.y+0.5,L.x,L.y+0.5,"#000000",1);for(var U=0;U<C.length;U++){var I=parseFloat(this._settings.value(C[U]||0));if(!I){if(!Z||!C[U].$startY)C[U].$startY=L.y;continue}if(!Z)I-=B;I*=P;var D=K.x+F+U*E,R=L.y;if(!Z)C[U].$startY=R;else R=C[U].$startY;if(R<(K.y+1))continue;if(I<0||(this._settings.yAxis&&I===0)){this.renderTextAt(true,true,D+Math.floor(a/2),R,this._settings.label(C[U]));continue}var X=this._settings.color.call(this,C[U]);H.globalAlpha=this._settings.alpha.call(this,C[U]);H.fillStyle=this._settings.color.call(this,C[U]);H.beginPath();var J=this._setStakedBarPoints(H,D-(this._settings.border?0.5:0),R,a+(this._settings.border?0.5:0),V,I,0,K.y);H.fill();if(W){H.save();var Y=this._setBarGradient(H,D,R,D+a,J[1],W,X,"y");H.fillStyle=Y.gradient;H.beginPath();J=this._setStakedBarPoints(H,D+Y.offset,R,a-Y.offset*2,V,I,(this._settings.border?1:0),K.y);H.fill();H.restore()}if(this._settings.border){H.save();this._setBorderStyles(H,X);H.beginPath();this._setStakedBarPoints(H,D-0.5,R,a+1,V,I,0,K.y,1);H.stroke();H.restore()}H.globalAlpha=1;this.renderTextAt(false,true,D+Math.floor(a/2),(J[1]+(R-J[1])/2)-7,this._settings.label(C[U]));G.addRect(C[U].id,[D,J[1],J[0],(C[U].$startY||R)],Z);C[U].$startY=(this._settings.border?(J[1]+1):J[1])}},_setStakedBarPoints:function(J,G,A,M,I,K,L,H,E){J.moveTo(G,A);var B=A-I*K+L;if(B<H)B=H;J.lineTo(G,B);var F=G+M,C=B;J.lineTo(F,C);var D=G+M;J.lineTo(D,A);if(!E)J.lineTo(G,A);return[D,C-2*L]}};dhtmlx.chart.line={pvt_render_line:function(J,B,O,P,N,K){var I,L,H,D,M,F,G,E,A,C;D=this._calculateParametersOfLineChart(J,B,O,P,N);L=this._settings;if(B.length){A=this._getYPointOfLineChart(B[0],O,P,D);G=(L.offset?O.x+D.cellWidth*0.5:O.x);F=G;for(H=1;H<=B.length;H++){E=((H==B.length-1)&&!this._settings.offset)?P.x:Math.floor(D.cellWidth*H)-0.5+F;if(B.length!=H){C=this._getYPointOfLineChart(B[H],O,P,D);if(!C)continue;if(L.line.width){this._drawLine(J,G,A,E,C,L.line.color.call(this,B[H-1]),L.line.width);if(L.line&&L.line.shadow){J.globalAlpha=0.3;this._drawLine(J,G+2,A+L.line.width+8,E+2,C+L.line.width+8,"#eeeeee",L.line.width+3);J.globalAlpha=1}}}this._drawItemOfLineChart(J,G,A,B[H-1],!!L.offset);M=(parseInt(L.item.radius.call(this,B[H-1]),10)||2);I=(L.eventRadius||M+1);K.addRect(B[H-1].id,[G-I,A-I,G+I,A+I],N);A=C;G=E}}},_drawItemOfLineChart:function(D,H,C,G,F){var E=this._settings.item,B=parseInt(E.radius.call(this,G),10);D.save();if(E.shadow){D.lineWidth=1;D.strokeStyle="#bdbdbd";D.fillStyle="#bdbdbd";var A=[0.1,0.2,0.3];for(var I=(A.length-1);I>=0;I--){D.globalAlpha=A[I];D.strokeStyle="#d0d0d0";D.beginPath();this._strokeChartItem(D,H,C+2*B/3,B+I+1,E.type);D.stroke()}D.beginPath();D.globalAlpha=0.3;D.fillStyle="#bdbdbd";this._strokeChartItem(D,H,C+2*B/3,B+1,E.type);D.fill()}D.restore();D.lineWidth=E.borderWidth;D.fillStyle=E.color.call(this,G);D.strokeStyle=E.borderColor.call(this,G);D.globalAlpha=E.alpha.call(this,G);D.beginPath();this._strokeChartItem(D,H,C,B+1,E.type);D.fill();D.stroke();D.globalAlpha=1;if(F)this.renderTextAt(false,true,H,C-B-this._settings.labelOffset,this._settings.label.call(this,G))},_strokeChartItem:function(C,F,B,A,E){if(E&&(E=="square"||E=="s")){A*=Math.sqrt(2)/2;C.moveTo(F-A-C.lineWidth/2,B-A);C.lineTo(F+A,B-A);C.lineTo(F+A,B+A);C.lineTo(F-A,B+A);C.lineTo(F-A,B-A)}else if(E&&(E=="diamond"||E=="d")){var D=(C.lineWidth>1?C.lineWidth*Math.sqrt(2)/4:0);C.moveTo(F,B-A);C.lineTo(F+A,B);C.lineTo(F,B+A);C.lineTo(F-A,B);C.lineTo(F+D,B-A-D)}else if(E&&(E=="triangle"||E=="t")){C.moveTo(F,B-A);C.lineTo(F+Math.sqrt(3)*A/2,B+A/2);C.lineTo(F-Math.sqrt(3)*A/2,B+A/2);C.lineTo(F,B-A)}else C.arc(F,B,A,0,Math.PI*2,true)},_getYPointOfLineChart:function(F,H,I,G){var D=G.minValue,K=G.maxValue,C=G.unit,B=G.valueFactor,E=this._settings.value(F),A=(parseFloat(E||0)-D)*B;if(!this._settings.yAxis)A+=G.startValue/C;var J=I.y-Math.floor(C*A);if(A<0)J=I.y;if(E>K)J=H.y;if(E<D)J=I.y;return J},_calculateParametersOfLineChart:function(E,D,H,I,G){var F={},B;F.totalHeight=I.y-H.y;F.cellWidth=Math.round((I.x-H.x)/((!this._settings.offset)?(D.length-1):D.length));var J=!!this._settings.yAxis,A=(this._settings.view.indexOf("stacked")!=-1?this._getStackedLimits(D):this._getLimits());F.maxValue=A.max;F.minValue=A.min;if(!G)this._drawScales(E,D,H,I,F.minValue,F.maxValue,F.cellWidth);if(J){F.maxValue=parseFloat(this._settings.yAxis.end);F.minValue=parseFloat(this._settings.yAxis.start)}var C=this._getRelativeValue(F.minValue,F.maxValue);B=C[0];F.valueFactor=C[1];F.unit=(B?F.totalHeight/B:10);F.startValue=0;if(!J){F.startValue=10;if(F.unit!=F.totalHeight)F.unit=(B?(F.totalHeight-F.startValue)/B:10)}return F}};dhtmlx.chart.bar={pvt_render_bar:function(I,C,K,L,a,H){var M,B,P,O,S=L.y-K.y,T=!!this._settings.yAxis,A=!!this._settings.xAxis,N=this._getLimits();M=N.max;B=N.min;var E=Math.floor((L.x-K.x)/C.length);if(!a&&!(this._settings.origin!="auto"&&!T))this._drawScales(I,C,K,L,B,M,E);if(T){M=parseFloat(this._settings.yAxis.end);B=parseFloat(this._settings.yAxis.start)}var Q=this._getRelativeValue(B,M);O=Q[0];P=Q[1];var V=(O?S/O:O);if(!T&&!(this._settings.origin!="auto"&&A)){var W=10;V=(O?(S-W)/O:W)}if(!a&&(this._settings.origin!="auto"&&!T)&&this._settings.origin>B)this._drawXAxis(I,C,K,L,E,L.y-V*(this._settings.origin-B));var b=parseInt(this._settings.width,10);if(this._series&&(b*this._series.length+4)>E)b=parseInt(E/this._series.length-4,10);var F=Math.floor((E-b*this._series.length)/2),Z=(typeof this._settings.radius!="undefined"?parseInt(this._settings.radius,10):Math.round(b/5)),X=false,c=this._settings.gradient;if(c&&typeof(c)!="function"){X=c;c=false}else if(c){c=I.createLinearGradient(0,L.y,0,K.y);this._settings.gradient(c)}if(!A)this._drawLine(I,K.x,L.y+0.5,L.x,L.y+0.5,"#000000",1);for(var U=0;U<C.length;U++){var G=parseFloat(this._settings.value(C[U]||0));if(G>M)G=M;G-=B;G*=P;var D=K.x+F+U*E+(b+1)*a,R=L.y+0.5;if(G<0||(this._settings.yAxis&&G===0&&!(this._settings.origin!="auto"&&this._settings.origin>B))){this.renderTextAt(true,true,D+Math.floor(b/2),R,this._settings.label(C[U]));continue}if(!T&&!(this._settings.origin!="auto"&&A))G+=W/V;var Y=c||this._settings.color.call(this,C[U]);I.globalAlpha=this._settings.alpha.call(this,C[U]);var J=this._drawBar(I,K,D,R,b,B,Z,V,G,Y,c,X);if(X)this._drawBarGradient(I,D,R,b,B,Z,V,G,Y,X);if(this._settings.border)this._drawBarBorder(I,D,R,b,B,Z,V,G,Y);I.globalAlpha=1;if(J[0]!=D)this.renderTextAt(false,true,D+Math.floor(b/2),J[1],this._settings.label(C[U]));else this.renderTextAt(true,true,D+Math.floor(b/2),J[3],this._settings.label(C[U]));H.addRect(C[U].id,[D,J[3],J[2],J[1]],a)}},_correctBarParams:function(F,I,H,E,A,G,D){var C=this._settings.xAxis,B=H;if(!!C&&this._settings.origin!="auto"&&(this._settings.origin>D)){H-=(this._settings.origin-D)*A;B=H;E=E-(this._settings.origin-D);if(E<0){E*=(-1);F.translate(I+G,H);F.rotate(Math.PI);I=0;H=0}H-=0.5}return{value:E,x0:parseInt(I,10),y0:parseInt(H,10),start:B}},_drawBar:function(L,P,F,A,Q,B,N,H,M,J,R,I){L.save();L.fillStyle=J;var K=this._correctBarParams(L,F,A,M,H,Q,B),O=this._setBarPoints(L,K.x0,K.y0,Q,N,H,K.value,(this._settings.border?1:0));if(R&&!I)L.lineTo(K.x0+(this._settings.border?1:0),P.y);L.fill();L.restore();var G=K.x0,E=(K.x0!=F?F+O[0]:O[0]),C=(K.x0!=F?(K.start-O[1]):A),D=(K.x0!=F?K.start:O[1]);return[G,C,E,D]},_setBorderStyles:function(C,A){var B,D;D=dhtmlx.math.toRgb(A);B=dhtmlx.math.rgbToHsv(D[0],D[1],D[2]);B[2]/=2;A="rgb("+dhtmlx.math.hsvToRgb(B[0],B[1],B[2])+")";C.strokeStyle=A;if(C.globalAlpha==1)C.globalAlpha=0.9},_drawBarBorder:function(G,J,E,I,D,H,A,F,B){var C;G.save();C=this._correctBarParams(G,J,E,F,A,I,D);this._setBorderStyles(G,B);this._setBarPoints(G,C.x0,C.y0,I,H,A,C.value,G.lineWidth/2,1);G.stroke();G.restore()},_drawBarGradient:function(I,D,B,M,C,K,E,J,G,F){I.save();var H=this._correctBarParams(I,D,B,J,E,M,C),L=this._setBarGradient(I,H.x0,H.y0,H.x0+M,H.y0-E*H.value+2,F,G,"y"),A=this._settings.border?1:0;I.fillStyle=L.gradient;this._setBarPoints(I,H.x0+L.offset,H.y0,M-L.offset*2,K,E,H.value,L.offset+A);I.fill();I.restore()},_setBarPoints:function(K,H,A,O,M,I,L,N,G){K.beginPath();var J=0;if(M>I*L){var P=(M-I*L)/M;if(P<=1&&P>=-1)J=-Math.acos(P)+Math.PI/2}K.moveTo(H+N,A);var B=A-Math.floor(I*L)+M+(M?0:N);if(M<I*L)K.lineTo(H+N,B);var E=H+M;if(M&&M>0)K.arc(E,B,M-N,-Math.PI+J,-Math.PI/2,false);var F=H+O-M-(M?0:N),C=B-M+(M?N:0);K.lineTo(F,C);if(M&&M>0)K.arc(F,B,M-N,-Math.PI/2,0-J,false);var D=H+O-N;K.lineTo(D,A);if(!G)K.lineTo(H+N,A);return[D,C]}};dhtmlx.chart.pie={pvt_render_pie:function(C,B,F,E,D,A){this._renderPie(C,B,F,E,1,A)},_renderPie:function(P,D,S,T,A,Q){if(!D.length)return;var K=this._getPieParameters(S,T),R=(this._settings.radius?this._settings.radius:K.radius);if(R<0)return;var L=this._getValues(D),F=this._getTotalValue(L),E=this._getRatios(L,F),G=(this._settings.x?this._settings.x:K.x),B=(this._settings.y?this._settings.y:K.y);if(A==1&&this._settings.shadow)this._addShadow(P,G,B,R);B=B/A;var M=-Math.PI/2,J=[];P.scale(1,A);if(this._settings.gradient){var I=(A!=1?G+R/3:G),C=(A!=1?B+R/3:B);this._showRadialGradient(P,G,B,R,I,C)}for(var H=0;H<D.length;H++){if(!L[H])continue;P.strokeStyle=this._settings.lineColor.call(this,D[H]);P.beginPath();P.moveTo(G,B);J.push(M);alpha1=-Math.PI/2+E[H]-0.0001;P.arc(G,B,R,M,alpha1,false);P.lineTo(G,B);var N=this._settings.color.call(this,D[H]);P.fillStyle=N;P.fill();if(this._settings.pieInnerText)this._drawSectorLabel(G,B,5*R/6,M,alpha1,A,this._settings.pieInnerText(D[H],F),true);if(this._settings.label)this._drawSectorLabel(G,B,R+this._settings.labelOffset,M,alpha1,A,this._settings.label(D[H]));if(A!=1){this._createLowerSector(P,G,B,M,alpha1,R,true);P.fillStyle="#000000";P.globalAlpha=0.2;this._createLowerSector(P,G,B,M,alpha1,R,false);P.globalAlpha=1;P.fillStyle=N}Q.addSector(D[H].id,M,alpha1,G,B,R,A);M=alpha1}P.globalAlpha=0.8;var O;for(H=0;H<J.length;H++){O=this._getPositionByAngle(J[H],G,B,R);this._drawLine(P,G,B,O.x,O.y,this._settings.lineColor.call(this,D[H]),2)}if(A==1){P.lineWidth=2;P.strokeStyle="#ffffff";P.beginPath();P.arc(G,B,R+1,0,2*Math.PI,false);P.stroke()}P.globalAlpha=1;P.scale(1,1/A)},_getValues:function(B){var A=[];for(var C=0;C<B.length;C++)A.push(parseFloat(this._settings.value(B[C])||0));return A},_getTotalValue:function(B){var A=0;for(var C=0;C<B.length;C++)A+=B[C];return A},_getRatios:function(A,D){var B,C=[],F=0;D=D||this._getTotalValue(A);for(var E=0;E<A.length;E++){B=A[E];C[E]=Math.PI*2*(D?((B+F)/D):(1/data.length));F+=B}return C},_getPieParameters:function(E,F){var C=F.x-E.x,A=F.y-E.y,G=E.x+C/2,B=E.y+A/2,D=Math.min(C/2,A/2);return{"x":G,"y":B,"radius":D}},_createLowerSector:function(D,H,B,C,F,A,E){D.lineWidth=1;if(!((C<=0&&F>=0)||(C>=0&&F<=Math.PI)||(Math.abs(C-Math.PI)>0.003&&C<=Math.PI&&F>=Math.PI)))return;if(C<=0&&F>=0){C=0;E=false;this._drawSectorLine(D,H,B,A,C,F)}if(C<=Math.PI&&F>=Math.PI){F=Math.PI;E=false;this._drawSectorLine(D,H,B,A,C,F)}var G=(this._settings.height||Math.floor(A/4))/this._settings.cant;D.beginPath();D.arc(H,B,A,C,F,false);D.lineTo(H+A*Math.cos(F),B+A*Math.sin(F)+G);D.arc(H,B+G,A,F,C,true);D.lineTo(H+A*Math.cos(C),B+A*Math.sin(C));D.fill();if(E)D.stroke()},_drawSectorLine:function(D,F,B,A,C,E){D.beginPath();D.arc(F,B,A,C,E,false);D.stroke()},_addShadow:function(B,F,D,A){B.globalAlpha=0.5;var C=["#c4c4c4","#c6c6c6","#cacaca","#dcdcdc","#dddddd","#e0e0e0","#eeeeee","#f5f5f5","#f8f8f8"];for(var E=C.length-1;E>-1;E--){B.beginPath();B.fillStyle=C[E];B.arc(F+1,D+1,A+E,0,Math.PI*2,true);B.fill()}B.globalAlpha=1},_getGrayGradient:function(A){A.addColorStop(0,"#ffffff");A.addColorStop(0.7,"#7a7a7a");A.addColorStop(1,"#000000");return A},_showRadialGradient:function(B,G,E,C,D,A){B.beginPath();var F;if(typeof this._settings.gradient!="function"){F=B.createRadialGradient(D,A,C/4,G,E,C);F=this._getGrayGradient(F)}else F=this._settings.gradient(F);B.fillStyle=F;B.arc(G,E,C,0,Math.PI*2,true);B.fill();B.globalAlpha=0.7},_drawSectorLabel:function(H,F,O,N,L,B,C,J){var M=this.renderText(0,0,C,0,1);if(!M)return;var D=M.scrollWidth;M.style.width=D+"px";if(D>H)D=H;var G=(L-N<0.2?4:8);if(J)G=D/1.8;var P=N+(L-N)/2;O=O-(G-8)/2;var I=-G,K=-8,E="right";if(P>=Math.PI/2&&P<Math.PI||P<=3*Math.PI/2&&P>=Math.PI){I=-D-I+1;E="left"}var Q=0;if(!J&&B<1&&(P>0&&P<Math.PI))Q=(this._settings.height||Math.floor(O/4))/B;var S=(F+Math.floor((O+Q)*Math.sin(P)))*B+K,T=H+Math.floor((O+G/2)*Math.cos(P))+I,R=(L<Math.PI/2+0.01),A=(N<Math.PI/2);if(A&&R){T=Math.max(T,H+3);if(L-N<0.2)T=H}else if(!A&&!R)T=Math.min(T,H-D);else if(!J&&(P>=Math.PI/2&&P<Math.PI||P<=3*Math.PI/2&&P>=Math.PI))T+=D/3;M.style.top=S+"px";M.style.left=T+"px";M.style.width=D+"px";M.style.textAlign=E;M.style.whiteSpace="nowrap"}};dhtmlx.chart.pie3D={pvt_render_pie3D:function(C,B,F,E,D,A){this._renderPie(C,B,F,E,this._settings.cant,A)}};dhtmlx.chart.donut={pvt_render_donut:function(G,B,K,L,J,H){if(!B.length)return;this._renderPie(G,B,K,L,1,H);var I=this._settings,E=this._getPieParameters(K,L),D=(I.radius?I.radius:E.radius),F=((I.innerRadius&&(I.innerRadius<D))?I.innerRadius:D/3),C=(I.x?I.x:E.x),A=(I.y?I.y:E.y);G.fillStyle="#ffffff";G.beginPath();G.arc(C,A,F,0,Math.PI*2,true);G.fill()}};dhtmlx.Template={_cache:{},empty:function(){return""},setter:function(A){return dhtmlx.Template.fromHTML(A)},obj_setter:function(B){var A=dhtmlx.Template.setter(B),C=this;return function(){return A.apply(C,arguments)}},fromHTML:function(A){if(typeof A=="function")return A;if(this._cache[A])return this._cache[A];A=(A||"").toString();A=A.replace(/[\r\n]+/g,"\\n");A=A.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,"\"+(obj.$1?\"$2\":\"$3\")+\"");A=A.replace(/\{common\.([^}\(]*)\}/g,"\"+common.$1+\"");A=A.replace(/\{common\.([^\}\(]*)\(\)\}/g,"\"+(common.$1?common.$1(obj):\"\")+\"");A=A.replace(/\{obj\.([^}]*)\}/g,"\"+obj.$1+\"");A=A.replace(/#([a-z0-9_]+)#/gi,"\"+obj.$1+\"");A=A.replace(/\{obj\}/g,"\"+obj+\"");A=A.replace(/\{-obj/g,"{obj");A=A.replace(/\{-common/g,"{common");A="return \""+A+"\";";return this._cache[A]=Function("obj","common",A)}};dhtmlx.Type={add:function(C,B){if(!C.types&&C.prototype.types)C=C.prototype;if(dhtmlx.assert_enabled())this.assert_event(B);var A=B.name||"default";this._template(B);this._template(B,"edit");this._template(B,"loading");C.types[A]=dhtmlx.extend(dhtmlx.extend({},(C.types[A]||this._default)),B);return A},_default:{css:"default",template:function(){return""},template_edit:function(){return""},template_loading:function(){return"..."},width:150,height:80,margin:5,padding:0},_template:function(C,A){A="template"+(A?("_"+A):"");var B=C[A];if(B&&(typeof B=="string")){if(B.indexOf("->")!=-1){B=B.split("->");switch(B[0]){case"html":B=dhtmlx.html.getValue(B[1]).replace(/\"/g,"\\\"");break;case"http":B=new dhtmlx.ajax().sync().get(B[1],{uid:(new Date()).valueOf()}).responseText;break;default:break}}C[A]=dhtmlx.Template.fromHTML(B)}}};dhtmlx.SingleRender={_init:function(){},_toHTML:function(A){return this.type._item_start(A,this.type)+this.type.template(A,this.type)+this.type._item_end},render:function(){if(!this.callEvent||this.callEvent("onBeforeRender",[this.data])){if(this.data)this._dataobj.innerHTML=this._toHTML(this.data);if(this.callEvent)this.callEvent("onAfterRender",[])}}};dhtmlx.ui.Tooltip=function(A){this.name="Tooltip";this.version="3.0";if(dhtmlx.assert_enabled())this._assert();if(typeof A=="string")A={template:A};dhtmlx.extend(this,dhtmlx.Settings);dhtmlx.extend(this,dhtmlx.SingleRender);this._parseSettings(A,{type:"default",dy:0,dx:20});this._dataobj=this._obj=document.createElement("DIV");this._obj.className="dhx_tooltip";dhtmlx.html.insertBefore(this._obj,document.body.firstChild)};dhtmlx.ui.Tooltip.prototype={show:function(A,B){if(this._disabled)return;if(this.data!=A){this.data=A;this.render(A)}this._obj.style.top=B.y+this._settings.dy+"px";this._obj.style.left=B.x+this._settings.dx+"px";this._obj.style.display="block"},hide:function(){this.data=null;this._obj.style.display="none"},disable:function(){this._disabled=true},enable:function(){this._disabled=false},types:{"default":dhtmlx.Template.fromHTML("{obj.id}")},template_item_start:dhtmlx.Template.empty,template_item_end:dhtmlx.Template.empty};dhtmlx.AutoTooltip={tooltip_setter:function(B){var A=new dhtmlx.ui.Tooltip(B);this.attachEvent("onMouseMove",function(B,C){A.show(this.get(B),dhtmlx.html.pos(C))});this.attachEvent("onMouseOut",function(B,C){A.hide()});this.attachEvent("onMouseMoving",function(B,C){A.hide()});return A}};dhtmlx.ajax=function(D,A,C){if(arguments.length!==0){var B=new dhtmlx.ajax();if(C)B.master=C;B.get(D,null,A)}if(!this.getXHR)return new dhtmlx.ajax();return this};dhtmlx.ajax.prototype={getXHR:function(){if(dhtmlx._isIE)return new ActiveXObject("Microsoft.xmlHTTP");else return new XMLHttpRequest()},send:function(G,F,A){var H=this.getXHR();if(typeof A=="function")A=[A];if(typeof F=="object"){var B=[];for(var C in F){var D=F[C];if(D===null||D===dhtmlx.undefined)D="";B.push(C+"="+encodeURIComponent(D))}F=B.join("&")}if(F&&!this.post){G=G+(G.indexOf("?")!=-1?"&":"?")+F;F=null}H.open(this.post?"POST":"GET",G,!this._sync);if(this.post)H.setRequestHeader("Content-type","application/x-www-form-urlencoded");var E=this;H.onreadystatechange=function(){if(!H.readyState||H.readyState==4){if(A&&E)for(var B=0;B<A.length;B++)if(A[B])A[B].call((E.master||E),H.responseText,H.responseXML,H);E.master=null;A=E=null}};H.send(F||null);return H},get:function(C,B,A){this.post=false;return this.send(C,B,A)},post:function(C,B,A){this.post=true;return this.send(C,B,A)},sync:function(){this._sync=true;return this}};dhtmlx.AtomDataLoader={_init:function(A){this.data={};if(A){this._settings.datatype=A.datatype||"json";this._after_init.push(this._load_when_ready)}},_load_when_ready:function(){this._ready_for_data=true;if(this._settings.url)this.url_setter(this._settings.url);if(this._settings.data)this.data_setter(this._settings.data)},url_setter:function(A){if(!this._ready_for_data)return A;this.load(A,this._settings.datatype);return A},data_setter:function(A){if(!this._ready_for_data)return A;this.parse(A,this._settings.datatype);return true},load:function(B,A){this.callEvent("onXLS",[]);if(typeof A=="string"){this.data.driver=dhtmlx.DataDriver[A];A=arguments[2]}else this.data.driver=dhtmlx.DataDriver["xml"];dhtmlx.ajax(B,[this._onLoad,A],this)},parse:function(A,B){this.callEvent("onXLS",[]);this.data.driver=dhtmlx.DataDriver[B||"xml"];this._onLoad(A,null)},_onLoad:function(A,D,B){var C=this.data.driver,E=C.getRecords(C.toObject(A,D))[0];this.data=(C?C.getDetails(E):A);this.callEvent("onXLE",[])},_check_data_feed:function(A){if(!this._settings.dataFeed||this._ignore_feed||!A)return true;var B=this._settings.dataFeed;if(typeof B=="function")return B.call(this,(A.id||A),A);B=B+(B.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(A.id||A);this.callEvent("onXLS",[]);dhtmlx.ajax(B,function(A,B){this._ignore_feed=true;this.setValues(dhtmlx.DataDriver.json.toObject(A)[0]);this._ignore_feed=false;this.callEvent("onXLE",[])},this);return false}};dhtmlx.DataDriver={};dhtmlx.DataDriver.json={toObject:function(data){if(!data)data="[]";if(typeof data=="string"){eval("dhtmlx.temp="+data);return dhtmlx.temp}return data},getRecords:function(A){if(A&&!(A instanceof Array))return[A];return A},getDetails:function(A){return A},getInfo:function(A){return{_size:(A.total_count||0),_from:(A.pos||0),_key:(A.dhx_security)}}};dhtmlx.DataDriver.json_ext={toObject:function(data){if(!data)data="[]";if(typeof data=="string"){var temp;eval("temp="+data);dhtmlx.temp=[];var header=temp.header;for(var i=0;i<temp.data.length;i++){var item={};for(var j=0;j<header.length;j++)if(typeof(temp.data[i][j])!="undefined")item[header[j]]=temp.data[i][j];dhtmlx.temp.push(item)}return dhtmlx.temp}return data},getRecords:function(A){if(A&&!(A instanceof Array))return[A];return A},getDetails:function(A){return A},getInfo:function(A){return{_size:(A.total_count||0),_from:(A.pos||0)}}};dhtmlx.DataDriver.html={toObject:function(B){if(typeof B=="string"){var A=null;if(B.indexOf("<")==-1)A=dhtmlx.toNode(B);if(!A){A=document.createElement("DIV");A.innerHTML=B}return A.getElementsByTagName(this.tag)}return B},getRecords:function(A){if(A.tagName)return A.childNodes;return A},getDetails:function(A){return dhtmlx.DataDriver.xml.tagToObject(A)},getInfo:function(A){return{_size:0,_from:0}},tag:"LI"};dhtmlx.DataDriver.jsarray={toObject:function(data){if(typeof data=="string"){eval("dhtmlx.temp="+data);return dhtmlx.temp}return data},getRecords:function(A){return A},getDetails:function(B){var A={};for(var C=0;C<B.length;C++)A["data"+C]=B[C];return A},getInfo:function(A){return{_size:0,_from:0}}};dhtmlx.DataDriver.csv={toObject:function(A){return A},getRecords:function(A){return A.split(this.row)},getDetails:function(B){B=this.stringToArray(B);var A={};for(var C=0;C<B.length;C++)A["data"+C]=B[C];return A},getInfo:function(A){return{_size:0,_from:0}},stringToArray:function(A){A=A.split(this.cell);for(var B=0;B<A.length;B++)A[B]=A[B].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"");return A},row:"\n",cell:","};dhtmlx.DataDriver.xml={toObject:function(A,B){if(B&&(B=this.checkResponse(A,B)))return B;if(typeof A=="string")return this.fromString(A);return A},getRecords:function(A){return this.xpath(A,this.records)},records:"/*/item",getDetails:function(A){return this.tagToObject(A,{})},getInfo:function(A){return{_size:(A.documentElement.getAttribute("total_count")||0),_from:(A.documentElement.getAttribute("pos")||0),_key:(A.documentElement.getAttribute("dhx_security"))}},xpath:function(I,G){if(window.XPathResult){var C=I;if(I.nodeName.indexOf("document")==-1)I=I.ownerDocument;var A=[],B=I.evaluate(G,C,null,XPathResult.ANY_TYPE,null),H=B.iterateNext();while(H){A.push(H);H=B.iterateNext()}return A}else{var E=true;try{if(typeof(I.selectNodes)=="undefined")E=false}catch(D){}if(E)return I.selectNodes(G);else{var F=G.split("/").pop();return I.getElementsByTagName(F)}}},tagToObject:function(C,G){G=G||{};var A=false,E=C.attributes;if(E&&E.length){for(var H=0;H<E.length;H++)G[E[H].name]=E[H].value;A=true}var B=C.childNodes,F={};for(H=0;H<B.length;H++)if(B[H].nodeType==1){var D=B[H].tagName;if(typeof G[D]!="undefined"){if(!(G[D]instanceof Array))G[D]=[G[D]];G[D].push(this.tagToObject(B[H],{}))}else G[B[H].tagName]=this.tagToObject(B[H],{});A=true}if(!A)return this.nodeValue(C);G.value=this.nodeValue(C);return G},nodeValue:function(A){if(A.firstChild)return A.firstChild.data;return""},fromString:function(A){if(window.DOMParser&&!dhtmlx._isIE)return(new DOMParser()).parseFromString(A,"text/xml");if(window.ActiveXObject){var B=new ActiveXObject("Microsoft.xmlDOM");B.loadXML(A);return B}dhtmlx.error("Load from xml string is not supported")},checkResponse:function(A,C){if(C&&(C.firstChild&&C.firstChild.tagName!="parsererror"))return C;var B=this.fromString(A.replace(/^[\s]+/,""));if(B)return B;dhtmlx.error("xml can't be parsed",A)}};dhtmlx.DataLoader={_init:function(A){A=A||"";this.name="DataStore";this.data=(A.datastore)||(new dhtmlx.DataStore());this._readyHandler=this.data.attachEvent("onStoreLoad",dhtmlx.bind(this._call_onready,this))},load:function(B,A){dhtmlx.AtomDataLoader.load.apply(this,arguments);if(!this.data.feed)this.data.feed=function(C,A){if(this._load_count)return this._load_count=[C,A];else this._load_count=true;this.load(B+((B.indexOf("?")==-1)?"?":"&")+"posStart="+C+"&count="+A,function(){var A=this._load_count;this._load_count=false;if(typeof A=="object")this.data.feed.apply(this,A)})}},_onLoad:function(A,C,B){this.data._parse(this.data.driver.toObject(A,C));this.callEvent("onXLE",[]);if(this._readyHandler){this.data.detachEvent(this._readyHandler);this._readyHandler=null}},dataFeed_setter:function(A){this.data.attachEvent("onBeforeFilter",dhtmlx.bind(function(A,C){if(this._settings.dataFeed){var F={};if(!A&&!F)return;if(typeof A=="function"){if(!C)return;A(C,F)}else F={text:C};this.clearAll();var E=this._settings.dataFeed;if(typeof E=="function")return E.call(this,C,F);var B=[];for(var D in F)B.push("dhx_filter["+D+"]="+encodeURIComponent(F[D]));this.load(E+(E.indexOf("?")<0?"?":"&")+B.join("&"),this._settings.datatype);return false}},this));return A},_call_onready:function(){if(this._settings.ready){var A=dhtmlx.toFunctor(this._settings.ready);if(A&&A.call)A.apply(this,arguments)}}};dhtmlx.DataStore=function(){this.name="DataStore";dhtmlx.extend(this,dhtmlx.EventSystem);this.setDriver("xml");this.pull={};this.order=dhtmlx.toArray()};dhtmlx.DataStore.prototype={setDriver:function(A){dhtmlx.assert(dhtmlx.DataDriver[A],"incorrect DataDriver");this.driver=dhtmlx.DataDriver[A]},_parse:function(B){this.callEvent("onParse",[this.driver,B]);if(this._filter_order)this.filter();var H=this.driver.getInfo(B);if(H._key)dhtmlx.security_key=H._key;var E=this.driver.getRecords(B),D=(H._from||0)*1;if(D===0&&this.order[0])D=this.order.length;var F=0;for(var G=0;G<E.length;G++){var C=this.driver.getDetails(E[G]),A=this.id(C);if(!this.pull[A]){this.order[F+D]=A;F++}this.pull[A]=C;if(this.extraParser)this.extraParser(C);if(this._scheme)if(this._scheme.$init)this._scheme.$update(C);else if(this._scheme.$update)this._scheme.$update(C)}for(G=0;G<H._size;G++)if(!this.order[G]){A=dhtmlx.uid(),C={id:A,$template:"loading"};this.pull[A]=C;this.order[G]=A}this.callEvent("onStoreLoad",[this.driver,B]);this.refresh()},id:function(A){return A.id||(A.id=dhtmlx.uid())},changeId:function(A,B){dhtmlx.assert(this.pull[A],"Can't change id, for non existing item: "+A);this.pull[B]=this.pull[A];this.pull[B].id=B;this.order[this.order.find(A)]=B;if(this._filter_order)this._filter_order[this._filter_order.find(A)]=B;this.callEvent("onIdChange",[A,B]);if(this._render_change_id)this._render_change_id(A,B)},get:function(A){return this.item(A)},set:function(A,B){return this.update(A,B)},item:function(A){return this.pull[A]},update:function(A,B){if(this._scheme&&this._scheme.$update)this._scheme.$update(B);if(this.callEvent("onBeforeUpdate",[A,B])===false)return false;this.pull[A]=B;this.refresh(A)},refresh:function(A){if(this._skip_refresh)return;if(A)this.callEvent("onStoreUpdated",[A,this.pull[A],"update"]);else this.callEvent("onStoreUpdated",[null,null,null])},silent:function(A){this._skip_refresh=true;A.call(this);this._skip_refresh=false},getRange:function(C,A){if(C)C=this.indexById(C);else C=this.startOffset||0;if(A)A=this.indexById(A);else{A=Math.min((this.endOffset||Infinity),(this.dataCount()-1));if(A<0)A=0}if(C>A){var B=A;A=C;C=B}return this.getIndexRange(C,A)},getIndexRange:function(C,B){B=Math.min((B||Infinity),this.dataCount()-1);var A=dhtmlx.toArray();for(var D=(C||0);D<=B;D++)A.push(this.item(this.order[D]));return A},dataCount:function(){return this.order.length},exists:function(A){return!!(this.pull[A])},move:function(B,D){if(B<0||D<0){dhtmlx.error("DataStore::move","Incorrect indexes");return}var A=this.idByIndex(B),C=this.item(A);this.order.removeAt(B);this.order.insertAt(A,Math.min(this.order.length,D));this.callEvent("onStoreUpdated",[A,C,"move"])},scheme:function(A){this._scheme=A},sync:function(C,D,B){if(typeof D!="function"){B=D;D=null}if(dhtmlx.debug_bind){this.debug_sync_master=C;dhtmlx.log("[sync] "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id+" <= "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id)}var A=C;if(C.name!="DataStore")C=C.data;var E=dhtmlx.bind(function(A,E,F){if(F!="update"||D)A=null;if(!A){this.order=dhtmlx.toArray([].concat(C.order));this._filter_order=null;this.pull=C.pull;if(D)this.silent(D);if(this._on_sync)this._on_sync()}if(dhtmlx.debug_bind)dhtmlx.log("[sync:request] "+this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id+" <= "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id);if(!B)this.refresh(A);else B=false},this);C.attachEvent("onStoreUpdated",E);this.feed=function(C,B){A.loadNext(B,C)};E()},add:function(E,B){if(this._scheme){E=E||{};for(var F in this._scheme)E[F]=E[F]||this._scheme[F];if(this._scheme)if(this._scheme.$init)this._scheme.$update(E);else if(this._scheme.$update)this._scheme.$update(E)}var A=this.id(E),C=this.dataCount();if(dhtmlx.isNotDefined(B)||B<0)B=C;if(B>C){dhtmlx.log("Warning","DataStore:add","Index of out of bounds");B=Math.min(this.order.length,B)}if(this.callEvent("onBeforeAdd",[A,E,B])===false)return false;if(this.exists(A))return dhtmlx.error("Not unique ID");this.pull[A]=E;this.order.insertAt(A,B);if(this._filter_order){var D=this._filter_order.length;if(!B&&this.order.length)D=0;this._filter_order.insertAt(A,D)}this.callEvent("onafterAdd",[A,B]);this.callEvent("onStoreUpdated",[A,E,"add"]);return A},remove:function(A){if(A instanceof Array){for(var C=0;C<A.length;C++)this.remove(A[C]);return}if(this.callEvent("onBeforeDelete",[A])===false)return false;if(!this.exists(A))return dhtmlx.error("Not existing ID",A);var B=this.item(A);this.order.remove(A);if(this._filter_order)this._filter_order.remove(A);delete this.pull[A];this.callEvent("onafterdelete",[A]);this.callEvent("onStoreUpdated",[A,B,"delete"])},clearAll:function(){this.pull={};this.order=dhtmlx.toArray();this.feed=null;this._filter_order=null;this.callEvent("onClearAll",[]);this.refresh()},idByIndex:function(A){if(A>=this.order.length||A<0)dhtmlx.log("Warning","DataStore::idByIndex Incorrect index");return this.order[A]},indexById:function(A){var B=this.order.find(A);return B},next:function(A,B){return this.order[this.indexById(A)+(B||1)]},first:function(){return this.order[0]},last:function(){return this.order[this.order.length-1]},previous:function(A,B){return this.order[this.indexById(A)-(B||1)]},sort:function(F,B,E){var A=F;if(typeof F=="function")A={as:F,dir:B};else if(typeof F=="string")A={by:F,dir:B,as:E};var G=[A.by,A.dir,A.as];if(!this.callEvent("onbeforesort",G))return;if(this.order.length){var C=dhtmlx.sort.create(A),D=this.getRange(this.first(),this.last());D.sort(C);this.order=D.map(function(A){return this.id(A)},this)}this.refresh();this.callEvent("onaftersort",G)},filter:function(B,C){if(!this.callEvent("onBeforeFilter",[B,C]))return;if(this._filter_order){this.order=this._filter_order;delete this._filter_order}if(!this.order.length)return;if(B){var E=B;C=C||"";if(typeof B=="string"){B=dhtmlx.Template.fromHTML(B);C=C.toString().toLowerCase();E=function(C,A){return B(C).toLowerCase().indexOf(A)!=-1}}var D=dhtmlx.toArray();for(var F=0;F<this.order.length;F++){var A=this.order[F];if(E(this.item(A),C))D.push(A)}this._filter_order=this.order;this.order=D}this.refresh();this.callEvent("onAfterFilter",[])},each:function(A,B){for(var C=0;C<this.order.length;C++)A.call((B||this),this.item(this.order[C]))},provideApi:function(A,C){this.debug_bind_master=A;if(C)this.mapEvent({onbeforesort:A,onaftersort:A,onbeforeadd:A,onafteradd:A,onbeforedelete:A,onafterdelete:A,onbeforeupdate:A});var B=["get","set","sort","add","remove","exists","idByIndex","indexById","item","update","refresh","dataCount","filter","next","previous","clearAll","first","last","serialize"];for(var D=0;D<B.length;D++)A[B[D]]=dhtmlx.methodPush(this,B[D]);if(dhtmlx.assert_enabled())this.assert_event(A)},serialize:function(){var B=this.order,A=[];for(var C=0;C<B.length;C++)A.push(this.pull[B[C]]);return A}};dhtmlx.sort={create:function(A){return dhtmlx.sort.dir(A.dir,dhtmlx.sort.by(A.by,A.as))},as:{"int":function(B,A){B=B*1;A=A*1;return B>A?1:(B<A?-1:0)},"string_strict":function(B,A){B=B.toString();A=A.toString();return B>A?1:(B<A?-1:0)},"string":function(B,A){B=B.toString().toLowerCase();A=A.toString().toLowerCase();return B>A?1:(B<A?-1:0)}},by:function(A,B){if(!A)return B;if(typeof B!="function")B=dhtmlx.sort.as[B||"string"];A=dhtmlx.Template.fromHTML(A);return function(D,C){return B(A(D),A(C))}},dir:function(A,B){if(A=="asc")return B;return function(C,A){return B(C,A)*-1}}};dhtmlx.Group={_init:function(){dhtmlx.assert(this.data,"DataStore required for grouping");this.data.attachEvent("onStoreLoad",dhtmlx.bind(function(){if(this._settings.group)this.group(this._settings.group,false)},this));this.attachEvent("onBeforeRender",dhtmlx.bind(function(A){if(this._settings.sort){A.block();A.sort(this._settings.sort);A.unblock()}},this));this.attachEvent("onBeforeSort",dhtmlx.bind(function(){this._settings.sort=null},this))},_init_group_data_event:function(A,B){A.attachEvent("onClearAll",dhtmlx.bind(function(){this.ungroup(false);this.block();this.clearAll();this.unblock()},B))},sum:function(B,A){B=dhtmlx.Template.setter(B);A=A||this.data;var C=0;A.each(function(A){C+=B(A)*1});return C},min:function(C,B){C=dhtmlx.Template.setter(C);B=B||this.data;var A=Infinity;B.each(function(B){if(C(B)*1<A)A=C(B)*1});return A*1},max:function(C,B){C=dhtmlx.Template.setter(C);B=B||this.data;var A=-Infinity;B.each(function(B){if(C(B)*1>A)A=C(B)*1});return A},_split_data_by:function(A){var C=function(B,A){B=dhtmlx.Template.setter(B);return B(A[0])},G=dhtmlx.Template.setter(A.by);if(!A.map[G])A.map[G]=[G,C];var F={},B=[];this.data.each(function(C){var A=G(C);if(!F[A]){B.push({id:A});F[A]=dhtmlx.toArray()}F[A].push(C)});for(var D in A.map){var E=(A.map[D][1]||C);if(typeof E!="function")E=this[E];for(var H=0;H<B.length;H++)B[H][D]=E.call(this,A.map[D][0],F[B[H].id])}this._not_grouped_data=this.data;this.data=new dhtmlx.DataStore();this.data.provideApi(this,true);this._init_group_data_event(this.data,this);this.parse(B,"json")},group:function(A,B){this.ungroup(false);this._split_data_by(A);if(B!==false)this.render()},ungroup:function(A){if(this._not_grouped_data){this.data=this._not_grouped_data;this.data.provideApi(this,true)}if(A!==false)this.render()},group_setter:function(A){dhtmlx.assert(typeof A=="object","Incorrect group value");dhtmlx.assert(A.by,"group.by is mandatory");dhtmlx.assert(A.map,"group.map is mandatory");return A},sort_setter:function(A){if(typeof A!="object")A={by:A};this._mergeSettings(A,{as:"string",dir:"asc"});return A}};dhtmlx.KeyEvents={_init:function(){dhtmlx.event(this._obj,"keypress",this._onKeyPress,this)},_onKeyPress:function(A){A=A||event;var B=A.which||A.keyCode;this.callEvent((this._edit_id?"onEditKeyPress":"onKeyPress"),[B,A.ctrlKey,A.shiftKey,A])}};dhtmlx.MouseEvents={_init:function(){if(this.on_click){dhtmlx.event(this._obj,"click",this._onClick,this);dhtmlx.event(this._obj,"contextmenu",this._onContext,this)}if(this.on_dblclick)dhtmlx.event(this._obj,"dblclick",this._onDblClick,this);if(this.on_mouse_move){dhtmlx.event(this._obj,"mousemove",this._onMouse,this);dhtmlx.event(this._obj,(dhtmlx._isIE?"mouseleave":"mouseout"),this._onMouse,this)}},_onClick:function(A){return this._mouseEvent(A,this.on_click,"ItemClick")},_onDblClick:function(A){return this._mouseEvent(A,this.on_dblclick,"ItemDblClick")},_onContext:function(B){var A=dhtmlx.html.locate(B,this._id);if(A&&!this.callEvent("onBeforeContextMenu",[A,B]))return dhtmlx.html.preventEvent(B)},_onMouse:function(A){if(dhtmlx._isIE)A=document.createEventObject(event);if(this._mouse_move_timer)window.clearTimeout(this._mouse_move_timer);this.callEvent("onMouseMoving",[A]);this._mouse_move_timer=window.setTimeout(dhtmlx.bind(function(){if(A.type=="mousemove")this._onMouseMove(A);else this._onMouseOut(A)},this),500)},_onMouseMove:function(A){if(!this._mouseEvent(A,this.on_mouse_move,"MouseMove"))this.callEvent("onMouseOut",[A||event])},_onMouseOut:function(A){this.callEvent("onMouseOut",[A||event])},_mouseEvent:function(B,C,D){B=B||event;var E=B.target||B.srcElement,F="",A=null,G=false;while(E&&E.parentNode){if(!G&&E.getAttribute){A=E.getAttribute(this._id);if(A){if(E.getAttribute("userdata"))this.callEvent("onLocateData",[A,E]);if(!this.callEvent("on"+D,[A,B,E]))return;G=true}}F=E.className;if(F){F=F.split(" ");F=F[0]||F[1];if(C[F])return C[F].call(this,B,A||dhx.html.locate(B,this._id),E)}E=E.parentNode}return G}};dhtmlx.Settings={_init:function(){this._settings=this.config={}},define:function(B,A){if(typeof B=="object")return this._parseSeetingColl(B);return this._define(B,A)},_define:function(C,A){dhtmlx.assert_settings.call(this,C,A);var B=this[C+"_setter"];return this._settings[C]=B?B.call(this,A):A},_parseSeetingColl:function(B){if(B)for(var A in B)this._define(A,B[A])},_parseSettings:function(C,A){var B=dhtmlx.extend({},A);if(typeof C=="object"&&!C.tagName)dhtmlx.extend(B,C);this._parseSeetingColl(B)},_mergeSettings:function(B,A){for(var C in A)switch(typeof B[C]){case"object":B[C]=this._mergeSettings((B[C]||{}),A[C]);break;case"undefined":B[C]=A[C];break;default:break}return B},_parseContainer:function(C,B,A){if(typeof C=="object"&&!C.tagName)C=C.container;this._obj=dhtmlx.toNode(C);if(!this._obj&&A)this._obj=A(C);dhtmlx.assert(this._obj,"Incorrect html container");this._obj.className+=" "+B;this._obj.onselectstart=function(){return false};this._dataobj=this._obj},_set_type:function(A){if(typeof A=="object")return this.type_setter(A);dhtmlx.assert(this.types,"RenderStack :: Types are not defined");dhtmlx.assert(this.types[A],"RenderStack :: Inccorect type name",A);this.type=dhtmlx.extend({},this.types[A]);this.customize()},customize:function(A){if(A)dhtmlx.extend(this.type,A);this.type._item_start=dhtmlx.Template.fromHTML(this.template_item_start(this.type));this.type._item_end=this.template_item_end(this.type);this.render()},type_setter:function(A){this._set_type(typeof A=="object"?dhtmlx.Type.add(this,A):A);return A},template_setter:function(A){return this.type_setter({template:A})},css_setter:function(A){this._obj.className+=" "+A;return A}};dhtmlx.compat=function(A,B){if(dhtmlx.compat[A])dhtmlx.compat[A](B)};(function(){if(!window.dhtmlxError){var B=function(){};window.dhtmlxError={catchError:B,throwError:B};window.convertStringToBoolean=function(A){return!!A};window.dhtmlxEventable=function(A){dhtmlx.extend(A,dhtmlx.EventSystem)};var A={getXMLTopNode:function(A){},doXPath:function(A){return dhtmlx.DataDriver.xml.xpath(this.xml,A)},xmlDoc:{responseXML:true}};dhtmlx.compat.dataProcessor=function(F){var D="_sendData",E="_in_progress",B="_tMode",C="_waitMode";F[D]=function(D,H){if(!D)return;if(H)this[E][H]=(new Date()).valueOf();if(!this.callEvent("onBeforeDataSending",H?[H,this.getState(H)]:[]))return false;var F=this,G=this.serverProcessor;if(this[B]!="POST")dhtmlx.ajax().get(G+((G.indexOf("?")!=-1)?"&":"?")+this.serialize(D,H),"",function(B,D,C){A.xml=dhtmlx.DataDriver.xml.checkResponse(B,D);F.afterUpdate(F,null,null,null,A)});else dhtmlx.ajax().post(G,this.serialize(D,H),function(B,D,C){A.xml=dhtmlx.DataDriver.xml.checkResponse(B,D);F.afterUpdate(F,null,null,null,A)});this[C]++}}}})();if(!dhtmlx.attaches)dhtmlx.attaches={};dhtmlx.attaches.attachAbstract=function(B,E){var D=document.createElement("DIV");D.id="CustomObject_"+dhtmlx.uid();D.style.width="100%";D.style.height="100%";D.cmp="grid";document.body.appendChild(D);this.attachObject(D.id);E.container=D.id;var A=this.vs[this.av];A.grid=new window[B](E);A.gridId=D.id;A.gridObj=D;A.grid.setSizes=function(){if(this.resize)this.resize();else this.render()};var C="_viewRestore";return this.vs[this[C]()].grid};dhtmlx.attaches.attachDataView=function(A){return this.attachAbstract("dhtmlXDataView",A)};dhtmlx.attaches.attachChart=function(A){return this.attachAbstract("dhtmlXChart",A)};dhtmlx.compat.layout=function(){};dhtmlx.DataDriver.dhtmlxgrid={_grid_getter:"_get_cell_value",toObject:function(A){this._grid=A;return A},getRecords:function(A){return A.rowsBuffer},getDetails:function(B){var A={};for(var C=0;C<this._grid.getColumnsNum();C++)A["data"+C]=this._grid[this._grid_getter](B,C);return A},getInfo:function(A){return{_size:0,_from:0}}};dhtmlx.Canvas={_init:function(){this._canvas_labels=[]},_prepareCanvas:function(A){this._canvas=dhtmlx.html.create("canvas",{width:A.offsetWidth,height:A.offsetHeight});A.appendChild(this._canvas);if(!this._canvas.getContext)if(dhtmlx._isIE){dhtmlx.require("thirdparty/excanvas/excanvas.js");G_vmlCanvasManager.init_(document);G_vmlCanvasManager.initElement(this._canvas)}else dhtmlx.error("Canvas is not supported in the current browser");return this._canvas},getCanvas:function(A){return(this._canvas||this._prepareCanvas(this._obj)).getContext(A||"2d")},_resizeCanvas:function(){if(this._canvas){this._canvas.setAttribute("width",this._canvas.parentNode.offsetWidth);this._canvas.setAttribute("height",this._canvas.parentNode.offsetHeight)}},renderText:function(F,E,B,D,A){if(!B)return;var C=dhtmlx.html.create("DIV",{"class":"dhx_canvas_text"+(D?(" "+D):""),"style":"left:"+F+"px;top:"+E+"px;"},B);this._obj.appendChild(C);this._canvas_labels.push(C);if(A)C.style.width=A+"px";return C},renderTextAt:function(F,E,H,G,C,D,A){var B=this.renderText.call(this,H,G,C,D,A);if(B){if(F)if(F=="middle")B.style.top=parseInt(G-B.offsetHeight/2,10)+"px";else B.style.top=G-B.offsetHeight+"px";if(E)if(E=="left")B.style.left=H-B.offsetWidth+"px";else B.style.left=parseInt(H-B.offsetWidth/2,10)+"px"}return B},clearCanvas:function(){for(var A=0;A<this._canvas_labels.length;A++)this._obj.removeChild(this._canvas_labels[A]);this._canvas_labels=[];if(this._obj._htmlmap){this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap);this._obj._htmlmap=null}this.getCanvas().clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight)}};dhtmlXChart=function(A){this.name="Chart";this.version="3.0";if(dhtmlx.assert_enabled())this._assert();dhtmlx.extend(this,dhtmlx.Settings);this._parseContainer(A,"dhx_chart");dhtmlx.extend(this,dhtmlx.AtomDataLoader);dhtmlx.extend(this,dhtmlx.DataLoader);this.data.provideApi(this,true);dhtmlx.extend(this,dhtmlx.EventSystem);dhtmlx.extend(this,dhtmlx.MouseEvents);dhtmlx.extend(this,dhtmlx.Destruction);dhtmlx.extend(this,dhtmlx.Canvas);dhtmlx.extend(this,dhtmlx.Group);dhtmlx.extend(this,dhtmlx.AutoTooltip);for(var B in dhtmlx.chart)dhtmlx.extend(this,dhtmlx.chart[B]);if(A.preset)this.definePreset(A);this._parseSettings(A,this.defaults);this._series=[this._settings];this.data.attachEvent("onStoreUpdated",dhtmlx.bind(function(){this.render()},this));this.attachEvent("onLocateData",this._switchSerie)};dhtmlXChart.prototype={_id:"dhx_area_id",on_click:{},on_dblclick:{},on_mouse_move:{},bind:function(){dhx.BaseBind.legacyBind.apply(this,arguments)},sync:function(){dhx.BaseBind.legacySync.apply(this,arguments)},resize:function(){this._resizeCanvas();this.render()},view_setter:function(A){if(!dhtmlx.chart[A])dhtmlx.error("Chart type extension is not loaded: "+A);if(typeof this._settings.offset=="undefined")this._settings.offset=!(A=="area"||A=="stackedArea");if(A=="radar"&&!this._settings.yAxis)this.define("yAxis",{});if(A=="scatter"){if(!this._settings.yAxis)this.define("yAxis",{});if(!this._settings.xAxis)this.define("xAxis",{})}return A},render:function(){if(!this.callEvent("onBeforeRender",[this.data]))return;this.clearCanvas();if(this._settings.legend)this._drawLegend(this.getCanvas(),this.data.getRange(),this._obj.offsetWidth);var A=this._getChartBounds(this._obj.offsetWidth,this._obj.offsetHeight),B=new dhtmlx.ui.Map(this._id),C=this._settings;for(var D=0;D<this._series.length;D++){this._settings=this._series[D];this["pvt_render_"+this._settings.view](this.getCanvas(),this.data.getRange(),A.start,A.end,D,B)}B.render(this._obj);this._settings=C},value_setter:dhtmlx.Template.obj_setter,xValue_setter:dhtmlx.Template.obj_setter,yValue_setter:function(A){this.define("value",A)},alpha_setter:dhtmlx.Template.obj_setter,label_setter:dhtmlx.Template.obj_setter,lineColor_setter:dhtmlx.Template.obj_setter,pieInnerText_setter:dhtmlx.Template.obj_setter,gradient_setter:function(A){if((typeof(A)!="function")&&A&&(A===true))A="light";return A},colormap:{"RAINBOW":function(A){var B=Math.floor(this.indexById(A.id)/this.dataCount()*1536);if(B==1536)B-=1;return this._rainbow[Math.floor(B/256)](B%256)}},color_setter:function(A){return this.colormap[A]||dhtmlx.Template.obj_setter(A)},fill_setter:function(A){return((!A||A==0)?false:dhtmlx.Template.obj_setter(A))},definePreset:function(A){this.define("preset",A.preset);delete A.preset},preset_setter:function(C){var B,A,D;this.defaults=dhtmlx.extend({},this.defaults);if(typeof dhtmlx.presets.chart[C]=="object"){D=dhtmlx.presets.chart[C];for(B in D)if(typeof D[B]=="object"){if(!this.defaults[B]||typeof this.defaults[B]!="object")this.defaults[B]=dhtmlx.extend({},D[B]);else{this.defaults[B]=dhtmlx.extend({},this.defaults[B]);for(A in D[B])this.defaults[B][A]=D[B][A]}}else this.defaults[B]=D[B];return C}return false},legend_setter:function(A){if(!A){if(this.legendObj){this.legendObj.innerHTML="";this.legendObj=null}return false}if(typeof(A)!="object")A={template:A};this._mergeSettings(A,{width:150,height:18,layout:"y",align:"left",valign:"bottom",template:"",marker:{type:"square",width:15,height:15,radius:3},margin:4,padding:3});A.template=dhtmlx.Template.setter(A.template);return A},defaults:{color:"RAINBOW",alpha:"1",label:false,value:"{obj.value}",padding:{},view:"pie",lineColor:"#ffffff",cant:0.5,width:30,labelWidth:100,line:{width:2,color:"#1293f8"},item:{radius:3,borderColor:"#636363",borderWidth:1,color:"#ffffff",alpha:1,type:"r",shadow:false},shadow:true,gradient:false,border:true,labelOffset:20,origin:"auto"},item_setter:function(A){if(typeof(A)!="object")A={color:A,borderColor:A};this._mergeSettings(A,dhtmlx.extend({},this.defaults.item));A.alpha=dhtmlx.Template.setter(A.alpha);A.borderColor=dhtmlx.Template.setter(A.borderColor);A.color=dhtmlx.Template.setter(A.color);A.radius=dhtmlx.Template.setter(A.radius);return A},line_setter:function(A){if(typeof(A)!="object")A={color:A};dhtmlx.extend(this.defaults.line,A);A=dhtmlx.extend({},this.defaults.line);A.color=dhtmlx.Template.setter(A.color);return A},padding_setter:function(A){if(typeof(A)!="object")A={left:A,right:A,top:A,bottom:A};this._mergeSettings(A,{left:50,right:20,top:35,bottom:40});return A},xAxis_setter:function(B){if(!B)return false;if(typeof(B)!="object")B={template:B};this._mergeSettings(B,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:true});var A=["lineColor","template","lines"];this._converToTemplate(A,B);this._settings.configXAxis=dhtmlx.extend({},B);return B},yAxis_setter:function(B){this._mergeSettings(B,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:true,bg:"#ffffff"});var A=["lineColor","template","lines","bg"];this._converToTemplate(A,B);this._settings.configYAxis=dhtmlx.extend({},B);return B},_converToTemplate:function(A,B){for(var C=0;C<A.length;C++)B[A[C]]=dhtmlx.Template.setter(B[A[C]])},_drawScales:function(C,B,D,E,A,G,H){var F=this._drawYAxis(C,B,D,E,A,G);this._drawXAxis(C,B,D,E,H,F);return F},_drawXAxis:function(I,B,J,K,D,L){if(!this._settings.xAxis)return;var C=J.x-0.5,A=parseInt((L?L:K.y),10)+0.5,E=K.x,H,G=true;this._drawLine(I,C,A,E,A,this._settings.xAxis.color,1);for(var F=0;F<B.length;F++){if(this._settings.offset===true)H=C+D/2+F*D;else{H=(F==B.length-1)?K.x:C+F*D;G=!!F}H=parseInt(H,10)-0.5;var M=((this._settings.origin!="auto")&&(this._settings.view=="bar")&&(parseFloat(this._settings.value(B[F]))<this._settings.origin));this._drawXAxisLabel(H,A,B[F],G,M);if((this._settings.offset||F)&&this._settings.xAxis.lines.call(this,B[F]))this._drawXAxisLine(I,H,K.y,J.y,B[F])}this.renderTextAt(true,false,C,K.y+this._settings.padding.bottom-3,this._settings.xAxis.title,"dhx_axis_title_x",K.x-J.x);if(!this._settings.xAxis.lines.call(this,{})||!this._settings.offset)return;this._drawLine(I,E+0.5,K.y,E+0.5,J.y+0.5,this._settings.xAxis.color,0.2)},_drawYAxis:function(M,E,O,P,L,Q){var R,B={};if(!this._settings.yAxis)return;var I=O.x-0.5,D=P.y,F=O.y,A=P.y;if(this._settings.yAxis.step)R=parseFloat(this._settings.yAxis.step);if(typeof this._settings.configYAxis.step=="undefined"||typeof this._settings.configYAxis.start=="undefined"||typeof this._settings.configYAxis.end=="undefined"){B=this._calculateScale(L,Q);L=B.start;Q=B.end;R=B.step;this._settings.yAxis.end=Q;this._settings.yAxis.start=L}this._setYAxisTitle(O,P);if(R===0)return;if(Q==L)return D;var K=(D-F)*R/(Q-L),C=0;for(var J=L;J<=Q;J+=R){if(B.fixNum)J=parseFloat((new Number(J)).toFixed(B.fixNum));var S=Math.floor(D-C*K)+0.5;if(!(J==L&&this._settings.origin=="auto")&&this._settings.yAxis.lines(J))this._drawLine(M,I,S,P.x,S,this._settings.yAxis.lineColor(J),1);if(J==this._settings.origin)A=S;var H=J;if(R<1){var N=Math.min(this._log10(R),(L<=0?0:this._log10(L))),G=Math.pow(10,-N);H=Math.round(J*G)/G;J=H}this.renderText(0,S-5,this._settings.yAxis.template(H.toString()),"dhx_axis_item_y",O.x-5);C++}this._drawLine(M,I,D+1,I,F,this._settings.yAxis.color,1);return A},_setYAxisTitle:function(C,D){var B="dhx_axis_title_y"+(dhtmlx._isIE&&dhtmlx._isIE!=9?" dhx_ie_filter":""),A=this.renderTextAt("middle",false,0,parseInt((D.y-C.y)/2+C.y,10),this._settings.yAxis.title,B);if(A)A.style.left=(dhtmlx.env.transform?(A.offsetHeight-A.offsetWidth)/2:0)+"px"},_calculateScale:function(A,C){if(this._settings.origin!="auto"&&this._settings.origin<A)A=this._settings.origin;var K,B,J;K=((C-A)/8)||1;var H=Math.floor(this._log10(K)),I=Math.pow(10,H),G=K/I;G=(G>5?10:5);K=parseInt(G,10)*I;if(K>Math.abs(A))B=(A<0?-K:0);else{var E=Math.abs(A),F=Math.floor(this._log10(E)),D=E/Math.pow(10,F);B=Math.ceil(D*10)/10*Math.pow(10,F)-K;if(E>1&&K>0.1)B=Math.ceil(B);while(A<0?B<=A:B>=A)B-=K;if(A<0)B=-B-2*K}J=B;while(J<C){J+=K;J=parseFloat((new Number(J)).toFixed(Math.abs(H)))}return{start:B,end:J,step:K,fixNum:Math.abs(H)}},_getLimits:function(B,E){var H,C,A=((arguments.length&&B=="h")?this._settings.configXAxis:this._settings.configYAxis);if(A&&(typeof A.end!="undefined")&&(typeof A.start!="undefined")&&A.step){H=parseFloat(A.end);C=parseFloat(A.start)}else{H=this.max(this._series[0][E||"value"]);C=(A&&(typeof A.start!="undefined"))?parseFloat(A.start):this.min(this._series[0][E||"value"]);if(this._series.length>1)for(var G=1;G<this._series.length;G++){var F=this.max(this._series[G][E||"value"]),D=this.min(this._series[G][E||"value"]);if(F>H)H=F;if(D<C)C=D}}return{max:H,min:C}},_log10:function(B){var A="log";return Math.floor((Math[A](B)/Math.LN10))},_drawXAxisLabel:function(F,D,C,B,E){if(!this._settings.xAxis)return;var A=this.renderTextAt(E,B,F,D-(E?2:0),this._settings.xAxis.template(C));if(A)A.className+=" dhx_axis_item_x"},_drawXAxisLine:function(B,E,A,C,D){if(!this._settings.xAxis||!this._settings.xAxis.lines)return;this._drawLine(B,E,A,E,C,this._settings.xAxis.lineColor.call(this,D),1)},_drawLine:function(D,G,C,F,E,A,B){D.strokeStyle=A;D.lineWidth=B;D.beginPath();D.moveTo(G,C);D.lineTo(F,E);D.stroke();D.lineWidth=1},_getRelativeValue:function(C,E){var B,D,A=1;if(E!=C){D=E-C;if(Math.abs(B)<1)while(Math.abs(B)<1){A*=10;D=B*A}B=D}else B=C;return[B,A]},_rainbow:[function(A){return"#FF"+dhtmlx.math.toHex(A/2,2)+"00"},function(A){return"#FF"+dhtmlx.math.toHex(A/2+128,2)+"00"},function(A){return"#"+dhtmlx.math.toHex(255-A,2)+"FF00"},function(A){return"#00FF"+dhtmlx.math.toHex(A,2)},function(A){return"#00"+dhtmlx.math.toHex(255-A,2)+"FF"},function(A){return"#"+dhtmlx.math.toHex(A,2)+"00FF"}],addSeries:function(B){var A=this._settings;this._settings=dhtmlx.extend({},A);this._parseSettings(B,{});this._series.push(this._settings);this._settings=A},_switchSerie:function(A,B){var C;this._active_serie=B.getAttribute("userdata");if(!this._series[this._active_serie])return;for(var D=0;D<this._series.length;D++){C=this._series[D].tooltip;if(C)C.disable()}C=this._series[this._active_serie].tooltip;if(C)C.enable()},_drawLegend:function(K,B,A){var F,I,D,H,L,C,G,N=0,M=0;I=this._settings.legend;G=(this._settings.legend.layout!="x"?"width:"+I.width+"px":"");if(this.legendObj)this.legendObj.innerHTML="";D=dhtmlx.html.create("DIV",{"class":"dhx_chart_legend","style":"left:"+N+"px;top:"+M+"px;"+G},"");if(I.padding)D.style.padding=I.padding+"px";this.legendObj=D;this._obj.appendChild(D);L=[];if(!I.values){for(F=0;F<B.length;F++)L.push(this._drawLegendText(D,I.template(B[F])))}else for(F=0;F<I.values.length;F++)L.push(this._drawLegendText(D,I.values[F].text));C=D.offsetWidth;H=D.offsetHeight;if(C<this._obj.offsetWidth){if(I.layout=="x"&&I.align=="center")N=(this._obj.offsetWidth-C)/2;if(I.align=="right")N=this._obj.offsetWidth-C;if(I.margin&&I.align!="center")N+=(I.align=="left"?1:-1)*I.margin}if(H<this._obj.offsetHeight){if(I.valign=="middle"&&I.align!="center"&&I.layout!="x")M=(this._obj.offsetHeight-H)/2;else if(I.valign=="bottom")M=this._obj.offsetHeight-H;if(I.margin&&I.valign!="middle")M+=(I.valign=="top"?1:-1)*I.margin}D.style.left=N+"px";D.style.top=M+"px";K.save();for(F=0;F<L.length;F++){var J=L[F],E=(I.values?I.values[F].color:this._settings.color.call(this,B[F]));this._drawLegendMarker(K,J.offsetLeft+N,J.offsetTop+M,E,J.offsetHeight)}K.restore();L=null},_drawLegendText:function(D,C){var B="";if(this._settings.legend.layout=="x")B="float:left;";var A=dhtmlx.html.create("DIV",{"style":B+"padding-left:"+(10+this._settings.legend.marker.width)+"px","class":"dhx_chart_legend_item"},C);D.appendChild(A);return A},_drawLegendMarker:function(E,I,G,C,A){var B=this._settings.legend.marker;E.strokeStyle=E.fillStyle=C;E.beginPath();if(B.type=="round"||!B.radius){E.lineWidth=B.height;E.lineCap=B.type;I+=E.lineWidth/2+5;G+=A/2;E.moveTo(I,G);var H=I+B.width-B.height+1;E.lineTo(H,G)}else{E.lineWidth=1;var F,D;I+=5;G+=A/2-B.height/2;F=I+B.width/2;D=G+B.height/2;E.arc(I+B.radius,G+B.radius,B.radius,Math.PI,3*Math.PI/2,false);E.lineTo(I+B.width-B.radius,G);E.arc(I+B.width-B.radius,G+B.radius,B.radius,-Math.PI/2,0,false);E.lineTo(I+B.width,G+B.height-B.radius);E.arc(I+B.width-B.radius,G+B.height-B.radius,B.radius,0,Math.PI/2,false);E.lineTo(I+B.radius,G+B.height);E.arc(I+B.radius,G+B.height-B.radius,B.radius,Math.PI/2,Math.PI,false);E.lineTo(I,G+B.radius)}E.stroke();E.fill()},_getChartBounds:function(H,C){var A,E,B,G;A=this._settings.padding.left;E=this._settings.padding.top;B=H-this._settings.padding.right;G=C-this._settings.padding.bottom;if(this._settings.legend){var F=this._settings.legend,I=this._settings.legend.width,D=this._settings.legend.height;if(F.layout=="x"){if(F.valign=="center"){if(F.align=="right")B-=I;else if(F.align=="left")A+=I}else if(F.valign=="bottom")G-=D;else E+=D}else if(F.align=="right")B-=I;else if(F.align=="left")A+=I}return{start:{x:A,y:E},end:{x:B,y:G}}},_getStackedLimits:function(C){var F,D,E,A,B;if(this._settings.yAxis&&(typeof this._settings.yAxis.end!="undefined")&&(typeof this._settings.yAxis.start!="undefined")&&this._settings.yAxis.step){E=parseFloat(this._settings.yAxis.end);A=parseFloat(this._settings.yAxis.start)}else{for(F=0;F<C.length;F++){C[F].$sum=0;C[F].$min=Infinity;for(D=0;D<this._series.length;D++){B=parseFloat(this._series[D].value(C[F])||0);if(isNaN(B))continue;C[F].$sum+=B;if(B<C[F].$min)C[F].$min=B}}E=-Infinity;A=Infinity;for(F=0;F<C.length;F++){if(C[F].$sum>E)E=C[F].$sum;if(C[F].$min<A)A=C[F].$min}if(A>0)A=0}return{max:E,min:A}},_setBarGradient:function(J,G,B,E,C,F,H,A){var M,K,D,I,L;if(F=="light"){if(A=="x")M=J.createLinearGradient(G,B,E,B);else M=J.createLinearGradient(G,B,G,C);M.addColorStop(0,"#FFFFFF");M.addColorStop(0.9,H);M.addColorStop(1,H);K=2}else if(F=="falling"||F=="rising"){if(A=="x")M=J.createLinearGradient(G,B,E,B);else M=J.createLinearGradient(G,B,G,C);D=dhtmlx.math.toRgb(H);I=dhtmlx.math.rgbToHsv(D[0],D[1],D[2]);I[1]*=1/2;L="rgb("+dhtmlx.math.hsvToRgb(I[0],I[1],I[2])+")";if(F=="falling"){M.addColorStop(0,L);M.addColorStop(0.7,H);M.addColorStop(1,H)}else if(F=="rising"){M.addColorStop(0,H);M.addColorStop(0.3,H);M.addColorStop(1,L)}K=0}else{J.globalAlpha=0.37;K=0;if(A=="x")M=J.createLinearGradient(G,C,G,B);else M=J.createLinearGradient(G,B,E,B);M.addColorStop(0,"#9d9d9d");M.addColorStop(0.3,"#e8e8e8");M.addColorStop(0.45,"#ffffff");M.addColorStop(0.55,"#ffffff");M.addColorStop(0.7,"#e8e8e8");M.addColorStop(1,"#9d9d9d")}return{gradient:M,offset:K}},_getPositionByAngle:function(B,D,C,A){B*=(-1);D=D+Math.cos(B)*A;C=C-Math.sin(B)*A;return{x:D,y:C}}};dhtmlx.compat("layout");function dataProcessor(A){this.serverProcessor=A;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=true;this.updateMode="cell";this._tMode="GET";this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"};this.enableUTFencoding(true);dhtmlxEventable(this);return this}dataProcessor.prototype={setTransactionMode:function(B,A){this._tMode=B;this._tSend=A},escape:function(A){if(this._utf)return encodeURIComponent(A);else return escape(A)},enableUTFencoding:function(A){this._utf=convertStringToBoolean(A)},setDataColumns:function(A){this._columns=(typeof A=="string")?A.split(","):A},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(A){this._endnm=convertStringToBoolean(A)},enablePartialDataSend:function(A){this._changed=convertStringToBoolean(A)},setUpdateMode:function(B,A){this.autoUpdate=(B=="cell");this.updateMode=B;this.dnd=A},ignore:function(A,B){this._silent_mode=true;A.call(B||window);this._silent_mode=false},setUpdated:function(D,C,E){if(this._silent_mode)return;var A=this.findRow(D);E=E||"updated";var B=this.obj.getUserData(D,this.action_param);if(B&&E=="updated")E=B;if(C){this.set_invalid(D,false);this.updatedRows[A]=D;this.obj.setUserData(D,this.action_param,E);if(this._in_progress[D])this._in_progress[D]="wait"}else if(!this.is_invalid(D)){this.updatedRows.splice(A,1);this.obj.setUserData(D,this.action_param,"")}if(!C)this._clearUpdateFlag(D);this.markRow(D,C,E);if(C&&this.autoUpdate)this.sendData(D)},_clearUpdateFlag:function(A){},markRow:function(A,D,F){var C="",B=this.is_invalid(A);if(B){C=this.styles[B];D=true}if(this.callEvent("onRowMark",[A,D,F,B])){C=this.styles[D?F:"clear"]+C;this.obj[this._methods[0]](A,C);if(B&&B.details){C+=this.styles[B+"_cell"];for(var E=0;E<B.details.length;E++)if(B.details[E])this.obj[this._methods[1]](A,E,C)}}},getState:function(A){return this.obj.getUserData(A,this.action_param)},is_invalid:function(A){return this._invalid[A]},set_invalid:function(A,C,B){if(B)C={value:C,details:B,toString:function(){return this.value.toString()}};this._invalid[A]=C},checkBeforeUpdate:function(A){return true},sendData:function(A){if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2))return;if(this.obj.editStop)this.obj.editStop();if(typeof A=="undefined"||this._tSend)return this.sendAllData();if(this._in_progress[A])return false;this.messages=[];if(!this.checkBeforeUpdate(A)&&this.callEvent("onValidationError",[A,this.messages]))return false;this._beforeSendData(this._getRowData(A),A)},_beforeSendData:function(A,B){if(!this.callEvent("onBeforeUpdate",[B,this.getState(B),A]))return false;this._sendData(A,B)},serialize:function(C,A){if(typeof C=="string")return C;if(typeof A!="undefined")return this.serialize_one(C,"");else{var D=[],B=[];for(var E in C)if(C.hasOwnProperty(E)){D.push(this.serialize_one(C[E],E+this.post_delim));B.push(E)}D.push("ids="+this.escape(B.join(",")));if(dhtmlx.security_key)D.push("dhx_security="+dhtmlx.security_key);return D.join("&")}},serialize_one:function(A,D){if(typeof A=="string")return A;var B=[];for(var C in A)if(A.hasOwnProperty(C))B.push(this.escape((D||"")+C)+"="+this.escape(A[C]));return B.join("&")},_sendData:function(A,D){if(!A)return;if(!this.callEvent("onBeforeDataSending",D?[D,this.getState(D),A]:[null,null,A]))return false;if(D)this._in_progress[D]=(new Date()).valueOf();var B=new dtmlXMLLoaderObject(this.afterUpdate,this,true),C=this.serverProcessor+(this._user?(getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&")):"");if(this._tMode!="POST")B.loadXML(C+((C.indexOf("?")!=-1)?"&":"?")+this.serialize(A,D));else B.loadXML(C,true,this.serialize(A,D));this._waitMode++},sendAllData:function(){if(!this.updatedRows.length)return;this.messages=[];var A=true;for(var B=0;B<this.updatedRows.length;B++)A&=this.checkBeforeUpdate(this.updatedRows[B]);if(!A&&!this.callEvent("onValidationError",["",this.messages]))return false;if(this._tSend)this._sendData(this._getAllData());else for(B=0;B<this.updatedRows.length;B++)if(!this._in_progress[this.updatedRows[B]]){if(this.is_invalid(this.updatedRows[B]))continue;this._beforeSendData(this._getRowData(this.updatedRows[B]),this.updatedRows[B]);if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2))return}},_getAllData:function(C){var E={},B=false;for(var D=0;D<this.updatedRows.length;D++){var A=this.updatedRows[D];if(this._in_progress[A]||this.is_invalid(A))continue;if(!this.callEvent("onBeforeUpdate",[A,this.getState(A)]))continue;E[A]=this._getRowData(A,A+this.post_delim);B=true;this._in_progress[A]=(new Date()).valueOf()}return B?E:null},setVerificator:function(B,A){this.mandatoryFields[B]=A||(function(A){return(A!="")})},clearVerificator:function(A){this.mandatoryFields[A]=false},findRow:function(A){var B=0;for(B=0;B<this.updatedRows.length;B++)if(A==this.updatedRows[B])break;return B},defineAction:function(A,B){if(!this._uActions)this._uActions=[];this._uActions[A]=B},afterUpdateCallback:function(A,F,E,G){var C=A,B=(E!="error"&&E!="invalid");if(!B)this.set_invalid(A,E);if((this._uActions)&&(this._uActions[E])&&(!this._uActions[E](G)))return(delete this._in_progress[C]);if(this._in_progress[C]!="wait")this.setUpdated(A,false);var D=A;switch(E){case"inserted":case"insert":if(F!=A){this.obj[this._methods[2]](A,F);A=F}break;case"delete":case"deleted":this.obj.setUserData(A,this.action_param,"true_deleted");this.obj[this._methods[3]](A);delete this._in_progress[C];return this.callEvent("onAfterUpdate",[A,E,F,G]);break}if(this._in_progress[C]!="wait"){if(B)this.obj.setUserData(A,this.action_param,"");delete this._in_progress[C]}else{delete this._in_progress[C];this.setUpdated(F,true,this.obj.getUserData(A,this.action_param))}this.callEvent("onAfterUpdate",[A,E,F,G])},afterUpdate:function(B,D,E,C,H){H.getXMLTopNode("data");if(!H.xmlDoc.responseXML)return;var G=H.doXPath("//data/action");for(var K=0;K<G.length;K++){var J=G[K],F=J.getAttribute("type"),A=J.getAttribute("sid"),I=J.getAttribute("tid");B.afterUpdateCallback(A,I,F,J)}B.finalizeUpdate()},finalizeUpdate:function(){if(this._waitMode)this._waitMode--;if((this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length)this.sendData();this.callEvent("onAfterUpdateFinish",[]);if(!this.updatedRows.length)this.callEvent("onFullSync",[])},init:function(A){this.obj=A;if(this.obj._dp_init)this.obj._dp_init(this)},setOnAfterUpdate:function(A){this.attachEvent("onAfterUpdate",A)},enableDebug:function(A){},setOnBeforeUpdateHandler:function(A){this.attachEvent("onBeforeDataSending",A)},setAutoUpdate:function(A,C){A=A||2000;this._user=C||(new Date()).valueOf();this._need_update=false;this._loader=null;this._update_busy=false;this.attachEvent("onAfterUpdate",function(A,B,D,C){this.afterAutoUpdate(A,B,D,C)});this.attachEvent("onFullSync",function(){this.fullSync()});var B=this;window.setInterval(function(){B.loadUpdate()},A)},afterAutoUpdate:function(A,B,D,C){if(B=="collision"){this._need_update=true;return false}else return true},fullSync:function(){if(this._need_update==true){this._need_update=false;this.loadUpdate()}return true},getUpdates:function(B,A){if(this._update_busy)return false;else this._update_busy=true;this._loader=this._loader||new dtmlXMLLoaderObject(true);this._loader.async=true;this._loader.waitCall=A;this._loader.loadXML(B)},_v:function(A){if(A.firstChild)return A.firstChild.nodeValue;return""},_a:function(B){var A=[];for(var C=0;C<B.length;C++)A[C]=this._v(B[C]);return A},loadUpdate:function(){var A=this,C=this.obj.getUserData(0,"version"),B=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+C].join("&");B=B.replace("editing=true&","");this.getUpdates(B,function(){var F=A._loader.doXPath("//userdata");A.obj.setUserData(0,"version",A._v(F[0]));var C=A._loader.doXPath("//update");if(C.length){A._silent_mode=true;for(var G=0;G<C.length;G++){var D=C[G].getAttribute("status"),B=C[G].getAttribute("id"),E=C[G].getAttribute("parent");switch(D){case"inserted":A.callEvent("insertCallback",[C[G],B,E]);break;case"updated":A.callEvent("updateCallback",[C[G],B,E]);break;case"deleted":A.callEvent("deleteCallback",[C[G],B,E]);break}}A._silent_mode=false}A._update_busy=false;A=null})}};if(window.dhtmlXGridObject&&!dhtmlXGridObject.prototype._init_point_connector){dhtmlXGridObject.prototype._init_point_connector=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._con_f_used=[].concat(this._con_f_used);dhtmlXGridObject.prototype._con_f_used=[];var B=function(A){A=A.replace(/(\?|\&)connector[^\f]*/g,"");return A+(A.indexOf("?")!=-1?"&":"?")+"connector=true"+(this.hdr.rows.length>0?"&dhx_no_header=1":"")},A=function(A){return B.call(this,A)+(this._connector_sorting||"")+(this._connector_filter||"")},C=function(D,C,B){this._connector_sorting="&dhx_sort["+C+"]="+B;return A.call(this,D)},D=function(E,C,D){var B=[];for(var F=0;F<C.length;F++)B[F]="dhx_filter["+C[F]+"]="+encodeURIComponent(D[F]);this._connector_filter="&"+B.join("&");return A.call(this,E)};this.attachEvent("onCollectValues",function(A){if(this._con_f_used[A])if(typeof(this._con_f_used[A])=="object")return this._con_f_used[A];else return false;return true});this.attachEvent("onDynXLS",function(){this.xmlFileUrl=A.call(this,this.xmlFileUrl);return true});this.attachEvent("onBeforeSorting",function(B,E,A){if(E=="connector"){var D=this;this.clearAndLoad(C.call(this,this.xmlFileUrl,B,A),function(){D.setSortImgState(true,B,A)});return false}return true});this.attachEvent("onFilterStart",function(B,A){var E=this.getSortingState();if(this._con_f_used.length){var C=this;this.clearAndLoad(D.call(this,this.xmlFileUrl,B,A));if(E.length)C.setSortImgState(true,E[0],E[1]);return false}return true});this.attachEvent("onXLE",function(C,A,B,D){if(!D)return});if(this._init_point_connector)this._init_point_connector()};dhtmlXGridObject.prototype._con_f_used=[];dhtmlXGridObject.prototype._in_header_connector_text_filter=function(A,B){if(!this._con_f_used[B])this._con_f_used[B]=1;return this._in_header_text_filter(A,B)};dhtmlXGridObject.prototype._in_header_connector_select_filter=function(A,B){if(!this._con_f_used[B])this._con_f_used[B]=2;return this._in_header_select_filter(A,B)};dhtmlXGridObject.prototype.load_connector=dhtmlXGridObject.prototype.load;dhtmlXGridObject.prototype.load=function(D,A,C){if(!this._colls_loaded&&this.cellType){var B=[];for(var E=0;E<this.cellType.length;E++)if(this.cellType[E].indexOf("co")==0||this._con_f_used[E]==2)B.push(E);if(B.length)arguments[0]+=(arguments[0].indexOf("?")!=-1?"&":"?")+"connector=true&dhx_colls="+B.join(",")}return this.load_connector.apply(this,arguments)};dhtmlXGridObject.prototype._parseHead_connector=dhtmlXGridObject.prototype._parseHead;dhtmlXGridObject.prototype._parseHead=function(K,C,H){this._parseHead_connector.apply(this,arguments);if(!this._colls_loaded){var F=this.xmlLoader.doXPath("./coll_options",arguments[0]);for(var L=0;L<F.length;L++){var A=F[L].getAttribute("for"),M=[],G=null;if(this.cellType[A]=="combo")G=this.getColumnCombo(A);else if(this.cellType[A].indexOf("co")==0)G=this.getCombo(A);var D=this.xmlLoader.doXPath("./item",F[L]),E=[];for(var I=0;I<D.length;I++){var B=D[I].getAttribute("value");if(G){var J=D[I].getAttribute("label")||B;if(G.addOption)E.push([B,J]);else G.put(B,J);M[M.length]=J}else M[M.length]=B}if(E.length)G.addOption(E);if(this._con_f_used[A*1])this._con_f_used[A*1]=M}this._colls_loaded=true}}}if(window.dataProcessor&&!dataProcessor.prototype.init_original){dataProcessor.prototype.init_original=dataProcessor.prototype.init;dataProcessor.prototype.init=function(A){this.init_original(A);A._dataprocessor=this;this.setTransactionMode("POST",true);this.serverProcessor+=(this.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true"}}dhtmlxError.catchError("LoadXML",function(C,A,B){alert(B[0].responseText)});window.dhx||(dhx={});dhx.version="3.0";dhx.codebase="./";dhx.name="Core";dhx.clone=function(B){var A=dhx.clone.xa;A.prototype=B;return new A};dhx.clone.xa=function(){};dhx.extend=function(D,B,C){if(D.q)return dhx.PowerArray.insertAt.call(D.q,B,1),D;for(var A in B)if(!D[A]||C)D[A]=B[A];B.defaults&&dhx.extend(D.defaults,B.defaults);B.$init&&B.$init.call(D);return D};dhx.copy=function(C){if(arguments.length>1)var A=arguments[0],C=arguments[1];else A=dhx.isArray(C)?[]:{};for(var B in C)C[B]&&typeof C[B]=="object"&&!dhx.isDate(C[B])?(A[B]=dhx.isArray(C[B])?[]:{},dhx.copy(A[B],C[B])):A[B]=C[B];return A};dhx.single=function(C){var A=null,B=function(B){A||(A=new C({}));A.Ia&&A.Ia.apply(A,arguments);return A};return B};dhx.protoUI=function(){var C=arguments,A=C[0].name,B=function(F){if(!B)return dhx.ui[A].prototype;var E=B.q;if(E){for(var C=[E[0]],D=1;D<E.length;D++)C[D]=E[D],C[D].q&&(C[D]=C[D].call(dhx,C[D].name)),C[D].prototype&&C[D].prototype.name&&(dhx.ui[C[D].prototype.name]=C[D]);dhx.ui[A]=dhx.proto.apply(dhx,C);if(B.r)for(D=0;D<B.r.length;D++)dhx.Type(dhx.ui[A],B.r[D]);B=E=null}return this!=dhx?new dhx.ui[A](F):dhx.ui[A]};B.q=Array.prototype.slice.call(arguments,0);return dhx.ui[A]=B};dhx.proto=function(){for(var G=arguments,E=G[0],F=!!E.$init,C=[],D=G.length-1;D>0;D--){if(typeof G[D]=="function")G[D]=G[D].prototype;G[D].$init&&C.push(G[D].$init);if(G[D].defaults){var A=G[D].defaults;if(!E.defaults)E.defaults={};for(var B in A)dhx.isUndefined(E.defaults[B])&&(E.defaults[B]=A[B])}if(G[D].type&&E.type)for(B in G[D].type)E.type[B]||(E.type[B]=G[D].type[B]);for(var H in G[D])E[H]||(E[H]=G[D][H])}F&&C.push(E.$init);E.$init=function(){for(var A=0;A<C.length;A++)C[A].apply(this,arguments)};var I=function(B){this.$ready=[];this.$init(B);this.$&&this.$(B,this.defaults);for(var A=0;A<this.$ready.length;A++)this.$ready[A].call(this)};I.prototype=E;E=G=null;return I};dhx.bind=function(B,A){return function(){return B.apply(A,arguments)}};dhx.require=function(G,E,F,C,D){if(typeof G!="string"){var A=G.length||0,B=E;if(A)E=function(){if(A)A--,dhx.require(G[G.length-A-1],E,F);else return B.apply(this,arguments)},E();else{for(var I in G)A++;E=function(){A--;A==0&&B.apply(this,arguments)};for(I in G)dhx.require(I,E,F)}}else if(dhx.i[G]!==!0)if(G.substr(-4)==".css"){var J=dhx.html.create("LINK",{type:"text/css",rel:"stylesheet",href:dhx.codebase+G});document.head.appendChild(J);E&&E.call(F||window)}else{var H=D;E?dhx.i[G]?dhx.i[G].push([E,F]):(dhx.i[G]=[[E,F]],dhx.ajax(dhx.codebase+G,function(B){dhx.exec(B);var C=dhx.i[G];dhx.i[G]=!0;for(var A=0;A<C.length;A++)C[A][0].call(C[A][1]||window,!A)})):(dhx.exec(dhx.ajax().sync().get(dhx.codebase+G).responseText),dhx.i[G]=!0)}};dhx.i={};dhx.exec=function(A){window.execScript?window.execScript(A):window.eval(A)};dhx.wrap=function(B,A){return!B?A:function(){var C=B.apply(this,arguments);A.apply(this,arguments);return C}};dhx.isUndefined=function(A){return typeof A=="undefined"};dhx.delay=function(D,B,C,A){return window.setTimeout(function(){var A=D.apply(B,C||[]);D=B=C=null;return A},A||1)};dhx.uid=function(){if(!this.R)this.R=(new Date).valueOf();this.R++;return this.R};dhx.toNode=function(A){return typeof A=="string"?document.getElementById(A):A};dhx.toArray=function(A){return dhx.extend(A||[],dhx.PowerArray,!0)};dhx.toFunctor=function(a){return typeof a=="string"?eval(a):a};dhx.isArray=function(A){return Array.isArray?Array.isArray(A):Object.prototype.toString.call(A)==="[object Array]"};dhx.isDate=function(A){return A instanceof Date};dhx.L={};dhx.event=function(E,C,D,A){var E=dhx.toNode(E),B=dhx.uid();A&&(D=dhx.bind(D,A));dhx.L[B]=[E,C,D];E.addEventListener?E.addEventListener(C,D,!1):E.attachEvent&&E.attachEvent("on"+C,D);return B};dhx.eventRemove=function(B){if(B){var A=dhx.L[B];A[0].removeEventListener?A[0].removeEventListener(A[1],A[2],!1):A[0].detachEvent&&A[0].detachEvent("on"+A[1],A[2]);delete this.L[B]}};dhx.EventSystem={$init:function(){if(!this.e)this.e={},this.s={},this.M={}},blockEvent:function(){this.e.T=!0},unblockEvent:function(){this.e.T=!1},mapEvent:function(A){dhx.extend(this.M,A,!0)},on_setter:function(B){if(B)for(var A in B)typeof B[A]=="function"&&this.attachEvent(A,B[A])},callEvent:function(E,C){if(this.e.T)return!0;var E=E.toLowerCase(),D=this.e[E.toLowerCase()],A=!0;if(D)for(var B=0;B<D.length;B++)if(D[B].apply(this,C||[])===!1)A=!1;this.M[E]&&!this.M[E].callEvent(E,C)&&(A=!1);return A},attachEvent:function(D,B,C){var D=D.toLowerCase(),C=C||dhx.uid(),B=dhx.toFunctor(B),A=this.e[D]||dhx.toArray();A.push(B);this.e[D]=A;this.s[C]={f:B,t:D};return C},detachEvent:function(D){if(this.s[D]){var B=this.s[D].t,C=this.s[D].f,A=this.e[B];A.remove(C);delete this.s[D]}},hasEvent:function(A){A=A.toLowerCase();return this.e[A]?!0:!1}};dhx.extend(dhx,dhx.EventSystem);dhx.PowerArray={removeAt:function(B,A){B>=0&&this.splice(B,A||1)},remove:function(A){this.removeAt(this.find(A))},insertAt:function(C,A){if(!A&&A!==0)this.push(C);else{var B=this.splice(A,this.length-A);this[A]=C;this.push.apply(this,B)}},find:function(B){for(var A=0;A<this.length;A++)if(B==this[A])return A;return-1},each:function(C,A){for(var B=0;B<this.length;B++)C.call(A||this,this[B])},map:function(C,A){for(var B=0;B<this.length;B++)this[B]=C.call(A||this,this[B]);return this},filter:function(C,A){for(var B=0;B<this.length;B++)C.call(A||this,this[B])||(this.splice(B,1),B--);return this}};dhx.env={};(function(){if(navigator.userAgent.indexOf("Mobile")!=-1)dhx.env.mobile=!0;if(dhx.env.mobile||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1)dhx.env.touch=!0;navigator.userAgent.indexOf("Opera")!=-1?dhx.env.isOpera=!0:(dhx.env.isIE=!!document.all,dhx.env.isFF=!document.all,dhx.env.isWebKit=navigator.userAgent.indexOf("KHTML")!=-1,dhx.env.isSafari=dhx.env.isWebKit&&navigator.userAgent.indexOf("Mac")!=-1);if(navigator.userAgent.toLowerCase().indexOf("android")!=-1)dhx.env.isAndroid=!0;dhx.env.transform=!1;dhx.env.transition=!1;for(var G={names:["transform","transition"],transform:["transform","WebkitTransform","MozTransform","OTransform","msTransform"],transition:["transition","WebkitTransition","MozTransition","OTransition","msTransition"]},E=document.createElement("DIV"),F=0;F<G.names.length;F++)for(var C=G[G.names[F]],D=0;D<C.length;D++)if(typeof E.style[C[D]]!="undefined"){dhx.env[G.names[F]]=C[D];break}E.style[dhx.env.transform]="translate3d(0,0,0)";dhx.env.translate=E.style[dhx.env.transform]?"translate3d":"translate";var A="",B=!1;dhx.env.isOpera&&(A="-o-",B="O");dhx.env.isFF&&(A="-Moz-");dhx.env.isWebKit&&(A="-webkit-");dhx.env.isIE&&(A="-ms-");dhx.env.transformCSSPrefix=A;dhx.env.transformPrefix=B||dhx.env.transformCSSPrefix.replace(/-/gi,"");dhx.env.transitionEnd=dhx.env.transformCSSPrefix=="-Moz-"?"transitionend":dhx.env.transformPrefix+"TransitionEnd"})();dhx.env.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}();dhx.html={v:0,denySelect:function(){if(!dhx.v)dhx.v=document.onselectstart;document.onselectstart=dhx.html.stopEvent},allowSelect:function(){if(dhx.v!==0)document.onselectstart=dhx.v||null;dhx.v=0},index:function(B){for(var A=0;B=B.previousSibling;)A++;return A},ga:{},createCss:function(D){var B="",C;for(C in D)B+=C+":"+D[C]+";";var A=this.ga[B];A||(A="s"+dhx.uid(),this.addStyle("."+A+"{"+B+"}"),this.ga[B]=A);return A},addStyle:function(B){var A=document.createElement("style");A.setAttribute("type","text/css");A.setAttribute("media","screen");A.styleSheet?A.styleSheet.cssText=B:A.appendChild(document.createTextNode(B));document.getElementsByTagName("head")[0].appendChild(A)},create:function(E,C,D){var C=C||{},A=document.createElement(E),B;for(B in C)A.setAttribute(B,C[B]);if(C.style)A.style.cssText=C.style;if(C["class"])A.className=C["class"];if(D)A.innerHTML=D;return A},getValue:function(A){A=dhx.toNode(A);return!A?"":dhx.isUndefined(A.value)?A.innerHTML:A.value},remove:function(B){if(B instanceof Array){for(var A=0;A<B.length;A++)this.remove(B[A])}else B&&B.parentNode&&B.parentNode.removeChild(B)},insertBefore:function(C,A,B){C&&(A&&A.parentNode?A.parentNode.insertBefore(C,A):B.appendChild(C))},locate:function(D,B){if(D.tagName)var C=D;else D=D||event,C=D.target||D.srcElement;for(;C;){if(C.getAttribute){var A=C.getAttribute(B);if(A)return A}C=C.parentNode}return null},offset:function(G){if(G.getBoundingClientRect){var E=G.getBoundingClientRect(),F=document.body,C=document.documentElement,D=window.pageYOffset||C.scrollTop||F.scrollTop,A=window.pageXOffset||C.scrollLeft||F.scrollLeft,B=C.clientTop||F.clientTop||0,I=C.clientLeft||F.clientLeft||0,J=E.top+D-B,H=E.left+A-I;return{y:Math.round(J),x:Math.round(H)}}else{for(H=J=0;G;)J+=parseInt(G.offsetTop,10),H+=parseInt(G.offsetLeft,10),G=G.offsetParent;return{y:J,x:H}}},posRelative:function(A){A=A||event;return dhx.isUndefined(A.offsetX)?{x:A.layerX,y:A.layerY}:{x:A.offsetX,y:A.offsetY}},pos:function(B){B=B||event;if(B.pageX||B.pageY)return{x:B.pageX,y:B.pageY};var A=dhx.env.isIE&&document.compatMode!="BackCompat"?document.documentElement:document.body;return{x:B.clientX+A.scrollLeft-A.clientLeft,y:B.clientY+A.scrollTop-A.clientTop}},preventEvent:function(A){A&&A.preventDefault&&A.preventDefault();return dhx.html.stopEvent(A)},stopEvent:function(A){(A||event).cancelBubble=!0;return!1},addCss:function(B,A){B.className+=" "+A},removeCss:function(B,A){B.className=B.className.replace(RegExp(" "+A,"g"),"")}};dhx.ready=function(A){this.Ga?A.call():this.D.push(A)};dhx.D=[];(function(){var A=document.getElementsByTagName("SCRIPT");if(A.length)A=(A[A.length-1].getAttribute("src")||"").split("/"),A.splice(A.length-1,1),dhx.codebase=A.slice(0,A.length).join("/")+"/";dhx.event(window,"load",function(){dhx.callEvent("onReady",[]);dhx.delay(function(){dhx.Ga=!0;for(var A=0;A<dhx.D.length;A++)dhx.D[A].call();dhx.D=[]})})})();dhx.locale=dhx.locale||{};dhx.ready(function(){dhx.event(document.body,"click",function(A){dhx.callEvent("onClick",[A||event])})});(function(){var C={},A=RegExp("(\\r\\n|\\n)","g"),B=RegExp("(\\\")","g");dhx.Template=function(D){if(typeof D=="function")return D;if(C[D])return C[D];D=(D||"").toString();if(D.indexOf("->")!=-1)switch(D=D.split("->"),D[0]){case"html":D=dhx.html.getValue(D[1]);break;case"http":D=(new dhx.ajax).sync().get(D[1],{uid:dhx.uid()}).responseText}D=(D||"").toString();D=D.replace(A,"\\n");D=D.replace(B,"\\\"");D=D.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,"\"+(obj.$1?\"$2\":\"$3\")+\"");D=D.replace(/\{common\.([^}\(]*)\}/g,"\"+(common.$1||'')+\"");D=D.replace(/\{common\.([^\}\(]*)\(\)\}/g,"\"+(common.$1?common.$1.apply(this, arguments):\"\")+\"");D=D.replace(/\{obj\.([^}]*)\}/g,"\"+(obj.$1)+\"");D=D.replace("{obj}","\"+obj+\"");D=D.replace(/#([^#'";, ]+)#/gi,"\"+(obj.$1)+\"");try{C[D]=Function("obj","common","return \""+D+"\";")}catch(E){}return C[D]};dhx.Template.empty=function(){return""};dhx.Template.bind=function(A){return dhx.bind(dhx.Template(A),this)};dhx.Type=function(D,B){if(D.q){if(!D.r)D.r=[];D.r.push(B)}else{if(typeof D=="function")D=D.prototype;if(!D.types)D.types={"default":D.type},D.type.name="default";var C=B.name,A=D.type;C&&(A=D.types[C]=dhx.clone(B.baseType?D.types[B.baseType]:D.type));for(var E in B)A[E]=E.indexOf("template")===0?dhx.Template(B[E]):B[E];return C}}})();dhx.Settings={$init:function(){this.a=this.config={}},define:function(B,A){return typeof B=="object"?this.Q(B):this.U(B,A)},U:function(C,A){var B=this[C+"_setter"];return this.a[C]=B?B.call(this,A,C):A},Q:function(B){if(B)for(var A in B)this.U(A,B[A])},$:function(C,A){var B={};A&&(B=dhx.extend(B,A));typeof C=="object"&&!C.tagName&&dhx.extend(B,C,!0);this.Q(B)},Ba:function(C,A){for(var B in A)switch(typeof C[B]){case"object":C[B]=this.Ba(C[B]||{},A[B]);break;case"undefined":C[B]=A[B]}return C}};dhx.ajax=function(D,B,C){if(arguments.length!==0){var A=new dhx.ajax;if(C)A.master=C;return A.get(D,null,B)}return!this.getXHR?new dhx.ajax:this};dhx.ajax.count=0;dhx.ajax.prototype={master:null,getXHR:function(){return dhx.env.isIE?new ActiveXObject("Microsoft.xmlHTTP"):new XMLHttpRequest},send:function(G,E,F){var C=this.getXHR();dhx.isArray(F)||(F=[F]);if(typeof E=="object"){var D=[],A;for(A in E){var B=E[A];if(B===null||B===dhx.undefined)B="";D.push(A+"="+encodeURIComponent(B))}E=D.join("&")}E&&this.request==="GET"&&(G=G+(G.indexOf("?")!=-1?"&":"?")+E,E=null);C.open(this.request,G,!this.Na);this.request==="POST"&&C.setRequestHeader("Content-type","application/x-www-form-urlencoded");var H=this;C.onreadystatechange=function(){if(!C.readyState||C.readyState==4){dhx.ajax.count++;if(F&&H)for(var B=0;B<F.length;B++)if(F[B]){var A=F[B].success||F[B];if(C.status>=400||!C.status&&!C.responseText)A=F[B].error;A&&A.call(H.master||H,C.responseText,C.responseXML,C)}if(H)H.master=null;F=H=null}};C.send(E||null);return C},get:function(C,A,B){this.request="GET";return this.send(C,A,B)},post:function(C,A,B){this.request="POST";return this.send(C,A,B)},put:function(C,A,B){this.request="PUT";return this.send(C,A,B)},del:function(C,A,B){this.request="DELETE";return this.send(C,A,B)},sync:function(){this.Na=!0;return this},bind:function(A){this.master=A;return this}};dhx.send=function(G,E,F,C){var D=dhx.html.create("FORM",{target:C||"_self",action:G,method:F||"POST"},""),A;for(A in E){var B=dhx.html.create("INPUT",{type:"hidden",name:A,value:E[A]},"");D.appendChild(B)}D.style.display="none";document.body.appendChild(D);D.submit();document.body.removeChild(D)};dhx.AtomDataLoader={$init:function(A){this.data={};if(A)this.a.datatype=A.datatype||"json",this.$ready.push(this.Aa)},Aa:function(){this.aa=!0;this.a.url&&this.url_setter(this.a.url);this.a.data&&this.data_setter(this.a.data)},url_setter:function(A){if(!this.aa)return A;this.load(A,this.a.datatype);return A},data_setter:function(A){if(!this.aa)return A;this.parse(A,this.a.datatype);return!0},load:function(D,B,C){if(D.$proxy)D.load(this,typeof B=="string"?B:"json");else{this.callEvent("onXLS",[]);if(typeof B=="string")this.data.driver=dhx.DataDriver[B],B=C;else if(!this.data.driver)this.data.driver=dhx.DataDriver.json;var A=[{success:this.P,error:this.C}];B&&(dhx.isArray(B)?A.push.apply(A,B):A.push(B));return dhx.ajax(D,A,this)}},parse:function(B,A){this.callEvent("onXLS",[]);this.data.driver=dhx.DataDriver[A||"json"];this.P(B,null)},P:function(F,D,E){var B=this.data.driver,C=B.toObject(F,D);if(C){var A=B.getRecords(C)[0];this.data=B?B.getDetails(A):F}else this.C(F,D,E);this.callEvent("onXLE",[])},C:function(C,A,B){this.callEvent("onXLE",[]);this.callEvent("onLoadError",arguments);dhx.callEvent("onLoadError",[C,A,B,this])},z:function(B){if(!this.a.dataFeed||this.N||!B)return!0;var A=this.a.dataFeed;if(typeof A=="function")return A.call(this,B.id||B,B);A=A+(A.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(B.id||B);this.callEvent("onXLS",[]);dhx.ajax(A,function(D,C,B){this.N=!0;var A=dhx.DataDriver.toObject(D,C);A?this.setValues(A.getDetails(A.getRecords()[0])):this.C(D,C,B);this.N=!1;this.callEvent("onXLE",[])},this);return!1}};dhx.DataDriver={};dhx.DataDriver.json={toObject:function(a){a||(a="[]");if(typeof a=="string"){try{eval("dhx.temp="+a)}catch(b){return null}a=dhx.temp}if(a.data){var c=a.data.config={},d;for(d in a)d!="data"&&(c[d]=a[d]);a=a.data}return a},getRecords:function(A){return A&&!dhx.isArray(A)?[A]:A},getDetails:function(A){return typeof A=="string"?{id:dhx.uid(),value:A}:A},getInfo:function(B){var A=B.config;return!A?{}:{n:A.total_count||0,m:A.pos||0,Ea:A.parent||0,K:A.config,O:A.dhx_security}},child:"data"};dhx.DataDriver.html={toObject:function(B){if(typeof B=="string"){var A=null;B.indexOf("<")==-1&&(A=dhx.toNode(B));if(!A)A=document.createElement("DIV"),A.innerHTML=B;return A.getElementsByTagName(this.tag)}return B},getRecords:function(D){for(var B=[],C=0;C<D.childNodes.length;C++){var A=D.childNodes[C];A.nodeType==1&&B.push(A)}return B},getDetails:function(A){return dhx.DataDriver.xml.tagToObject(A)},getInfo:function(){return{n:0,m:0}},tag:"LI"};dhx.DataDriver.jsarray={toObject:function(a){return typeof a=="string"?(eval("dhx.temp="+a),dhx.temp):a},getRecords:function(A){return A},getDetails:function(C){for(var A={},B=0;B<C.length;B++)A["data"+B]=C[B];return A},getInfo:function(){return{n:0,m:0}}};dhx.DataDriver.csv={toObject:function(A){return A},getRecords:function(A){return A.split(this.row)},getDetails:function(C){for(var C=this.stringToArray(C),A={},B=0;B<C.length;B++)A["data"+B]=C[B];return A},getInfo:function(){return{n:0,m:0}},stringToArray:function(B){for(var B=B.split(this.cell),A=0;A<B.length;A++)B[A]=B[A].replace(/^[ \t\n\r]*(\"|)/g,"").replace(/(\"|)[ \t\n\r]*$/g,"");return B},row:"\n",cell:","};dhx.DataDriver.xml={Y:function(A){return!A||!A.documentElement?null:A.getElementsByTagName("parsererror").length?null:A},toObject:function(B){if(this.Y(A))return A;var A=typeof B=="string"?this.fromString(B.replace(/^[\s]+/,"")):B;return this.Y(A)?A:null},getRecords:function(A){return this.xpath(A,this.records)},records:"/*/item",child:"item",config:"/*/config",getDetails:function(A){return this.tagToObject(A,{})},getInfo:function(B){var A=this.xpath(B,this.config),A=A.length?this.assignTypes(this.tagToObject(A[0],{})):null;return{n:B.documentElement.getAttribute("total_count")||0,m:B.documentElement.getAttribute("pos")||0,Ea:B.documentElement.getAttribute("parent")||0,K:A,O:B.documentElement.getAttribute("dhx_security")||null}},xpath:function(G,E){if(window.XPathResult){var F=G;if(G.nodeName.indexOf("document")==-1)G=G.ownerDocument;for(var C=[],D=G.evaluate(E,F,null,XPathResult.ANY_TYPE,null),A=D.iterateNext();A;)C.push(A),A=D.iterateNext();return C}else{var B=!0;try{typeof G.selectNodes=="undefined"&&(B=!1)}catch(H){}if(B)return G.selectNodes(E);else{var I=E.split("/").pop();return G.getElementsByTagName(I)}}},assignTypes:function(C){for(var A in C){var B=C[A];typeof B=="object"?this.assignTypes(B):typeof B=="string"&&B!==""&&(B=="true"?C[A]=!0:B=="false"?C[A]=!1:B==B*1&&(C[A]*=1))}return C},tagToObject:function(G,E){var E=E||{},F=!1,C=G.attributes;if(C&&C.length){for(var D=0;D<C.length;D++)E[C[D].name]=C[D].value;F=!0}for(var A=G.childNodes,B={},D=0;D<A.length;D++)if(A[D].nodeType==1){var H=A[D].tagName;typeof E[H]!="undefined"?(dhx.isArray(E[H])||(E[H]=[E[H]]),E[H].push(this.tagToObject(A[D],{}))):E[A[D].tagName]=this.tagToObject(A[D],{});F=!0}if(!F)return this.nodeValue(G);E.value=E.value||this.nodeValue(G);return E},nodeValue:function(A){return A.firstChild?A.firstChild.data:""},fromString:function(C){try{if(window.DOMParser)return(new DOMParser).parseFromString(C,"text/xml");if(window.ActiveXObject){var A=new ActiveXObject("Microsoft.xmlDOM");A.loadXML(C);return A}}catch(B){return null}}};dhx.DataLoader=dhx.proto({$init:function(A){A=A||"";this.o=dhx.toArray();this.data=new dhx.DataStore;this.data.attachEvent("onClearAll",dhx.bind(this.oa,this));this.data.attachEvent("onServerConfig",dhx.bind(this.na,this));this.data.feed=this.sa},sa:function(C,A,B){if(this.u)return this.u=[C,A,B];else this.u=!0;this.W=[C,A];this.ua.call(this,C,A,B)},ua:function(D,B,C){var A=this.data.url;D<0&&(D=0);this.load(A+(A.indexOf("?")==-1?"?":"&")+(this.dataCount()?"continue=true&":"")+"start="+D+"&count="+B,[this.ta,C])},ta:function(){var B=this.u,A=this.W;this.u=!1;typeof B=="object"&&(B[0]!=A[0]||B[1]!=A[1])&&this.data.feed.apply(this,B)},load:function(C,A){var B=dhx.AtomDataLoader.load.apply(this,arguments);this.o.push(B);if(!this.data.url)this.data.url=C},loadNext:function(E,C,D,A,B){this.a.datathrottle&&!B?(this.ha&&window.clearTimeout(this.ha),this.ha=dhx.delay(function(){this.loadNext(E,C,D,A,!0)},this,0,this.a.datathrottle)):(!C&&C!==0&&(C=this.dataCount()),this.data.url=this.data.url||A,this.callEvent("onDataRequest",[C,E,D,A])&&this.data.url&&this.data.feed.call(this,C,E,D))},Ra:function(C,A){var B=this.W;return this.u&&B&&B[0]<=A&&B[1]+B[0]>=C+A?!0:!1},P:function(D,B,C){this.o.remove(C);var A=this.data.driver.toObject(D,B);if(A)this.data.Fa(A);else return this.C(D,B,C);this.pa();this.callEvent("onXLE",[])},removeMissed_setter:function(A){return this.data.Ja=A},scheme_setter:function(A){this.data.scheme(A)},dataFeed_setter:function(A){this.data.attachEvent("onBeforeFilter",dhx.bind(function(F,E){if(this.a.dataFeed){var C={};if(F||E){if(typeof F=="function"){if(!E)return;F(E,C)}else C={text:E};this.clearAll();var D=this.a.dataFeed,A=[];if(typeof D=="function")return D.call(this,E,C);for(var B in C)A.push("dhx_filter["+B+"]="+encodeURIComponent(C[B]));this.load(D+(D.indexOf("?")<0?"?":"&")+A.join("&"),this.a.datatype);return!1}}},this));return A},pa:function(){if(this.a.ready&&!this.Ha){var A=dhx.toFunctor(this.a.ready);A&&dhx.delay(A,this,arguments);this.Ha=!0}},oa:function(){for(var A=0;A<this.o.length;A++)this.o[A].abort();this.o=dhx.toArray()},na:function(A){this.Q(A)}},dhx.AtomDataLoader);dhx.DataStore=function(){this.name="DataStore";dhx.extend(this,dhx.EventSystem);this.setDriver("json");this.pull={};this.order=dhx.toArray();this.d={}};dhx.DataStore.prototype={setDriver:function(A){this.driver=dhx.DataDriver[A]},Fa:function(C){this.callEvent("onParse",[this.driver,C]);this.c&&this.filter();var A=this.driver.getInfo(C);if(A.O)dhx.securityKey=A.O;A.K&&this.callEvent("onServerConfig",[A.K]);var B=this.driver.getRecords(C);this.za(A,B);this.ba&&this.ya&&this.ya(this.ba);this.da&&(this.blockEvent(),this.sort(this.da),this.unblockEvent());this.callEvent("onStoreLoad",[this.driver,C]);this.refresh()},za:function(G,E){var F=(G.m||0)*1,C=!0,D=!1;if(F===0&&this.order[0]){if(this.Ja)for(var D={},A=0;A<this.order.length;A++)D[this.order[A]]=!0;C=!1;F=this.order.length}for(var B=0,A=0;A<E.length;A++){var I=this.driver.getDetails(E[A]),J=this.id(I);this.pull[J]?C&&this.order[B+F]&&B++:(this.order[B+F]=J,B++);this.pull[J]?(dhx.extend(this.pull[J],I,!0),this.H&&this.H(this.pull[J]),D&&delete D[J]):(this.pull[J]=I,this.G&&this.G(I))}if(D){this.blockEvent();for(var H in D)this.remove(H);this.unblockEvent()}if(!this.order[G.n-1])this.order[G.n-1]=dhx.undefined},id:function(A){return A.id||(A.id=dhx.uid())},changeId:function(B,A){this.pull[B]&&(this.pull[A]=this.pull[B]);this.pull[A].id=A;this.order[this.order.find(B)]=A;this.c&&(this.c[this.c.find(B)]=A);this.d[B]&&(this.d[A]=this.d[B],delete this.d[B]);this.callEvent("onIdChange",[B,A]);this.Ka&&this.Ka(B,A);delete this.pull[B]},item:function(A){return this.pull[A]},update:function(B,A){dhx.isUndefined(A)&&(A=this.item(B));this.H&&this.H(A);if(this.callEvent("onBeforeUpdate",[B,A])===!1)return!1;this.pull[B]=A;this.callEvent("onStoreUpdated",[B,A,"update"])},refresh:function(A){this.fa||(A?this.callEvent("onStoreUpdated",[A,this.pull[A],"paint"]):this.callEvent("onStoreUpdated",[null,null,null]))},silent:function(B,A){this.fa=!0;B.call(A||this);this.fa=!1},getRange:function(C,A){C=C?this.indexById(C):this.$min||this.startOffset||0;A?A=this.indexById(A):(A=Math.min(this.$max||this.endOffset||Infinity,this.dataCount()-1),A<0&&(A=0));if(C>A)var B=A,A=C,C=B;return this.getIndexRange(C,A)},getIndexRange:function(D,B){for(var B=Math.min(B||Infinity,this.dataCount()-1),C=dhx.toArray(),A=D||0;A<=B;A++)C.push(this.item(this.order[A]));return C},dataCount:function(){return this.order.length},exists:function(A){return!!this.pull[A]},move:function(D,B){var C=this.idByIndex(D),A=this.item(C);this.order.removeAt(D);this.order.insertAt(C,Math.min(this.order.length,B));this.callEvent("onStoreUpdated",[C,A,"move"])},scheme:function(B){this.F={};this.G=B.$init;this.H=B.$update;this.ca=B.$serialize;this.ba=B.$group;this.da=B.$sort;for(var A in B)A.substr(0,1)!="$"&&(this.F[A]=B[A])},sync:function(D,B,C){typeof D=="string"&&(D=$$("source"));typeof B!="function"&&(C=B,B=null);this.I=!1;if(D.name!="DataStore")D.data&&D.data.name=="DataStore"?D=D.data:this.I=!0;var A=dhx.bind(function(F,A,E){if(this.I){if(!F)return;if(F.indexOf("change")==0){if(F=="change")this.pull[A.id]=A.attributes,this.refresh(A.id);return}F=="reset"&&(E=A);this.order=[];this.pull={};this.c=null;for(var G=0;G<E.models.length;G++){var H=E.models[G].id;this.order.push(H);this.pull[H]=E.models[G].attributes}}else this.c=null,this.order=dhx.toArray([].concat(D.order)),this.pull=D.pull;B&&this.silent(B);this.Z&&this.Z();this.callEvent("onSyncApply",[]);C?C=!1:this.refresh()},this);this.I?D.bind("all",A):this.w=[D.attachEvent("onStoreUpdated",A)];A()},add:function(G,E,F){if(this.F)for(var C in this.F)dhx.isUndefined(G[C])&&(G[C]=this.F[C]);this.G&&this.G(G);var D=this.id(G),A=F||this.order,B=A.length;if(dhx.isUndefined(E)||E<0)E=B;E>B&&(E=Math.min(A.length,E));if(this.callEvent("onBeforeAdd",[D,G,E])===!1)return!1;this.pull[D]=G;A.insertAt(D,E);if(this.c){var H=this.c.length;!E&&this.order.length&&(H=0);this.c.insertAt(D,H)}this.callEvent("onAfterAdd",[D,E]);this.callEvent("onStoreUpdated",[D,G,"add"]);return D},remove:function(C){if(dhx.isArray(C)){for(var A=0;A<C.length;A++)this.remove(C[A])}else{if(this.callEvent("onBeforeDelete",[C])===!1)return!1;var B=this.item(C);this.order.remove(C);this.c&&this.c.remove(C);delete this.pull[C];this.d[C]&&delete this.d[C];this.callEvent("onAfterDelete",[C]);this.callEvent("onStoreUpdated",[C,B,"delete"])}},clearAll:function(){this.pull={};this.order=dhx.toArray();this.c=null;this.callEvent("onClearAll",[]);this.refresh()},idByIndex:function(A){return this.order[A]},indexById:function(B){var A=this.order.find(B);return A},next:function(B,A){return this.order[this.indexById(B)+(A||1)]},first:function(){return this.order[0]},last:function(){return this.order[this.order.length-1]},previous:function(B,A){return this.order[this.indexById(B)-(A||1)]},sort:function(E,C,D){var A=E;typeof E=="function"?A={as:E,dir:C}:typeof E=="string"&&(A={by:E.replace(/#/g,""),dir:C,as:D});var B=[A.by,A.dir,A.as];this.callEvent("onBeforeSort",B)&&(this.Ma(A),this.refresh(),this.callEvent("onAfterSort",B))},Ma:function(C){if(this.order.length){var A=this.La.qa(C),B=this.getRange(this.first(),this.last());B.sort(A);this.order=B.map(function(A){return this.id(A)},this)}},wa:function(A){if(this.c&&!A)this.order=this.c,delete this.c},va:function(F,D,E){for(var B=dhx.toArray(),C=0;C<this.order.length;C++){var A=this.order[C];F(this.item(A),D)&&B.push(A)}if(!E||!this.c)this.c=this.order;this.order=B},filter:function(D,B,C){if(this.callEvent("onBeforeFilter",[D,B])&&(this.wa(C),this.order.length)){if(D){var A=D,B=B||"";typeof D=="string"&&(D=D.replace(/#/g,""),B=B.toString().toLowerCase(),A=function(A,B){return(A[D]||"").toString().toLowerCase().indexOf(B)!=-1});this.va(A,B,C,this.Pa)}this.refresh();this.callEvent("onAfterFilter",[])}},each:function(C,A){for(var B=0;B<this.order.length;B++)C.call(A||this,this.item(this.order[B]))},Ca:function(B,A){return function(){return B[A].apply(B,arguments)}},addMark:function(E,C,D,A){var B=this.d[E]||{};this.d[E]=B;if(!B[C]&&(B[C]=A||!0,D))this.item(E).$css=(this.item(E).$css||"")+" "+C,this.refresh(E);return B[C]},removeMark:function(E,C,D){var A=this.d[E];A&&A[C]&&delete A[C];if(D){var B=this.item(E).$css;B&&(B=this.item(E).$css.replace(C,""),this.refresh(E))}},hasMark:function(C,A){var B=this.d[C];return B&&B[A]},provideApi:function(D,B){B&&this.mapEvent({onbeforesort:D,onaftersort:D,onbeforeadd:D,onafteradd:D,onbeforedelete:D,onafterdelete:D,onbeforeupdate:D});for(var C="sort,add,remove,exists,idByIndex,indexById,item,update,refresh,dataCount,filter,next,previous,clearAll,first,last,serialize,sync,addMark,removeMark,hasMark".split(","),A=0;A<C.length;A++)D[C[A]]=this.Ca(this,C[A])},serialize:function(){for(var D=this.order,B=[],C=0;C<D.length;C++){var A=this.pull[D[C]];if(this.ca&&(A=this.ca(A),A===!1))continue;B.push(A)}return B},La:{qa:function(A){return this.ra(A.dir,this.ma(A.by,A.as))},ja:{date:function(B,A){B-=0;A-=0;return B>A?1:B<A?-1:0},"int":function(B,A){B*=1;A*=1;return B>A?1:B<A?-1:0},string_strict:function(B,A){B=B.toString();A=A.toString();return B>A?1:B<A?-1:0},string:function(B,A){if(!A)return 1;if(!B)return-1;B=B.toString().toLowerCase();A=A.toString().toLowerCase();return B>A?1:B<A?-1:0}},ma:function(B,A){if(!B)return A;typeof A!="function"&&(A=this.ja[A||"string"]);return function(D,C){return A(D[B],C[B])}},ra:function(B,A){return B=="asc"||!B?A:function(C,B){return A(C,B)*-1}}}};dhx.BaseBind={bind:function(F,D,E){typeof F=="string"&&(F=dhx.ui.get(F));F.b&&F.b();this.b&&this.b();F.getBindData||dhx.extend(F,dhx.BindSource);if(!this.ka){var B=this.render;if(this.filter){var C=this.a.id;this.data.Z=function(){F.l[C]=!1}}this.render=function(){if(!this.X){this.X=!0;var A=this.callEvent("onBindRequest");this.X=!1;return B.apply(this,A===!1?arguments:[])}};if(this.getValue||this.getValues)this.save=function(){if(!this.validate||this.validate())F.setBindData(this.getValue?this.getValue:this.getValues(),this.a.id)};this.ka=!0}F.addBind(this.a.id,D,E);var A=this.a.id;this.attachEvent(this.touchable?"onAfterRender":"onBindRequest",function(){return F.getBindData(A)});!this.a.dataFeed&&this.loadNext&&this.data.attachEvent("onStoreLoad",function(){F.l[A]=!1});this.isVisible(this.a.id)&&this.refresh()},g:function(C){C.removeBind(this.a.id);var A=this.w||(this.data?this.data.w:0);if(A&&C.data)for(var B=0;B<A.length;B++)C.data.detachEvent(A[B])}};dhx.BindSource={$init:function(){this.p={};this.l={};this.A={};this.la(this)},saveBatch:function(A){this.V=!0;A.call(this);this.V=!1;this.k()},setBindData:function(C,A){A&&(this.A[A]=!0);if(this.setValue)this.setValue(C);else if(this.setValues)this.setValues(C);else{var B=this.getCursor();B&&(C=dhx.extend(this.item(B),C,!0),this.update(B,C))}this.callEvent("onBindUpdate",[C,A]);this.save&&this.save();A&&(this.A[A]=!1)},getBindData:function(C,A){if(this.l[C])return!1;var B=dhx.ui.get(C);B.isVisible(B.a.id)&&(this.l[C]=!0,this.J(B,this.p[C][0],this.p[C][1]),A&&B.filter&&B.refresh())},addBind:function(C,A,B){this.p[C]=[A,B]},removeBind:function(A){delete this.p[A];delete this.l[A];delete this.A[A]},la:function(A){A.filter?dhx.extend(this,dhx.CollectionBind):A.setValue?dhx.extend(this,dhx.ValueBind):dhx.extend(this,dhx.RecordBind)},k:function(){if(!this.V)for(var A in this.p)this.A[A]||(this.l[A]=!1,this.getBindData(A,!0))},S:function(C,A,B){C.setValue?C.setValue(B?B[A]:B):C.filter?C.data.silent(function(){this.filter(A,B)}):!B&&C.clear?C.clear():C.z(B)&&C.setValues(dhx.clone(B));C.callEvent("onBindApply",[B,A,this])}};dhx.DataValue=dhx.proto({name:"DataValue",isVisible:function(){return!0},$init:function(B){var A=(this.data=B)&&B.id?B.id:dhx.uid();this.a={id:A};dhx.ui.views[A]=this},setValue:function(A){this.data=A;this.callEvent("onChange",[A])},getValue:function(){return this.data},refresh:function(){this.callEvent("onBindRequest")}},dhx.EventSystem,dhx.BaseBind);dhx.DataRecord=dhx.proto({name:"DataRecord",isVisible:function(){return!0},$init:function(B){this.data=B||{};var A=B&&B.id?B.id:dhx.uid();this.a={id:A};dhx.ui.views[A]=this},getValues:function(){return this.data},setValues:function(A){this.data=A;this.callEvent("onChange",[A])},refresh:function(){this.callEvent("onBindRequest")}},dhx.EventSystem,dhx.BaseBind,dhx.AtomDataLoader,dhx.Settings);dhx.DataCollection=dhx.proto({name:"DataCollection",isVisible:function(){return!this.data.order.length&&!this.data.c&&!this.a.dataFeed?!1:!0},$init:function(B){this.data.provideApi(this,!0);var A=B&&B.id?B.id:dhx.uid();this.a.id=A;dhx.ui.views[A]=this;this.data.attachEvent("onStoreLoad",dhx.bind(function(){this.callEvent("onBindRequest",[])},this))},refresh:function(){this.callEvent("onBindRequest",[])}},dhx.DataLoader,dhx.EventSystem,dhx.BaseBind,dhx.Settings);dhx.ValueBind={$init:function(){this.attachEvent("onChange",this.k)},J:function(E,C,D){var A=this.getValue()||"";D&&(A=D(A));if(E.setValue)E.setValue(A);else if(E.filter)E.data.silent(function(){this.filter(C,A)});else{var B={};B[C]=A;E.z(A)&&E.setValues(B)}E.callEvent("onBindApply",[A,C,this])}};dhx.RecordBind={$init:function(){this.attachEvent("onChange",this.k)},J:function(C,A){var B=this.getValues()||null;this.S(C,A,B)}};dhx.CollectionBind={$init:function(){this.h=null;this.attachEvent("onSelectChange",function(){var A=this.getSelected();this.setCursor(A?A.id||A:null)});this.attachEvent("onAfterCursorChange",this.k);this.data.attachEvent("onStoreUpdated",dhx.bind(function(C,A,B){C&&C==this.getCursor()&&B!="paint"&&this.k()},this));this.data.attachEvent("onClearAll",dhx.bind(function(){this.h=null},this));this.data.attachEvent("onIdChange",dhx.bind(function(B,A){if(this.h==B)this.h=A},this))},setCursor:function(A){if(!(A==this.h||A!==null&&!this.item(A)))this.callEvent("onBeforeCursorChange",[this.h]),this.h=A,this.callEvent("onAfterCursorChange",[A])},getCursor:function(){return this.h},J:function(C,A){var B=this.item(this.getCursor())||this.a.defaultData||null;this.S(C,A,B)}};if(!dhx.ui)dhx.ui={};if(!dhx.ui.views)dhx.ui.views={},dhx.ui.get=function(A){return A.a?A:dhx.ui.views[A]};dhtmlXDataStore=function(C){var A=new dhx.DataCollection(C),B="_dp_init";A[B]=function(B){var A="_methods";B[A]=["dummy","dummy","changeId","dummy"];this.data.Da={add:"inserted",update:"updated","delete":"deleted"};this.data.attachEvent("onStoreUpdated",function(C,D,A){C&&!B.ea&&B.setUpdated(C,!0,this.Da[A])});A="_getRowData";B[A]=function(D){var B=this.obj.data.item(D),C={id:D,"!nativeeditor_status":this.obj.getUserData(D)};if(B)for(var A in B)A.indexOf("_")!==0&&(C[A]=B[A]);return C};this.changeId=function(A,C){this.data.changeId(A,C);B.ea=!0;this.data.callEvent("onStoreUpdated",[C,this.item(C),"update"]);B.ea=!1};A="_clearUpdateFlag";B[A]=function(){};this.ia={}};A.dummy=function(){};A.setUserData=function(C,A,B){this.ia[C]=B};A.getUserData=function(A){return this.ia[A]};A.dataFeed=function(A){this.define("dataFeed",A)};dhx.extend(A,dhx.BindSource);return A};if(window.dhtmlXDataView)dhtmlXDataView.prototype.b=function(){this.isVisible=function(){return!this.data.order.length&&!this.data.c&&!this.a.dataFeed?!1:!0};var A="_settings";this.a=this.a||this[A];if(!this.a.id)this.a.id=dhx.uid();this.unbind=dhx.BaseBind.unbind;this.unsync=dhx.BaseBind.unsync;dhx.ui.views[this.a.id]=this};if(window.dhtmlXChart)dhtmlXChart.prototype.b=function(){this.isVisible=function(){return!this.data.order.length&&!this.data.Qa&&!this.a.dataFeed?!1:!0};var A="_settings";this.a=this.a||this[A];if(!this.a.id)this.a.id=dhx.uid();this.unbind=dhx.BaseBind.unbind;this.unsync=dhx.BaseBind.unsync;dhx.ui.views[this.a.id]=this};dhx.BaseBind.unsync=function(A){return dhx.BaseBind.g.call(this,A)};dhx.BaseBind.unbind=function(A){return dhx.BaseBind.g.call(this,A)};dhx.BaseBind.legacyBind=function(){return dhx.BaseBind.bind.apply(this,arguments)};dhx.BaseBind.legacySync=function(B,A){this.b&&this.b();B.b&&B.b();this.attachEvent("onAfterEditStop",function(A){this.save(A);return!0});this.attachEvent("onDataRequest",function(D,A){for(var C=D;C<D+A;C++)if(!B.data.order[C])return B.loadNext(A,D),!1});this.save=function(E){E||(E=this.getCursor());var C=this.item(E),D=B.item(E),A;for(A in C)A.indexOf("$")!==0&&(D[A]=C[A]);B.refresh(E)};return B&&B.name=="DataCollection"?B.data.sync.apply(this.data,arguments):this.data.sync.apply(this.data,arguments)};if(window.dhtmlXForm)dhtmlXForm.prototype.bind=function(A){dhx.BaseBind.bind.apply(this,arguments);A.getBindData(this.a.id)},dhtmlXForm.prototype.unbind=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXForm.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this},dhtmlXForm.prototype.z=function(B){if(!this.a.dataFeed||this.N||!B)return!0;var A=this.a.dataFeed;if(typeof A=="function")return A.call(this,B.id||B,B);A=A+(A.indexOf("?")==-1?"?":"&")+"action=get&id="+encodeURIComponent(B.id||B);this.load(A);return!1},dhtmlXForm.prototype.setValues=dhtmlXForm.prototype.setFormData,dhtmlXForm.prototype.getValues=function(){return this.getFormData(!1,!0)},dhtmlXForm.prototype.dataFeed=function(A){this.a?this.a.dataFeed=A:this.j=A},dhtmlXForm.prototype.refresh=dhtmlXForm.prototype.isVisible=function(){return!0};if(window.scheduler){if(!window.Scheduler)window.Scheduler={};Scheduler.$syncFactory=function(A){A.sync=function(D,E){this.b&&this.b();D.b&&D.b();var B="_process_loading",C=function(){A.clearAll();for(var F=D.data.order,C=D.data.pull,G=[],H=0;H<F.length;H++)G[H]=E&&E.copy?dhx.clone(C[F[H]]):C[F[H]];A[B](G)};this.save=function(C){C||(C=this.getCursor());var B=this.item(C),A=D.item(C);this.callEvent("onStoreSave",[C,B,A])&&(dhx.extend(D.item(C),B,!0),D.update(C))};this.item=function(A){return this.getEvent(A)};this.w=[D.data.attachEvent("onStoreUpdated",function(){C.call(this)}),D.data.attachEvent("onIdChange",function(B,A){combo.changeOptionId(B,A)})];this.attachEvent("onEventChanged",function(A){this.save(A)});this.attachEvent("onEventAdded",function(B,A){D.data.pull[B]||D.add(A)});this.attachEvent("onEventDeleted",function(A){D.data.pull[A]&&D.remove(A)});C()};A.unsync=function(A){dhx.BaseBind.g.call(this,A)};A.b=function(){if(!this.a)this.a={id:dhx.uid()}}};Scheduler.$syncFactory(window.scheduler)}if(window.dhtmlXCombo)dhtmlXCombo.prototype.bind=function(){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXCombo.unbind=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXCombo.unsync=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXCombo.prototype.dataFeed=function(A){this.a?this.a.dataFeed=A:this.j=A},dhtmlXCombo.prototype.sync=function(C){this.b&&this.b();C.b&&C.b();var A=this,B=function(){A.clearAll();A.addOption(this.serialize())};this.w=[C.data.attachEvent("onStoreUpdated",function(){B.call(this)}),C.data.attachEvent("onIdChange",function(C,B){A.changeOptionId(C,B)})];B.call(C)},dhtmlXCombo.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this,this.data={silent:dhx.bind(function(A){A.call(this)},this)},dhtmlxEventable(this.data),this.attachEvent("onChange",function(){this.callEvent("onSelectChange",[this.getSelectedValue()])}),this.attachEvent("onXLE",function(){this.callEvent("onBindRequest",[])})},dhtmlXCombo.prototype.item=function(){return this.Sa},dhtmlXCombo.prototype.getSelected=function(){return this.getSelectedValue()},dhtmlXCombo.prototype.isVisible=function(){return!this.optionsArr.length&&!this.a.dataFeed?!1:!0},dhtmlXCombo.prototype.refresh=function(){this.render(!0)},dhtmlXCombo.prototype.filter=function(){alert("not implemented")};if(window.dhtmlXGridObject)dhtmlXGridObject.prototype.bind=function(C,A,B){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXGridObject.prototype.unbind=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXGridObject.prototype.unsync=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXGridObject.prototype.dataFeed=function(A){this.a?this.a.dataFeed=A:this.j=A},dhtmlXGridObject.prototype.sync=function(G,E){this.b&&this.b();G.b&&G.b();var F=this,C="_parsing",D="_parser",A="_locator",B="_process_store_row",H="_get_store_data";this.save=function(A){A||(A=this.getCursor());dhx.extend(G.item(A),this.item(A),!0);G.update(A)};var I=function(){var G=0;F.B?(G=F.B,F.B=!1):F.clearAll();var E=this.dataCount();if(E){F[C]=!0;for(var J=G;J<E;J++){var I=this.order[J];if(I&&(!G||!F.rowsBuffer[J]))F.rowsBuffer[J]={idd:I,data:this.pull[I]},F.rowsBuffer[J][D]=F[B],F.rowsBuffer[J][A]=F[H],F.rowsAr[I]=this.pull[I]}if(!F.rowsBuffer[E-1])F.rowsBuffer[E-1]=dhtmlx.undefined,F.xmlFileUrl=F.xmlFileUrl||!0;F.pagingOn?F.changePage():F.Ta&&F.Oa?F.Ua():(F.render_dataset(),F.callEvent("onXLE",[]));F[C]=!1}};this.w=[G.data.attachEvent("onStoreUpdated",function(C,B,A){A=="delete"?(F.deleteRow(C),F.data.callEvent("onStoreUpdated",[C,B,A])):A=="update"?(F.callEvent("onSyncUpdate",[B,A]),F.update(C,B),F.data.callEvent("onStoreUpdated",[C,B,A])):A=="add"?(F.callEvent("onSyncUpdate",[B,A]),F.add(C,B,this.indexById(C)),F.data.callEvent("onStoreUpdated",[C,B,A])):I.call(this)}),G.data.attachEvent("onStoreLoad",function(B,A){F.xmlFileUrl=G.data.url;F.B=B.getInfo(A).m}),G.data.attachEvent("onIdChange",function(B,A){F.changeRowId(B,A)})];F.attachEvent("onDynXLS",function(C,A){for(var B=C;B<C+A;B++)if(!G.data.order[B])return G.loadNext(A,C),!1;F.B=C;I.call(G.data)});I.call(G.data);F.attachEvent("onEditCell",function(B,A){B==2&&this.save(A);return!0});F.attachEvent("onClearAll",function(){var A="_f_rowsBuffer";this[A]=null});E&&E.sort&&F.attachEvent("onBeforeSorting",function(D,B,C){if(B=="connector")return!1;var A=this.getColumnId(D);G.sort("#"+A+"#",C=="asc"?"asc":"desc",B=="int"?B:"string");F.setSortImgState(!0,D,C);return!1});if(E&&E.filter)F.attachEvent("onFilterStart",function(C,A){var B="_con_f_used";if(F[B]&&F[B].length)return!1;G.data.silent(function(){G.filter();for(var D=0;D<C.length;D++)if(A[D]!=""){var B=F.getColumnId(C[D]);G.filter("#"+B+"#",A[D],D!=0)}});G.refresh();return!1}),F.collectValues=function(A){var B=this.getColumnId(A);return function(C){var A=[],B={};this.data.each(function(D){var E=D[C];B[E]||(B[E]=!0,A.push(E))});return A}.call(G,B)};E&&E.select&&F.attachEvent("onRowSelect",function(A){G.setCursor(A)});F.clearAndLoad=function(A){G.clearAll();G.load(A)}},dhtmlXGridObject.prototype.b=function(){if(dhx.isUndefined(this.a)){this.a={id:dhx.uid(),dataFeed:this.j};dhx.ui.views[this.a.id]=this;this.data={silent:dhx.bind(function(A){A.call(this)},this)};dhtmlxEventable(this.data);for(var B="_cCount",A=0;A<this[B];A++)this.columnIds[A]||(this.columnIds[A]="cell"+A);this.attachEvent("onSelectStateChanged",function(A){this.callEvent("onSelectChange",[A])});this.attachEvent("onSelectionCleared",function(){this.callEvent("onSelectChange",[null])});this.attachEvent("onEditCell",function(B,A){B===2&&this.getCursor&&A&&A==this.getCursor()&&this.k();return!0});this.attachEvent("onXLE",function(){this.callEvent("onBindRequest",[])})}},dhtmlXGridObject.prototype.item=function(F){if(F===null)return null;var D=this.getRowById(F);if(!D)return null;var E="_attrs",B=dhx.copy(D[E]);B.id=F;for(var C=this.getColumnsNum(),A=0;A<C;A++)B[this.columnIds[A]]=this.cells(F,A).getValue();return B},dhtmlXGridObject.prototype.update=function(F,D){for(var E=0;E<this.columnIds.length;E++){var B=this.columnIds[E];dhx.isUndefined(D[B])||this.cells(F,E).setValue(D[B])}var C="_attrs",A=this.getRowById(F)[C];for(B in D)A[B]=D[B];this.callEvent("onBindUpdate",[F])},dhtmlXGridObject.prototype.add=function(G,E,F){for(var C=[],D=0;D<this.columnIds.length;D++){var A=this.columnIds[D];C[D]=dhx.isUndefined(E[A])?"":E[A]}this.addRow(G,C,F);var B="_attrs";this.getRowById(G)[B]=dhx.copy(E)},dhtmlXGridObject.prototype.getSelected=function(){return this.getSelectedRowId()},dhtmlXGridObject.prototype.isVisible=function(){var A="_f_rowsBuffer";return!this.rowsBuffer.length&&!this[A]&&!this.a.dataFeed?!1:!0},dhtmlXGridObject.prototype.refresh=function(){this.render_dataset()},dhtmlXGridObject.prototype.filter=function(F,D){if(this.a.dataFeed){var E={};if(!F&&!D)return;if(typeof F=="function"){if(!D)return;F(D,E)}else dhx.isUndefined(F)?E=D:E[F]=D;this.clearAll();var B=this.a.dataFeed;if(typeof B=="function")return B.call(this,D,E);var C=[],A;for(A in E)C.push("dhx_filter["+A+"]="+encodeURIComponent(E[A]));this.load(B+(B.indexOf("?")<0?"?":"&")+C.join("&"));return!1}if(D===null)return this.filterBy(0,function(){return!1});this.filterBy(0,function(B,A){return F.call(this,A,D)})};if(window.dhtmlXTreeObject)dhtmlXTreeObject.prototype.bind=function(){dhx.BaseBind.bind.apply(this,arguments)},dhtmlXTreeObject.prototype.unbind=function(A){dhx.BaseBind.g.call(this,A)},dhtmlXTreeObject.prototype.dataFeed=function(A){this.a?this.a.dataFeed=A:this.j=A},dhtmlXTreeObject.prototype.b=function(){if(dhx.isUndefined(this.a))this.a={id:dhx.uid(),dataFeed:this.j},dhx.ui.views[this.a.id]=this,this.data={silent:dhx.bind(function(A){A.call(this)},this)},dhtmlxEventable(this.data),this.attachEvent("onSelect",function(A){this.callEvent("onSelectChange",[A])}),this.attachEvent("onEdit",function(B,A){B===2&&A&&A==this.getCursor()&&this.k();return!0})},dhtmlXTreeObject.prototype.item=function(A){return A===null?null:{id:A,text:this.getItemText(A)}},dhtmlXTreeObject.prototype.getSelected=function(){return this.getSelectedItemId()},dhtmlXTreeObject.prototype.isVisible=function(){return!0},dhtmlXTreeObject.prototype.refresh=function(){},dhtmlXTreeObject.prototype.filter=function(F,D){if(this.a.dataFeed){var E={};if(F||D){if(typeof F=="function"){if(!D)return;F(D,E)}else dhx.isUndefined(F)?E=D:E[F]=D;this.deleteChildItems(0);var B=this.a.dataFeed;if(typeof B=="function")return B.call(this,[data.id||data,data]);var C=[],A;for(A in E)C.push("dhx_filter["+A+"]="+encodeURIComponent(E[A]));this.loadXML(B+(B.indexOf("?")<0?"?":"&")+C.join("&"));return!1}}},dhtmlXTreeObject.prototype.update=function(B,A){dhx.isUndefined(A.text)||this.setItemText(B,A.text)};dhtmlx.skin="dhx_skyblue"